function _mergeNamespaces(e,t){for(var n=0;n<t.length;n++){const a=t[n];if(typeof a!="string"&&!Array.isArray(a)){for(const i in a)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(a,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>a[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function a(){var i=!1;try{i=this instanceof a}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var i=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(n,a,i.get?i:{enumerable:!0,get:function(){return e[a]}})}),n}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),p=Symbol.iterator;function g(I){return I===null||typeof I!="object"?null:(I=p&&I[p]||I["@@iterator"],typeof I=="function"?I:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,S={};function E(I,M,H){this.props=I,this.context=M,this.refs=S,this.updater=H||v}E.prototype.isReactComponent={},E.prototype.setState=function(I,M){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,M,"setState")},E.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function w(){}w.prototype=E.prototype;function T(I,M,H){this.props=I,this.context=M,this.refs=S,this.updater=H||v}var A=T.prototype=new w;A.constructor=T,m(A,E.prototype),A.isPureReactComponent=!0;var L=Array.isArray,k=Object.prototype.hasOwnProperty,D={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function Y(I,M,H){var G,j={},F=null,q=null;if(M!=null)for(G in M.ref!==void 0&&(q=M.ref),M.key!==void 0&&(F=""+M.key),M)k.call(M,G)&&!N.hasOwnProperty(G)&&(j[G]=M[G]);var X=arguments.length-2;if(X===1)j.children=H;else if(1<X){for(var W=Array(X),K=0;K<X;K++)W[K]=arguments[K+2];j.children=W}if(I&&I.defaultProps)for(G in X=I.defaultProps,X)j[G]===void 0&&(j[G]=X[G]);return{$$typeof:e,type:I,key:F,ref:q,props:j,_owner:D.current}}function z(I,M){return{$$typeof:e,type:I.type,key:M,ref:I.ref,props:I.props,_owner:I._owner}}function te(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function Z(I){var M={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(H){return M[H]})}var ne=/\/+/g;function oe(I,M){return typeof I=="object"&&I!==null&&I.key!=null?Z(""+I.key):M.toString(36)}function le(I,M,H,G,j){var F=typeof I;(F==="undefined"||F==="boolean")&&(I=null);var q=!1;if(I===null)q=!0;else switch(F){case"string":case"number":q=!0;break;case"object":switch(I.$$typeof){case e:case t:q=!0}}if(q)return q=I,j=j(q),I=G===""?"."+oe(q,0):G,L(j)?(H="",I!=null&&(H=I.replace(ne,"$&/")+"/"),le(j,M,H,"",function(K){return K})):j!=null&&(te(j)&&(j=z(j,H+(!j.key||q&&q.key===j.key?"":(""+j.key).replace(ne,"$&/")+"/")+I)),M.push(j)),1;if(q=0,G=G===""?".":G+":",L(I))for(var X=0;X<I.length;X++){F=I[X];var W=G+oe(F,X);q+=le(F,M,H,W,j)}else if(W=g(I),typeof W=="function")for(I=W.call(I),X=0;!(F=I.next()).done;)F=F.value,W=G+oe(F,X++),q+=le(F,M,H,W,j);else if(F==="object")throw M=String(I),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return q}function pe(I,M,H){if(I==null)return I;var G=[],j=0;return le(I,G,"","",function(F){return M.call(H,F,j++)}),G}function de(I){if(I._status===-1){var M=I._result;M=M(),M.then(function(H){(I._status===0||I._status===-1)&&(I._status=1,I._result=H)},function(H){(I._status===0||I._status===-1)&&(I._status=2,I._result=H)}),I._status===-1&&(I._status=0,I._result=M)}if(I._status===1)return I._result.default;throw I._result}var J={current:null},V={transition:null},C={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:V,ReactCurrentOwner:D};function O(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:pe,forEach:function(I,M,H){pe(I,function(){M.apply(this,arguments)},H)},count:function(I){var M=0;return pe(I,function(){M++}),M},toArray:function(I){return pe(I,function(M){return M})||[]},only:function(I){if(!te(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},react_production_min.Component=E,react_production_min.Fragment=n,react_production_min.Profiler=i,react_production_min.PureComponent=T,react_production_min.StrictMode=a,react_production_min.Suspense=h,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C,react_production_min.act=O,react_production_min.cloneElement=function(I,M,H){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var G=m({},I.props),j=I.key,F=I.ref,q=I._owner;if(M!=null){if(M.ref!==void 0&&(F=M.ref,q=D.current),M.key!==void 0&&(j=""+M.key),I.type&&I.type.defaultProps)var X=I.type.defaultProps;for(W in M)k.call(M,W)&&!N.hasOwnProperty(W)&&(G[W]=M[W]===void 0&&X!==void 0?X[W]:M[W])}var W=arguments.length-2;if(W===1)G.children=H;else if(1<W){X=Array(W);for(var K=0;K<W;K++)X[K]=arguments[K+2];G.children=X}return{$$typeof:e,type:I.type,key:j,ref:F,props:G,_owner:q}},react_production_min.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:s,_context:I},I.Consumer=I},react_production_min.createElement=Y,react_production_min.createFactory=function(I){var M=Y.bind(null,I);return M.type=I,M},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(I){return{$$typeof:c,render:I}},react_production_min.isValidElement=te,react_production_min.lazy=function(I){return{$$typeof:u,_payload:{_status:-1,_result:I},_init:de}},react_production_min.memo=function(I,M){return{$$typeof:f,type:I,compare:M===void 0?null:M}},react_production_min.startTransition=function(I){var M=V.transition;V.transition={};try{I()}finally{V.transition=M}},react_production_min.unstable_act=O,react_production_min.useCallback=function(I,M){return J.current.useCallback(I,M)},react_production_min.useContext=function(I){return J.current.useContext(I)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(I){return J.current.useDeferredValue(I)},react_production_min.useEffect=function(I,M){return J.current.useEffect(I,M)},react_production_min.useId=function(){return J.current.useId()},react_production_min.useImperativeHandle=function(I,M,H){return J.current.useImperativeHandle(I,M,H)},react_production_min.useInsertionEffect=function(I,M){return J.current.useInsertionEffect(I,M)},react_production_min.useLayoutEffect=function(I,M){return J.current.useLayoutEffect(I,M)},react_production_min.useMemo=function(I,M){return J.current.useMemo(I,M)},react_production_min.useReducer=function(I,M,H){return J.current.useReducer(I,M,H)},react_production_min.useRef=function(I){return J.current.useRef(I)},react_production_min.useState=function(I){return J.current.useState(I)},react_production_min.useSyncExternalStore=function(I,M,H){return J.current.useSyncExternalStore(I,M,H)},react_production_min.useTransition=function(){return J.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var e=requireReact(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(c,h,f){var u,p={},g=null,v=null;f!==void 0&&(g=""+f),h.key!==void 0&&(g=""+h.key),h.ref!==void 0&&(v=h.ref);for(u in h)a.call(h,u)&&!s.hasOwnProperty(u)&&(p[u]=h[u]);if(c&&c.defaultProps)for(u in h=c.defaultProps,h)p[u]===void 0&&(p[u]=h[u]);return{$$typeof:t,type:c,key:g,ref:v,props:p,_owner:i.current}}return reactJsxRuntime_production_min.Fragment=n,reactJsxRuntime_production_min.jsx=o,reactJsxRuntime_production_min.jsxs=o,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(e){function t(V,C){var O=V.length;V.push(C);e:for(;0<O;){var I=O-1>>>1,M=V[I];if(0<i(M,C))V[I]=C,V[O]=M,O=I;else break e}}function n(V){return V.length===0?null:V[0]}function a(V){if(V.length===0)return null;var C=V[0],O=V.pop();if(O!==C){V[0]=O;e:for(var I=0,M=V.length,H=M>>>1;I<H;){var G=2*(I+1)-1,j=V[G],F=G+1,q=V[F];if(0>i(j,O))F<M&&0>i(q,j)?(V[I]=q,V[F]=O,I=F):(V[I]=j,V[G]=O,I=G);else if(F<M&&0>i(q,O))V[I]=q,V[F]=O,I=F;else break e}}return C}function i(V,C){var O=V.sortIndex-C.sortIndex;return O!==0?O:V.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var h=[],f=[],u=1,p=null,g=3,v=!1,m=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(V){for(var C=n(f);C!==null;){if(C.callback===null)a(f);else if(C.startTime<=V)a(f),C.sortIndex=C.expirationTime,t(h,C);else break;C=n(f)}}function L(V){if(S=!1,A(V),!m)if(n(h)!==null)m=!0,de(k);else{var C=n(f);C!==null&&J(L,C.startTime-V)}}function k(V,C){m=!1,S&&(S=!1,w(Y),Y=-1),v=!0;var O=g;try{for(A(C),p=n(h);p!==null&&(!(p.expirationTime>C)||V&&!Z());){var I=p.callback;if(typeof I=="function"){p.callback=null,g=p.priorityLevel;var M=I(p.expirationTime<=C);C=e.unstable_now(),typeof M=="function"?p.callback=M:p===n(h)&&a(h),A(C)}else a(h);p=n(h)}if(p!==null)var H=!0;else{var G=n(f);G!==null&&J(L,G.startTime-C),H=!1}return H}finally{p=null,g=O,v=!1}}var D=!1,N=null,Y=-1,z=5,te=-1;function Z(){return!(e.unstable_now()-te<z)}function ne(){if(N!==null){var V=e.unstable_now();te=V;var C=!0;try{C=N(!0,V)}finally{C?oe():(D=!1,N=null)}}else D=!1}var oe;if(typeof T=="function")oe=function(){T(ne)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,pe=le.port2;le.port1.onmessage=ne,oe=function(){pe.postMessage(null)}}else oe=function(){E(ne,0)};function de(V){N=V,D||(D=!0,oe())}function J(V,C){Y=E(function(){V(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){m||v||(m=!0,de(k))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(h)},e.unstable_next=function(V){switch(g){case 1:case 2:case 3:var C=3;break;default:C=g}var O=g;g=C;try{return V()}finally{g=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,C){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var O=g;g=V;try{return C()}finally{g=O}},e.unstable_scheduleCallback=function(V,C,O){var I=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?I+O:I):O=I,V){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=O+M,V={id:u++,callback:C,priorityLevel:V,startTime:O,expirationTime:M,sortIndex:-1},O>I?(V.sortIndex=O,t(f,V),n(h)===null&&V===n(f)&&(S?(w(Y),Y=-1):S=!0,J(L,O-I))):(V.sortIndex=M,t(h,V),m||v||(m=!0,de(k))),V},e.unstable_shouldYield=Z,e.unstable_wrapCallback=function(V){var C=g;return function(){var O=g;g=C;try{return V.apply(this,arguments)}finally{g=O}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var e=requireReact(),t=requireScheduler();function n(l){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+l,_=1;_<arguments.length;_++)d+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,i={};function s(l,d){o(l,d),o(l+"Capture",d)}function o(l,d){for(i[l]=d,l=0;l<d.length;l++)a.add(d[l])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},p={};function g(l){return h.call(p,l)?!0:h.call(u,l)?!1:f.test(l)?p[l]=!0:(u[l]=!0,!1)}function v(l,d,_,b){if(_!==null&&_.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return b?!1:_!==null?!_.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function m(l,d,_,b){if(d===null||typeof d>"u"||v(l,d,_,b))return!0;if(b)return!1;if(_!==null)switch(_.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function S(l,d,_,b,R,B,Q){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=b,this.attributeNamespace=R,this.mustUseProperty=_,this.propertyName=l,this.type=d,this.sanitizeURL=B,this.removeEmptyString=Q}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){E[l]=new S(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var d=l[0];E[d]=new S(d,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){E[l]=new S(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){E[l]=new S(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){E[l]=new S(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){E[l]=new S(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){E[l]=new S(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){E[l]=new S(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){E[l]=new S(l,5,!1,l.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function T(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var d=l.replace(w,T);E[d]=new S(d,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var d=l.replace(w,T);E[d]=new S(d,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var d=l.replace(w,T);E[d]=new S(d,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){E[l]=new S(l,1,!1,l.toLowerCase(),null,!1,!1)}),E.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){E[l]=new S(l,1,!1,l.toLowerCase(),null,!0,!0)});function A(l,d,_,b){var R=E.hasOwnProperty(d)?E[d]:null;(R!==null?R.type!==0:b||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(m(d,_,R,b)&&(_=null),b||R===null?g(d)&&(_===null?l.removeAttribute(d):l.setAttribute(d,""+_)):R.mustUseProperty?l[R.propertyName]=_===null?R.type===3?!1:"":_:(d=R.attributeName,b=R.attributeNamespace,_===null?l.removeAttribute(d):(R=R.type,_=R===3||R===4&&_===!0?"":""+_,b?l.setAttributeNS(b,d,_):l.setAttribute(d,_))))}var L=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),D=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),Z=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),V=Symbol.iterator;function C(l){return l===null||typeof l!="object"?null:(l=V&&l[V]||l["@@iterator"],typeof l=="function"?l:null)}var O=Object.assign,I;function M(l){if(I===void 0)try{throw Error()}catch(_){var d=_.stack.trim().match(/\n( *(at )?)/);I=d&&d[1]||""}return`
`+I+l}var H=!1;function G(l,d){if(!l||H)return"";H=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(Oe){var b=Oe}Reflect.construct(l,[],d)}else{try{d.call()}catch(Oe){b=Oe}l.call(d.prototype)}else{try{throw Error()}catch(Oe){b=Oe}l()}}catch(Oe){if(Oe&&b&&typeof Oe.stack=="string"){for(var R=Oe.stack.split(`
`),B=b.stack.split(`
`),Q=R.length-1,he=B.length-1;1<=Q&&0<=he&&R[Q]!==B[he];)he--;for(;1<=Q&&0<=he;Q--,he--)if(R[Q]!==B[he]){if(Q!==1||he!==1)do if(Q--,he--,0>he||R[Q]!==B[he]){var me=`
`+R[Q].replace(" at new "," at ");return l.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",l.displayName)),me}while(1<=Q&&0<=he);break}}}finally{H=!1,Error.prepareStackTrace=_}return(l=l?l.displayName||l.name:"")?M(l):""}function j(l){switch(l.tag){case 5:return M(l.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return l=G(l.type,!1),l;case 11:return l=G(l.type.render,!1),l;case 1:return l=G(l.type,!0),l;default:return""}}function F(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case N:return"Fragment";case D:return"Portal";case z:return"Profiler";case Y:return"StrictMode";case oe:return"Suspense";case le:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case Z:return(l.displayName||"Context")+".Consumer";case te:return(l._context.displayName||"Context")+".Provider";case ne:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case pe:return d=l.displayName||null,d!==null?d:F(l.type)||"Memo";case de:d=l._payload,l=l._init;try{return F(l(d))}catch{}}return null}function q(l){var d=l.type;switch(l.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=d.render,l=l.displayName||l.name||"",d.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(d);case 8:return d===Y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function X(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function W(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function K(l){var d=W(l)?"checked":"value",_=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),b=""+l[d];if(!l.hasOwnProperty(d)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var R=_.get,B=_.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return R.call(this)},set:function(Q){b=""+Q,B.call(this,Q)}}),Object.defineProperty(l,d,{enumerable:_.enumerable}),{getValue:function(){return b},setValue:function(Q){b=""+Q},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function ae(l){l._valueTracker||(l._valueTracker=K(l))}function U(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var _=d.getValue(),b="";return l&&(b=W(l)?l.checked?"true":"false":l.value),l=b,l!==_?(d.setValue(l),!0):!1}function ve(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function be(l,d){var _=d.checked;return O({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??l._wrapperState.initialChecked})}function ye(l,d){var _=d.defaultValue==null?"":d.defaultValue,b=d.checked!=null?d.checked:d.defaultChecked;_=X(d.value!=null?d.value:_),l._wrapperState={initialChecked:b,initialValue:_,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function _e(l,d){d=d.checked,d!=null&&A(l,"checked",d,!1)}function ge(l,d){_e(l,d);var _=X(d.value),b=d.type;if(_!=null)b==="number"?(_===0&&l.value===""||l.value!=_)&&(l.value=""+_):l.value!==""+_&&(l.value=""+_);else if(b==="submit"||b==="reset"){l.removeAttribute("value");return}d.hasOwnProperty("value")?De(l,d.type,_):d.hasOwnProperty("defaultValue")&&De(l,d.type,X(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(l.defaultChecked=!!d.defaultChecked)}function Re(l,d,_){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var b=d.type;if(!(b!=="submit"&&b!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+l._wrapperState.initialValue,_||d===l.value||(l.value=d),l.defaultValue=d}_=l.name,_!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,_!==""&&(l.name=_)}function De(l,d,_){(d!=="number"||ve(l.ownerDocument)!==l)&&(_==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+_&&(l.defaultValue=""+_))}var We=Array.isArray;function ze(l,d,_,b){if(l=l.options,d){d={};for(var R=0;R<_.length;R++)d["$"+_[R]]=!0;for(_=0;_<l.length;_++)R=d.hasOwnProperty("$"+l[_].value),l[_].selected!==R&&(l[_].selected=R),R&&b&&(l[_].defaultSelected=!0)}else{for(_=""+X(_),d=null,R=0;R<l.length;R++){if(l[R].value===_){l[R].selected=!0,b&&(l[R].defaultSelected=!0);return}d!==null||l[R].disabled||(d=l[R])}d!==null&&(d.selected=!0)}}function Je(l,d){if(d.dangerouslySetInnerHTML!=null)throw Error(n(91));return O({},d,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Qe(l,d){var _=d.value;if(_==null){if(_=d.children,d=d.defaultValue,_!=null){if(d!=null)throw Error(n(92));if(We(_)){if(1<_.length)throw Error(n(93));_=_[0]}d=_}d==null&&(d=""),_=d}l._wrapperState={initialValue:X(_)}}function et(l,d){var _=X(d.value),b=X(d.defaultValue);_!=null&&(_=""+_,_!==l.value&&(l.value=_),d.defaultValue==null&&l.defaultValue!==_&&(l.defaultValue=_)),b!=null&&(l.defaultValue=""+b)}function st(l){var d=l.textContent;d===l._wrapperState.initialValue&&d!==""&&d!==null&&(l.value=d)}function vt(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xt(l,d){return l==null||l==="http://www.w3.org/1999/xhtml"?vt(d):l==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var ht,ft=(function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,_,b,R){MSApp.execUnsafeLocalFunction(function(){return l(d,_,b,R)})}:l})(function(l,d){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=d;else{for(ht=ht||document.createElement("div"),ht.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=ht.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;d.firstChild;)l.appendChild(d.firstChild)}});function tt(l,d){if(d){var _=l.firstChild;if(_&&_===l.lastChild&&_.nodeType===3){_.nodeValue=d;return}}l.textContent=d}var ut={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ht=["Webkit","ms","Moz","O"];Object.keys(ut).forEach(function(l){Ht.forEach(function(d){d=d+l.charAt(0).toUpperCase()+l.substring(1),ut[d]=ut[l]})});function St(l,d,_){return d==null||typeof d=="boolean"||d===""?"":_||typeof d!="number"||d===0||ut.hasOwnProperty(l)&&ut[l]?(""+d).trim():d+"px"}function Ie(l,d){l=l.style;for(var _ in d)if(d.hasOwnProperty(_)){var b=_.indexOf("--")===0,R=St(_,d[_],b);_==="float"&&(_="cssFloat"),b?l.setProperty(_,R):l[_]=R}}var we=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Se(l,d){if(d){if(we[l]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(n(137,l));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(n(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(n(61))}if(d.style!=null&&typeof d.style!="object")throw Error(n(62))}}function qe(l,d){if(l.indexOf("-")===-1)return typeof d.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ot=null;function Et(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var wt=null,Xt=null,Kt=null;function Yt(l){if(l=ua(l)){if(typeof wt!="function")throw Error(n(280));var d=l.stateNode;d&&(d=za(d),wt(l.stateNode,l.type,d))}}function It(l){Xt?Kt?Kt.push(l):Kt=[l]:Xt=l}function xr(){if(Xt){var l=Xt,d=Kt;if(Kt=Xt=null,Yt(l),d)for(l=0;l<d.length;l++)Yt(d[l])}}function ar(l,d){return l(d)}function Rr(){}var bt=!1;function Or(l,d,_){if(bt)return l(d,_);bt=!0;try{return ar(l,d,_)}finally{bt=!1,(Xt!==null||Kt!==null)&&(Rr(),xr())}}function ur(l,d){var _=l.stateNode;if(_===null)return null;var b=za(_);if(b===null)return null;_=b[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(l=l.type,b=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!b;break e;default:l=!1}if(l)return null;if(_&&typeof _!="function")throw Error(n(231,d,typeof _));return _}var Fr=!1;if(c)try{var ir={};Object.defineProperty(ir,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",ir,ir),window.removeEventListener("test",ir,ir)}catch{Fr=!1}function Dr(l,d,_,b,R,B,Q,he,me){var Oe=Array.prototype.slice.call(arguments,3);try{d.apply(_,Oe)}catch(Le){this.onError(Le)}}var Pt=!1,fr=null,ee=!1,ce=null,ie={onError:function(l){Pt=!0,fr=l}};function se(l,d,_,b,R,B,Q,he,me){Pt=!1,fr=null,Dr.apply(ie,arguments)}function ue(l,d,_,b,R,B,Q,he,me){if(se.apply(this,arguments),Pt){if(Pt){var Oe=fr;Pt=!1,fr=null}else throw Error(n(198));ee||(ee=!0,ce=Oe)}}function fe(l){var d=l,_=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(_=d.return),l=d.return;while(l)}return d.tag===3?_:null}function ke(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function Fe(l){if(fe(l)!==l)throw Error(n(188))}function Te(l){var d=l.alternate;if(!d){if(d=fe(l),d===null)throw Error(n(188));return d!==l?null:l}for(var _=l,b=d;;){var R=_.return;if(R===null)break;var B=R.alternate;if(B===null){if(b=R.return,b!==null){_=b;continue}break}if(R.child===B.child){for(B=R.child;B;){if(B===_)return Fe(R),l;if(B===b)return Fe(R),d;B=B.sibling}throw Error(n(188))}if(_.return!==b.return)_=R,b=B;else{for(var Q=!1,he=R.child;he;){if(he===_){Q=!0,_=R,b=B;break}if(he===b){Q=!0,b=R,_=B;break}he=he.sibling}if(!Q){for(he=B.child;he;){if(he===_){Q=!0,_=B,b=R;break}if(he===b){Q=!0,b=B,_=R;break}he=he.sibling}if(!Q)throw Error(n(189))}}if(_.alternate!==b)throw Error(n(190))}if(_.tag!==3)throw Error(n(188));return _.stateNode.current===_?l:d}function Ce(l){return l=Te(l),l!==null?Pe(l):null}function Pe(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var d=Pe(l);if(d!==null)return d;l=l.sibling}return null}var Ne=t.unstable_scheduleCallback,He=t.unstable_cancelCallback,Ge=t.unstable_shouldYield,je=t.unstable_requestPaint,$e=t.unstable_now,it=t.unstable_getCurrentPriorityLevel,pt=t.unstable_ImmediatePriority,mt=t.unstable_UserBlockingPriority,Rt=t.unstable_NormalPriority,un=t.unstable_LowPriority,Wr=t.unstable_IdlePriority,Ar=null,Nt=null;function qn(l){if(Nt&&typeof Nt.onCommitFiberRoot=="function")try{Nt.onCommitFiberRoot(Ar,l,void 0,(l.current.flags&128)===128)}catch{}}var Ot=Math.clz32?Math.clz32:Bc,Lc=Math.log,Nc=Math.LN2;function Bc(l){return l>>>=0,l===0?32:31-(Lc(l)/Nc|0)|0}var Ta=64,ka=4194304;function Vn(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Ca(l,d){var _=l.pendingLanes;if(_===0)return 0;var b=0,R=l.suspendedLanes,B=l.pingedLanes,Q=_&268435455;if(Q!==0){var he=Q&~R;he!==0?b=Vn(he):(B&=Q,B!==0&&(b=Vn(B)))}else Q=_&~R,Q!==0?b=Vn(Q):B!==0&&(b=Vn(B));if(b===0)return 0;if(d!==0&&d!==b&&(d&R)===0&&(R=b&-b,B=d&-d,R>=B||R===16&&(B&4194240)!==0))return d;if((b&4)!==0&&(b|=_&16),d=l.entangledLanes,d!==0)for(l=l.entanglements,d&=b;0<d;)_=31-Ot(d),R=1<<_,b|=l[_],d&=~R;return b}function $c(l,d){switch(l){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jc(l,d){for(var _=l.suspendedLanes,b=l.pingedLanes,R=l.expirationTimes,B=l.pendingLanes;0<B;){var Q=31-Ot(B),he=1<<Q,me=R[Q];me===-1?((he&_)===0||(he&b)!==0)&&(R[Q]=$c(he,d)):me<=d&&(l.expiredLanes|=he),B&=~he}}function Ri(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function fo(){var l=Ta;return Ta<<=1,(Ta&4194240)===0&&(Ta=64),l}function Oi(l){for(var d=[],_=0;31>_;_++)d.push(l);return d}function Gn(l,d,_){l.pendingLanes|=d,d!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,d=31-Ot(d),l[d]=_}function Uc(l,d){var _=l.pendingLanes&~d;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=d,l.mutableReadLanes&=d,l.entangledLanes&=d,d=l.entanglements;var b=l.eventTimes;for(l=l.expirationTimes;0<_;){var R=31-Ot(_),B=1<<R;d[R]=0,b[R]=-1,l[R]=-1,_&=~B}}function Fi(l,d){var _=l.entangledLanes|=d;for(l=l.entanglements;_;){var b=31-Ot(_),R=1<<b;R&d|l[b]&d&&(l[b]|=d),_&=~R}}var dt=0;function ho(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var po,Di,mo,go,vo,Ii=!1,Pa=[],Hr=null,zr=null,qr=null,Xn=new Map,Kn=new Map,Vr=[],Wc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xo(l,d){switch(l){case"focusin":case"focusout":Hr=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":qr=null;break;case"pointerover":case"pointerout":Xn.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kn.delete(d.pointerId)}}function Yn(l,d,_,b,R,B){return l===null||l.nativeEvent!==B?(l={blockedOn:d,domEventName:_,eventSystemFlags:b,nativeEvent:B,targetContainers:[R]},d!==null&&(d=ua(d),d!==null&&Di(d)),l):(l.eventSystemFlags|=b,d=l.targetContainers,R!==null&&d.indexOf(R)===-1&&d.push(R),l)}function Hc(l,d,_,b,R){switch(d){case"focusin":return Hr=Yn(Hr,l,d,_,b,R),!0;case"dragenter":return zr=Yn(zr,l,d,_,b,R),!0;case"mouseover":return qr=Yn(qr,l,d,_,b,R),!0;case"pointerover":var B=R.pointerId;return Xn.set(B,Yn(Xn.get(B)||null,l,d,_,b,R)),!0;case"gotpointercapture":return B=R.pointerId,Kn.set(B,Yn(Kn.get(B)||null,l,d,_,b,R)),!0}return!1}function yo(l){var d=fn(l.target);if(d!==null){var _=fe(d);if(_!==null){if(d=_.tag,d===13){if(d=ke(_),d!==null){l.blockedOn=d,vo(l.priority,function(){mo(_)});return}}else if(d===3&&_.stateNode.current.memoizedState.isDehydrated){l.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Ra(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var _=Li(l.domEventName,l.eventSystemFlags,d[0],l.nativeEvent);if(_===null){_=l.nativeEvent;var b=new _.constructor(_.type,_);ot=b,_.target.dispatchEvent(b),ot=null}else return d=ua(_),d!==null&&Di(d),l.blockedOn=_,!1;d.shift()}return!0}function _o(l,d,_){Ra(l)&&_.delete(d)}function zc(){Ii=!1,Hr!==null&&Ra(Hr)&&(Hr=null),zr!==null&&Ra(zr)&&(zr=null),qr!==null&&Ra(qr)&&(qr=null),Xn.forEach(_o),Kn.forEach(_o)}function Jn(l,d){l.blockedOn===d&&(l.blockedOn=null,Ii||(Ii=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,zc)))}function Zn(l){function d(R){return Jn(R,l)}if(0<Pa.length){Jn(Pa[0],l);for(var _=1;_<Pa.length;_++){var b=Pa[_];b.blockedOn===l&&(b.blockedOn=null)}}for(Hr!==null&&Jn(Hr,l),zr!==null&&Jn(zr,l),qr!==null&&Jn(qr,l),Xn.forEach(d),Kn.forEach(d),_=0;_<Vr.length;_++)b=Vr[_],b.blockedOn===l&&(b.blockedOn=null);for(;0<Vr.length&&(_=Vr[0],_.blockedOn===null);)yo(_),_.blockedOn===null&&Vr.shift()}var wn=L.ReactCurrentBatchConfig,Oa=!0;function qc(l,d,_,b){var R=dt,B=wn.transition;wn.transition=null;try{dt=1,Mi(l,d,_,b)}finally{dt=R,wn.transition=B}}function Vc(l,d,_,b){var R=dt,B=wn.transition;wn.transition=null;try{dt=4,Mi(l,d,_,b)}finally{dt=R,wn.transition=B}}function Mi(l,d,_,b){if(Oa){var R=Li(l,d,_,b);if(R===null)Qi(l,d,b,Fa,_),xo(l,b);else if(Hc(R,l,d,_,b))b.stopPropagation();else if(xo(l,b),d&4&&-1<Wc.indexOf(l)){for(;R!==null;){var B=ua(R);if(B!==null&&po(B),B=Li(l,d,_,b),B===null&&Qi(l,d,b,Fa,_),B===R)break;R=B}R!==null&&b.stopPropagation()}else Qi(l,d,b,null,_)}}var Fa=null;function Li(l,d,_,b){if(Fa=null,l=Et(b),l=fn(l),l!==null)if(d=fe(l),d===null)l=null;else if(_=d.tag,_===13){if(l=ke(d),l!==null)return l;l=null}else if(_===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null);return Fa=l,null}function So(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(it()){case pt:return 1;case mt:return 4;case Rt:case un:return 16;case Wr:return 536870912;default:return 16}default:return 16}}var Gr=null,Ni=null,Da=null;function Eo(){if(Da)return Da;var l,d=Ni,_=d.length,b,R="value"in Gr?Gr.value:Gr.textContent,B=R.length;for(l=0;l<_&&d[l]===R[l];l++);var Q=_-l;for(b=1;b<=Q&&d[_-b]===R[B-b];b++);return Da=R.slice(l,1<b?1-b:void 0)}function Ia(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function Ma(){return!0}function wo(){return!1}function sr(l){function d(_,b,R,B,Q){this._reactName=_,this._targetInst=R,this.type=b,this.nativeEvent=B,this.target=Q,this.currentTarget=null;for(var he in l)l.hasOwnProperty(he)&&(_=l[he],this[he]=_?_(B):B[he]);return this.isDefaultPrevented=(B.defaultPrevented!=null?B.defaultPrevented:B.returnValue===!1)?Ma:wo,this.isPropagationStopped=wo,this}return O(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=Ma)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=Ma)},persist:function(){},isPersistent:Ma}),d}var bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bi=sr(bn),Qn=O({},bn,{view:0,detail:0}),Gc=sr(Qn),$i,ji,ea,La=O({},Qn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wi,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==ea&&(ea&&l.type==="mousemove"?($i=l.screenX-ea.screenX,ji=l.screenY-ea.screenY):ji=$i=0,ea=l),$i)},movementY:function(l){return"movementY"in l?l.movementY:ji}}),bo=sr(La),Xc=O({},La,{dataTransfer:0}),Kc=sr(Xc),Yc=O({},Qn,{relatedTarget:0}),Ui=sr(Yc),Jc=O({},bn,{animationName:0,elapsedTime:0,pseudoElement:0}),Zc=sr(Jc),Qc=O({},bn,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),eu=sr(Qc),tu=O({},bn,{data:0}),Ao=sr(tu),ru={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},au={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iu(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=au[l])?!!d[l]:!1}function Wi(){return iu}var su=O({},Qn,{key:function(l){if(l.key){var d=ru[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=Ia(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?nu[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wi,charCode:function(l){return l.type==="keypress"?Ia(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?Ia(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),ou=sr(su),lu=O({},La,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),To=sr(lu),cu=O({},Qn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wi}),uu=sr(cu),fu=O({},bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),du=sr(fu),hu=O({},La,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),pu=sr(hu),mu=[9,13,27,32],Hi=c&&"CompositionEvent"in window,ta=null;c&&"documentMode"in document&&(ta=document.documentMode);var gu=c&&"TextEvent"in window&&!ta,ko=c&&(!Hi||ta&&8<ta&&11>=ta),Co=" ",Po=!1;function Ro(l,d){switch(l){case"keyup":return mu.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oo(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var An=!1;function vu(l,d){switch(l){case"compositionend":return Oo(d);case"keypress":return d.which!==32?null:(Po=!0,Co);case"textInput":return l=d.data,l===Co&&Po?null:l;default:return null}}function xu(l,d){if(An)return l==="compositionend"||!Hi&&Ro(l,d)?(l=Eo(),Da=Ni=Gr=null,An=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return ko&&d.locale!=="ko"?null:d.data;default:return null}}var yu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fo(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!yu[l.type]:d==="textarea"}function Do(l,d,_,b){It(b),d=Ua(d,"onChange"),0<d.length&&(_=new Bi("onChange","change",null,_,b),l.push({event:_,listeners:d}))}var ra=null,na=null;function _u(l){Jo(l,0)}function Na(l){var d=Rn(l);if(U(d))return l}function Su(l,d){if(l==="change")return d}var Io=!1;if(c){var zi;if(c){var qi="oninput"in document;if(!qi){var Mo=document.createElement("div");Mo.setAttribute("oninput","return;"),qi=typeof Mo.oninput=="function"}zi=qi}else zi=!1;Io=zi&&(!document.documentMode||9<document.documentMode)}function Lo(){ra&&(ra.detachEvent("onpropertychange",No),na=ra=null)}function No(l){if(l.propertyName==="value"&&Na(na)){var d=[];Do(d,na,l,Et(l)),Or(_u,d)}}function Eu(l,d,_){l==="focusin"?(Lo(),ra=d,na=_,ra.attachEvent("onpropertychange",No)):l==="focusout"&&Lo()}function wu(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Na(na)}function bu(l,d){if(l==="click")return Na(d)}function Au(l,d){if(l==="input"||l==="change")return Na(d)}function Tu(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var yr=typeof Object.is=="function"?Object.is:Tu;function aa(l,d){if(yr(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var _=Object.keys(l),b=Object.keys(d);if(_.length!==b.length)return!1;for(b=0;b<_.length;b++){var R=_[b];if(!h.call(d,R)||!yr(l[R],d[R]))return!1}return!0}function Bo(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function $o(l,d){var _=Bo(l);l=0;for(var b;_;){if(_.nodeType===3){if(b=l+_.textContent.length,l<=d&&b>=d)return{node:_,offset:d-l};l=b}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=Bo(_)}}function jo(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?jo(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function Uo(){for(var l=window,d=ve();d instanceof l.HTMLIFrameElement;){try{var _=typeof d.contentWindow.location.href=="string"}catch{_=!1}if(_)l=d.contentWindow;else break;d=ve(l.document)}return d}function Vi(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}function ku(l){var d=Uo(),_=l.focusedElem,b=l.selectionRange;if(d!==_&&_&&_.ownerDocument&&jo(_.ownerDocument.documentElement,_)){if(b!==null&&Vi(_)){if(d=b.start,l=b.end,l===void 0&&(l=d),"selectionStart"in _)_.selectionStart=d,_.selectionEnd=Math.min(l,_.value.length);else if(l=(d=_.ownerDocument||document)&&d.defaultView||window,l.getSelection){l=l.getSelection();var R=_.textContent.length,B=Math.min(b.start,R);b=b.end===void 0?B:Math.min(b.end,R),!l.extend&&B>b&&(R=b,b=B,B=R),R=$o(_,B);var Q=$o(_,b);R&&Q&&(l.rangeCount!==1||l.anchorNode!==R.node||l.anchorOffset!==R.offset||l.focusNode!==Q.node||l.focusOffset!==Q.offset)&&(d=d.createRange(),d.setStart(R.node,R.offset),l.removeAllRanges(),B>b?(l.addRange(d),l.extend(Q.node,Q.offset)):(d.setEnd(Q.node,Q.offset),l.addRange(d)))}}for(d=[],l=_;l=l.parentNode;)l.nodeType===1&&d.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<d.length;_++)l=d[_],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var Cu=c&&"documentMode"in document&&11>=document.documentMode,Tn=null,Gi=null,ia=null,Xi=!1;function Wo(l,d,_){var b=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;Xi||Tn==null||Tn!==ve(b)||(b=Tn,"selectionStart"in b&&Vi(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),ia&&aa(ia,b)||(ia=b,b=Ua(Gi,"onSelect"),0<b.length&&(d=new Bi("onSelect","select",null,d,_),l.push({event:d,listeners:b}),d.target=Tn)))}function Ba(l,d){var _={};return _[l.toLowerCase()]=d.toLowerCase(),_["Webkit"+l]="webkit"+d,_["Moz"+l]="moz"+d,_}var kn={animationend:Ba("Animation","AnimationEnd"),animationiteration:Ba("Animation","AnimationIteration"),animationstart:Ba("Animation","AnimationStart"),transitionend:Ba("Transition","TransitionEnd")},Ki={},Ho={};c&&(Ho=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);function $a(l){if(Ki[l])return Ki[l];if(!kn[l])return l;var d=kn[l],_;for(_ in d)if(d.hasOwnProperty(_)&&_ in Ho)return Ki[l]=d[_];return l}var zo=$a("animationend"),qo=$a("animationiteration"),Vo=$a("animationstart"),Go=$a("transitionend"),Xo=new Map,Ko="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xr(l,d){Xo.set(l,d),s(d,[l])}for(var Yi=0;Yi<Ko.length;Yi++){var Ji=Ko[Yi],Pu=Ji.toLowerCase(),Ru=Ji[0].toUpperCase()+Ji.slice(1);Xr(Pu,"on"+Ru)}Xr(zo,"onAnimationEnd"),Xr(qo,"onAnimationIteration"),Xr(Vo,"onAnimationStart"),Xr("dblclick","onDoubleClick"),Xr("focusin","onFocus"),Xr("focusout","onBlur"),Xr(Go,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ou=new Set("cancel close invalid load scroll toggle".split(" ").concat(sa));function Yo(l,d,_){var b=l.type||"unknown-event";l.currentTarget=_,ue(b,d,void 0,l),l.currentTarget=null}function Jo(l,d){d=(d&4)!==0;for(var _=0;_<l.length;_++){var b=l[_],R=b.event;b=b.listeners;e:{var B=void 0;if(d)for(var Q=b.length-1;0<=Q;Q--){var he=b[Q],me=he.instance,Oe=he.currentTarget;if(he=he.listener,me!==B&&R.isPropagationStopped())break e;Yo(R,he,Oe),B=me}else for(Q=0;Q<b.length;Q++){if(he=b[Q],me=he.instance,Oe=he.currentTarget,he=he.listener,me!==B&&R.isPropagationStopped())break e;Yo(R,he,Oe),B=me}}}if(ee)throw l=ce,ee=!1,ce=null,l}function yt(l,d){var _=d[ss];_===void 0&&(_=d[ss]=new Set);var b=l+"__bubble";_.has(b)||(Zo(d,l,2,!1),_.add(b))}function Zi(l,d,_){var b=0;d&&(b|=4),Zo(_,l,b,d)}var ja="_reactListening"+Math.random().toString(36).slice(2);function oa(l){if(!l[ja]){l[ja]=!0,a.forEach(function(_){_!=="selectionchange"&&(Ou.has(_)||Zi(_,!1,l),Zi(_,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[ja]||(d[ja]=!0,Zi("selectionchange",!1,d))}}function Zo(l,d,_,b){switch(So(d)){case 1:var R=qc;break;case 4:R=Vc;break;default:R=Mi}_=R.bind(null,d,_,l),R=void 0,!Fr||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(R=!0),b?R!==void 0?l.addEventListener(d,_,{capture:!0,passive:R}):l.addEventListener(d,_,!0):R!==void 0?l.addEventListener(d,_,{passive:R}):l.addEventListener(d,_,!1)}function Qi(l,d,_,b,R){var B=b;if((d&1)===0&&(d&2)===0&&b!==null)e:for(;;){if(b===null)return;var Q=b.tag;if(Q===3||Q===4){var he=b.stateNode.containerInfo;if(he===R||he.nodeType===8&&he.parentNode===R)break;if(Q===4)for(Q=b.return;Q!==null;){var me=Q.tag;if((me===3||me===4)&&(me=Q.stateNode.containerInfo,me===R||me.nodeType===8&&me.parentNode===R))return;Q=Q.return}for(;he!==null;){if(Q=fn(he),Q===null)return;if(me=Q.tag,me===5||me===6){b=B=Q;continue e}he=he.parentNode}}b=b.return}Or(function(){var Oe=B,Le=Et(_),Be=[];e:{var Me=Xo.get(l);if(Me!==void 0){var Ve=Bi,Ke=l;switch(l){case"keypress":if(Ia(_)===0)break e;case"keydown":case"keyup":Ve=ou;break;case"focusin":Ke="focus",Ve=Ui;break;case"focusout":Ke="blur",Ve=Ui;break;case"beforeblur":case"afterblur":Ve=Ui;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=bo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=Kc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=uu;break;case zo:case qo:case Vo:Ve=Zc;break;case Go:Ve=du;break;case"scroll":Ve=Gc;break;case"wheel":Ve=pu;break;case"copy":case"cut":case"paste":Ve=eu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=To}var Ye=(d&4)!==0,Ft=!Ye&&l==="scroll",Ee=Ye?Me!==null?Me+"Capture":null:Me;Ye=[];for(var xe=Oe,Ae;xe!==null;){Ae=xe;var Ue=Ae.stateNode;if(Ae.tag===5&&Ue!==null&&(Ae=Ue,Ee!==null&&(Ue=ur(xe,Ee),Ue!=null&&Ye.push(la(xe,Ue,Ae)))),Ft)break;xe=xe.return}0<Ye.length&&(Me=new Ve(Me,Ke,null,_,Le),Be.push({event:Me,listeners:Ye}))}}if((d&7)===0){e:{if(Me=l==="mouseover"||l==="pointerover",Ve=l==="mouseout"||l==="pointerout",Me&&_!==ot&&(Ke=_.relatedTarget||_.fromElement)&&(fn(Ke)||Ke[Ir]))break e;if((Ve||Me)&&(Me=Le.window===Le?Le:(Me=Le.ownerDocument)?Me.defaultView||Me.parentWindow:window,Ve?(Ke=_.relatedTarget||_.toElement,Ve=Oe,Ke=Ke?fn(Ke):null,Ke!==null&&(Ft=fe(Ke),Ke!==Ft||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):(Ve=null,Ke=Oe),Ve!==Ke)){if(Ye=bo,Ue="onMouseLeave",Ee="onMouseEnter",xe="mouse",(l==="pointerout"||l==="pointerover")&&(Ye=To,Ue="onPointerLeave",Ee="onPointerEnter",xe="pointer"),Ft=Ve==null?Me:Rn(Ve),Ae=Ke==null?Me:Rn(Ke),Me=new Ye(Ue,xe+"leave",Ve,_,Le),Me.target=Ft,Me.relatedTarget=Ae,Ue=null,fn(Le)===Oe&&(Ye=new Ye(Ee,xe+"enter",Ke,_,Le),Ye.target=Ae,Ye.relatedTarget=Ft,Ue=Ye),Ft=Ue,Ve&&Ke)t:{for(Ye=Ve,Ee=Ke,xe=0,Ae=Ye;Ae;Ae=Cn(Ae))xe++;for(Ae=0,Ue=Ee;Ue;Ue=Cn(Ue))Ae++;for(;0<xe-Ae;)Ye=Cn(Ye),xe--;for(;0<Ae-xe;)Ee=Cn(Ee),Ae--;for(;xe--;){if(Ye===Ee||Ee!==null&&Ye===Ee.alternate)break t;Ye=Cn(Ye),Ee=Cn(Ee)}Ye=null}else Ye=null;Ve!==null&&Qo(Be,Me,Ve,Ye,!1),Ke!==null&&Ft!==null&&Qo(Be,Ft,Ke,Ye,!0)}}e:{if(Me=Oe?Rn(Oe):window,Ve=Me.nodeName&&Me.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&Me.type==="file")var Ze=Su;else if(Fo(Me))if(Io)Ze=Au;else{Ze=wu;var rt=Eu}else(Ve=Me.nodeName)&&Ve.toLowerCase()==="input"&&(Me.type==="checkbox"||Me.type==="radio")&&(Ze=bu);if(Ze&&(Ze=Ze(l,Oe))){Do(Be,Ze,_,Le);break e}rt&&rt(l,Me,Oe),l==="focusout"&&(rt=Me._wrapperState)&&rt.controlled&&Me.type==="number"&&De(Me,"number",Me.value)}switch(rt=Oe?Rn(Oe):window,l){case"focusin":(Fo(rt)||rt.contentEditable==="true")&&(Tn=rt,Gi=Oe,ia=null);break;case"focusout":ia=Gi=Tn=null;break;case"mousedown":Xi=!0;break;case"contextmenu":case"mouseup":case"dragend":Xi=!1,Wo(Be,_,Le);break;case"selectionchange":if(Cu)break;case"keydown":case"keyup":Wo(Be,_,Le)}var nt;if(Hi)e:{switch(l){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else An?Ro(l,_)&&(at="onCompositionEnd"):l==="keydown"&&_.keyCode===229&&(at="onCompositionStart");at&&(ko&&_.locale!=="ko"&&(An||at!=="onCompositionStart"?at==="onCompositionEnd"&&An&&(nt=Eo()):(Gr=Le,Ni="value"in Gr?Gr.value:Gr.textContent,An=!0)),rt=Ua(Oe,at),0<rt.length&&(at=new Ao(at,l,null,_,Le),Be.push({event:at,listeners:rt}),nt?at.data=nt:(nt=Oo(_),nt!==null&&(at.data=nt)))),(nt=gu?vu(l,_):xu(l,_))&&(Oe=Ua(Oe,"onBeforeInput"),0<Oe.length&&(Le=new Ao("onBeforeInput","beforeinput",null,_,Le),Be.push({event:Le,listeners:Oe}),Le.data=nt))}Jo(Be,d)})}function la(l,d,_){return{instance:l,listener:d,currentTarget:_}}function Ua(l,d){for(var _=d+"Capture",b=[];l!==null;){var R=l,B=R.stateNode;R.tag===5&&B!==null&&(R=B,B=ur(l,_),B!=null&&b.unshift(la(l,B,R)),B=ur(l,d),B!=null&&b.push(la(l,B,R))),l=l.return}return b}function Cn(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function Qo(l,d,_,b,R){for(var B=d._reactName,Q=[];_!==null&&_!==b;){var he=_,me=he.alternate,Oe=he.stateNode;if(me!==null&&me===b)break;he.tag===5&&Oe!==null&&(he=Oe,R?(me=ur(_,B),me!=null&&Q.unshift(la(_,me,he))):R||(me=ur(_,B),me!=null&&Q.push(la(_,me,he)))),_=_.return}Q.length!==0&&l.push({event:d,listeners:Q})}var Fu=/\r\n?/g,Du=/\u0000|\uFFFD/g;function el(l){return(typeof l=="string"?l:""+l).replace(Fu,`
`).replace(Du,"")}function Wa(l,d,_){if(d=el(d),el(l)!==d&&_)throw Error(n(425))}function Ha(){}var es=null,ts=null;function rs(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var ns=typeof setTimeout=="function"?setTimeout:void 0,Iu=typeof clearTimeout=="function"?clearTimeout:void 0,tl=typeof Promise=="function"?Promise:void 0,Mu=typeof queueMicrotask=="function"?queueMicrotask:typeof tl<"u"?function(l){return tl.resolve(null).then(l).catch(Lu)}:ns;function Lu(l){setTimeout(function(){throw l})}function as(l,d){var _=d,b=0;do{var R=_.nextSibling;if(l.removeChild(_),R&&R.nodeType===8)if(_=R.data,_==="/$"){if(b===0){l.removeChild(R),Zn(d);return}b--}else _!=="$"&&_!=="$?"&&_!=="$!"||b++;_=R}while(_);Zn(d)}function Kr(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return l}function rl(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var _=l.data;if(_==="$"||_==="$!"||_==="$?"){if(d===0)return l;d--}else _==="/$"&&d++}l=l.previousSibling}return null}var Pn=Math.random().toString(36).slice(2),Tr="__reactFiber$"+Pn,ca="__reactProps$"+Pn,Ir="__reactContainer$"+Pn,ss="__reactEvents$"+Pn,Nu="__reactListeners$"+Pn,Bu="__reactHandles$"+Pn;function fn(l){var d=l[Tr];if(d)return d;for(var _=l.parentNode;_;){if(d=_[Ir]||_[Tr]){if(_=d.alternate,d.child!==null||_!==null&&_.child!==null)for(l=rl(l);l!==null;){if(_=l[Tr])return _;l=rl(l)}return d}l=_,_=l.parentNode}return null}function ua(l){return l=l[Tr]||l[Ir],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Rn(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(n(33))}function za(l){return l[ca]||null}var os=[],On=-1;function Yr(l){return{current:l}}function _t(l){0>On||(l.current=os[On],os[On]=null,On--)}function gt(l,d){On++,os[On]=l.current,l.current=d}var Jr={},zt=Yr(Jr),Qt=Yr(!1),dn=Jr;function Fn(l,d){var _=l.type.contextTypes;if(!_)return Jr;var b=l.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===d)return b.__reactInternalMemoizedMaskedChildContext;var R={},B;for(B in _)R[B]=d[B];return b&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=d,l.__reactInternalMemoizedMaskedChildContext=R),R}function er(l){return l=l.childContextTypes,l!=null}function qa(){_t(Qt),_t(zt)}function nl(l,d,_){if(zt.current!==Jr)throw Error(n(168));gt(zt,d),gt(Qt,_)}function al(l,d,_){var b=l.stateNode;if(d=d.childContextTypes,typeof b.getChildContext!="function")return _;b=b.getChildContext();for(var R in b)if(!(R in d))throw Error(n(108,q(l)||"Unknown",R));return O({},_,b)}function Va(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Jr,dn=zt.current,gt(zt,l),gt(Qt,Qt.current),!0}function il(l,d,_){var b=l.stateNode;if(!b)throw Error(n(169));_?(l=al(l,d,dn),b.__reactInternalMemoizedMergedChildContext=l,_t(Qt),_t(zt),gt(zt,l)):_t(Qt),gt(Qt,_)}var Mr=null,Ga=!1,ls=!1;function sl(l){Mr===null?Mr=[l]:Mr.push(l)}function $u(l){Ga=!0,sl(l)}function Zr(){if(!ls&&Mr!==null){ls=!0;var l=0,d=dt;try{var _=Mr;for(dt=1;l<_.length;l++){var b=_[l];do b=b(!0);while(b!==null)}Mr=null,Ga=!1}catch(R){throw Mr!==null&&(Mr=Mr.slice(l+1)),Ne(pt,Zr),R}finally{dt=d,ls=!1}}return null}var Dn=[],In=0,Xa=null,Ka=0,dr=[],hr=0,hn=null,Lr=1,Nr="";function pn(l,d){Dn[In++]=Ka,Dn[In++]=Xa,Xa=l,Ka=d}function ol(l,d,_){dr[hr++]=Lr,dr[hr++]=Nr,dr[hr++]=hn,hn=l;var b=Lr;l=Nr;var R=32-Ot(b)-1;b&=~(1<<R),_+=1;var B=32-Ot(d)+R;if(30<B){var Q=R-R%5;B=(b&(1<<Q)-1).toString(32),b>>=Q,R-=Q,Lr=1<<32-Ot(d)+R|_<<R|b,Nr=B+l}else Lr=1<<B|_<<R|b,Nr=l}function cs(l){l.return!==null&&(pn(l,1),ol(l,1,0))}function us(l){for(;l===Xa;)Xa=Dn[--In],Dn[In]=null,Ka=Dn[--In],Dn[In]=null;for(;l===hn;)hn=dr[--hr],dr[hr]=null,Nr=dr[--hr],dr[hr]=null,Lr=dr[--hr],dr[hr]=null}var or=null,lr=null,At=!1,_r=null;function ll(l,d){var _=vr(5,null,null,0);_.elementType="DELETED",_.stateNode=d,_.return=l,d=l.deletions,d===null?(l.deletions=[_],l.flags|=16):d.push(_)}function cl(l,d){switch(l.tag){case 5:var _=l.type;return d=d.nodeType!==1||_.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(l.stateNode=d,or=l,lr=Kr(d.firstChild),!0):!1;case 6:return d=l.pendingProps===""||d.nodeType!==3?null:d,d!==null?(l.stateNode=d,or=l,lr=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(_=hn!==null?{id:Lr,overflow:Nr}:null,l.memoizedState={dehydrated:d,treeContext:_,retryLane:1073741824},_=vr(18,null,null,0),_.stateNode=d,_.return=l,l.child=_,or=l,lr=null,!0):!1;default:return!1}}function fs(l){return(l.mode&1)!==0&&(l.flags&128)===0}function ds(l){if(At){var d=lr;if(d){var _=d;if(!cl(l,d)){if(fs(l))throw Error(n(418));d=Kr(_.nextSibling);var b=or;d&&cl(l,d)?ll(b,_):(l.flags=l.flags&-4097|2,At=!1,or=l)}}else{if(fs(l))throw Error(n(418));l.flags=l.flags&-4097|2,At=!1,or=l}}}function ul(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;or=l}function Ya(l){if(l!==or)return!1;if(!At)return ul(l),At=!0,!1;var d;if((d=l.tag!==3)&&!(d=l.tag!==5)&&(d=l.type,d=d!=="head"&&d!=="body"&&!rs(l.type,l.memoizedProps)),d&&(d=lr)){if(fs(l))throw fl(),Error(n(418));for(;d;)ll(l,d),d=Kr(d.nextSibling)}if(ul(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8){var _=l.data;if(_==="/$"){if(d===0){lr=Kr(l.nextSibling);break e}d--}else _!=="$"&&_!=="$!"&&_!=="$?"||d++}l=l.nextSibling}lr=null}}else lr=or?Kr(l.stateNode.nextSibling):null;return!0}function fl(){for(var l=lr;l;)l=Kr(l.nextSibling)}function Mn(){lr=or=null,At=!1}function hs(l){_r===null?_r=[l]:_r.push(l)}var ju=L.ReactCurrentBatchConfig;function fa(l,d,_){if(l=_.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(n(309));var b=_.stateNode}if(!b)throw Error(n(147,l));var R=b,B=""+l;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===B?d.ref:(d=function(Q){var he=R.refs;Q===null?delete he[B]:he[B]=Q},d._stringRef=B,d)}if(typeof l!="string")throw Error(n(284));if(!_._owner)throw Error(n(290,l))}return l}function Ja(l,d){throw l=Object.prototype.toString.call(d),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l))}function dl(l){var d=l._init;return d(l._payload)}function hl(l){function d(Ee,xe){if(l){var Ae=Ee.deletions;Ae===null?(Ee.deletions=[xe],Ee.flags|=16):Ae.push(xe)}}function _(Ee,xe){if(!l)return null;for(;xe!==null;)d(Ee,xe),xe=xe.sibling;return null}function b(Ee,xe){for(Ee=new Map;xe!==null;)xe.key!==null?Ee.set(xe.key,xe):Ee.set(xe.index,xe),xe=xe.sibling;return Ee}function R(Ee,xe){return Ee=on(Ee,xe),Ee.index=0,Ee.sibling=null,Ee}function B(Ee,xe,Ae){return Ee.index=Ae,l?(Ae=Ee.alternate,Ae!==null?(Ae=Ae.index,Ae<xe?(Ee.flags|=2,xe):Ae):(Ee.flags|=2,xe)):(Ee.flags|=1048576,xe)}function Q(Ee){return l&&Ee.alternate===null&&(Ee.flags|=2),Ee}function he(Ee,xe,Ae,Ue){return xe===null||xe.tag!==6?(xe=io(Ae,Ee.mode,Ue),xe.return=Ee,xe):(xe=R(xe,Ae),xe.return=Ee,xe)}function me(Ee,xe,Ae,Ue){var Ze=Ae.type;return Ze===N?Le(Ee,xe,Ae.props.children,Ue,Ae.key):xe!==null&&(xe.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===de&&dl(Ze)===xe.type)?(Ue=R(xe,Ae.props),Ue.ref=fa(Ee,xe,Ae),Ue.return=Ee,Ue):(Ue=Ei(Ae.type,Ae.key,Ae.props,null,Ee.mode,Ue),Ue.ref=fa(Ee,xe,Ae),Ue.return=Ee,Ue)}function Oe(Ee,xe,Ae,Ue){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Ae.containerInfo||xe.stateNode.implementation!==Ae.implementation?(xe=so(Ae,Ee.mode,Ue),xe.return=Ee,xe):(xe=R(xe,Ae.children||[]),xe.return=Ee,xe)}function Le(Ee,xe,Ae,Ue,Ze){return xe===null||xe.tag!==7?(xe=En(Ae,Ee.mode,Ue,Ze),xe.return=Ee,xe):(xe=R(xe,Ae),xe.return=Ee,xe)}function Be(Ee,xe,Ae){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return xe=io(""+xe,Ee.mode,Ae),xe.return=Ee,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case k:return Ae=Ei(xe.type,xe.key,xe.props,null,Ee.mode,Ae),Ae.ref=fa(Ee,null,xe),Ae.return=Ee,Ae;case D:return xe=so(xe,Ee.mode,Ae),xe.return=Ee,xe;case de:var Ue=xe._init;return Be(Ee,Ue(xe._payload),Ae)}if(We(xe)||C(xe))return xe=En(xe,Ee.mode,Ae,null),xe.return=Ee,xe;Ja(Ee,xe)}return null}function Me(Ee,xe,Ae,Ue){var Ze=xe!==null?xe.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return Ze!==null?null:he(Ee,xe,""+Ae,Ue);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case k:return Ae.key===Ze?me(Ee,xe,Ae,Ue):null;case D:return Ae.key===Ze?Oe(Ee,xe,Ae,Ue):null;case de:return Ze=Ae._init,Me(Ee,xe,Ze(Ae._payload),Ue)}if(We(Ae)||C(Ae))return Ze!==null?null:Le(Ee,xe,Ae,Ue,null);Ja(Ee,Ae)}return null}function Ve(Ee,xe,Ae,Ue,Ze){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return Ee=Ee.get(Ae)||null,he(xe,Ee,""+Ue,Ze);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case k:return Ee=Ee.get(Ue.key===null?Ae:Ue.key)||null,me(xe,Ee,Ue,Ze);case D:return Ee=Ee.get(Ue.key===null?Ae:Ue.key)||null,Oe(xe,Ee,Ue,Ze);case de:var rt=Ue._init;return Ve(Ee,xe,Ae,rt(Ue._payload),Ze)}if(We(Ue)||C(Ue))return Ee=Ee.get(Ae)||null,Le(xe,Ee,Ue,Ze,null);Ja(xe,Ue)}return null}function Ke(Ee,xe,Ae,Ue){for(var Ze=null,rt=null,nt=xe,at=xe=0,jt=null;nt!==null&&at<Ae.length;at++){nt.index>at?(jt=nt,nt=null):jt=nt.sibling;var ct=Me(Ee,nt,Ae[at],Ue);if(ct===null){nt===null&&(nt=jt);break}l&&nt&&ct.alternate===null&&d(Ee,nt),xe=B(ct,xe,at),rt===null?Ze=ct:rt.sibling=ct,rt=ct,nt=jt}if(at===Ae.length)return _(Ee,nt),At&&pn(Ee,at),Ze;if(nt===null){for(;at<Ae.length;at++)nt=Be(Ee,Ae[at],Ue),nt!==null&&(xe=B(nt,xe,at),rt===null?Ze=nt:rt.sibling=nt,rt=nt);return At&&pn(Ee,at),Ze}for(nt=b(Ee,nt);at<Ae.length;at++)jt=Ve(nt,Ee,at,Ae[at],Ue),jt!==null&&(l&&jt.alternate!==null&&nt.delete(jt.key===null?at:jt.key),xe=B(jt,xe,at),rt===null?Ze=jt:rt.sibling=jt,rt=jt);return l&&nt.forEach(function(cn){return d(Ee,cn)}),At&&pn(Ee,at),Ze}function Ye(Ee,xe,Ae,Ue){var Ze=C(Ae);if(typeof Ze!="function")throw Error(n(150));if(Ae=Ze.call(Ae),Ae==null)throw Error(n(151));for(var rt=Ze=null,nt=xe,at=xe=0,jt=null,ct=Ae.next();nt!==null&&!ct.done;at++,ct=Ae.next()){nt.index>at?(jt=nt,nt=null):jt=nt.sibling;var cn=Me(Ee,nt,ct.value,Ue);if(cn===null){nt===null&&(nt=jt);break}l&&nt&&cn.alternate===null&&d(Ee,nt),xe=B(cn,xe,at),rt===null?Ze=cn:rt.sibling=cn,rt=cn,nt=jt}if(ct.done)return _(Ee,nt),At&&pn(Ee,at),Ze;if(nt===null){for(;!ct.done;at++,ct=Ae.next())ct=Be(Ee,ct.value,Ue),ct!==null&&(xe=B(ct,xe,at),rt===null?Ze=ct:rt.sibling=ct,rt=ct);return At&&pn(Ee,at),Ze}for(nt=b(Ee,nt);!ct.done;at++,ct=Ae.next())ct=Ve(nt,Ee,at,ct.value,Ue),ct!==null&&(l&&ct.alternate!==null&&nt.delete(ct.key===null?at:ct.key),xe=B(ct,xe,at),rt===null?Ze=ct:rt.sibling=ct,rt=ct);return l&&nt.forEach(function(_f){return d(Ee,_f)}),At&&pn(Ee,at),Ze}function Ft(Ee,xe,Ae,Ue){if(typeof Ae=="object"&&Ae!==null&&Ae.type===N&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case k:e:{for(var Ze=Ae.key,rt=xe;rt!==null;){if(rt.key===Ze){if(Ze=Ae.type,Ze===N){if(rt.tag===7){_(Ee,rt.sibling),xe=R(rt,Ae.props.children),xe.return=Ee,Ee=xe;break e}}else if(rt.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===de&&dl(Ze)===rt.type){_(Ee,rt.sibling),xe=R(rt,Ae.props),xe.ref=fa(Ee,rt,Ae),xe.return=Ee,Ee=xe;break e}_(Ee,rt);break}else d(Ee,rt);rt=rt.sibling}Ae.type===N?(xe=En(Ae.props.children,Ee.mode,Ue,Ae.key),xe.return=Ee,Ee=xe):(Ue=Ei(Ae.type,Ae.key,Ae.props,null,Ee.mode,Ue),Ue.ref=fa(Ee,xe,Ae),Ue.return=Ee,Ee=Ue)}return Q(Ee);case D:e:{for(rt=Ae.key;xe!==null;){if(xe.key===rt)if(xe.tag===4&&xe.stateNode.containerInfo===Ae.containerInfo&&xe.stateNode.implementation===Ae.implementation){_(Ee,xe.sibling),xe=R(xe,Ae.children||[]),xe.return=Ee,Ee=xe;break e}else{_(Ee,xe);break}else d(Ee,xe);xe=xe.sibling}xe=so(Ae,Ee.mode,Ue),xe.return=Ee,Ee=xe}return Q(Ee);case de:return rt=Ae._init,Ft(Ee,xe,rt(Ae._payload),Ue)}if(We(Ae))return Ke(Ee,xe,Ae,Ue);if(C(Ae))return Ye(Ee,xe,Ae,Ue);Ja(Ee,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"?(Ae=""+Ae,xe!==null&&xe.tag===6?(_(Ee,xe.sibling),xe=R(xe,Ae),xe.return=Ee,Ee=xe):(_(Ee,xe),xe=io(Ae,Ee.mode,Ue),xe.return=Ee,Ee=xe),Q(Ee)):_(Ee,xe)}return Ft}var Ln=hl(!0),pl=hl(!1),Za=Yr(null),Qa=null,Nn=null,ps=null;function ms(){ps=Nn=Qa=null}function gs(l){var d=Za.current;_t(Za),l._currentValue=d}function vs(l,d,_){for(;l!==null;){var b=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,b!==null&&(b.childLanes|=d)):b!==null&&(b.childLanes&d)!==d&&(b.childLanes|=d),l===_)break;l=l.return}}function Bn(l,d){Qa=l,ps=Nn=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&d)!==0&&(tr=!0),l.firstContext=null)}function pr(l){var d=l._currentValue;if(ps!==l)if(l={context:l,memoizedValue:d,next:null},Nn===null){if(Qa===null)throw Error(n(308));Nn=l,Qa.dependencies={lanes:0,firstContext:l}}else Nn=Nn.next=l;return d}var mn=null;function xs(l){mn===null?mn=[l]:mn.push(l)}function ml(l,d,_,b){var R=d.interleaved;return R===null?(_.next=_,xs(d)):(_.next=R.next,R.next=_),d.interleaved=_,Br(l,b)}function Br(l,d){l.lanes|=d;var _=l.alternate;for(_!==null&&(_.lanes|=d),_=l,l=l.return;l!==null;)l.childLanes|=d,_=l.alternate,_!==null&&(_.childLanes|=d),_=l,l=l.return;return _.tag===3?_.stateNode:null}var Qr=!1;function ys(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gl(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function $r(l,d){return{eventTime:l,lane:d,tag:0,payload:null,callback:null,next:null}}function en(l,d,_){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(lt&2)!==0){var R=b.pending;return R===null?d.next=d:(d.next=R.next,R.next=d),b.pending=d,Br(l,_)}return R=b.interleaved,R===null?(d.next=d,xs(b)):(d.next=R.next,R.next=d),b.interleaved=d,Br(l,_)}function ei(l,d,_){if(d=d.updateQueue,d!==null&&(d=d.shared,(_&4194240)!==0)){var b=d.lanes;b&=l.pendingLanes,_|=b,d.lanes=_,Fi(l,_)}}function vl(l,d){var _=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,_===b)){var R=null,B=null;if(_=_.firstBaseUpdate,_!==null){do{var Q={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};B===null?R=B=Q:B=B.next=Q,_=_.next}while(_!==null);B===null?R=B=d:B=B.next=d}else R=B=d;_={baseState:b.baseState,firstBaseUpdate:R,lastBaseUpdate:B,shared:b.shared,effects:b.effects},l.updateQueue=_;return}l=_.lastBaseUpdate,l===null?_.firstBaseUpdate=d:l.next=d,_.lastBaseUpdate=d}function ti(l,d,_,b){var R=l.updateQueue;Qr=!1;var B=R.firstBaseUpdate,Q=R.lastBaseUpdate,he=R.shared.pending;if(he!==null){R.shared.pending=null;var me=he,Oe=me.next;me.next=null,Q===null?B=Oe:Q.next=Oe,Q=me;var Le=l.alternate;Le!==null&&(Le=Le.updateQueue,he=Le.lastBaseUpdate,he!==Q&&(he===null?Le.firstBaseUpdate=Oe:he.next=Oe,Le.lastBaseUpdate=me))}if(B!==null){var Be=R.baseState;Q=0,Le=Oe=me=null,he=B;do{var Me=he.lane,Ve=he.eventTime;if((b&Me)===Me){Le!==null&&(Le=Le.next={eventTime:Ve,lane:0,tag:he.tag,payload:he.payload,callback:he.callback,next:null});e:{var Ke=l,Ye=he;switch(Me=d,Ve=_,Ye.tag){case 1:if(Ke=Ye.payload,typeof Ke=="function"){Be=Ke.call(Ve,Be,Me);break e}Be=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Ye.payload,Me=typeof Ke=="function"?Ke.call(Ve,Be,Me):Ke,Me==null)break e;Be=O({},Be,Me);break e;case 2:Qr=!0}}he.callback!==null&&he.lane!==0&&(l.flags|=64,Me=R.effects,Me===null?R.effects=[he]:Me.push(he))}else Ve={eventTime:Ve,lane:Me,tag:he.tag,payload:he.payload,callback:he.callback,next:null},Le===null?(Oe=Le=Ve,me=Be):Le=Le.next=Ve,Q|=Me;if(he=he.next,he===null){if(he=R.shared.pending,he===null)break;Me=he,he=Me.next,Me.next=null,R.lastBaseUpdate=Me,R.shared.pending=null}}while(!0);if(Le===null&&(me=Be),R.baseState=me,R.firstBaseUpdate=Oe,R.lastBaseUpdate=Le,d=R.shared.interleaved,d!==null){R=d;do Q|=R.lane,R=R.next;while(R!==d)}else B===null&&(R.shared.lanes=0);xn|=Q,l.lanes=Q,l.memoizedState=Be}}function xl(l,d,_){if(l=d.effects,d.effects=null,l!==null)for(d=0;d<l.length;d++){var b=l[d],R=b.callback;if(R!==null){if(b.callback=null,b=_,typeof R!="function")throw Error(n(191,R));R.call(b)}}}var da={},kr=Yr(da),ha=Yr(da),pa=Yr(da);function gn(l){if(l===da)throw Error(n(174));return l}function _s(l,d){switch(gt(pa,d),gt(ha,l),gt(kr,da),l=d.nodeType,l){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:xt(null,"");break;default:l=l===8?d.parentNode:d,d=l.namespaceURI||null,l=l.tagName,d=xt(d,l)}_t(kr),gt(kr,d)}function $n(){_t(kr),_t(ha),_t(pa)}function yl(l){gn(pa.current);var d=gn(kr.current),_=xt(d,l.type);d!==_&&(gt(ha,l),gt(kr,_))}function Ss(l){ha.current===l&&(_t(kr),_t(ha))}var Tt=Yr(0);function ri(l){for(var d=l;d!==null;){if(d.tag===13){var _=d.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var Es=[];function ws(){for(var l=0;l<Es.length;l++)Es[l]._workInProgressVersionPrimary=null;Es.length=0}var ni=L.ReactCurrentDispatcher,bs=L.ReactCurrentBatchConfig,vn=0,kt=null,Mt=null,Bt=null,ai=!1,ma=!1,ga=0,Uu=0;function qt(){throw Error(n(321))}function As(l,d){if(d===null)return!1;for(var _=0;_<d.length&&_<l.length;_++)if(!yr(l[_],d[_]))return!1;return!0}function Ts(l,d,_,b,R,B){if(vn=B,kt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,ni.current=l===null||l.memoizedState===null?qu:Vu,l=_(b,R),ma){B=0;do{if(ma=!1,ga=0,25<=B)throw Error(n(301));B+=1,Bt=Mt=null,d.updateQueue=null,ni.current=Gu,l=_(b,R)}while(ma)}if(ni.current=oi,d=Mt!==null&&Mt.next!==null,vn=0,Bt=Mt=kt=null,ai=!1,d)throw Error(n(300));return l}function ks(){var l=ga!==0;return ga=0,l}function Cr(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?kt.memoizedState=Bt=l:Bt=Bt.next=l,Bt}function mr(){if(Mt===null){var l=kt.alternate;l=l!==null?l.memoizedState:null}else l=Mt.next;var d=Bt===null?kt.memoizedState:Bt.next;if(d!==null)Bt=d,Mt=l;else{if(l===null)throw Error(n(310));Mt=l,l={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Bt===null?kt.memoizedState=Bt=l:Bt=Bt.next=l}return Bt}function va(l,d){return typeof d=="function"?d(l):d}function Cs(l){var d=mr(),_=d.queue;if(_===null)throw Error(n(311));_.lastRenderedReducer=l;var b=Mt,R=b.baseQueue,B=_.pending;if(B!==null){if(R!==null){var Q=R.next;R.next=B.next,B.next=Q}b.baseQueue=R=B,_.pending=null}if(R!==null){B=R.next,b=b.baseState;var he=Q=null,me=null,Oe=B;do{var Le=Oe.lane;if((vn&Le)===Le)me!==null&&(me=me.next={lane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),b=Oe.hasEagerState?Oe.eagerState:l(b,Oe.action);else{var Be={lane:Le,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null};me===null?(he=me=Be,Q=b):me=me.next=Be,kt.lanes|=Le,xn|=Le}Oe=Oe.next}while(Oe!==null&&Oe!==B);me===null?Q=b:me.next=he,yr(b,d.memoizedState)||(tr=!0),d.memoizedState=b,d.baseState=Q,d.baseQueue=me,_.lastRenderedState=b}if(l=_.interleaved,l!==null){R=l;do B=R.lane,kt.lanes|=B,xn|=B,R=R.next;while(R!==l)}else R===null&&(_.lanes=0);return[d.memoizedState,_.dispatch]}function Ps(l){var d=mr(),_=d.queue;if(_===null)throw Error(n(311));_.lastRenderedReducer=l;var b=_.dispatch,R=_.pending,B=d.memoizedState;if(R!==null){_.pending=null;var Q=R=R.next;do B=l(B,Q.action),Q=Q.next;while(Q!==R);yr(B,d.memoizedState)||(tr=!0),d.memoizedState=B,d.baseQueue===null&&(d.baseState=B),_.lastRenderedState=B}return[B,b]}function _l(){}function Sl(l,d){var _=kt,b=mr(),R=d(),B=!yr(b.memoizedState,R);if(B&&(b.memoizedState=R,tr=!0),b=b.queue,Rs(bl.bind(null,_,b,l),[l]),b.getSnapshot!==d||B||Bt!==null&&Bt.memoizedState.tag&1){if(_.flags|=2048,xa(9,wl.bind(null,_,b,R,d),void 0,null),$t===null)throw Error(n(349));(vn&30)!==0||El(_,d,R)}return R}function El(l,d,_){l.flags|=16384,l={getSnapshot:d,value:_},d=kt.updateQueue,d===null?(d={lastEffect:null,stores:null},kt.updateQueue=d,d.stores=[l]):(_=d.stores,_===null?d.stores=[l]:_.push(l))}function wl(l,d,_,b){d.value=_,d.getSnapshot=b,Al(d)&&Tl(l)}function bl(l,d,_){return _(function(){Al(d)&&Tl(l)})}function Al(l){var d=l.getSnapshot;l=l.value;try{var _=d();return!yr(l,_)}catch{return!0}}function Tl(l){var d=Br(l,1);d!==null&&br(d,l,1,-1)}function kl(l){var d=Cr();return typeof l=="function"&&(l=l()),d.memoizedState=d.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:va,lastRenderedState:l},d.queue=l,l=l.dispatch=zu.bind(null,kt,l),[d.memoizedState,l]}function xa(l,d,_,b){return l={tag:l,create:d,destroy:_,deps:b,next:null},d=kt.updateQueue,d===null?(d={lastEffect:null,stores:null},kt.updateQueue=d,d.lastEffect=l.next=l):(_=d.lastEffect,_===null?d.lastEffect=l.next=l:(b=_.next,_.next=l,l.next=b,d.lastEffect=l)),l}function Cl(){return mr().memoizedState}function ii(l,d,_,b){var R=Cr();kt.flags|=l,R.memoizedState=xa(1|d,_,void 0,b===void 0?null:b)}function si(l,d,_,b){var R=mr();b=b===void 0?null:b;var B=void 0;if(Mt!==null){var Q=Mt.memoizedState;if(B=Q.destroy,b!==null&&As(b,Q.deps)){R.memoizedState=xa(d,_,B,b);return}}kt.flags|=l,R.memoizedState=xa(1|d,_,B,b)}function Pl(l,d){return ii(8390656,8,l,d)}function Rs(l,d){return si(2048,8,l,d)}function Rl(l,d){return si(4,2,l,d)}function Ol(l,d){return si(4,4,l,d)}function Fl(l,d){if(typeof d=="function")return l=l(),d(l),function(){d(null)};if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function Dl(l,d,_){return _=_!=null?_.concat([l]):null,si(4,4,Fl.bind(null,d,l),_)}function Os(){}function Il(l,d){var _=mr();d=d===void 0?null:d;var b=_.memoizedState;return b!==null&&d!==null&&As(d,b[1])?b[0]:(_.memoizedState=[l,d],l)}function Ml(l,d){var _=mr();d=d===void 0?null:d;var b=_.memoizedState;return b!==null&&d!==null&&As(d,b[1])?b[0]:(l=l(),_.memoizedState=[l,d],l)}function Ll(l,d,_){return(vn&21)===0?(l.baseState&&(l.baseState=!1,tr=!0),l.memoizedState=_):(yr(_,d)||(_=fo(),kt.lanes|=_,xn|=_,l.baseState=!0),d)}function Wu(l,d){var _=dt;dt=_!==0&&4>_?_:4,l(!0);var b=bs.transition;bs.transition={};try{l(!1),d()}finally{dt=_,bs.transition=b}}function Nl(){return mr().memoizedState}function Hu(l,d,_){var b=an(l);if(_={lane:b,action:_,hasEagerState:!1,eagerState:null,next:null},Bl(l))$l(d,_);else if(_=ml(l,d,_,b),_!==null){var R=Zt();br(_,l,b,R),jl(_,d,b)}}function zu(l,d,_){var b=an(l),R={lane:b,action:_,hasEagerState:!1,eagerState:null,next:null};if(Bl(l))$l(d,R);else{var B=l.alternate;if(l.lanes===0&&(B===null||B.lanes===0)&&(B=d.lastRenderedReducer,B!==null))try{var Q=d.lastRenderedState,he=B(Q,_);if(R.hasEagerState=!0,R.eagerState=he,yr(he,Q)){var me=d.interleaved;me===null?(R.next=R,xs(d)):(R.next=me.next,me.next=R),d.interleaved=R;return}}catch{}finally{}_=ml(l,d,R,b),_!==null&&(R=Zt(),br(_,l,b,R),jl(_,d,b))}}function Bl(l){var d=l.alternate;return l===kt||d!==null&&d===kt}function $l(l,d){ma=ai=!0;var _=l.pending;_===null?d.next=d:(d.next=_.next,_.next=d),l.pending=d}function jl(l,d,_){if((_&4194240)!==0){var b=d.lanes;b&=l.pendingLanes,_|=b,d.lanes=_,Fi(l,_)}}var oi={readContext:pr,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},qu={readContext:pr,useCallback:function(l,d){return Cr().memoizedState=[l,d===void 0?null:d],l},useContext:pr,useEffect:Pl,useImperativeHandle:function(l,d,_){return _=_!=null?_.concat([l]):null,ii(4194308,4,Fl.bind(null,d,l),_)},useLayoutEffect:function(l,d){return ii(4194308,4,l,d)},useInsertionEffect:function(l,d){return ii(4,2,l,d)},useMemo:function(l,d){var _=Cr();return d=d===void 0?null:d,l=l(),_.memoizedState=[l,d],l},useReducer:function(l,d,_){var b=Cr();return d=_!==void 0?_(d):d,b.memoizedState=b.baseState=d,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:d},b.queue=l,l=l.dispatch=Hu.bind(null,kt,l),[b.memoizedState,l]},useRef:function(l){var d=Cr();return l={current:l},d.memoizedState=l},useState:kl,useDebugValue:Os,useDeferredValue:function(l){return Cr().memoizedState=l},useTransition:function(){var l=kl(!1),d=l[0];return l=Wu.bind(null,l[1]),Cr().memoizedState=l,[d,l]},useMutableSource:function(){},useSyncExternalStore:function(l,d,_){var b=kt,R=Cr();if(At){if(_===void 0)throw Error(n(407));_=_()}else{if(_=d(),$t===null)throw Error(n(349));(vn&30)!==0||El(b,d,_)}R.memoizedState=_;var B={value:_,getSnapshot:d};return R.queue=B,Pl(bl.bind(null,b,B,l),[l]),b.flags|=2048,xa(9,wl.bind(null,b,B,_,d),void 0,null),_},useId:function(){var l=Cr(),d=$t.identifierPrefix;if(At){var _=Nr,b=Lr;_=(b&~(1<<32-Ot(b)-1)).toString(32)+_,d=":"+d+"R"+_,_=ga++,0<_&&(d+="H"+_.toString(32)),d+=":"}else _=Uu++,d=":"+d+"r"+_.toString(32)+":";return l.memoizedState=d},unstable_isNewReconciler:!1},Vu={readContext:pr,useCallback:Il,useContext:pr,useEffect:Rs,useImperativeHandle:Dl,useInsertionEffect:Rl,useLayoutEffect:Ol,useMemo:Ml,useReducer:Cs,useRef:Cl,useState:function(){return Cs(va)},useDebugValue:Os,useDeferredValue:function(l){var d=mr();return Ll(d,Mt.memoizedState,l)},useTransition:function(){var l=Cs(va)[0],d=mr().memoizedState;return[l,d]},useMutableSource:_l,useSyncExternalStore:Sl,useId:Nl,unstable_isNewReconciler:!1},Gu={readContext:pr,useCallback:Il,useContext:pr,useEffect:Rs,useImperativeHandle:Dl,useInsertionEffect:Rl,useLayoutEffect:Ol,useMemo:Ml,useReducer:Ps,useRef:Cl,useState:function(){return Ps(va)},useDebugValue:Os,useDeferredValue:function(l){var d=mr();return Mt===null?d.memoizedState=l:Ll(d,Mt.memoizedState,l)},useTransition:function(){var l=Ps(va)[0],d=mr().memoizedState;return[l,d]},useMutableSource:_l,useSyncExternalStore:Sl,useId:Nl,unstable_isNewReconciler:!1};function Sr(l,d){if(l&&l.defaultProps){d=O({},d),l=l.defaultProps;for(var _ in l)d[_]===void 0&&(d[_]=l[_]);return d}return d}function Fs(l,d,_,b){d=l.memoizedState,_=_(b,d),_=_==null?d:O({},d,_),l.memoizedState=_,l.lanes===0&&(l.updateQueue.baseState=_)}var li={isMounted:function(l){return(l=l._reactInternals)?fe(l)===l:!1},enqueueSetState:function(l,d,_){l=l._reactInternals;var b=Zt(),R=an(l),B=$r(b,R);B.payload=d,_!=null&&(B.callback=_),d=en(l,B,R),d!==null&&(br(d,l,R,b),ei(d,l,R))},enqueueReplaceState:function(l,d,_){l=l._reactInternals;var b=Zt(),R=an(l),B=$r(b,R);B.tag=1,B.payload=d,_!=null&&(B.callback=_),d=en(l,B,R),d!==null&&(br(d,l,R,b),ei(d,l,R))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var _=Zt(),b=an(l),R=$r(_,b);R.tag=2,d!=null&&(R.callback=d),d=en(l,R,b),d!==null&&(br(d,l,b,_),ei(d,l,b))}};function Ul(l,d,_,b,R,B,Q){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,B,Q):d.prototype&&d.prototype.isPureReactComponent?!aa(_,b)||!aa(R,B):!0}function Wl(l,d,_){var b=!1,R=Jr,B=d.contextType;return typeof B=="object"&&B!==null?B=pr(B):(R=er(d)?dn:zt.current,b=d.contextTypes,B=(b=b!=null)?Fn(l,R):Jr),d=new d(_,B),l.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=li,l.stateNode=d,d._reactInternals=l,b&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=R,l.__reactInternalMemoizedMaskedChildContext=B),d}function Hl(l,d,_,b){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(_,b),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(_,b),d.state!==l&&li.enqueueReplaceState(d,d.state,null)}function Ds(l,d,_,b){var R=l.stateNode;R.props=_,R.state=l.memoizedState,R.refs={},ys(l);var B=d.contextType;typeof B=="object"&&B!==null?R.context=pr(B):(B=er(d)?dn:zt.current,R.context=Fn(l,B)),R.state=l.memoizedState,B=d.getDerivedStateFromProps,typeof B=="function"&&(Fs(l,d,B,_),R.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(d=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),d!==R.state&&li.enqueueReplaceState(R,R.state,null),ti(l,_,R,b),R.state=l.memoizedState),typeof R.componentDidMount=="function"&&(l.flags|=4194308)}function jn(l,d){try{var _="",b=d;do _+=j(b),b=b.return;while(b);var R=_}catch(B){R=`
Error generating stack: `+B.message+`
`+B.stack}return{value:l,source:d,stack:R,digest:null}}function Is(l,d,_){return{value:l,source:null,stack:_??null,digest:d??null}}function Ms(l,d){try{console.error(d.value)}catch(_){setTimeout(function(){throw _})}}var Xu=typeof WeakMap=="function"?WeakMap:Map;function zl(l,d,_){_=$r(-1,_),_.tag=3,_.payload={element:null};var b=d.value;return _.callback=function(){gi||(gi=!0,Ys=b),Ms(l,d)},_}function ql(l,d,_){_=$r(-1,_),_.tag=3;var b=l.type.getDerivedStateFromError;if(typeof b=="function"){var R=d.value;_.payload=function(){return b(R)},_.callback=function(){Ms(l,d)}}var B=l.stateNode;return B!==null&&typeof B.componentDidCatch=="function"&&(_.callback=function(){Ms(l,d),typeof b!="function"&&(rn===null?rn=new Set([this]):rn.add(this));var Q=d.stack;this.componentDidCatch(d.value,{componentStack:Q!==null?Q:""})}),_}function Vl(l,d,_){var b=l.pingCache;if(b===null){b=l.pingCache=new Xu;var R=new Set;b.set(d,R)}else R=b.get(d),R===void 0&&(R=new Set,b.set(d,R));R.has(_)||(R.add(_),l=cf.bind(null,l,d,_),d.then(l,l))}function Gl(l){do{var d;if((d=l.tag===13)&&(d=l.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return l;l=l.return}while(l!==null);return null}function Xl(l,d,_,b,R){return(l.mode&1)===0?(l===d?l.flags|=65536:(l.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(d=$r(-1,1),d.tag=2,en(_,d,1))),_.lanes|=1),l):(l.flags|=65536,l.lanes=R,l)}var Ku=L.ReactCurrentOwner,tr=!1;function Jt(l,d,_,b){d.child=l===null?pl(d,null,_,b):Ln(d,l.child,_,b)}function Kl(l,d,_,b,R){_=_.render;var B=d.ref;return Bn(d,R),b=Ts(l,d,_,b,B,R),_=ks(),l!==null&&!tr?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~R,jr(l,d,R)):(At&&_&&cs(d),d.flags|=1,Jt(l,d,b,R),d.child)}function Yl(l,d,_,b,R){if(l===null){var B=_.type;return typeof B=="function"&&!ao(B)&&B.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(d.tag=15,d.type=B,Jl(l,d,B,b,R)):(l=Ei(_.type,null,b,d,d.mode,R),l.ref=d.ref,l.return=d,d.child=l)}if(B=l.child,(l.lanes&R)===0){var Q=B.memoizedProps;if(_=_.compare,_=_!==null?_:aa,_(Q,b)&&l.ref===d.ref)return jr(l,d,R)}return d.flags|=1,l=on(B,b),l.ref=d.ref,l.return=d,d.child=l}function Jl(l,d,_,b,R){if(l!==null){var B=l.memoizedProps;if(aa(B,b)&&l.ref===d.ref)if(tr=!1,d.pendingProps=b=B,(l.lanes&R)!==0)(l.flags&131072)!==0&&(tr=!0);else return d.lanes=l.lanes,jr(l,d,R)}return Ls(l,d,_,b,R)}function Zl(l,d,_){var b=d.pendingProps,R=b.children,B=l!==null?l.memoizedState:null;if(b.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(Wn,cr),cr|=_;else{if((_&1073741824)===0)return l=B!==null?B.baseLanes|_:_,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:l,cachePool:null,transitions:null},d.updateQueue=null,gt(Wn,cr),cr|=l,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=B!==null?B.baseLanes:_,gt(Wn,cr),cr|=b}else B!==null?(b=B.baseLanes|_,d.memoizedState=null):b=_,gt(Wn,cr),cr|=b;return Jt(l,d,R,_),d.child}function Ql(l,d){var _=d.ref;(l===null&&_!==null||l!==null&&l.ref!==_)&&(d.flags|=512,d.flags|=2097152)}function Ls(l,d,_,b,R){var B=er(_)?dn:zt.current;return B=Fn(d,B),Bn(d,R),_=Ts(l,d,_,b,B,R),b=ks(),l!==null&&!tr?(d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~R,jr(l,d,R)):(At&&b&&cs(d),d.flags|=1,Jt(l,d,_,R),d.child)}function ec(l,d,_,b,R){if(er(_)){var B=!0;Va(d)}else B=!1;if(Bn(d,R),d.stateNode===null)ui(l,d),Wl(d,_,b),Ds(d,_,b,R),b=!0;else if(l===null){var Q=d.stateNode,he=d.memoizedProps;Q.props=he;var me=Q.context,Oe=_.contextType;typeof Oe=="object"&&Oe!==null?Oe=pr(Oe):(Oe=er(_)?dn:zt.current,Oe=Fn(d,Oe));var Le=_.getDerivedStateFromProps,Be=typeof Le=="function"||typeof Q.getSnapshotBeforeUpdate=="function";Be||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(he!==b||me!==Oe)&&Hl(d,Q,b,Oe),Qr=!1;var Me=d.memoizedState;Q.state=Me,ti(d,b,Q,R),me=d.memoizedState,he!==b||Me!==me||Qt.current||Qr?(typeof Le=="function"&&(Fs(d,_,Le,b),me=d.memoizedState),(he=Qr||Ul(d,_,he,b,Me,me,Oe))?(Be||typeof Q.UNSAFE_componentWillMount!="function"&&typeof Q.componentWillMount!="function"||(typeof Q.componentWillMount=="function"&&Q.componentWillMount(),typeof Q.UNSAFE_componentWillMount=="function"&&Q.UNSAFE_componentWillMount()),typeof Q.componentDidMount=="function"&&(d.flags|=4194308)):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=b,d.memoizedState=me),Q.props=b,Q.state=me,Q.context=Oe,b=he):(typeof Q.componentDidMount=="function"&&(d.flags|=4194308),b=!1)}else{Q=d.stateNode,gl(l,d),he=d.memoizedProps,Oe=d.type===d.elementType?he:Sr(d.type,he),Q.props=Oe,Be=d.pendingProps,Me=Q.context,me=_.contextType,typeof me=="object"&&me!==null?me=pr(me):(me=er(_)?dn:zt.current,me=Fn(d,me));var Ve=_.getDerivedStateFromProps;(Le=typeof Ve=="function"||typeof Q.getSnapshotBeforeUpdate=="function")||typeof Q.UNSAFE_componentWillReceiveProps!="function"&&typeof Q.componentWillReceiveProps!="function"||(he!==Be||Me!==me)&&Hl(d,Q,b,me),Qr=!1,Me=d.memoizedState,Q.state=Me,ti(d,b,Q,R);var Ke=d.memoizedState;he!==Be||Me!==Ke||Qt.current||Qr?(typeof Ve=="function"&&(Fs(d,_,Ve,b),Ke=d.memoizedState),(Oe=Qr||Ul(d,_,Oe,b,Me,Ke,me)||!1)?(Le||typeof Q.UNSAFE_componentWillUpdate!="function"&&typeof Q.componentWillUpdate!="function"||(typeof Q.componentWillUpdate=="function"&&Q.componentWillUpdate(b,Ke,me),typeof Q.UNSAFE_componentWillUpdate=="function"&&Q.UNSAFE_componentWillUpdate(b,Ke,me)),typeof Q.componentDidUpdate=="function"&&(d.flags|=4),typeof Q.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof Q.componentDidUpdate!="function"||he===l.memoizedProps&&Me===l.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||he===l.memoizedProps&&Me===l.memoizedState||(d.flags|=1024),d.memoizedProps=b,d.memoizedState=Ke),Q.props=b,Q.state=Ke,Q.context=me,b=Oe):(typeof Q.componentDidUpdate!="function"||he===l.memoizedProps&&Me===l.memoizedState||(d.flags|=4),typeof Q.getSnapshotBeforeUpdate!="function"||he===l.memoizedProps&&Me===l.memoizedState||(d.flags|=1024),b=!1)}return Ns(l,d,_,b,B,R)}function Ns(l,d,_,b,R,B){Ql(l,d);var Q=(d.flags&128)!==0;if(!b&&!Q)return R&&il(d,_,!1),jr(l,d,B);b=d.stateNode,Ku.current=d;var he=Q&&typeof _.getDerivedStateFromError!="function"?null:b.render();return d.flags|=1,l!==null&&Q?(d.child=Ln(d,l.child,null,B),d.child=Ln(d,null,he,B)):Jt(l,d,he,B),d.memoizedState=b.state,R&&il(d,_,!0),d.child}function tc(l){var d=l.stateNode;d.pendingContext?nl(l,d.pendingContext,d.pendingContext!==d.context):d.context&&nl(l,d.context,!1),_s(l,d.containerInfo)}function rc(l,d,_,b,R){return Mn(),hs(R),d.flags|=256,Jt(l,d,_,b),d.child}var Bs={dehydrated:null,treeContext:null,retryLane:0};function $s(l){return{baseLanes:l,cachePool:null,transitions:null}}function nc(l,d,_){var b=d.pendingProps,R=Tt.current,B=!1,Q=(d.flags&128)!==0,he;if((he=Q)||(he=l!==null&&l.memoizedState===null?!1:(R&2)!==0),he?(B=!0,d.flags&=-129):(l===null||l.memoizedState!==null)&&(R|=1),gt(Tt,R&1),l===null)return ds(d),l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((d.mode&1)===0?d.lanes=1:l.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(Q=b.children,l=b.fallback,B?(b=d.mode,B=d.child,Q={mode:"hidden",children:Q},(b&1)===0&&B!==null?(B.childLanes=0,B.pendingProps=Q):B=wi(Q,b,0,null),l=En(l,b,_,null),B.return=d,l.return=d,B.sibling=l,d.child=B,d.child.memoizedState=$s(_),d.memoizedState=Bs,l):js(d,Q));if(R=l.memoizedState,R!==null&&(he=R.dehydrated,he!==null))return Yu(l,d,Q,b,he,R,_);if(B){B=b.fallback,Q=d.mode,R=l.child,he=R.sibling;var me={mode:"hidden",children:b.children};return(Q&1)===0&&d.child!==R?(b=d.child,b.childLanes=0,b.pendingProps=me,d.deletions=null):(b=on(R,me),b.subtreeFlags=R.subtreeFlags&14680064),he!==null?B=on(he,B):(B=En(B,Q,_,null),B.flags|=2),B.return=d,b.return=d,b.sibling=B,d.child=b,b=B,B=d.child,Q=l.child.memoizedState,Q=Q===null?$s(_):{baseLanes:Q.baseLanes|_,cachePool:null,transitions:Q.transitions},B.memoizedState=Q,B.childLanes=l.childLanes&~_,d.memoizedState=Bs,b}return B=l.child,l=B.sibling,b=on(B,{mode:"visible",children:b.children}),(d.mode&1)===0&&(b.lanes=_),b.return=d,b.sibling=null,l!==null&&(_=d.deletions,_===null?(d.deletions=[l],d.flags|=16):_.push(l)),d.child=b,d.memoizedState=null,b}function js(l,d){return d=wi({mode:"visible",children:d},l.mode,0,null),d.return=l,l.child=d}function ci(l,d,_,b){return b!==null&&hs(b),Ln(d,l.child,null,_),l=js(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function Yu(l,d,_,b,R,B,Q){if(_)return d.flags&256?(d.flags&=-257,b=Is(Error(n(422))),ci(l,d,Q,b)):d.memoizedState!==null?(d.child=l.child,d.flags|=128,null):(B=b.fallback,R=d.mode,b=wi({mode:"visible",children:b.children},R,0,null),B=En(B,R,Q,null),B.flags|=2,b.return=d,B.return=d,b.sibling=B,d.child=b,(d.mode&1)!==0&&Ln(d,l.child,null,Q),d.child.memoizedState=$s(Q),d.memoizedState=Bs,B);if((d.mode&1)===0)return ci(l,d,Q,null);if(R.data==="$!"){if(b=R.nextSibling&&R.nextSibling.dataset,b)var he=b.dgst;return b=he,B=Error(n(419)),b=Is(B,b,void 0),ci(l,d,Q,b)}if(he=(Q&l.childLanes)!==0,tr||he){if(b=$t,b!==null){switch(Q&-Q){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(b.suspendedLanes|Q))!==0?0:R,R!==0&&R!==B.retryLane&&(B.retryLane=R,Br(l,R),br(b,l,R,-1))}return no(),b=Is(Error(n(421))),ci(l,d,Q,b)}return R.data==="$?"?(d.flags|=128,d.child=l.child,d=uf.bind(null,l),R._reactRetry=d,null):(l=B.treeContext,lr=Kr(R.nextSibling),or=d,At=!0,_r=null,l!==null&&(dr[hr++]=Lr,dr[hr++]=Nr,dr[hr++]=hn,Lr=l.id,Nr=l.overflow,hn=d),d=js(d,b.children),d.flags|=4096,d)}function ac(l,d,_){l.lanes|=d;var b=l.alternate;b!==null&&(b.lanes|=d),vs(l.return,d,_)}function Us(l,d,_,b,R){var B=l.memoizedState;B===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:b,tail:_,tailMode:R}:(B.isBackwards=d,B.rendering=null,B.renderingStartTime=0,B.last=b,B.tail=_,B.tailMode=R)}function ic(l,d,_){var b=d.pendingProps,R=b.revealOrder,B=b.tail;if(Jt(l,d,b.children,_),b=Tt.current,(b&2)!==0)b=b&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&ac(l,_,d);else if(l.tag===19)ac(l,_,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}b&=1}if(gt(Tt,b),(d.mode&1)===0)d.memoizedState=null;else switch(R){case"forwards":for(_=d.child,R=null;_!==null;)l=_.alternate,l!==null&&ri(l)===null&&(R=_),_=_.sibling;_=R,_===null?(R=d.child,d.child=null):(R=_.sibling,_.sibling=null),Us(d,!1,R,_,B);break;case"backwards":for(_=null,R=d.child,d.child=null;R!==null;){if(l=R.alternate,l!==null&&ri(l)===null){d.child=R;break}l=R.sibling,R.sibling=_,_=R,R=l}Us(d,!0,_,null,B);break;case"together":Us(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function ui(l,d){(d.mode&1)===0&&l!==null&&(l.alternate=null,d.alternate=null,d.flags|=2)}function jr(l,d,_){if(l!==null&&(d.dependencies=l.dependencies),xn|=d.lanes,(_&d.childLanes)===0)return null;if(l!==null&&d.child!==l.child)throw Error(n(153));if(d.child!==null){for(l=d.child,_=on(l,l.pendingProps),d.child=_,_.return=d;l.sibling!==null;)l=l.sibling,_=_.sibling=on(l,l.pendingProps),_.return=d;_.sibling=null}return d.child}function Ju(l,d,_){switch(d.tag){case 3:tc(d),Mn();break;case 5:yl(d);break;case 1:er(d.type)&&Va(d);break;case 4:_s(d,d.stateNode.containerInfo);break;case 10:var b=d.type._context,R=d.memoizedProps.value;gt(Za,b._currentValue),b._currentValue=R;break;case 13:if(b=d.memoizedState,b!==null)return b.dehydrated!==null?(gt(Tt,Tt.current&1),d.flags|=128,null):(_&d.child.childLanes)!==0?nc(l,d,_):(gt(Tt,Tt.current&1),l=jr(l,d,_),l!==null?l.sibling:null);gt(Tt,Tt.current&1);break;case 19:if(b=(_&d.childLanes)!==0,(l.flags&128)!==0){if(b)return ic(l,d,_);d.flags|=128}if(R=d.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),gt(Tt,Tt.current),b)break;return null;case 22:case 23:return d.lanes=0,Zl(l,d,_)}return jr(l,d,_)}var sc,Ws,oc,lc;sc=function(l,d){for(var _=d.child;_!==null;){if(_.tag===5||_.tag===6)l.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},Ws=function(){},oc=function(l,d,_,b){var R=l.memoizedProps;if(R!==b){l=d.stateNode,gn(kr.current);var B=null;switch(_){case"input":R=be(l,R),b=be(l,b),B=[];break;case"select":R=O({},R,{value:void 0}),b=O({},b,{value:void 0}),B=[];break;case"textarea":R=Je(l,R),b=Je(l,b),B=[];break;default:typeof R.onClick!="function"&&typeof b.onClick=="function"&&(l.onclick=Ha)}Se(_,b);var Q;_=null;for(Oe in R)if(!b.hasOwnProperty(Oe)&&R.hasOwnProperty(Oe)&&R[Oe]!=null)if(Oe==="style"){var he=R[Oe];for(Q in he)he.hasOwnProperty(Q)&&(_||(_={}),_[Q]="")}else Oe!=="dangerouslySetInnerHTML"&&Oe!=="children"&&Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&Oe!=="autoFocus"&&(i.hasOwnProperty(Oe)?B||(B=[]):(B=B||[]).push(Oe,null));for(Oe in b){var me=b[Oe];if(he=R?.[Oe],b.hasOwnProperty(Oe)&&me!==he&&(me!=null||he!=null))if(Oe==="style")if(he){for(Q in he)!he.hasOwnProperty(Q)||me&&me.hasOwnProperty(Q)||(_||(_={}),_[Q]="");for(Q in me)me.hasOwnProperty(Q)&&he[Q]!==me[Q]&&(_||(_={}),_[Q]=me[Q])}else _||(B||(B=[]),B.push(Oe,_)),_=me;else Oe==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,he=he?he.__html:void 0,me!=null&&he!==me&&(B=B||[]).push(Oe,me)):Oe==="children"?typeof me!="string"&&typeof me!="number"||(B=B||[]).push(Oe,""+me):Oe!=="suppressContentEditableWarning"&&Oe!=="suppressHydrationWarning"&&(i.hasOwnProperty(Oe)?(me!=null&&Oe==="onScroll"&&yt("scroll",l),B||he===me||(B=[])):(B=B||[]).push(Oe,me))}_&&(B=B||[]).push("style",_);var Oe=B;(d.updateQueue=Oe)&&(d.flags|=4)}},lc=function(l,d,_,b){_!==b&&(d.flags|=4)};function ya(l,d){if(!At)switch(l.tailMode){case"hidden":d=l.tail;for(var _=null;d!==null;)d.alternate!==null&&(_=d),d=d.sibling;_===null?l.tail=null:_.sibling=null;break;case"collapsed":_=l.tail;for(var b=null;_!==null;)_.alternate!==null&&(b=_),_=_.sibling;b===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function Vt(l){var d=l.alternate!==null&&l.alternate.child===l.child,_=0,b=0;if(d)for(var R=l.child;R!==null;)_|=R.lanes|R.childLanes,b|=R.subtreeFlags&14680064,b|=R.flags&14680064,R.return=l,R=R.sibling;else for(R=l.child;R!==null;)_|=R.lanes|R.childLanes,b|=R.subtreeFlags,b|=R.flags,R.return=l,R=R.sibling;return l.subtreeFlags|=b,l.childLanes=_,d}function Zu(l,d,_){var b=d.pendingProps;switch(us(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vt(d),null;case 1:return er(d.type)&&qa(),Vt(d),null;case 3:return b=d.stateNode,$n(),_t(Qt),_t(zt),ws(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(l===null||l.child===null)&&(Ya(d)?d.flags|=4:l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,_r!==null&&(Qs(_r),_r=null))),Ws(l,d),Vt(d),null;case 5:Ss(d);var R=gn(pa.current);if(_=d.type,l!==null&&d.stateNode!=null)oc(l,d,_,b,R),l.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!b){if(d.stateNode===null)throw Error(n(166));return Vt(d),null}if(l=gn(kr.current),Ya(d)){b=d.stateNode,_=d.type;var B=d.memoizedProps;switch(b[Tr]=d,b[ca]=B,l=(d.mode&1)!==0,_){case"dialog":yt("cancel",b),yt("close",b);break;case"iframe":case"object":case"embed":yt("load",b);break;case"video":case"audio":for(R=0;R<sa.length;R++)yt(sa[R],b);break;case"source":yt("error",b);break;case"img":case"image":case"link":yt("error",b),yt("load",b);break;case"details":yt("toggle",b);break;case"input":ye(b,B),yt("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!B.multiple},yt("invalid",b);break;case"textarea":Qe(b,B),yt("invalid",b)}Se(_,B),R=null;for(var Q in B)if(B.hasOwnProperty(Q)){var he=B[Q];Q==="children"?typeof he=="string"?b.textContent!==he&&(B.suppressHydrationWarning!==!0&&Wa(b.textContent,he,l),R=["children",he]):typeof he=="number"&&b.textContent!==""+he&&(B.suppressHydrationWarning!==!0&&Wa(b.textContent,he,l),R=["children",""+he]):i.hasOwnProperty(Q)&&he!=null&&Q==="onScroll"&&yt("scroll",b)}switch(_){case"input":ae(b),Re(b,B,!0);break;case"textarea":ae(b),st(b);break;case"select":case"option":break;default:typeof B.onClick=="function"&&(b.onclick=Ha)}b=R,d.updateQueue=b,b!==null&&(d.flags|=4)}else{Q=R.nodeType===9?R:R.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=vt(_)),l==="http://www.w3.org/1999/xhtml"?_==="script"?(l=Q.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof b.is=="string"?l=Q.createElement(_,{is:b.is}):(l=Q.createElement(_),_==="select"&&(Q=l,b.multiple?Q.multiple=!0:b.size&&(Q.size=b.size))):l=Q.createElementNS(l,_),l[Tr]=d,l[ca]=b,sc(l,d,!1,!1),d.stateNode=l;e:{switch(Q=qe(_,b),_){case"dialog":yt("cancel",l),yt("close",l),R=b;break;case"iframe":case"object":case"embed":yt("load",l),R=b;break;case"video":case"audio":for(R=0;R<sa.length;R++)yt(sa[R],l);R=b;break;case"source":yt("error",l),R=b;break;case"img":case"image":case"link":yt("error",l),yt("load",l),R=b;break;case"details":yt("toggle",l),R=b;break;case"input":ye(l,b),R=be(l,b),yt("invalid",l);break;case"option":R=b;break;case"select":l._wrapperState={wasMultiple:!!b.multiple},R=O({},b,{value:void 0}),yt("invalid",l);break;case"textarea":Qe(l,b),R=Je(l,b),yt("invalid",l);break;default:R=b}Se(_,R),he=R;for(B in he)if(he.hasOwnProperty(B)){var me=he[B];B==="style"?Ie(l,me):B==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&ft(l,me)):B==="children"?typeof me=="string"?(_!=="textarea"||me!=="")&&tt(l,me):typeof me=="number"&&tt(l,""+me):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(i.hasOwnProperty(B)?me!=null&&B==="onScroll"&&yt("scroll",l):me!=null&&A(l,B,me,Q))}switch(_){case"input":ae(l),Re(l,b,!1);break;case"textarea":ae(l),st(l);break;case"option":b.value!=null&&l.setAttribute("value",""+X(b.value));break;case"select":l.multiple=!!b.multiple,B=b.value,B!=null?ze(l,!!b.multiple,B,!1):b.defaultValue!=null&&ze(l,!!b.multiple,b.defaultValue,!0);break;default:typeof R.onClick=="function"&&(l.onclick=Ha)}switch(_){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Vt(d),null;case 6:if(l&&d.stateNode!=null)lc(l,d,l.memoizedProps,b);else{if(typeof b!="string"&&d.stateNode===null)throw Error(n(166));if(_=gn(pa.current),gn(kr.current),Ya(d)){if(b=d.stateNode,_=d.memoizedProps,b[Tr]=d,(B=b.nodeValue!==_)&&(l=or,l!==null))switch(l.tag){case 3:Wa(b.nodeValue,_,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Wa(b.nodeValue,_,(l.mode&1)!==0)}B&&(d.flags|=4)}else b=(_.nodeType===9?_:_.ownerDocument).createTextNode(b),b[Tr]=d,d.stateNode=b}return Vt(d),null;case 13:if(_t(Tt),b=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(At&&lr!==null&&(d.mode&1)!==0&&(d.flags&128)===0)fl(),Mn(),d.flags|=98560,B=!1;else if(B=Ya(d),b!==null&&b.dehydrated!==null){if(l===null){if(!B)throw Error(n(318));if(B=d.memoizedState,B=B!==null?B.dehydrated:null,!B)throw Error(n(317));B[Tr]=d}else Mn(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Vt(d),B=!1}else _r!==null&&(Qs(_r),_r=null),B=!0;if(!B)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=_,d):(b=b!==null,b!==(l!==null&&l.memoizedState!==null)&&b&&(d.child.flags|=8192,(d.mode&1)!==0&&(l===null||(Tt.current&1)!==0?Lt===0&&(Lt=3):no())),d.updateQueue!==null&&(d.flags|=4),Vt(d),null);case 4:return $n(),Ws(l,d),l===null&&oa(d.stateNode.containerInfo),Vt(d),null;case 10:return gs(d.type._context),Vt(d),null;case 17:return er(d.type)&&qa(),Vt(d),null;case 19:if(_t(Tt),B=d.memoizedState,B===null)return Vt(d),null;if(b=(d.flags&128)!==0,Q=B.rendering,Q===null)if(b)ya(B,!1);else{if(Lt!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(Q=ri(l),Q!==null){for(d.flags|=128,ya(B,!1),b=Q.updateQueue,b!==null&&(d.updateQueue=b,d.flags|=4),d.subtreeFlags=0,b=_,_=d.child;_!==null;)B=_,l=b,B.flags&=14680066,Q=B.alternate,Q===null?(B.childLanes=0,B.lanes=l,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=Q.childLanes,B.lanes=Q.lanes,B.child=Q.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=Q.memoizedProps,B.memoizedState=Q.memoizedState,B.updateQueue=Q.updateQueue,B.type=Q.type,l=Q.dependencies,B.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),_=_.sibling;return gt(Tt,Tt.current&1|2),d.child}l=l.sibling}B.tail!==null&&$e()>Hn&&(d.flags|=128,b=!0,ya(B,!1),d.lanes=4194304)}else{if(!b)if(l=ri(Q),l!==null){if(d.flags|=128,b=!0,_=l.updateQueue,_!==null&&(d.updateQueue=_,d.flags|=4),ya(B,!0),B.tail===null&&B.tailMode==="hidden"&&!Q.alternate&&!At)return Vt(d),null}else 2*$e()-B.renderingStartTime>Hn&&_!==1073741824&&(d.flags|=128,b=!0,ya(B,!1),d.lanes=4194304);B.isBackwards?(Q.sibling=d.child,d.child=Q):(_=B.last,_!==null?_.sibling=Q:d.child=Q,B.last=Q)}return B.tail!==null?(d=B.tail,B.rendering=d,B.tail=d.sibling,B.renderingStartTime=$e(),d.sibling=null,_=Tt.current,gt(Tt,b?_&1|2:_&1),d):(Vt(d),null);case 22:case 23:return ro(),b=d.memoizedState!==null,l!==null&&l.memoizedState!==null!==b&&(d.flags|=8192),b&&(d.mode&1)!==0?(cr&1073741824)!==0&&(Vt(d),d.subtreeFlags&6&&(d.flags|=8192)):Vt(d),null;case 24:return null;case 25:return null}throw Error(n(156,d.tag))}function Qu(l,d){switch(us(d),d.tag){case 1:return er(d.type)&&qa(),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return $n(),_t(Qt),_t(zt),ws(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 5:return Ss(d),null;case 13:if(_t(Tt),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(n(340));Mn()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return _t(Tt),null;case 4:return $n(),null;case 10:return gs(d.type._context),null;case 22:case 23:return ro(),null;case 24:return null;default:return null}}var fi=!1,Gt=!1,ef=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Un(l,d){var _=l.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(b){Ct(l,d,b)}else _.current=null}function Hs(l,d,_){try{_()}catch(b){Ct(l,d,b)}}var cc=!1;function tf(l,d){if(es=Oa,l=Uo(),Vi(l)){if("selectionStart"in l)var _={start:l.selectionStart,end:l.selectionEnd};else e:{_=(_=l.ownerDocument)&&_.defaultView||window;var b=_.getSelection&&_.getSelection();if(b&&b.rangeCount!==0){_=b.anchorNode;var R=b.anchorOffset,B=b.focusNode;b=b.focusOffset;try{_.nodeType,B.nodeType}catch{_=null;break e}var Q=0,he=-1,me=-1,Oe=0,Le=0,Be=l,Me=null;t:for(;;){for(var Ve;Be!==_||R!==0&&Be.nodeType!==3||(he=Q+R),Be!==B||b!==0&&Be.nodeType!==3||(me=Q+b),Be.nodeType===3&&(Q+=Be.nodeValue.length),(Ve=Be.firstChild)!==null;)Me=Be,Be=Ve;for(;;){if(Be===l)break t;if(Me===_&&++Oe===R&&(he=Q),Me===B&&++Le===b&&(me=Q),(Ve=Be.nextSibling)!==null)break;Be=Me,Me=Be.parentNode}Be=Ve}_=he===-1||me===-1?null:{start:he,end:me}}else _=null}_=_||{start:0,end:0}}else _=null;for(ts={focusedElem:l,selectionRange:_},Oa=!1,Xe=d;Xe!==null;)if(d=Xe,l=d.child,(d.subtreeFlags&1028)!==0&&l!==null)l.return=d,Xe=l;else for(;Xe!==null;){d=Xe;try{var Ke=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var Ye=Ke.memoizedProps,Ft=Ke.memoizedState,Ee=d.stateNode,xe=Ee.getSnapshotBeforeUpdate(d.elementType===d.type?Ye:Sr(d.type,Ye),Ft);Ee.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:var Ae=d.stateNode.containerInfo;Ae.nodeType===1?Ae.textContent="":Ae.nodeType===9&&Ae.documentElement&&Ae.removeChild(Ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ue){Ct(d,d.return,Ue)}if(l=d.sibling,l!==null){l.return=d.return,Xe=l;break}Xe=d.return}return Ke=cc,cc=!1,Ke}function _a(l,d,_){var b=d.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var R=b=b.next;do{if((R.tag&l)===l){var B=R.destroy;R.destroy=void 0,B!==void 0&&Hs(d,_,B)}R=R.next}while(R!==b)}}function di(l,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var _=d=d.next;do{if((_.tag&l)===l){var b=_.create;_.destroy=b()}_=_.next}while(_!==d)}}function zs(l){var d=l.ref;if(d!==null){var _=l.stateNode;switch(l.tag){case 5:l=_;break;default:l=_}typeof d=="function"?d(l):d.current=l}}function uc(l){var d=l.alternate;d!==null&&(l.alternate=null,uc(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&(delete d[Tr],delete d[ca],delete d[ss],delete d[Nu],delete d[Bu])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function fc(l){return l.tag===5||l.tag===3||l.tag===4}function dc(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||fc(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function qs(l,d,_){var b=l.tag;if(b===5||b===6)l=l.stateNode,d?_.nodeType===8?_.parentNode.insertBefore(l,d):_.insertBefore(l,d):(_.nodeType===8?(d=_.parentNode,d.insertBefore(l,_)):(d=_,d.appendChild(l)),_=_._reactRootContainer,_!=null||d.onclick!==null||(d.onclick=Ha));else if(b!==4&&(l=l.child,l!==null))for(qs(l,d,_),l=l.sibling;l!==null;)qs(l,d,_),l=l.sibling}function Vs(l,d,_){var b=l.tag;if(b===5||b===6)l=l.stateNode,d?_.insertBefore(l,d):_.appendChild(l);else if(b!==4&&(l=l.child,l!==null))for(Vs(l,d,_),l=l.sibling;l!==null;)Vs(l,d,_),l=l.sibling}var Ut=null,Er=!1;function tn(l,d,_){for(_=_.child;_!==null;)hc(l,d,_),_=_.sibling}function hc(l,d,_){if(Nt&&typeof Nt.onCommitFiberUnmount=="function")try{Nt.onCommitFiberUnmount(Ar,_)}catch{}switch(_.tag){case 5:Gt||Un(_,d);case 6:var b=Ut,R=Er;Ut=null,tn(l,d,_),Ut=b,Er=R,Ut!==null&&(Er?(l=Ut,_=_.stateNode,l.nodeType===8?l.parentNode.removeChild(_):l.removeChild(_)):Ut.removeChild(_.stateNode));break;case 18:Ut!==null&&(Er?(l=Ut,_=_.stateNode,l.nodeType===8?as(l.parentNode,_):l.nodeType===1&&as(l,_),Zn(l)):as(Ut,_.stateNode));break;case 4:b=Ut,R=Er,Ut=_.stateNode.containerInfo,Er=!0,tn(l,d,_),Ut=b,Er=R;break;case 0:case 11:case 14:case 15:if(!Gt&&(b=_.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){R=b=b.next;do{var B=R,Q=B.destroy;B=B.tag,Q!==void 0&&((B&2)!==0||(B&4)!==0)&&Hs(_,d,Q),R=R.next}while(R!==b)}tn(l,d,_);break;case 1:if(!Gt&&(Un(_,d),b=_.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=_.memoizedProps,b.state=_.memoizedState,b.componentWillUnmount()}catch(he){Ct(_,d,he)}tn(l,d,_);break;case 21:tn(l,d,_);break;case 22:_.mode&1?(Gt=(b=Gt)||_.memoizedState!==null,tn(l,d,_),Gt=b):tn(l,d,_);break;default:tn(l,d,_)}}function pc(l){var d=l.updateQueue;if(d!==null){l.updateQueue=null;var _=l.stateNode;_===null&&(_=l.stateNode=new ef),d.forEach(function(b){var R=ff.bind(null,l,b);_.has(b)||(_.add(b),b.then(R,R))})}}function wr(l,d){var _=d.deletions;if(_!==null)for(var b=0;b<_.length;b++){var R=_[b];try{var B=l,Q=d,he=Q;e:for(;he!==null;){switch(he.tag){case 5:Ut=he.stateNode,Er=!1;break e;case 3:Ut=he.stateNode.containerInfo,Er=!0;break e;case 4:Ut=he.stateNode.containerInfo,Er=!0;break e}he=he.return}if(Ut===null)throw Error(n(160));hc(B,Q,R),Ut=null,Er=!1;var me=R.alternate;me!==null&&(me.return=null),R.return=null}catch(Oe){Ct(R,d,Oe)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)mc(d,l),d=d.sibling}function mc(l,d){var _=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(wr(d,l),Pr(l),b&4){try{_a(3,l,l.return),di(3,l)}catch(Ye){Ct(l,l.return,Ye)}try{_a(5,l,l.return)}catch(Ye){Ct(l,l.return,Ye)}}break;case 1:wr(d,l),Pr(l),b&512&&_!==null&&Un(_,_.return);break;case 5:if(wr(d,l),Pr(l),b&512&&_!==null&&Un(_,_.return),l.flags&32){var R=l.stateNode;try{tt(R,"")}catch(Ye){Ct(l,l.return,Ye)}}if(b&4&&(R=l.stateNode,R!=null)){var B=l.memoizedProps,Q=_!==null?_.memoizedProps:B,he=l.type,me=l.updateQueue;if(l.updateQueue=null,me!==null)try{he==="input"&&B.type==="radio"&&B.name!=null&&_e(R,B),qe(he,Q);var Oe=qe(he,B);for(Q=0;Q<me.length;Q+=2){var Le=me[Q],Be=me[Q+1];Le==="style"?Ie(R,Be):Le==="dangerouslySetInnerHTML"?ft(R,Be):Le==="children"?tt(R,Be):A(R,Le,Be,Oe)}switch(he){case"input":ge(R,B);break;case"textarea":et(R,B);break;case"select":var Me=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!B.multiple;var Ve=B.value;Ve!=null?ze(R,!!B.multiple,Ve,!1):Me!==!!B.multiple&&(B.defaultValue!=null?ze(R,!!B.multiple,B.defaultValue,!0):ze(R,!!B.multiple,B.multiple?[]:"",!1))}R[ca]=B}catch(Ye){Ct(l,l.return,Ye)}}break;case 6:if(wr(d,l),Pr(l),b&4){if(l.stateNode===null)throw Error(n(162));R=l.stateNode,B=l.memoizedProps;try{R.nodeValue=B}catch(Ye){Ct(l,l.return,Ye)}}break;case 3:if(wr(d,l),Pr(l),b&4&&_!==null&&_.memoizedState.isDehydrated)try{Zn(d.containerInfo)}catch(Ye){Ct(l,l.return,Ye)}break;case 4:wr(d,l),Pr(l);break;case 13:wr(d,l),Pr(l),R=l.child,R.flags&8192&&(B=R.memoizedState!==null,R.stateNode.isHidden=B,!B||R.alternate!==null&&R.alternate.memoizedState!==null||(Ks=$e())),b&4&&pc(l);break;case 22:if(Le=_!==null&&_.memoizedState!==null,l.mode&1?(Gt=(Oe=Gt)||Le,wr(d,l),Gt=Oe):wr(d,l),Pr(l),b&8192){if(Oe=l.memoizedState!==null,(l.stateNode.isHidden=Oe)&&!Le&&(l.mode&1)!==0)for(Xe=l,Le=l.child;Le!==null;){for(Be=Xe=Le;Xe!==null;){switch(Me=Xe,Ve=Me.child,Me.tag){case 0:case 11:case 14:case 15:_a(4,Me,Me.return);break;case 1:Un(Me,Me.return);var Ke=Me.stateNode;if(typeof Ke.componentWillUnmount=="function"){b=Me,_=Me.return;try{d=b,Ke.props=d.memoizedProps,Ke.state=d.memoizedState,Ke.componentWillUnmount()}catch(Ye){Ct(b,_,Ye)}}break;case 5:Un(Me,Me.return);break;case 22:if(Me.memoizedState!==null){xc(Be);continue}}Ve!==null?(Ve.return=Me,Xe=Ve):xc(Be)}Le=Le.sibling}e:for(Le=null,Be=l;;){if(Be.tag===5){if(Le===null){Le=Be;try{R=Be.stateNode,Oe?(B=R.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none"):(he=Be.stateNode,me=Be.memoizedProps.style,Q=me!=null&&me.hasOwnProperty("display")?me.display:null,he.style.display=St("display",Q))}catch(Ye){Ct(l,l.return,Ye)}}}else if(Be.tag===6){if(Le===null)try{Be.stateNode.nodeValue=Oe?"":Be.memoizedProps}catch(Ye){Ct(l,l.return,Ye)}}else if((Be.tag!==22&&Be.tag!==23||Be.memoizedState===null||Be===l)&&Be.child!==null){Be.child.return=Be,Be=Be.child;continue}if(Be===l)break e;for(;Be.sibling===null;){if(Be.return===null||Be.return===l)break e;Le===Be&&(Le=null),Be=Be.return}Le===Be&&(Le=null),Be.sibling.return=Be.return,Be=Be.sibling}}break;case 19:wr(d,l),Pr(l),b&4&&pc(l);break;case 21:break;default:wr(d,l),Pr(l)}}function Pr(l){var d=l.flags;if(d&2){try{e:{for(var _=l.return;_!==null;){if(fc(_)){var b=_;break e}_=_.return}throw Error(n(160))}switch(b.tag){case 5:var R=b.stateNode;b.flags&32&&(tt(R,""),b.flags&=-33);var B=dc(l);Vs(l,B,R);break;case 3:case 4:var Q=b.stateNode.containerInfo,he=dc(l);qs(l,he,Q);break;default:throw Error(n(161))}}catch(me){Ct(l,l.return,me)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function rf(l,d,_){Xe=l,gc(l)}function gc(l,d,_){for(var b=(l.mode&1)!==0;Xe!==null;){var R=Xe,B=R.child;if(R.tag===22&&b){var Q=R.memoizedState!==null||fi;if(!Q){var he=R.alternate,me=he!==null&&he.memoizedState!==null||Gt;he=fi;var Oe=Gt;if(fi=Q,(Gt=me)&&!Oe)for(Xe=R;Xe!==null;)Q=Xe,me=Q.child,Q.tag===22&&Q.memoizedState!==null?yc(R):me!==null?(me.return=Q,Xe=me):yc(R);for(;B!==null;)Xe=B,gc(B),B=B.sibling;Xe=R,fi=he,Gt=Oe}vc(l)}else(R.subtreeFlags&8772)!==0&&B!==null?(B.return=R,Xe=B):vc(l)}}function vc(l){for(;Xe!==null;){var d=Xe;if((d.flags&8772)!==0){var _=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Gt||di(5,d);break;case 1:var b=d.stateNode;if(d.flags&4&&!Gt)if(_===null)b.componentDidMount();else{var R=d.elementType===d.type?_.memoizedProps:Sr(d.type,_.memoizedProps);b.componentDidUpdate(R,_.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var B=d.updateQueue;B!==null&&xl(d,B,b);break;case 3:var Q=d.updateQueue;if(Q!==null){if(_=null,d.child!==null)switch(d.child.tag){case 5:_=d.child.stateNode;break;case 1:_=d.child.stateNode}xl(d,Q,_)}break;case 5:var he=d.stateNode;if(_===null&&d.flags&4){_=he;var me=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&_.focus();break;case"img":me.src&&(_.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var Oe=d.alternate;if(Oe!==null){var Le=Oe.memoizedState;if(Le!==null){var Be=Le.dehydrated;Be!==null&&Zn(Be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Gt||d.flags&512&&zs(d)}catch(Me){Ct(d,d.return,Me)}}if(d===l){Xe=null;break}if(_=d.sibling,_!==null){_.return=d.return,Xe=_;break}Xe=d.return}}function xc(l){for(;Xe!==null;){var d=Xe;if(d===l){Xe=null;break}var _=d.sibling;if(_!==null){_.return=d.return,Xe=_;break}Xe=d.return}}function yc(l){for(;Xe!==null;){var d=Xe;try{switch(d.tag){case 0:case 11:case 15:var _=d.return;try{di(4,d)}catch(me){Ct(d,_,me)}break;case 1:var b=d.stateNode;if(typeof b.componentDidMount=="function"){var R=d.return;try{b.componentDidMount()}catch(me){Ct(d,R,me)}}var B=d.return;try{zs(d)}catch(me){Ct(d,B,me)}break;case 5:var Q=d.return;try{zs(d)}catch(me){Ct(d,Q,me)}}}catch(me){Ct(d,d.return,me)}if(d===l){Xe=null;break}var he=d.sibling;if(he!==null){he.return=d.return,Xe=he;break}Xe=d.return}}var nf=Math.ceil,hi=L.ReactCurrentDispatcher,Gs=L.ReactCurrentOwner,gr=L.ReactCurrentBatchConfig,lt=0,$t=null,Dt=null,Wt=0,cr=0,Wn=Yr(0),Lt=0,Sa=null,xn=0,mi=0,Xs=0,Ea=null,rr=null,Ks=0,Hn=1/0,Ur=null,gi=!1,Ys=null,rn=null,vi=!1,nn=null,xi=0,wa=0,Js=null,yi=-1,_i=0;function Zt(){return(lt&6)!==0?$e():yi!==-1?yi:yi=$e()}function an(l){return(l.mode&1)===0?1:(lt&2)!==0&&Wt!==0?Wt&-Wt:ju.transition!==null?(_i===0&&(_i=fo()),_i):(l=dt,l!==0||(l=window.event,l=l===void 0?16:So(l.type)),l)}function br(l,d,_,b){if(50<wa)throw wa=0,Js=null,Error(n(185));Gn(l,_,b),((lt&2)===0||l!==$t)&&(l===$t&&((lt&2)===0&&(mi|=_),Lt===4&&sn(l,Wt)),nr(l,b),_===1&&lt===0&&(d.mode&1)===0&&(Hn=$e()+500,Ga&&Zr()))}function nr(l,d){var _=l.callbackNode;jc(l,d);var b=Ca(l,l===$t?Wt:0);if(b===0)_!==null&&He(_),l.callbackNode=null,l.callbackPriority=0;else if(d=b&-b,l.callbackPriority!==d){if(_!=null&&He(_),d===1)l.tag===0?$u(Sc.bind(null,l)):sl(Sc.bind(null,l)),Mu(function(){(lt&6)===0&&Zr()}),_=null;else{switch(ho(b)){case 1:_=pt;break;case 4:_=mt;break;case 16:_=Rt;break;case 536870912:_=Wr;break;default:_=Rt}_=Pc(_,_c.bind(null,l))}l.callbackPriority=d,l.callbackNode=_}}function _c(l,d){if(yi=-1,_i=0,(lt&6)!==0)throw Error(n(327));var _=l.callbackNode;if(zn()&&l.callbackNode!==_)return null;var b=Ca(l,l===$t?Wt:0);if(b===0)return null;if((b&30)!==0||(b&l.expiredLanes)!==0||d)d=Si(l,b);else{d=b;var R=lt;lt|=2;var B=wc();($t!==l||Wt!==d)&&(Ur=null,Hn=$e()+500,_n(l,d));do try{of();break}catch(he){Ec(l,he)}while(!0);ms(),hi.current=B,lt=R,Dt!==null?d=0:($t=null,Wt=0,d=Lt)}if(d!==0){if(d===2&&(R=Ri(l),R!==0&&(b=R,d=Zs(l,R))),d===1)throw _=Sa,_n(l,0),sn(l,b),nr(l,$e()),_;if(d===6)sn(l,b);else{if(R=l.current.alternate,(b&30)===0&&!af(R)&&(d=Si(l,b),d===2&&(B=Ri(l),B!==0&&(b=B,d=Zs(l,B))),d===1))throw _=Sa,_n(l,0),sn(l,b),nr(l,$e()),_;switch(l.finishedWork=R,l.finishedLanes=b,d){case 0:case 1:throw Error(n(345));case 2:Sn(l,rr,Ur);break;case 3:if(sn(l,b),(b&130023424)===b&&(d=Ks+500-$e(),10<d)){if(Ca(l,0)!==0)break;if(R=l.suspendedLanes,(R&b)!==b){Zt(),l.pingedLanes|=l.suspendedLanes&R;break}l.timeoutHandle=ns(Sn.bind(null,l,rr,Ur),d);break}Sn(l,rr,Ur);break;case 4:if(sn(l,b),(b&4194240)===b)break;for(d=l.eventTimes,R=-1;0<b;){var Q=31-Ot(b);B=1<<Q,Q=d[Q],Q>R&&(R=Q),b&=~B}if(b=R,b=$e()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*nf(b/1960))-b,10<b){l.timeoutHandle=ns(Sn.bind(null,l,rr,Ur),b);break}Sn(l,rr,Ur);break;case 5:Sn(l,rr,Ur);break;default:throw Error(n(329))}}}return nr(l,$e()),l.callbackNode===_?_c.bind(null,l):null}function Zs(l,d){var _=Ea;return l.current.memoizedState.isDehydrated&&(_n(l,d).flags|=256),l=Si(l,d),l!==2&&(d=rr,rr=_,d!==null&&Qs(d)),l}function Qs(l){rr===null?rr=l:rr.push.apply(rr,l)}function af(l){for(var d=l;;){if(d.flags&16384){var _=d.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var b=0;b<_.length;b++){var R=_[b],B=R.getSnapshot;R=R.value;try{if(!yr(B(),R))return!1}catch{return!1}}}if(_=d.child,d.subtreeFlags&16384&&_!==null)_.return=d,d=_;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function sn(l,d){for(d&=~Xs,d&=~mi,l.suspendedLanes|=d,l.pingedLanes&=~d,l=l.expirationTimes;0<d;){var _=31-Ot(d),b=1<<_;l[_]=-1,d&=~b}}function Sc(l){if((lt&6)!==0)throw Error(n(327));zn();var d=Ca(l,0);if((d&1)===0)return nr(l,$e()),null;var _=Si(l,d);if(l.tag!==0&&_===2){var b=Ri(l);b!==0&&(d=b,_=Zs(l,b))}if(_===1)throw _=Sa,_n(l,0),sn(l,d),nr(l,$e()),_;if(_===6)throw Error(n(345));return l.finishedWork=l.current.alternate,l.finishedLanes=d,Sn(l,rr,Ur),nr(l,$e()),null}function eo(l,d){var _=lt;lt|=1;try{return l(d)}finally{lt=_,lt===0&&(Hn=$e()+500,Ga&&Zr())}}function yn(l){nn!==null&&nn.tag===0&&(lt&6)===0&&zn();var d=lt;lt|=1;var _=gr.transition,b=dt;try{if(gr.transition=null,dt=1,l)return l()}finally{dt=b,gr.transition=_,lt=d,(lt&6)===0&&Zr()}}function ro(){cr=Wn.current,_t(Wn)}function _n(l,d){l.finishedWork=null,l.finishedLanes=0;var _=l.timeoutHandle;if(_!==-1&&(l.timeoutHandle=-1,Iu(_)),Dt!==null)for(_=Dt.return;_!==null;){var b=_;switch(us(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&qa();break;case 3:$n(),_t(Qt),_t(zt),ws();break;case 5:Ss(b);break;case 4:$n();break;case 13:_t(Tt);break;case 19:_t(Tt);break;case 10:gs(b.type._context);break;case 22:case 23:ro()}_=_.return}if($t=l,Dt=l=on(l.current,null),Wt=cr=d,Lt=0,Sa=null,Xs=mi=xn=0,rr=Ea=null,mn!==null){for(d=0;d<mn.length;d++)if(_=mn[d],b=_.interleaved,b!==null){_.interleaved=null;var R=b.next,B=_.pending;if(B!==null){var Q=B.next;B.next=R,b.next=Q}_.pending=b}mn=null}return l}function Ec(l,d){do{var _=Dt;try{if(ms(),ni.current=oi,ai){for(var b=kt.memoizedState;b!==null;){var R=b.queue;R!==null&&(R.pending=null),b=b.next}ai=!1}if(vn=0,Bt=Mt=kt=null,ma=!1,ga=0,Gs.current=null,_===null||_.return===null){Lt=1,Sa=d,Dt=null;break}e:{var B=l,Q=_.return,he=_,me=d;if(d=Wt,he.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Oe=me,Le=he,Be=Le.tag;if((Le.mode&1)===0&&(Be===0||Be===11||Be===15)){var Me=Le.alternate;Me?(Le.updateQueue=Me.updateQueue,Le.memoizedState=Me.memoizedState,Le.lanes=Me.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var Ve=Gl(Q);if(Ve!==null){Ve.flags&=-257,Xl(Ve,Q,he,B,d),Ve.mode&1&&Vl(B,Oe,d),d=Ve,me=Oe;var Ke=d.updateQueue;if(Ke===null){var Ye=new Set;Ye.add(me),d.updateQueue=Ye}else Ke.add(me);break e}else{if((d&1)===0){Vl(B,Oe,d),no();break e}me=Error(n(426))}}else if(At&&he.mode&1){var Ft=Gl(Q);if(Ft!==null){(Ft.flags&65536)===0&&(Ft.flags|=256),Xl(Ft,Q,he,B,d),hs(jn(me,he));break e}}B=me=jn(me,he),Lt!==4&&(Lt=2),Ea===null?Ea=[B]:Ea.push(B),B=Q;do{switch(B.tag){case 3:B.flags|=65536,d&=-d,B.lanes|=d;var Ee=zl(B,me,d);vl(B,Ee);break e;case 1:he=me;var xe=B.type,Ae=B.stateNode;if((B.flags&128)===0&&(typeof xe.getDerivedStateFromError=="function"||Ae!==null&&typeof Ae.componentDidCatch=="function"&&(rn===null||!rn.has(Ae)))){B.flags|=65536,d&=-d,B.lanes|=d;var Ue=ql(B,he,d);vl(B,Ue);break e}}B=B.return}while(B!==null)}Ac(_)}catch(Ze){d=Ze,Dt===_&&_!==null&&(Dt=_=_.return);continue}break}while(!0)}function wc(){var l=hi.current;return hi.current=oi,l===null?oi:l}function no(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),$t===null||(xn&268435455)===0&&(mi&268435455)===0||sn($t,Wt)}function Si(l,d){var _=lt;lt|=2;var b=wc();($t!==l||Wt!==d)&&(Ur=null,_n(l,d));do try{sf();break}catch(R){Ec(l,R)}while(!0);if(ms(),lt=_,hi.current=b,Dt!==null)throw Error(n(261));return $t=null,Wt=0,Lt}function sf(){for(;Dt!==null;)bc(Dt)}function of(){for(;Dt!==null&&!Ge();)bc(Dt)}function bc(l){var d=Cc(l.alternate,l,cr);l.memoizedProps=l.pendingProps,d===null?Ac(l):Dt=d,Gs.current=null}function Ac(l){var d=l;do{var _=d.alternate;if(l=d.return,(d.flags&32768)===0){if(_=Zu(_,d,cr),_!==null){Dt=_;return}}else{if(_=Qu(_,d),_!==null){_.flags&=32767,Dt=_;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Lt=6,Dt=null;return}}if(d=d.sibling,d!==null){Dt=d;return}Dt=d=l}while(d!==null);Lt===0&&(Lt=5)}function Sn(l,d,_){var b=dt,R=gr.transition;try{gr.transition=null,dt=1,lf(l,d,_,b)}finally{gr.transition=R,dt=b}return null}function lf(l,d,_,b){do zn();while(nn!==null);if((lt&6)!==0)throw Error(n(327));_=l.finishedWork;var R=l.finishedLanes;if(_===null)return null;if(l.finishedWork=null,l.finishedLanes=0,_===l.current)throw Error(n(177));l.callbackNode=null,l.callbackPriority=0;var B=_.lanes|_.childLanes;if(Uc(l,B),l===$t&&(Dt=$t=null,Wt=0),(_.subtreeFlags&2064)===0&&(_.flags&2064)===0||vi||(vi=!0,Pc(Rt,function(){return zn(),null})),B=(_.flags&15990)!==0,(_.subtreeFlags&15990)!==0||B){B=gr.transition,gr.transition=null;var Q=dt;dt=1;var he=lt;lt|=4,Gs.current=null,tf(l,_),mc(_,l),ku(ts),Oa=!!es,ts=es=null,l.current=_,rf(_),je(),lt=he,dt=Q,gr.transition=B}else l.current=_;if(vi&&(vi=!1,nn=l,xi=R),B=l.pendingLanes,B===0&&(rn=null),qn(_.stateNode),nr(l,$e()),d!==null)for(b=l.onRecoverableError,_=0;_<d.length;_++)R=d[_],b(R.value,{componentStack:R.stack,digest:R.digest});if(gi)throw gi=!1,l=Ys,Ys=null,l;return(xi&1)!==0&&l.tag!==0&&zn(),B=l.pendingLanes,(B&1)!==0?l===Js?wa++:(wa=0,Js=l):wa=0,Zr(),null}function zn(){if(nn!==null){var l=ho(xi),d=gr.transition,_=dt;try{if(gr.transition=null,dt=16>l?16:l,nn===null)var b=!1;else{if(l=nn,nn=null,xi=0,(lt&6)!==0)throw Error(n(331));var R=lt;for(lt|=4,Xe=l.current;Xe!==null;){var B=Xe,Q=B.child;if((Xe.flags&16)!==0){var he=B.deletions;if(he!==null){for(var me=0;me<he.length;me++){var Oe=he[me];for(Xe=Oe;Xe!==null;){var Le=Xe;switch(Le.tag){case 0:case 11:case 15:_a(8,Le,B)}var Be=Le.child;if(Be!==null)Be.return=Le,Xe=Be;else for(;Xe!==null;){Le=Xe;var Me=Le.sibling,Ve=Le.return;if(uc(Le),Le===Oe){Xe=null;break}if(Me!==null){Me.return=Ve,Xe=Me;break}Xe=Ve}}}var Ke=B.alternate;if(Ke!==null){var Ye=Ke.child;if(Ye!==null){Ke.child=null;do{var Ft=Ye.sibling;Ye.sibling=null,Ye=Ft}while(Ye!==null)}}Xe=B}}if((B.subtreeFlags&2064)!==0&&Q!==null)Q.return=B,Xe=Q;else e:for(;Xe!==null;){if(B=Xe,(B.flags&2048)!==0)switch(B.tag){case 0:case 11:case 15:_a(9,B,B.return)}var Ee=B.sibling;if(Ee!==null){Ee.return=B.return,Xe=Ee;break e}Xe=B.return}}var xe=l.current;for(Xe=xe;Xe!==null;){Q=Xe;var Ae=Q.child;if((Q.subtreeFlags&2064)!==0&&Ae!==null)Ae.return=Q,Xe=Ae;else e:for(Q=xe;Xe!==null;){if(he=Xe,(he.flags&2048)!==0)try{switch(he.tag){case 0:case 11:case 15:di(9,he)}}catch(Ze){Ct(he,he.return,Ze)}if(he===Q){Xe=null;break e}var Ue=he.sibling;if(Ue!==null){Ue.return=he.return,Xe=Ue;break e}Xe=he.return}}if(lt=R,Zr(),Nt&&typeof Nt.onPostCommitFiberRoot=="function")try{Nt.onPostCommitFiberRoot(Ar,l)}catch{}b=!0}return b}finally{dt=_,gr.transition=d}}return!1}function Tc(l,d,_){d=jn(_,d),d=zl(l,d,1),l=en(l,d,1),d=Zt(),l!==null&&(Gn(l,1,d),nr(l,d))}function Ct(l,d,_){if(l.tag===3)Tc(l,l,_);else for(;d!==null;){if(d.tag===3){Tc(d,l,_);break}else if(d.tag===1){var b=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(rn===null||!rn.has(b))){l=jn(_,l),l=ql(d,l,1),d=en(d,l,1),l=Zt(),d!==null&&(Gn(d,1,l),nr(d,l));break}}d=d.return}}function cf(l,d,_){var b=l.pingCache;b!==null&&b.delete(d),d=Zt(),l.pingedLanes|=l.suspendedLanes&_,$t===l&&(Wt&_)===_&&(Lt===4||Lt===3&&(Wt&130023424)===Wt&&500>$e()-Ks?_n(l,0):Xs|=_),nr(l,d)}function kc(l,d){d===0&&((l.mode&1)===0?d=1:(d=ka,ka<<=1,(ka&130023424)===0&&(ka=4194304)));var _=Zt();l=Br(l,d),l!==null&&(Gn(l,d,_),nr(l,_))}function uf(l){var d=l.memoizedState,_=0;d!==null&&(_=d.retryLane),kc(l,_)}function ff(l,d){var _=0;switch(l.tag){case 13:var b=l.stateNode,R=l.memoizedState;R!==null&&(_=R.retryLane);break;case 19:b=l.stateNode;break;default:throw Error(n(314))}b!==null&&b.delete(d),kc(l,_)}var Cc;Cc=function(l,d,_){if(l!==null)if(l.memoizedProps!==d.pendingProps||Qt.current)tr=!0;else{if((l.lanes&_)===0&&(d.flags&128)===0)return tr=!1,Ju(l,d,_);tr=(l.flags&131072)!==0}else tr=!1,At&&(d.flags&1048576)!==0&&ol(d,Ka,d.index);switch(d.lanes=0,d.tag){case 2:var b=d.type;ui(l,d),l=d.pendingProps;var R=Fn(d,zt.current);Bn(d,_),R=Ts(null,d,b,l,R,_);var B=ks();return d.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,er(b)?(B=!0,Va(d)):B=!1,d.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,ys(d),R.updater=li,d.stateNode=R,R._reactInternals=d,Ds(d,b,l,_),d=Ns(null,d,b,!0,B,_)):(d.tag=0,At&&B&&cs(d),Jt(null,d,R,_),d=d.child),d;case 16:b=d.elementType;e:{switch(ui(l,d),l=d.pendingProps,R=b._init,b=R(b._payload),d.type=b,R=d.tag=hf(b),l=Sr(b,l),R){case 0:d=Ls(null,d,b,l,_);break e;case 1:d=ec(null,d,b,l,_);break e;case 11:d=Kl(null,d,b,l,_);break e;case 14:d=Yl(null,d,b,Sr(b.type,l),_);break e}throw Error(n(306,b,""))}return d;case 0:return b=d.type,R=d.pendingProps,R=d.elementType===b?R:Sr(b,R),Ls(l,d,b,R,_);case 1:return b=d.type,R=d.pendingProps,R=d.elementType===b?R:Sr(b,R),ec(l,d,b,R,_);case 3:e:{if(tc(d),l===null)throw Error(n(387));b=d.pendingProps,B=d.memoizedState,R=B.element,gl(l,d),ti(d,b,null,_);var Q=d.memoizedState;if(b=Q.element,B.isDehydrated)if(B={element:b,isDehydrated:!1,cache:Q.cache,pendingSuspenseBoundaries:Q.pendingSuspenseBoundaries,transitions:Q.transitions},d.updateQueue.baseState=B,d.memoizedState=B,d.flags&256){R=jn(Error(n(423)),d),d=rc(l,d,b,_,R);break e}else if(b!==R){R=jn(Error(n(424)),d),d=rc(l,d,b,_,R);break e}else for(lr=Kr(d.stateNode.containerInfo.firstChild),or=d,At=!0,_r=null,_=pl(d,null,b,_),d.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Mn(),b===R){d=jr(l,d,_);break e}Jt(l,d,b,_)}d=d.child}return d;case 5:return yl(d),l===null&&ds(d),b=d.type,R=d.pendingProps,B=l!==null?l.memoizedProps:null,Q=R.children,rs(b,R)?Q=null:B!==null&&rs(b,B)&&(d.flags|=32),Ql(l,d),Jt(l,d,Q,_),d.child;case 6:return l===null&&ds(d),null;case 13:return nc(l,d,_);case 4:return _s(d,d.stateNode.containerInfo),b=d.pendingProps,l===null?d.child=Ln(d,null,b,_):Jt(l,d,b,_),d.child;case 11:return b=d.type,R=d.pendingProps,R=d.elementType===b?R:Sr(b,R),Kl(l,d,b,R,_);case 7:return Jt(l,d,d.pendingProps,_),d.child;case 8:return Jt(l,d,d.pendingProps.children,_),d.child;case 12:return Jt(l,d,d.pendingProps.children,_),d.child;case 10:e:{if(b=d.type._context,R=d.pendingProps,B=d.memoizedProps,Q=R.value,gt(Za,b._currentValue),b._currentValue=Q,B!==null)if(yr(B.value,Q)){if(B.children===R.children&&!Qt.current){d=jr(l,d,_);break e}}else for(B=d.child,B!==null&&(B.return=d);B!==null;){var he=B.dependencies;if(he!==null){Q=B.child;for(var me=he.firstContext;me!==null;){if(me.context===b){if(B.tag===1){me=$r(-1,_&-_),me.tag=2;var Oe=B.updateQueue;if(Oe!==null){Oe=Oe.shared;var Le=Oe.pending;Le===null?me.next=me:(me.next=Le.next,Le.next=me),Oe.pending=me}}B.lanes|=_,me=B.alternate,me!==null&&(me.lanes|=_),vs(B.return,_,d),he.lanes|=_;break}me=me.next}}else if(B.tag===10)Q=B.type===d.type?null:B.child;else if(B.tag===18){if(Q=B.return,Q===null)throw Error(n(341));Q.lanes|=_,he=Q.alternate,he!==null&&(he.lanes|=_),vs(Q,_,d),Q=B.sibling}else Q=B.child;if(Q!==null)Q.return=B;else for(Q=B;Q!==null;){if(Q===d){Q=null;break}if(B=Q.sibling,B!==null){B.return=Q.return,Q=B;break}Q=Q.return}B=Q}Jt(l,d,R.children,_),d=d.child}return d;case 9:return R=d.type,b=d.pendingProps.children,Bn(d,_),R=pr(R),b=b(R),d.flags|=1,Jt(l,d,b,_),d.child;case 14:return b=d.type,R=Sr(b,d.pendingProps),R=Sr(b.type,R),Yl(l,d,b,R,_);case 15:return Jl(l,d,d.type,d.pendingProps,_);case 17:return b=d.type,R=d.pendingProps,R=d.elementType===b?R:Sr(b,R),ui(l,d),d.tag=1,er(b)?(l=!0,Va(d)):l=!1,Bn(d,_),Wl(d,b,R),Ds(d,b,R,_),Ns(null,d,b,!0,l,_);case 19:return ic(l,d,_);case 22:return Zl(l,d,_)}throw Error(n(156,d.tag))};function Pc(l,d){return Ne(l,d)}function df(l,d,_,b){this.tag=l,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vr(l,d,_,b){return new df(l,d,_,b)}function ao(l){return l=l.prototype,!(!l||!l.isReactComponent)}function hf(l){if(typeof l=="function")return ao(l)?1:0;if(l!=null){if(l=l.$$typeof,l===ne)return 11;if(l===pe)return 14}return 2}function on(l,d){var _=l.alternate;return _===null?(_=vr(l.tag,d,l.key,l.mode),_.elementType=l.elementType,_.type=l.type,_.stateNode=l.stateNode,_.alternate=l,l.alternate=_):(_.pendingProps=d,_.type=l.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=l.flags&14680064,_.childLanes=l.childLanes,_.lanes=l.lanes,_.child=l.child,_.memoizedProps=l.memoizedProps,_.memoizedState=l.memoizedState,_.updateQueue=l.updateQueue,d=l.dependencies,_.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},_.sibling=l.sibling,_.index=l.index,_.ref=l.ref,_}function Ei(l,d,_,b,R,B){var Q=2;if(b=l,typeof l=="function")ao(l)&&(Q=1);else if(typeof l=="string")Q=5;else e:switch(l){case N:return En(_.children,R,B,d);case Y:Q=8,R|=8;break;case z:return l=vr(12,_,d,R|2),l.elementType=z,l.lanes=B,l;case oe:return l=vr(13,_,d,R),l.elementType=oe,l.lanes=B,l;case le:return l=vr(19,_,d,R),l.elementType=le,l.lanes=B,l;case J:return wi(_,R,B,d);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case te:Q=10;break e;case Z:Q=9;break e;case ne:Q=11;break e;case pe:Q=14;break e;case de:Q=16,b=null;break e}throw Error(n(130,l==null?l:typeof l,""))}return d=vr(Q,_,d,R),d.elementType=l,d.type=b,d.lanes=B,d}function En(l,d,_,b){return l=vr(7,l,b,d),l.lanes=_,l}function wi(l,d,_,b){return l=vr(22,l,b,d),l.elementType=J,l.lanes=_,l.stateNode={isHidden:!1},l}function io(l,d,_){return l=vr(6,l,null,d),l.lanes=_,l}function so(l,d,_){return d=vr(4,l.children!==null?l.children:[],l.key,d),d.lanes=_,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}function pf(l,d,_,b,R){this.tag=d,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oi(0),this.expirationTimes=Oi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oi(0),this.identifierPrefix=b,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function oo(l,d,_,b,R,B,Q,he,me){return l=new pf(l,d,_,he,me),d===1?(d=1,B===!0&&(d|=8)):d=0,B=vr(3,null,null,d),l.current=B,B.stateNode=l,B.memoizedState={element:b,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},ys(B),l}function mf(l,d,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:b==null?null:""+b,children:l,containerInfo:d,implementation:_}}function Rc(l){if(!l)return Jr;l=l._reactInternals;e:{if(fe(l)!==l||l.tag!==1)throw Error(n(170));var d=l;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(er(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(n(171))}if(l.tag===1){var _=l.type;if(er(_))return al(l,_,d)}return d}function Oc(l,d,_,b,R,B,Q,he,me){return l=oo(_,b,!0,l,R,B,Q,he,me),l.context=Rc(null),_=l.current,b=Zt(),R=an(_),B=$r(b,R),B.callback=d??null,en(_,B,R),l.current.lanes=R,Gn(l,R,b),nr(l,b),l}function bi(l,d,_,b){var R=d.current,B=Zt(),Q=an(R);return _=Rc(_),d.context===null?d.context=_:d.pendingContext=_,d=$r(B,Q),d.payload={element:l},b=b===void 0?null:b,b!==null&&(d.callback=b),l=en(R,d,Q),l!==null&&(br(l,R,Q,B),ei(l,R,Q)),Q}function Ai(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function Fc(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var _=l.retryLane;l.retryLane=_!==0&&_<d?_:d}}function lo(l,d){Fc(l,d),(l=l.alternate)&&Fc(l,d)}function gf(){return null}var Dc=typeof reportError=="function"?reportError:function(l){console.error(l)};function co(l){this._internalRoot=l}Ti.prototype.render=co.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(n(409));bi(l,d,null,null)},Ti.prototype.unmount=co.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;yn(function(){bi(null,l,null,null)}),d[Ir]=null}};function Ti(l){this._internalRoot=l}Ti.prototype.unstable_scheduleHydration=function(l){if(l){var d=go();l={blockedOn:null,target:l,priority:d};for(var _=0;_<Vr.length&&d!==0&&d<Vr[_].priority;_++);Vr.splice(_,0,l),_===0&&yo(l)}};function uo(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function ki(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function Ic(){}function vf(l,d,_,b,R){if(R){if(typeof b=="function"){var B=b;b=function(){var Oe=Ai(Q);B.call(Oe)}}var Q=Oc(d,b,l,0,null,!1,!1,"",Ic);return l._reactRootContainer=Q,l[Ir]=Q.current,oa(l.nodeType===8?l.parentNode:l),yn(),Q}for(;R=l.lastChild;)l.removeChild(R);if(typeof b=="function"){var he=b;b=function(){var Oe=Ai(me);he.call(Oe)}}var me=oo(l,0,!1,null,null,!1,!1,"",Ic);return l._reactRootContainer=me,l[Ir]=me.current,oa(l.nodeType===8?l.parentNode:l),yn(function(){bi(d,me,_,b)}),me}function Ci(l,d,_,b,R){var B=_._reactRootContainer;if(B){var Q=B;if(typeof R=="function"){var he=R;R=function(){var me=Ai(Q);he.call(me)}}bi(d,Q,l,R)}else Q=vf(_,d,l,R,b);return Ai(Q)}po=function(l){switch(l.tag){case 3:var d=l.stateNode;if(d.current.memoizedState.isDehydrated){var _=Vn(d.pendingLanes);_!==0&&(Fi(d,_|1),nr(d,$e()),(lt&6)===0&&(Hn=$e()+500,Zr()))}break;case 13:yn(function(){var b=Br(l,1);if(b!==null){var R=Zt();br(b,l,1,R)}}),lo(l,1)}},Di=function(l){if(l.tag===13){var d=Br(l,134217728);if(d!==null){var _=Zt();br(d,l,134217728,_)}lo(l,134217728)}},mo=function(l){if(l.tag===13){var d=an(l),_=Br(l,d);if(_!==null){var b=Zt();br(_,l,d,b)}lo(l,d)}},go=function(){return dt},vo=function(l,d){var _=dt;try{return dt=l,d()}finally{dt=_}},wt=function(l,d,_){switch(d){case"input":if(ge(l,_),d=_.name,_.type==="radio"&&d!=null){for(_=l;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<_.length;d++){var b=_[d];if(b!==l&&b.form===l.form){var R=za(b);if(!R)throw Error(n(90));U(b),ge(b,R)}}}break;case"textarea":et(l,_);break;case"select":d=_.value,d!=null&&ze(l,!!_.multiple,d,!1)}},ar=eo,Rr=yn;var xf={usingClientEntryPoint:!1,Events:[ua,Rn,za,It,xr,eo]},ba={findFiberByHostInstance:fn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yf={bundleType:ba.bundleType,version:ba.version,rendererPackageName:ba.rendererPackageName,rendererConfig:ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Ce(l),l===null?null:l.stateNode},findFiberByHostInstance:ba.findFiberByHostInstance||gf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pi.isDisabled&&Pi.supportsFiber)try{Ar=Pi.inject(yf),Nt=Pi}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xf,reactDom_production_min.createPortal=function(l,d){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uo(d))throw Error(n(200));return mf(l,d,null,_)},reactDom_production_min.createRoot=function(l,d){if(!uo(l))throw Error(n(299));var _=!1,b="",R=Dc;return d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(R=d.onRecoverableError)),d=oo(l,1,!1,null,null,_,!1,b,R),l[Ir]=d.current,oa(l.nodeType===8?l.parentNode:l),new co(d)},reactDom_production_min.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=Ce(d),l=l===null?null:l.stateNode,l},reactDom_production_min.flushSync=function(l){return yn(l)},reactDom_production_min.hydrate=function(l,d,_){if(!ki(d))throw Error(n(200));return Ci(null,l,d,!0,_)},reactDom_production_min.hydrateRoot=function(l,d,_){if(!uo(l))throw Error(n(405));var b=_!=null&&_.hydratedSources||null,R=!1,B="",Q=Dc;if(_!=null&&(_.unstable_strictMode===!0&&(R=!0),_.identifierPrefix!==void 0&&(B=_.identifierPrefix),_.onRecoverableError!==void 0&&(Q=_.onRecoverableError)),d=Oc(d,null,l,1,_??null,R,!1,B,Q),l[Ir]=d.current,oa(l),b)for(l=0;l<b.length;l++)_=b[l],R=_._getVersion,R=R(_._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[_,R]:d.mutableSourceEagerHydrationData.push(_,R);return new Ti(d)},reactDom_production_min.render=function(l,d,_){if(!ki(d))throw Error(n(200));return Ci(null,l,d,!1,_)},reactDom_production_min.unmountComponentAtNode=function(l){if(!ki(l))throw Error(n(40));return l._reactRootContainer?(yn(function(){Ci(null,null,l,!1,function(){l._reactRootContainer=null,l[Ir]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=eo,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(l,d,_,b){if(!ki(_))throw Error(n(200));if(l==null||l._reactInternals===void 0)throw Error(n(38));return Ci(l,d,_,!1,b)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var e=requireReactDom();return client.createRoot=e.createRoot,client.hydrateRoot=e.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function t(a,i){let{pathname:s,search:o,hash:c}=a.location;return createLocation("",{pathname:s,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(a,i){return typeof i=="string"?i:createPath(i)}return getUrlBasedHistory(t,n,null,e)}function invariant(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function warning(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,t){return{usr:e.state,key:e.key,idx:t}}function createLocation(e,t,n=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?parsePath(t):t,state:n,key:t&&t.key||a||createKey()}}function createPath({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function parsePath(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function getUrlBasedHistory(e,t,n,a={}){let{window:i=document.defaultView,v5Compat:s=!1}=a,o=i.history,c="POP",h=null,f=u();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function u(){return(o.state||{idx:null}).idx}function p(){c="POP";let E=u(),w=E==null?null:E-f;f=E,h&&h({action:c,location:S.location,delta:w})}function g(E,w){c="PUSH";let T=createLocation(S.location,E,w);f=u()+1;let A=getHistoryState(T,f),L=S.createHref(T);try{o.pushState(A,"",L)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(L)}s&&h&&h({action:c,location:S.location,delta:1})}function v(E,w){c="REPLACE";let T=createLocation(S.location,E,w);f=u();let A=getHistoryState(T,f),L=S.createHref(T);o.replaceState(A,"",L),s&&h&&h({action:c,location:S.location,delta:0})}function m(E){return createBrowserURLImpl(E)}let S={get action(){return c},get location(){return e(i,o)},listen(E){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(PopStateEventType,p),h=E,()=>{i.removeEventListener(PopStateEventType,p),h=null}},createHref(E){return t(i,E)},createURL:m,encodeLocation(E){let w=m(E);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:g,replace:v,go(E){return o.go(E)}};return S}function createBrowserURLImpl(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(n,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:createPath(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a),new URL(a,n)}function matchRoutes(e,t,n="/"){return matchRoutesImpl(e,t,n,!1)}function matchRoutesImpl(e,t,n,a){let i=typeof t=="string"?parsePath(t):t,s=stripBasename(i.pathname||"/",n);if(s==null)return null;let o=flattenRoutes(e);rankRouteBranches(o);let c=null;for(let h=0;c==null&&h<o.length;++h){let f=decodePath(s);c=matchRouteBranch(o[h],f,a)}return c}function flattenRoutes(e,t=[],n=[],a="",i=!1){let s=(o,c,h=i,f)=>{let u={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(a)&&h)return;invariant(u.relativePath.startsWith(a),`Absolute route path "${u.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(a.length)}let p=joinPaths([a,u.relativePath]),g=n.concat(u);o.children&&o.children.length>0&&(invariant(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),flattenRoutes(o.children,t,g,p,h)),!(o.path==null&&!o.index)&&t.push({path:p,score:computeScore(p,o.index),routesMeta:g})};return e.forEach((o,c)=>{if(o.path===""||!o.path?.includes("?"))s(o,c);else for(let h of explodeOptionalSegments(o.path))s(o,c,!0,h)}),t}function explodeOptionalSegments(e){let t=e.split("/");if(t.length===0)return[];let[n,...a]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(a.length===0)return i?[s,""]:[s];let o=explodeOptionalSegments(a.join("/")),c=[];return c.push(...o.map(h=>h===""?s:[s,h].join("/"))),i&&c.push(...o),c.map(h=>e.startsWith("/")&&h===""?"/":h)}function rankRouteBranches(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:compareIndexes(t.routesMeta.map(a=>a.childrenIndex),n.routesMeta.map(a=>a.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,t){let n=e.split("/"),a=n.length;return n.some(isSplat)&&(a+=splatPenalty),t&&(a+=indexRouteValue),n.filter(i=>!isSplat(i)).reduce((i,s)=>i+(paramRe.test(s)?dynamicSegmentValue:s===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(e,t){return e.length===t.length&&e.slice(0,-1).every((a,i)=>a===t[i])?e[e.length-1]-t[t.length-1]:0}function matchRouteBranch(e,t,n=!1){let{routesMeta:a}=e,i={},s="/",o=[];for(let c=0;c<a.length;++c){let h=a[c],f=c===a.length-1,u=s==="/"?t:t.slice(s.length)||"/",p=matchPath({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},u),g=h.route;if(!p&&f&&n&&!a[a.length-1].route.index&&(p=matchPath({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},u)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:joinPaths([s,p.pathname]),pathnameBase:normalizePathname(joinPaths([s,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(s=joinPaths([s,p.pathnameBase]))}return o}function matchPath(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=compilePath(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:a.reduce((f,{paramName:u,isOptional:p},g)=>{if(u==="*"){let m=c[g]||"";o=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const v=c[g];return p&&!v?f[u]=void 0:f[u]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:o,pattern:e}}function compilePath(e,t=!1,n=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,h)=>(a.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),a]}function decodePath(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function stripBasename(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&a!=="/"?null:e.slice(n)||"/"}function resolvePath(e,t="/"){let{pathname:n,search:a="",hash:i=""}=typeof e=="string"?parsePath(e):e;return{pathname:n?n.startsWith("/")?n:resolvePathname(n,t):t,search:normalizeSearch(a),hash:normalizeHash(i)}}function resolvePathname(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function getInvalidPathError(e,t,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function getResolveToMatches(e){let t=getPathContributingMatches(e);return t.map((n,a)=>a===t.length-1?n.pathname:n.pathnameBase)}function resolveTo(e,t,n,a=!1){let i;typeof e=="string"?i=parsePath(e):(i={...e},invariant(!i.pathname||!i.pathname.includes("?"),getInvalidPathError("?","pathname","search",i)),invariant(!i.pathname||!i.pathname.includes("#"),getInvalidPathError("#","pathname","hash",i)),invariant(!i.search||!i.search.includes("#"),getInvalidPathError("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,c;if(o==null)c=n;else{let p=t.length-1;if(!a&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}c=p>=0?t[p]:"/"}let h=resolvePath(i,c),f=o&&o!=="/"&&o.endsWith("/"),u=(s||o===".")&&n.endsWith("/");return!h.pathname.endsWith("/")&&(f||u)&&(h.pathname+="/"),h}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:t}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=reactExports.useContext(NavigationContext),{hash:i,pathname:s,search:o}=useResolvedPath(e,{relative:t}),c=s;return n!=="/"&&(c=s==="/"?n:joinPaths([n,s])),a.createHref({pathname:c,search:o,hash:i})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect$1(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:t,navigator:n}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),s=JSON.stringify(getResolveToMatches(a)),o=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{o.current=!0}),reactExports.useCallback((h,f={})=>{if(warning(o.current,navigateEffectWarning),!o.current)return;if(typeof h=="number"){n.go(h);return}let u=resolveTo(h,JSON.parse(s),i,f.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:joinPaths([t,u.pathname])),(f.replace?n.replace:n.push)(u,f.state,f)},[t,n,s,i,e])}var OutletContext=reactExports.createContext(null);function useOutlet(e){let t=reactExports.useContext(RouteContext).outlet;return reactExports.useMemo(()=>t&&reactExports.createElement(OutletContext.Provider,{value:e},t),[t,e])}function useResolvedPath(e,{relative:t}={}){let{matches:n}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),i=JSON.stringify(getResolveToMatches(n));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(i),a,t==="path"),[e,i,a,t])}function useRoutes(e,t){return useRoutesImpl(e,t)}function useRoutesImpl(e,t,n,a,i){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),c=o[o.length-1],h=c?c.params:{},f=c?c.pathname:"/",u=c?c.pathnameBase:"/",p=c&&c.route;{let T=p&&p.path||"";warningOnce(f,!p||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let g=useLocation(),v;if(t){let T=typeof t=="string"?parsePath(t):t;invariant(u==="/"||T.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${T.pathname}" was given in the \`location\` prop.`),v=T}else v=g;let m=v.pathname||"/",S=m;if(u!=="/"){let T=u.replace(/^\//,"").split("/");S="/"+m.replace(/^\//,"").split("/").slice(T.length).join("/")}let E=matchRoutes(e,{pathname:S});warning(p||E!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),warning(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=_renderMatches(E&&E.map(T=>Object.assign({},T,{params:Object.assign({},h,T.params),pathname:joinPaths([u,s.encodeLocation?s.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?u:joinPaths([u,s.encodeLocation?s.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),o,n,a,i);return t&&w?reactExports.createElement(LocationContext.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},w):w}function DefaultErrorComponent(){let e=useRouteError(),t=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a},s={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:s},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:s},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},t),n?reactExports.createElement("pre",{style:i},n):null,o)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:t,children:n}){let a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),reactExports.createElement(RouteContext.Provider,{value:e},n)}function _renderMatches(e,t=[],n=null,a=null,i=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let s=e,o=n?.errors;if(o!=null){let f=s.findIndex(u=>u.route.id&&o?.[u.route.id]!==void 0);invariant(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let c=!1,h=-1;if(n)for(let f=0;f<s.length;f++){let u=s[f];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(h=f),u.route.id){let{loaderData:p,errors:g}=n,v=u.route.loader&&!p.hasOwnProperty(u.route.id)&&(!g||g[u.route.id]===void 0);if(u.route.lazy||v){c=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((f,u,p)=>{let g,v=!1,m=null,S=null;n&&(g=o&&u.route.id?o[u.route.id]:void 0,m=u.route.errorElement||defaultErrorElement,c&&(h<0&&p===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,S=null):h===p&&(v=!0,S=u.route.hydrateFallbackElement||null)));let E=t.concat(s.slice(0,p+1)),w=()=>{let T;return g?T=m:v?T=S:u.route.Component?T=reactExports.createElement(u.route.Component,null):u.route.element?T=u.route.element:T=f,reactExports.createElement(RenderedRoute,{match:u,routeContext:{outlet:f,matches:E,isDataRoute:n!=null},children:T})};return n&&(u.route.ErrorBoundary||u.route.errorElement||p===0)?reactExports.createElement(RenderErrorBoundary,{location:n.location,revalidation:n.revalidation,component:m,error:g,children:w(),routeContext:{outlet:null,matches:E,isDataRoute:!0},unstable_onError:a}):w()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let t=reactExports.useContext(DataRouterContext);return invariant(t,getDataRouterConsoleError(e)),t}function useDataRouterState(e){let t=reactExports.useContext(DataRouterStateContext);return invariant(t,getDataRouterConsoleError(e)),t}function useRouteContext(e){let t=reactExports.useContext(RouteContext);return invariant(t,getDataRouterConsoleError(e)),t}function useCurrentRouteId(e){let t=useRouteContext(e),n=t.matches[t.matches.length-1];return invariant(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=reactExports.useContext(RouteErrorContext),t=useDataRouterState("useRouteError"),n=useCurrentRouteId("useRouteError");return e!==void 0?e:t.errors?.[n]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),t=useCurrentRouteId("useNavigate"),n=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{n.current=!0}),reactExports.useCallback(async(i,s={})=>{warning(n.current,navigateEffectWarning),n.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...s}))},[e,t])}var alreadyWarned={};function warningOnce(e,t,n){!t&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,n))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:t,state:n,unstable_onError:a}){return useRoutesImpl(e,void 0,n,a,t)}function Outlet(e){return useOutlet(e.context)}function Route(e){invariant(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Router({basename:e="/",children:t=null,location:n,navigationType:a="POP",navigator:i,static:s=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),c=reactExports.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof n=="string"&&(n=parsePath(n));let{pathname:h="/",search:f="",hash:u="",state:p=null,key:g="default"}=n,v=reactExports.useMemo(()=>{let m=stripBasename(h,o);return m==null?null:{location:{pathname:m,search:f,hash:u,state:p,key:g},navigationType:a}},[o,h,f,u,p,g,a]);return warning(v!=null,`<Router basename="${o}"> is not able to match the URL "${h}${f}${u}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:reactExports.createElement(NavigationContext.Provider,{value:c},reactExports.createElement(LocationContext.Provider,{children:t,value:v}))}function Routes({children:e,location:t}){return useRoutes(createRoutesFromChildren(e),t)}function createRoutesFromChildren(e,t=[]){let n=[];return reactExports.Children.forEach(e,(a,i)=>{if(!reactExports.isValidElement(a))return;let s=[...t,i];if(a.type===reactExports.Fragment){n.push.apply(n,createRoutesFromChildren(a.props.children,s));return}invariant(a.type===Route,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),invariant(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||s.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=createRoutesFromChildren(a.props.children,s)),n.push(o)}),n}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,t){return e.button===0&&(!t||t==="_self")&&!isModifiedEvent(e)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,t){let n,a,i,s,o;if(isFormElement(e)){let c=e.getAttribute("action");a=c?stripBasename(c,t):null,n=e.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("enctype"))||defaultEncType,s=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=e.getAttribute("formaction")||c.getAttribute("action");if(a=h?stripBasename(h,t):null,n=e.getAttribute("formmethod")||c.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(c.getAttribute("enctype"))||defaultEncType,s=new FormData(c,e),!isFormDataSubmitterSupported()){let{name:f,type:u,value:p}=e;if(u==="image"){let g=f?`${f}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else f&&s.append(f,p)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=defaultMethod,a=null,i=defaultEncType,o=e}return s&&i==="text/plain"&&(o=s,s=void 0),{action:a,method:n.toLowerCase(),encType:i,formData:s,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function singleFetchUrl(e,t,n){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return a.pathname==="/"?a.pathname=`_root.${n}`:t&&stripBasename(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}async function loadRouteModule(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,t,n){let a=await Promise.all(e.map(async i=>{let s=t.routes[i.route.id];if(s){let o=await loadRouteModule(s,n);return o.links?o.links():[]}return[]}));return dedupeLinkDescriptors(a.flat(1).filter(isHtmlLinkDescriptor).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function getNewMatchesForLinks(e,t,n,a,i,s){let o=(h,f)=>n[f]?h.route.id!==n[f].route.id:!0,c=(h,f)=>n[f].pathname!==h.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==h.params["*"];return s==="assets"?t.filter((h,f)=>o(h,f)||c(h,f)):s==="data"?t.filter((h,f)=>{let u=a.routes[h.route.id];if(!u||!u.hasLoader)return!1;if(o(h,f)||c(h,f))return!0;if(h.route.shouldRevalidate){let p=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function getModuleLinkHrefs(e,t,{includeHydrateFallback:n}={}){return dedupeHrefs(e.map(a=>{let i=t.routes[a.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}function dedupeLinkDescriptors(e,t){let n=new Set;return new Set(t),e.reduce((a,i)=>{let s=JSON.stringify(sortKeys(i));return n.has(s)||(n.add(s),a.push({key:s,link:i})),a},[])}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,t){let n=reactExports.useContext(FrameworkContext),[a,i]=reactExports.useState(!1),[s,o]=reactExports.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:f,onMouseLeave:u,onTouchStart:p}=t,g=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let S=w=>{w.forEach(T=>{o(T.isIntersecting)})},E=new IntersectionObserver(S,{threshold:.5});return g.current&&E.observe(g.current),()=>{E.disconnect()}}},[e]),reactExports.useEffect(()=>{if(a){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[a]);let v=()=>{i(!0)},m=()=>{i(!1),o(!1)};return n?e!=="intent"?[s,g,{}]:[s,g,{onFocus:composeEventHandlers(c,v),onBlur:composeEventHandlers(h,m),onMouseEnter:composeEventHandlers(f,v),onMouseLeave:composeEventHandlers(u,m),onTouchStart:composeEventHandlers(p,v)}]:[!1,g,{}]}function composeEventHandlers(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function PrefetchPageLinks({page:e,...t}){let{router:n}=useDataRouterContext2(),a=reactExports.useMemo(()=>matchRoutes(n.routes,e,n.basename),[n.routes,e,n.basename]);return a?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:a,...t}):null}function useKeyedPrefetchLinks(e){let{manifest:t,routeModules:n}=useFrameworkContext(),[a,i]=reactExports.useState([]);return reactExports.useEffect(()=>{let s=!1;return getKeyedPrefetchLinks(e,t,n).then(o=>{s||i(o)}),()=>{s=!0}},[e,t,n]),a}function PrefetchPageLinksImpl({page:e,matches:t,...n}){let a=useLocation(),{manifest:i,routeModules:s}=useFrameworkContext(),{basename:o}=useDataRouterContext2(),{loaderData:c,matches:h}=useDataRouterStateContext(),f=reactExports.useMemo(()=>getNewMatchesForLinks(e,t,h,i,a,"data"),[e,t,h,i,a]),u=reactExports.useMemo(()=>getNewMatchesForLinks(e,t,h,i,a,"assets"),[e,t,h,i,a]),p=reactExports.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let m=new Set,S=!1;if(t.forEach(w=>{let T=i.routes[w.route.id];!T||!T.hasLoader||(!f.some(A=>A.route.id===w.route.id)&&w.route.id in c&&s[w.route.id]?.shouldRevalidate||T.hasClientLoader?S=!0:m.add(w.route.id))}),m.size===0)return[];let E=singleFetchUrl(e,o,"data");return S&&m.size>0&&E.searchParams.set("_routes",t.filter(w=>m.has(w.route.id)).map(w=>w.route.id).join(",")),[E.pathname+E.search]},[o,c,a,i,f,t,e,s]),g=reactExports.useMemo(()=>getModuleLinkHrefs(u,i),[u,i]),v=useKeyedPrefetchLinks(u);return reactExports.createElement(reactExports.Fragment,null,p.map(m=>reactExports.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...n})),g.map(m=>reactExports.createElement("link",{key:m,rel:"modulepreload",href:m,...n})),v.map(({key:m,link:S})=>reactExports.createElement("link",{key:m,nonce:n.nonce,...S})))}function mergeRefs(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.9.5")}catch{}function BrowserRouter({basename:e,children:t,window:n}){let a=reactExports.useRef();a.current==null&&(a.current=createBrowserHistory({window:n,v5Compat:!0}));let i=a.current,[s,o]=reactExports.useState({action:i.action,location:i.location}),c=reactExports.useCallback(h=>{reactExports.startTransition(()=>o(h))},[o]);return reactExports.useLayoutEffect(()=>i.listen(c),[i,c]),reactExports.createElement(Router,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:i})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:t,discover:n="render",prefetch:a="none",relative:i,reloadDocument:s,replace:o,state:c,target:h,to:f,preventScrollReset:u,viewTransition:p,...g},v){let{basename:m}=reactExports.useContext(NavigationContext),S=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),E,w=!1;if(typeof f=="string"&&S&&(E=f,isBrowser))try{let z=new URL(window.location.href),te=f.startsWith("//")?new URL(z.protocol+f):new URL(f),Z=stripBasename(te.pathname,m);te.origin===z.origin&&Z!=null?f=Z+te.search+te.hash:w=!0}catch{warning(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=useHref(f,{relative:i}),[A,L,k]=usePrefetchBehavior(a,g),D=useLinkClickHandler(f,{replace:o,state:c,target:h,preventScrollReset:u,relative:i,viewTransition:p});function N(z){t&&t(z),z.defaultPrevented||D(z)}let Y=reactExports.createElement("a",{...g,...k,href:E||T,onClick:w||s?t:N,ref:mergeRefs(v,L),target:h,"data-discover":!S&&n==="render"?"true":void 0});return A&&!S?reactExports.createElement(reactExports.Fragment,null,Y,reactExports.createElement(PrefetchPageLinks,{page:T})):Y});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:a="",end:i=!1,style:s,to:o,viewTransition:c,children:h,...f},u){let p=useResolvedPath(o,{relative:f.relative}),g=useLocation(),v=reactExports.useContext(DataRouterStateContext),{navigator:m,basename:S}=reactExports.useContext(NavigationContext),E=v!=null&&useViewTransitionState(p)&&c===!0,w=m.encodeLocation?m.encodeLocation(p).pathname:p.pathname,T=g.pathname,A=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(T=T.toLowerCase(),A=A?A.toLowerCase():null,w=w.toLowerCase()),A&&S&&(A=stripBasename(A,S)||A);const L=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let k=T===w||!i&&T.startsWith(w)&&T.charAt(L)==="/",D=A!=null&&(A===w||!i&&A.startsWith(w)&&A.charAt(w.length)==="/"),N={isActive:k,isPending:D,isTransitioning:E},Y=k?t:void 0,z;typeof a=="function"?z=a(N):z=[a,k?"active":null,D?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let te=typeof s=="function"?s(N):s;return reactExports.createElement(Link,{...f,"aria-current":Y,className:z,ref:u,style:te,to:o,viewTransition:c},typeof h=="function"?h(N):h)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:a,replace:i,state:s,method:o=defaultMethod,action:c,onSubmit:h,relative:f,preventScrollReset:u,viewTransition:p,...g},v)=>{let m=useSubmit(),S=useFormAction(c,{relative:f}),E=o.toLowerCase()==="get"?"get":"post",w=typeof c=="string"&&ABSOLUTE_URL_REGEX2.test(c),T=A=>{if(h&&h(A),A.defaultPrevented)return;A.preventDefault();let L=A.nativeEvent.submitter,k=L?.getAttribute("formmethod")||o;m(L||A.currentTarget,{fetcherKey:t,method:k,navigate:n,replace:i,state:s,relative:f,preventScrollReset:u,viewTransition:p})};return reactExports.createElement("form",{ref:v,method:E,action:S,onSubmit:a?h:T,...g,"data-discover":!w&&e==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let t=reactExports.useContext(DataRouterContext);return invariant(t,getDataRouterConsoleError2(e)),t}function useLinkClickHandler(e,{target:t,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:o}={}){let c=useNavigate(),h=useLocation(),f=useResolvedPath(e,{relative:s});return reactExports.useCallback(u=>{if(shouldProcessLinkClick(u,t)){u.preventDefault();let p=n!==void 0?n:createPath(h)===createPath(f);c(e,{replace:p,state:a,preventScrollReset:i,relative:s,viewTransition:o})}},[h,c,f,n,a,t,e,i,s,o])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:t}=reactExports.useContext(NavigationContext),n=useRouteId();return reactExports.useCallback(async(a,i={})=>{let{action:s,method:o,encType:c,formData:h,body:f}=getFormSubmissionInfo(a,t);if(i.navigate===!1){let u=i.fetcherKey||getUniqueFetcherId();await e.fetch(u,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||o,formEncType:i.encType||c,flushSync:i.flushSync})}else await e.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||o,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function useFormAction(e,{relative:t}={}){let{basename:n}=reactExports.useContext(NavigationContext),a=reactExports.useContext(RouteContext);invariant(a,"useFormAction must be used inside a RouteContext");let[i]=a.matches.slice(-1),s={...useResolvedPath(e||".",{relative:t})},o=useLocation();if(e==null){s.search=o.search;let c=new URLSearchParams(s.search),h=c.getAll("index");if(h.some(u=>u==="")){c.delete("index"),h.filter(p=>p).forEach(p=>c.append("index",p));let u=c.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:joinPaths([n,s.pathname])),createPath(s)}function useViewTransitionState(e,{relative:t}={}){let n=reactExports.useContext(ViewTransitionContext);invariant(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=useDataRouterContext3("useViewTransitionState"),i=useResolvedPath(e,{relative:t});if(!n.isTransitioning)return!1;let s=stripBasename(n.currentLocation.pathname,a)||n.currentLocation.pathname,o=stripBasename(n.nextLocation.pathname,a)||n.nextLocation.pathname;return matchPath(i.pathname,o)!=null||matchPath(i.pathname,s)!=null}var reactDomExports=requireReactDom();function Header(){const{pathname:e}=useLocation();return jsxRuntimeExports.jsx("header",{className:"fixed top-0 left-0 w-full bg-white/70 backdrop-blur-md border-b border-gray-200 z-50",children:jsxRuntimeExports.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between px-5 py-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xl",children:""}),jsxRuntimeExports.jsx(Link,{to:"/",className:"text-lg md:text-xl font-semibold text-blue-700 hover:text-blue-800 transition",children:"iSolarChecking"})]}),jsxRuntimeExports.jsxs("nav",{className:"hidden md:flex items-center space-x-6 text-sm font-medium text-gray-600",children:[jsxRuntimeExports.jsx(Link,{to:"/",className:`hover:text-blue-700 transition ${e==="/"?"text-blue-700 font-semibold":""}`,children:"Home"}),jsxRuntimeExports.jsx(Link,{to:"/report",className:`hover:text-blue-700 transition ${e==="/report"?"text-blue-700 font-semibold":""}`,children:"Report"})]}),jsxRuntimeExports.jsx("button",{className:"text-sm md:text-[15px] px-4 py-1.5 rounded-xl border border-gray-200 bg-white hover:bg-blue-50 transition",children:"Login / Register"})]})})}function AppLayout(){return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#EFF6FF] to-white text-slate-800",children:[jsxRuntimeExports.jsx("div",{className:"fixed top-0 left-0 w-full z-50",children:jsxRuntimeExports.jsx(Header,{})}),jsxRuntimeExports.jsx("div",{className:"flex flex-col items-center w-full max-w-7xl mx-auto px-6 pb-16",style:{paddingTop:"84px"},children:jsxRuntimeExports.jsx(Outlet,{})})]})}const BASE$1=void 0;console.log("[cloudApi] Backend URL:",BASE$1);function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(t,n){module.exports=t.pdfjsLib=n()})(globalThis,()=>(()=>{var __webpack_modules__=[,((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=C,t.bytesToString=ae,t.createValidAbsoluteUrl=I,t.getModificationDate=xt,t.getUuid=Ht,t.getVerbosityLevel=pe,t.info=de,t.isArrayBuffer=st,t.isArrayEqual=vt,t.isNodeJS=void 0,t.normalizeUnicode=ut,t.objectFromMap=ye,t.objectSize=be,t.setVerbosityLevel=le,t.shadow=M,t.string32=ve,t.stringToBytes=U,t.stringToPDFString=Je,t.stringToUTF8String=Qe,t.unreachable=V,t.utf8StringToString=et,t.warn=J;const n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=n;const a=[1,0,0,1,0,0];t.IDENTITY_MATRIX=a;const i=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=i;const s=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=s;const o=1.35;t.LINE_FACTOR=o;const c=.35;t.LINE_DESCENT_FACTOR=c;const h=c/o;t.BASELINE_FACTOR=h;const f={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=f;const u={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=u;const p="pdfjs_internal_editor_";t.AnnotationEditorPrefix=p;const g={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=g;const v={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=v;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=m;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=S;const E={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=E;const w={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=w;const T={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=T;const A={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=A;const L={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=L;const k={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=k;const D={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=D;const N={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=N;const Y={O:"PageOpen",C:"PageClose"};t.PageActionEventType=Y;const z={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=z;const te={NONE:0,BINARY:1};t.CMapCompressionType=te;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=Z;const ne={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=ne;let oe=z.WARNINGS;function le(Ie){Number.isInteger(Ie)&&(oe=Ie)}function pe(){return oe}function de(Ie){oe>=z.INFOS&&console.log(`Info: ${Ie}`)}function J(Ie){oe>=z.WARNINGS&&console.log(`Warning: ${Ie}`)}function V(Ie){throw new Error(Ie)}function C(Ie,we){Ie||V(we)}function O(Ie){switch(Ie?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function I(Ie,we=null,Se=null){if(!Ie)return null;try{if(Se&&typeof Ie=="string"&&(Se.addDefaultProtocol&&Ie.startsWith("www.")&&Ie.match(/\./g)?.length>=2&&(Ie=`http://${Ie}`),Se.tryConvertEncoding))try{Ie=Qe(Ie)}catch{}const qe=we?new URL(Ie,we):new URL(Ie);if(O(qe))return qe}catch{}return null}function M(Ie,we,Se,qe=!1){return Object.defineProperty(Ie,we,{value:Se,enumerable:!qe,configurable:!0,writable:!1}),Se}const H=(function(){function we(Se,qe){this.constructor===we&&V("Cannot initialize BaseException."),this.message=Se,this.name=qe}return we.prototype=new Error,we.constructor=we,we})();t.BaseException=H;class G extends H{constructor(we,Se){super(we,"PasswordException"),this.code=Se}}t.PasswordException=G;class j extends H{constructor(we,Se){super(we,"UnknownErrorException"),this.details=Se}}t.UnknownErrorException=j;class F extends H{constructor(we){super(we,"InvalidPDFException")}}t.InvalidPDFException=F;class q extends H{constructor(we){super(we,"MissingPDFException")}}t.MissingPDFException=q;class X extends H{constructor(we,Se){super(we,"UnexpectedResponseException"),this.status=Se}}t.UnexpectedResponseException=X;class W extends H{constructor(we){super(we,"FormatError")}}t.FormatError=W;class K extends H{constructor(we){super(we,"AbortException")}}t.AbortException=K;function ae(Ie){(typeof Ie!="object"||Ie?.length===void 0)&&V("Invalid argument for bytesToString");const we=Ie.length,Se=8192;if(we<Se)return String.fromCharCode.apply(null,Ie);const qe=[];for(let ot=0;ot<we;ot+=Se){const Et=Math.min(ot+Se,we),wt=Ie.subarray(ot,Et);qe.push(String.fromCharCode.apply(null,wt))}return qe.join("")}function U(Ie){typeof Ie!="string"&&V("Invalid argument for stringToBytes");const we=Ie.length,Se=new Uint8Array(we);for(let qe=0;qe<we;++qe)Se[qe]=Ie.charCodeAt(qe)&255;return Se}function ve(Ie){return String.fromCharCode(Ie>>24&255,Ie>>16&255,Ie>>8&255,Ie&255)}function be(Ie){return Object.keys(Ie).length}function ye(Ie){const we=Object.create(null);for(const[Se,qe]of Ie)we[Se]=qe;return we}function _e(){const Ie=new Uint8Array(4);return Ie[0]=1,new Uint32Array(Ie.buffer,0,1)[0]===1}function ge(){try{return new Function(""),!0}catch{return!1}}class Re{static get isLittleEndian(){return M(this,"isLittleEndian",_e())}static get isEvalSupported(){return M(this,"isEvalSupported",ge())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?M(this,"platform",{isWin:!1,isMac:!1}):M(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return M(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}t.FeatureTest=Re;const De=[...Array(256).keys()].map(Ie=>Ie.toString(16).padStart(2,"0"));class We{static makeHexColor(we,Se,qe){return`#${De[we]}${De[Se]}${De[qe]}`}static scaleMinMax(we,Se){let qe;we[0]?(we[0]<0&&(qe=Se[0],Se[0]=Se[1],Se[1]=qe),Se[0]*=we[0],Se[1]*=we[0],we[3]<0&&(qe=Se[2],Se[2]=Se[3],Se[3]=qe),Se[2]*=we[3],Se[3]*=we[3]):(qe=Se[0],Se[0]=Se[2],Se[2]=qe,qe=Se[1],Se[1]=Se[3],Se[3]=qe,we[1]<0&&(qe=Se[2],Se[2]=Se[3],Se[3]=qe),Se[2]*=we[1],Se[3]*=we[1],we[2]<0&&(qe=Se[0],Se[0]=Se[1],Se[1]=qe),Se[0]*=we[2],Se[1]*=we[2]),Se[0]+=we[4],Se[1]+=we[4],Se[2]+=we[5],Se[3]+=we[5]}static transform(we,Se){return[we[0]*Se[0]+we[2]*Se[1],we[1]*Se[0]+we[3]*Se[1],we[0]*Se[2]+we[2]*Se[3],we[1]*Se[2]+we[3]*Se[3],we[0]*Se[4]+we[2]*Se[5]+we[4],we[1]*Se[4]+we[3]*Se[5]+we[5]]}static applyTransform(we,Se){const qe=we[0]*Se[0]+we[1]*Se[2]+Se[4],ot=we[0]*Se[1]+we[1]*Se[3]+Se[5];return[qe,ot]}static applyInverseTransform(we,Se){const qe=Se[0]*Se[3]-Se[1]*Se[2],ot=(we[0]*Se[3]-we[1]*Se[2]+Se[2]*Se[5]-Se[4]*Se[3])/qe,Et=(-we[0]*Se[1]+we[1]*Se[0]+Se[4]*Se[1]-Se[5]*Se[0])/qe;return[ot,Et]}static getAxialAlignedBoundingBox(we,Se){const qe=this.applyTransform(we,Se),ot=this.applyTransform(we.slice(2,4),Se),Et=this.applyTransform([we[0],we[3]],Se),wt=this.applyTransform([we[2],we[1]],Se);return[Math.min(qe[0],ot[0],Et[0],wt[0]),Math.min(qe[1],ot[1],Et[1],wt[1]),Math.max(qe[0],ot[0],Et[0],wt[0]),Math.max(qe[1],ot[1],Et[1],wt[1])]}static inverseTransform(we){const Se=we[0]*we[3]-we[1]*we[2];return[we[3]/Se,-we[1]/Se,-we[2]/Se,we[0]/Se,(we[2]*we[5]-we[4]*we[3])/Se,(we[4]*we[1]-we[5]*we[0])/Se]}static singularValueDecompose2dScale(we){const Se=[we[0],we[2],we[1],we[3]],qe=we[0]*Se[0]+we[1]*Se[2],ot=we[0]*Se[1]+we[1]*Se[3],Et=we[2]*Se[0]+we[3]*Se[2],wt=we[2]*Se[1]+we[3]*Se[3],Xt=(qe+wt)/2,Kt=Math.sqrt((qe+wt)**2-4*(qe*wt-Et*ot))/2,Yt=Xt+Kt||1,It=Xt-Kt||1;return[Math.sqrt(Yt),Math.sqrt(It)]}static normalizeRect(we){const Se=we.slice(0);return we[0]>we[2]&&(Se[0]=we[2],Se[2]=we[0]),we[1]>we[3]&&(Se[1]=we[3],Se[3]=we[1]),Se}static intersect(we,Se){const qe=Math.max(Math.min(we[0],we[2]),Math.min(Se[0],Se[2])),ot=Math.min(Math.max(we[0],we[2]),Math.max(Se[0],Se[2]));if(qe>ot)return null;const Et=Math.max(Math.min(we[1],we[3]),Math.min(Se[1],Se[3])),wt=Math.min(Math.max(we[1],we[3]),Math.max(Se[1],Se[3]));return Et>wt?null:[qe,Et,ot,wt]}static bezierBoundingBox(we,Se,qe,ot,Et,wt,Xt,Kt){const Yt=[],It=[[],[]];let xr,ar,Rr,bt,Or,ur,Fr,ir;for(let ee=0;ee<2;++ee){if(ee===0?(ar=6*we-12*qe+6*Et,xr=-3*we+9*qe-9*Et+3*Xt,Rr=3*qe-3*we):(ar=6*Se-12*ot+6*wt,xr=-3*Se+9*ot-9*wt+3*Kt,Rr=3*ot-3*Se),Math.abs(xr)<1e-12){if(Math.abs(ar)<1e-12)continue;bt=-Rr/ar,0<bt&&bt<1&&Yt.push(bt);continue}Fr=ar*ar-4*Rr*xr,ir=Math.sqrt(Fr),!(Fr<0)&&(Or=(-ar+ir)/(2*xr),0<Or&&Or<1&&Yt.push(Or),ur=(-ar-ir)/(2*xr),0<ur&&ur<1&&Yt.push(ur))}let Dr=Yt.length,Pt;const fr=Dr;for(;Dr--;)bt=Yt[Dr],Pt=1-bt,It[0][Dr]=Pt*Pt*Pt*we+3*Pt*Pt*bt*qe+3*Pt*bt*bt*Et+bt*bt*bt*Xt,It[1][Dr]=Pt*Pt*Pt*Se+3*Pt*Pt*bt*ot+3*Pt*bt*bt*wt+bt*bt*bt*Kt;return It[0][fr]=we,It[1][fr]=Se,It[0][fr+1]=Xt,It[1][fr+1]=Kt,It[0].length=It[1].length=fr+2,[Math.min(...It[0]),Math.min(...It[1]),Math.max(...It[0]),Math.max(...It[1])]}}t.Util=We;const ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Je(Ie){if(Ie[0]>=""){let Se;if(Ie[0]===""&&Ie[1]===""?Se="utf-16be":Ie[0]===""&&Ie[1]===""?Se="utf-16le":Ie[0]===""&&Ie[1]===""&&Ie[2]===""&&(Se="utf-8"),Se)try{const qe=new TextDecoder(Se,{fatal:!0}),ot=U(Ie);return qe.decode(ot)}catch(qe){J(`stringToPDFString: "${qe}".`)}}const we=[];for(let Se=0,qe=Ie.length;Se<qe;Se++){const ot=ze[Ie.charCodeAt(Se)];we.push(ot?String.fromCharCode(ot):Ie.charAt(Se))}return we.join("")}function Qe(Ie){return decodeURIComponent(escape(Ie))}function et(Ie){return unescape(encodeURIComponent(Ie))}function st(Ie){return typeof Ie=="object"&&Ie?.byteLength!==void 0}function vt(Ie,we){if(Ie.length!==we.length)return!1;for(let Se=0,qe=Ie.length;Se<qe;Se++)if(Ie[Se]!==we[Se])return!1;return!0}function xt(Ie=new Date){return[Ie.getUTCFullYear().toString(),(Ie.getUTCMonth()+1).toString().padStart(2,"0"),Ie.getUTCDate().toString().padStart(2,"0"),Ie.getUTCHours().toString().padStart(2,"0"),Ie.getUTCMinutes().toString().padStart(2,"0"),Ie.getUTCSeconds().toString().padStart(2,"0")].join("")}class ht{#e=!1;constructor(){this.promise=new Promise((we,Se)=>{this.resolve=qe=>{this.#e=!0,we(qe)},this.reject=qe=>{this.#e=!0,Se(qe)}})}get settled(){return this.#e}}t.PromiseCapability=ht;let ft=null,tt=null;function ut(Ie){return ft||(ft=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,tt=new Map([["","t"]])),Ie.replaceAll(ft,(we,Se,qe)=>Se?Se.normalize("NFKC"):tt.get(qe))}function Ht(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const Ie=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(Ie);else for(let we=0;we<32;we++)Ie[we]=Math.floor(Math.random()*255);return ae(Ie)}const St="pdfjs_internal_id_";t.AnnotationPrefix=St}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(e){if(typeof e=="string"||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),typeof e!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new PDFDocumentLoadingTask,{docId:n}=t,a=e.url?getUrlProp(e.url):null,i=e.data?getDataProp(e.data):null,s=e.httpHeaders||null,o=e.withCredentials===!0,c=e.password??null,h=e.range instanceof PDFDataRangeTransport?e.range:null,f=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let u=e.worker instanceof PDFWorker?e.worker:null;const p=e.verbosity,g=typeof e.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(e.docBaseUrl)?e.docBaseUrl:null,v=typeof e.cMapUrl=="string"?e.cMapUrl:null,m=e.cMapPacked!==!1,S=e.CMapReaderFactory||DefaultCMapReaderFactory,E=typeof e.standardFontDataUrl=="string"?e.standardFontDataUrl:null,w=e.StandardFontDataFactory||DefaultStandardFontDataFactory,T=e.stopAtErrors!==!0,A=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,L=e.isEvalSupported!==!1,k=typeof e.isOffscreenCanvasSupported=="boolean"?e.isOffscreenCanvasSupported:!_util.isNodeJS,D=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,N=typeof e.disableFontFace=="boolean"?e.disableFontFace:_util.isNodeJS,Y=e.fontExtraProperties===!0,z=e.enableXfa===!0,te=e.ownerDocument||globalThis.document,Z=e.disableRange===!0,ne=e.disableStream===!0,oe=e.disableAutoFetch===!0,le=e.pdfBug===!0,pe=h?h.length:e.length??NaN,de=typeof e.useSystemFonts=="boolean"?e.useSystemFonts:!_util.isNodeJS&&!N,J=typeof e.useWorkerFetch=="boolean"?e.useWorkerFetch:S===_display_utils.DOMCMapReaderFactory&&w===_display_utils.DOMStandardFontDataFactory&&v&&E&&(0,_display_utils.isValidFetchUrl)(v,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(E,document.baseURI),V=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:te}),C=e.filterFactory||new DefaultFilterFactory({docId:n,ownerDocument:te}),O=null;(0,_util.setVerbosityLevel)(p);const I={canvasFactory:V,filterFactory:C};if(J||(I.cMapReaderFactory=new S({baseUrl:v,isCompressed:m}),I.standardFontDataFactory=new w({baseUrl:E})),!u){const G={verbosity:p,port:_worker_options.GlobalWorkerOptions.workerPort};u=G.port?PDFWorker.fromPort(G):new PDFWorker(G),t._worker=u}const M={docId:n,apiVersion:"3.11.174",data:i,password:c,disableAutoFetch:oe,rangeChunkSize:f,length:pe,docBaseUrl:g,enableXfa:z,evaluatorOptions:{maxImageSize:A,disableFontFace:N,ignoreErrors:T,isEvalSupported:L,isOffscreenCanvasSupported:k,canvasMaxAreaInBytes:D,fontExtraProperties:Y,useSystemFonts:de,cMapUrl:J?v:null,standardFontDataUrl:J?E:null}},H={ignoreErrors:T,isEvalSupported:L,disableFontFace:N,fontExtraProperties:Y,enableXfa:z,ownerDocument:te,disableAutoFetch:oe,pdfBug:le,styleElement:O};return u.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const G=_fetchDocument(u,M),j=new Promise(function(F){let q;h?q=new _transport_stream.PDFDataTransportStream({length:pe,initialData:h.initialData,progressiveDone:h.progressiveDone,contentDispositionFilename:h.contentDispositionFilename,disableRange:Z,disableStream:ne},h):i||(q=(W=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(W):(0,_display_utils.isValidFetchUrl)(W.url)?new _displayFetch_stream.PDFFetchStream(W):new _displayNetwork.PDFNetworkStream(W))({url:a,length:pe,httpHeaders:s,withCredentials:o,rangeChunkSize:f,disableRange:Z,disableStream:ne})),F(q)});return Promise.all([G,j]).then(function([F,q]){if(t.destroyed)throw new Error("Loading aborted");const X=new _message_handler.MessageHandler(n,F,u.port),W=new WorkerTransport(X,t,q,H,I);t._transport=W,X.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(e,t){if(e.destroyed)throw new Error("Worker was destroyed");const n=await e.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(e.destroyed)throw new Error("Worker was destroyed");return n}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(_util.isNodeJS&&typeof e=="string")return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_util.isNodeJS&&typeof Buffer<"u"&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e=="string")return(0,_util.stringToBytes)(e);if(typeof e=="object"&&!isNaN(e?.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,n,a=!1,i=null){this.length=t,this.initialData=n,this.progressiveDone=a,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,n){for(const a of this._rangeListeners)a(t,n)}onDataProgress(t,n){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(t,n)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const n of this._progressiveReadListeners)n(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,n){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,n){this._pdfInfo=t,this._transport=n,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(a=>{if(!a)return a;const i=[];for(const s in a)i.push(...a[s]);return i}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(t,n,a,i=!1){this._pageIndex=t,this._pageInfo=n,this._transport=a,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:n=this.rotate,offsetX:a=0,offsetY:i=0,dontFlip:s=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:n,offsetX:a,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const n=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,n.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:n,intent:a="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:h=null,pageColors:f=null,printAnnotationStorage:u=null}){this._stats?.time("Overall");const p=this._transport.getRenderingIntent(a,i,u);this.#t=!1,this.#n(),c||(c=this._transport.getOptionalContentConfig());let g=this._intentStates.get(p.cacheKey);g||(g=Object.create(null),this._intentStates.set(p.cacheKey,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const v=!!(p.renderingIntent&_util.RenderingIntentFlag.PRINT);g.displayReadyCapability||(g.displayReadyCapability=new _util.PromiseCapability,g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(p));const m=w=>{g.renderTasks.delete(S),(this._maybeCleanupAfterRender||v)&&(this.#t=!0),this.#r(!v),w?(S.capability.reject(w),this._abortOperatorList({intentState:g,reason:w instanceof Error?w:new Error(w)})):S.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},S=new InternalRenderTask({callback:m,params:{canvasContext:t,viewport:n,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:f});(g.renderTasks||=new Set).add(S);const E=S.task;return Promise.all([g.displayReadyCapability.promise,c]).then(([w,T])=>{if(this.destroyed){m();return}this._stats?.time("Rendering"),S.initializeGraphics({transparency:w,optionalContentConfig:T}),S.operatorListChanged()}).catch(m),E}getOperatorList({intent:t="display",annotationMode:n=_util.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const s=this._transport.getRenderingIntent(t,n,a,!0);let o=this._intentStates.get(s.cacheKey);o||(o=Object.create(null),this._intentStates.set(s.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,o.opListReadCapability=new _util.PromiseCapability,(o.renderTasks||=new Set).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:n===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));const n=this.streamTextContent(t);return new Promise(function(a,i){function s(){o.read().then(function({value:h,done:f}){if(f){a(c);return}Object.assign(c.styles,h.styles),c.items.push(...h.items),s()},i)}const o=n.getReader(),c={items:[],styles:Object.create(null)};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(const a of n.renderTasks)t.push(a.completed),a.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(t)}cleanup(t=!1){this.#t=!0;const n=this.#r(!1);return t&&n&&(this._stats&&=new _display_utils.StatTimer),n}#r(t=!1){if(this.#n(),!this.#t||this.destroyed)return!1;if(t)return this.#e=setTimeout(()=>{this.#e=null,this.#r(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:n,operatorList:a}of this._intentStates.values())if(n.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(t,n){const a=this._intentStates.get(n);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(t))}_renderPageChunk(t,n){for(let a=0,i=t.length;a<i;a++)n.operatorList.fnArray.push(t.fnArray[a]),n.operatorList.argsArray.push(t.argsArray[a]);n.operatorList.lastChunk=t.lastChunk,n.operatorList.separateAnnots=t.separateAnnots;for(const a of n.renderTasks)a.operatorListChanged();t.lastChunk&&this.#r(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:n,annotationStorageSerializable:a}){const{map:i,transfers:s}=a,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:i},s).getReader(),h=this._intentStates.get(n);h.streamReader=c;const f=()=>{c.read().then(({value:u,done:p})=>{if(p){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,h),f())},u=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const p of h.renderTasks)p.operatorListChanged();this.#r(!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(u);else if(h.opListReadCapability)h.opListReadCapability.reject(u);else throw u}})};f()}_abortOperatorList({intentState:t,reason:n,force:a=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!a){if(t.renderTasks.size>0)return;if(n instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;n.extraDelay>0&&n.extraDelay<1e3&&(i+=n.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:n,force:!0})},i);return}}if(t.streamReader.cancel(new _util.AbortException(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(t,n){const a={data:structuredClone(t,n?{transfer:n}:null)};this.#t.then(()=>{for(const i of this.#e)i.call(this,a)})}addEventListener(t,n){this.#e.add(n)}removeEventListener(t,n){this.#e.delete(n)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const e=document?.currentScript?.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const a=new URL(t,n);return n.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t]))}}class PDFWorker{static#workerPorts;constructor({name:e=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){if(PDFWorker.#workerPorts?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),n=new _message_handler.MessageHandler("main","worker",t),a=()=>{t.removeEventListener("error",i),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||a()};t.addEventListener("error",i),n.on("test",o=>{if(t.removeEventListener("error",i),this.destroyed){a();return}o?(this._messageHandler=n,this._port=t,this._webWorker=t,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),t.terminate())}),n.on("ready",o=>{if(t.removeEventListener("error",i),this.destroyed){a();return}try{s()}catch{this._setupFakeWorker()}});const s=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};s();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const n=`fake${PDFWorkerUtil.fakeWorkerId++}`,a=new _message_handler.MessageHandler(n+"_worker",n,t);e.setup(a,t);const i=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#workerPorts?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#r=new Map;#n=null;constructor(t,n,a,i,s){this.messageHandler=t,this.loadingTask=n,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(t,n=null){const a=this.#e.get(t);if(a)return a;const i=this.messageHandler.sendWithPromise(t,n);return this.#e.set(t,i),i}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(t,n=_util.AnnotationMode.ENABLE,a=null,i=!1){let s=_util.RenderingIntentFlag.DISPLAY,o=_annotation_storage.SerializableEmpty;switch(t){case"any":s=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":s=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(n){case _util.AnnotationMode.DISABLE:s+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:s+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:s+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,o=(s&_util.RenderingIntentFlag.PRINT&&a instanceof _annotation_storage.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${n}`)}return i&&(s+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:s,cacheKey:`${s}_${o.hash}`,annotationStorageSerializable:o}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#n?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const a of this.#t.values())t.push(a._destroy());this.#t.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:n}=this;t.on("GetReader",(a,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}(0,_util.assert)(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",a=>{const i=new _util.PromiseCapability,s=this._fullReader;return s.headersReady.then(()=>{(!s.isStreamingSupported||!s.isRangeSupported)&&(this._lastProgress&&n.onProgress?.(this._lastProgress),s.onProgress=o=>{n.onProgress?.({loaded:o.loaded,total:o.total})}),i.resolve({isStreamingSupported:s.isStreamingSupported,isRangeSupported:s.isRangeSupported,contentLength:s.contentLength})},i.reject),i.promise}),t.on("GetRangeReader",(a,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(a.begin,a.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:c}){if(c){i.close();return}(0,_util.assert)(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,n._capability.resolve(new PDFDocumentProxy(a,this))}),t.on("DocException",function(a){let i;switch(a.name){case"PasswordException":i=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":i=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}n._capability.reject(i)}),t.on("PasswordRequest",a=>{if(this.#n=new _util.PromiseCapability,n.onPassword){const i=s=>{s instanceof Error?this.#n.reject(s):this.#n.resolve({password:s})};try{n.onPassword(i,a.code)}catch(s){this.#n.reject(s)}}else this.#n.reject(new _util.PasswordException(a.message,a.code));return this.#n.promise}),t.on("DataLoaded",a=>{n.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),t.on("StartRenderPage",a=>{if(this.destroyed)return;this.#t.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),t.on("commonobj",([a,i,s])=>{if(!this.destroyed&&!this.commonObjs.has(a))switch(i){case"Font":const o=this._params;if("error"in s){const f=s.error;(0,_util.warn)(`Error during font loading: ${f}`),this.commonObjs.resolve(a,f);break}const c=o.pdfBug&&globalThis.FontInspector?.enabled?(f,u)=>globalThis.FontInspector.fontAdded(f,u):null,h=new _font_loader.FontFaceObject(s,{isEvalSupported:o.isEvalSupported,disableFontFace:o.disableFontFace,ignoreErrors:o.ignoreErrors,inspectFont:c});this.fontLoader.bind(h).catch(f=>t.sendWithPromise("FontFallback",{id:a})).finally(()=>{!o.fontExtraProperties&&h.data&&(h.data=null),this.commonObjs.resolve(a,h)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,s);break;default:throw new Error(`Got unknown common object type ${i}`)}}),t.on("obj",([a,i,s,o])=>{if(this.destroyed)return;const c=this.#t.get(i);if(!c.objs.has(a))switch(s){case"Image":if(c.objs.resolve(a,o),o){let h;if(o.bitmap){const{width:f,height:u}=o;h=f*u*4}else h=o.data?.length||0;h>_util.MAX_IMAGE_SIZE_TO_CACHE&&(c._maybeCleanupAfterRender=!0)}break;case"Pattern":c.objs.resolve(a,o);break;default:throw new Error(`Got unknown object type ${s}`)}}),t.on("DocProgress",a=>{this.destroyed||n.onProgress?.({loaded:a.loaded,total:a.total})}),t.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfers:n}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},n).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const n=t-1,a=this.#r.get(n);if(a)return a;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");const o=new PDFPageProxy(n,s,this,this._params.pdfBug);return this.#t.set(n,o),o});return this.#r.set(n,i),i}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:n})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",n=this.#e.get(t);if(n)return n;const a=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(t,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const n of this.#t.values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:n}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:n})}}class PDFObjects{#e=Object.create(null);#t(t){return this.#e[t]||={capability:new _util.PromiseCapability,data:null}}get(t,n=null){if(n){const i=this.#t(t);return i.capability.promise.then(()=>n(i.data)),null}const a=this.#e[t];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return a.data}has(t){return this.#e[t]?.capability.settled||!1}resolve(t,n=null){const a=this.#t(t);a.data=n,a.capability.resolve()}clear(){for(const t in this.#e){const{data:n}=this.#e[t];n?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(t){this.#e=t,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(t=0){this.#e.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#e.operatorList;if(!t)return!1;const{annotationCanvasMap:n}=this.#e;return t.form||t.canvas&&n?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:t,params:n,objs:a,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:u=!1,pdfBug:p=!1,pageColors:g=null}){this.callback=t,this.params=n,this.objs=a,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:n}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:i,transform:s,background:o}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,n=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,n))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var a=n(1),i=n(4),s=n(8);const o=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=o;class c{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(u,p){const g=this.#t.get(u);return g===void 0?p:Object.assign(p,g)}getRawValue(u){return this.#t.get(u)}remove(u){if(this.#t.delete(u),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const p of this.#t.values())if(p instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(u,p){const g=this.#t.get(u);let v=!1;if(g!==void 0)for(const[m,S]of Object.entries(p))g[m]!==S&&(v=!0,g[m]=S);else v=!0,this.#t.set(u,p);v&&this.#r(),p instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(p.constructor._type)}has(u){return this.#t.has(u)}getAll(){return this.#t.size>0?(0,a.objectFromMap)(this.#t):null}setAll(u){for(const[p,g]of Object.entries(u))this.setValue(p,g)}get size(){return this.#t.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new h(this)}get serializable(){if(this.#t.size===0)return o;const u=new Map,p=new s.MurmurHash3_64,g=[],v=Object.create(null);let m=!1;for(const[S,E]of this.#t){const w=E instanceof i.AnnotationEditor?E.serialize(!1,v):E;w&&(u.set(S,w),p.update(`${S}:${JSON.stringify(w)}`),m||=!!w.bitmap)}if(m)for(const S of u.values())S.bitmap&&g.push(S.bitmap);return u.size>0?{map:u,hash:p.hexdigest(),transfers:g}:o}}t.AnnotationStorage=c;class h extends c{#e;constructor(u){super();const{map:p,hash:g,transfers:v}=u.serializable,m=structuredClone(p,v?{transfer:v}:null);this.#e={map:m,hash:g,transfers:v}}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}t.PrintAnnotationStorage=h}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var a=n(5),i=n(1),s=n(6);class o{#e="";#t=!1;#r=null;#n=null;#o=null;#s=!1;#i=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#a=!1;#h=!1;#f=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#d=!1;#p=o._zIndex++;static _borderLineWidth=-1;static _colorManager=new a.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(f){this.constructor===o&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=f.parent,this.id=f.id,this.width=this.height=null,this.pageIndex=f.parent.pageIndex,this.name=f.name,this.div=null,this._uiManager=f.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=f.isCentered,this._structTreeParentId=null;const{rotation:u,rawDims:{pageWidth:p,pageHeight:g,pageX:v,pageY:m}}=this.parent.viewport;this.rotation=u,this.pageRotation=(360+u-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[p,g],this.pageTranslation=[v,m];const[S,E]=this.parentDimensions;this.x=f.x/S,this.y=f.y/E,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(f){const u=new c({id:f.parent.getNextId(),parent:f.parent,uiManager:f._uiManager});u.annotationElementId=f.annotationElementId,u.deleted=!0,u._uiManager.addToAnnotationStorage(u)}static initialize(f,u=null){if(o._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(g=>[g,f.get(g)])),u?.strings)for(const g of u.strings)o._l10nPromise.set(g,f.get(g));if(o._borderLineWidth!==-1)return;const p=getComputedStyle(document.documentElement);o._borderLineWidth=parseFloat(p.getPropertyValue("--outline-width"))||0}static updateDefaultParams(f,u){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(f){return!1}static paste(f,u){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#d}set _isDraggable(f){this.#d=f,this.div?.classList.toggle("draggable",f)}center(){const[f,u]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*u/(f*2),this.y+=this.width*f/(u*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*u/(f*2),this.y-=this.width*f/(u*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(f){this._uiManager.addCommands(f)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(f){f!==null&&(this.pageIndex=f.pageIndex,this.pageDimensions=f.pageDimensions),this.parent=f}focusin(f){this._focusEventsAllowed&&(this.#a?this.#a=!1:this.parent.setSelected(this))}focusout(f){!this._focusEventsAllowed||!this.isAttachedToDOM||f.relatedTarget?.closest(`#${this.id}`)||(f.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(f,u,p,g){const[v,m]=this.parentDimensions;[p,g]=this.screenToPageTranslation(p,g),this.x=(f+p)/v,this.y=(u+g)/m,this.fixAndSetPosition()}#v([f,u],p,g){[p,g]=this.screenToPageTranslation(p,g),this.x+=p/f,this.y+=g/u,this.fixAndSetPosition()}translate(f,u){this.#v(this.parentDimensions,f,u)}translateInPage(f,u){this.#v(this.pageDimensions,f,u),this.div.scrollIntoView({block:"nearest"})}drag(f,u){const[p,g]=this.parentDimensions;if(this.x+=f/p,this.y+=u/g,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:w,y:T}=this.div.getBoundingClientRect();this.parent.findNewParent(this,w,T)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:v,y:m}=this;const[S,E]=this.#g();v+=S,m+=E,this.div.style.left=`${(100*v).toFixed(2)}%`,this.div.style.top=`${(100*m).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#g(){const[f,u]=this.parentDimensions,{_borderLineWidth:p}=o,g=p/f,v=p/u;switch(this.rotation){case 90:return[-g,v];case 180:return[g,v];case 270:return[g,-v];default:return[-g,-v]}}fixAndSetPosition(){const[f,u]=this.pageDimensions;let{x:p,y:g,width:v,height:m}=this;switch(v*=f,m*=u,p*=f,g*=u,this.rotation){case 0:p=Math.max(0,Math.min(f-v,p)),g=Math.max(0,Math.min(u-m,g));break;case 90:p=Math.max(0,Math.min(f-m,p)),g=Math.min(u,Math.max(v,g));break;case 180:p=Math.min(f,Math.max(v,p)),g=Math.min(u,Math.max(m,g));break;case 270:p=Math.min(f,Math.max(m,p)),g=Math.max(0,Math.min(u-v,g));break}this.x=p/=f,this.y=g/=u;const[S,E]=this.#g();p+=S,g+=E;const{style:w}=this.div;w.left=`${(100*p).toFixed(2)}%`,w.top=`${(100*g).toFixed(2)}%`,this.moveInDOM()}static#m(f,u,p){switch(p){case 90:return[u,-f];case 180:return[-f,-u];case 270:return[-u,f];default:return[f,u]}}screenToPageTranslation(f,u){return o.#m(f,u,this.parentRotation)}pageTranslationToScreen(f,u){return o.#m(f,u,360-this.parentRotation)}#u(f){switch(f){case 90:{const[u,p]=this.pageDimensions;return[0,-u/p,p/u,0]}case 180:return[-1,0,0,-1];case 270:{const[u,p]=this.pageDimensions;return[0,u/p,-p/u,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:f,pageDimensions:[u,p]}=this,g=u*f,v=p*f;return i.FeatureTest.isCSSRoundSupported?[Math.round(g),Math.round(v)]:[g,v]}setDims(f,u){const[p,g]=this.parentDimensions;this.div.style.width=`${(100*f/p).toFixed(2)}%`,this.#s||(this.div.style.height=`${(100*u/g).toFixed(2)}%`),this.#r?.classList.toggle("small",f<o.SMALL_EDITOR_SIZE||u<o.SMALL_EDITOR_SIZE)}fixDims(){const{style:f}=this.div,{height:u,width:p}=f,g=p.endsWith("%"),v=!this.#s&&u.endsWith("%");if(g&&v)return;const[m,S]=this.parentDimensions;g||(f.width=`${(100*parseFloat(p)/m).toFixed(2)}%`),!this.#s&&!v&&(f.height=`${(100*parseFloat(u)/S).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#i)return;this.#i=document.createElement("div"),this.#i.classList.add("resizers");const f=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||f.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const u of f){const p=document.createElement("div");this.#i.append(p),p.classList.add("resizer",u),p.addEventListener("pointerdown",this.#w.bind(this,u)),p.addEventListener("contextmenu",s.noContextMenu)}this.div.prepend(this.#i)}#w(f,u){u.preventDefault();const{isMac:p}=i.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&p)return;const g=this.#E.bind(this,f),v=this._isDraggable;this._isDraggable=!1;const m={passive:!0,capture:!0};window.addEventListener("pointermove",g,m);const S=this.x,E=this.y,w=this.width,T=this.height,A=this.parent.div.style.cursor,L=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(u.target).cursor;const k=()=>{this._isDraggable=v,window.removeEventListener("pointerup",k),window.removeEventListener("blur",k),window.removeEventListener("pointermove",g,m),this.parent.div.style.cursor=A,this.div.style.cursor=L;const D=this.x,N=this.y,Y=this.width,z=this.height;D===S&&N===E&&Y===w&&z===T||this.addCommands({cmd:()=>{this.width=Y,this.height=z,this.x=D,this.y=N;const[te,Z]=this.parentDimensions;this.setDims(te*Y,Z*z),this.fixAndSetPosition()},undo:()=>{this.width=w,this.height=T,this.x=S,this.y=E;const[te,Z]=this.parentDimensions;this.setDims(te*w,Z*T),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",k),window.addEventListener("blur",k)}#E(f,u){const[p,g]=this.parentDimensions,v=this.x,m=this.y,S=this.width,E=this.height,w=o.MIN_SIZE/p,T=o.MIN_SIZE/g,A=j=>Math.round(j*1e4)/1e4,L=this.#u(this.rotation),k=(j,F)=>[L[0]*j+L[2]*F,L[1]*j+L[3]*F],D=this.#u(360-this.rotation),N=(j,F)=>[D[0]*j+D[2]*F,D[1]*j+D[3]*F];let Y,z,te=!1,Z=!1;switch(f){case"topLeft":te=!0,Y=(j,F)=>[0,0],z=(j,F)=>[j,F];break;case"topMiddle":Y=(j,F)=>[j/2,0],z=(j,F)=>[j/2,F];break;case"topRight":te=!0,Y=(j,F)=>[j,0],z=(j,F)=>[0,F];break;case"middleRight":Z=!0,Y=(j,F)=>[j,F/2],z=(j,F)=>[0,F/2];break;case"bottomRight":te=!0,Y=(j,F)=>[j,F],z=(j,F)=>[0,0];break;case"bottomMiddle":Y=(j,F)=>[j/2,F],z=(j,F)=>[j/2,0];break;case"bottomLeft":te=!0,Y=(j,F)=>[0,F],z=(j,F)=>[j,0];break;case"middleLeft":Z=!0,Y=(j,F)=>[0,F/2],z=(j,F)=>[j,F/2];break}const ne=Y(S,E),oe=z(S,E);let le=k(...oe);const pe=A(v+le[0]),de=A(m+le[1]);let J=1,V=1,[C,O]=this.screenToPageTranslation(u.movementX,u.movementY);if([C,O]=N(C/p,O/g),te){const j=Math.hypot(S,E);J=V=Math.max(Math.min(Math.hypot(oe[0]-ne[0]-C,oe[1]-ne[1]-O)/j,1/S,1/E),w/S,T/E)}else Z?J=Math.max(w,Math.min(1,Math.abs(oe[0]-ne[0]-C)))/S:V=Math.max(T,Math.min(1,Math.abs(oe[1]-ne[1]-O)))/E;const I=A(S*J),M=A(E*V);le=k(...z(I,M));const H=pe-le[0],G=de-le[1];this.width=I,this.height=M,this.x=H,this.y=G,this.setDims(p*I,g*M),this.fixAndSetPosition()}async addAltTextButton(){if(this.#r)return;const f=this.#r=document.createElement("button");f.className="altText";const u=await o._l10nPromise.get("editor_alt_text_button_label");f.textContent=u,f.setAttribute("aria-label",u),f.tabIndex="0",f.addEventListener("contextmenu",s.noContextMenu),f.addEventListener("pointerdown",p=>p.stopPropagation()),f.addEventListener("click",p=>{p.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),f.addEventListener("keydown",p=>{p.target===f&&p.key==="Enter"&&(p.preventDefault(),this._uiManager.editAltText(this))}),this.#T(),this.div.append(f),o.SMALL_EDITOR_SIZE||(o.SMALL_EDITOR_SIZE=Math.min(128,Math.round(f.getBoundingClientRect().width*1.4)))}async#T(){const f=this.#r;if(!f)return;if(!this.#e&&!this.#t){f.classList.remove("done"),this.#n?.remove();return}o._l10nPromise.get("editor_alt_text_edit_button_label").then(p=>{f.setAttribute("aria-label",p)});let u=this.#n;if(!u){this.#n=u=document.createElement("span"),u.className="tooltip",u.setAttribute("role","tooltip");const p=u.id=`alt-text-tooltip-${this.id}`;f.setAttribute("aria-describedby",p);const g=100;f.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#n.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},g)}),f.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#n?.classList.remove("show")})}f.classList.add("done"),u.innerText=this.#t?await o._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#e,u.parentNode||f.append(u)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#e,decorative:this.#t}}set altTextData({altText:f,decorative:u}){this.#e===f&&this.#t===u||(this.#e=f,this.#t=u,this.#T())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[f,u]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*u/f).toFixed(2)}%`,this.div.style.maxHeight=`${(100*f/u).toFixed(2)}%`);const[p,g]=this.getInitialTranslation();return this.translate(p,g),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(f){const{isMac:u}=i.FeatureTest.platform;if(f.button!==0||f.ctrlKey&&u){f.preventDefault();return}this.#a=!0,this.#C(f)}#C(f){if(!this._isDraggable)return;const u=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let p,g;u&&(p={passive:!0,capture:!0},g=m=>{const[S,E]=this.screenToPageTranslation(m.movementX,m.movementY);this._uiManager.dragSelectedEditors(S,E)},window.addEventListener("pointermove",g,p));const v=()=>{if(window.removeEventListener("pointerup",v),window.removeEventListener("blur",v),u&&window.removeEventListener("pointermove",g,p),this.#a=!1,!this._uiManager.endDragSession()){const{isMac:m}=i.FeatureTest.platform;f.ctrlKey&&!m||f.shiftKey||f.metaKey&&m?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",v),window.addEventListener("blur",v)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(f,u,p){f.changeParent(this),this.x=u,this.y=p,this.fixAndSetPosition()}getRect(f,u){const p=this.parentScale,[g,v]=this.pageDimensions,[m,S]=this.pageTranslation,E=f/p,w=u/p,T=this.x*g,A=this.y*v,L=this.width*g,k=this.height*v;switch(this.rotation){case 0:return[T+E+m,v-A-w-k+S,T+E+L+m,v-A-w+S];case 90:return[T+w+m,v-A+E+S,T+w+k+m,v-A+E+L+S];case 180:return[T-E-L+m,v-A+w+S,T-E+m,v-A+w+k+S];case 270:return[T-w-k+m,v-A-E-L+S,T-w+m,v-A-E+S];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(f,u){const[p,g,v,m]=f,S=v-p,E=m-g;switch(this.rotation){case 0:return[p,u-m,S,E];case 90:return[p,u-g,E,S];case 180:return[v,u-g,S,E];case 270:return[v,u-m,E,S];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#f=!0}disableEditMode(){this.#f=!1}isInEditMode(){return this.#f}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(f=!1,u=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(f,u,p){const g=new this.prototype.constructor({parent:u,id:u.getNextId(),uiManager:p});g.rotation=f.rotation;const[v,m]=g.pageDimensions,[S,E,w,T]=g.getRectInCurrentCoords(f.rect,m);return g.x=S/v,g.y=E/m,g.width=w/v,g.height=T/m,g}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#r?.remove(),this.#r=null,this.#n=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#i.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#i?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(f,u){}disableEditing(){this.#r&&(this.#r.hidden=!0)}enableEditing(){this.#r&&(this.#r.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(f){this.#h=f,this.parent&&(f?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(f,u){this.#s=!0;const p=f/u,{style:g}=this.div;g.aspectRatio=p,g.height="auto"}static get MIN_SIZE(){return 16}}t.AnnotationEditor=o;class c extends o{constructor(f){super(f),this.annotationElementId=f.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=s,t.opacityToHex=o;var a=n(1),i=n(6);function s(v,m,S){for(const E of S)m.addEventListener(E,v[E].bind(v))}function o(v){return Math.round(Math.min(255,Math.max(1,255*v))).toString(16).padStart(2,"0")}class c{#e=0;getId(){return`${a.AnnotationEditorPrefix}${this.#e++}`}}class h{#e=(0,a.getUuid)();#t=0;#r=null;static get _isSVGFittingCanvas(){const m='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',E=new OffscreenCanvas(1,3).getContext("2d"),w=new Image;w.src=m;const T=w.decode().then(()=>(E.drawImage(w,0,0,1,1,0,0,1,3),new Uint32Array(E.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,a.shadow)(this,"_isSVGFittingCanvas",T)}async#n(m,S){this.#r||=new Map;let E=this.#r.get(m);if(E===null)return null;if(E?.bitmap)return E.refCounter+=1,E;try{E||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let w;if(typeof S=="string"){E.url=S;const T=await fetch(S);if(!T.ok)throw new Error(T.statusText);w=await T.blob()}else w=E.file=S;if(w.type==="image/svg+xml"){const T=h._isSVGFittingCanvas,A=new FileReader,L=new Image,k=new Promise((D,N)=>{L.onload=()=>{E.bitmap=L,E.isSvg=!0,D()},A.onload=async()=>{const Y=E.svgUrl=A.result;L.src=await T?`${Y}#svgView(preserveAspectRatio(none))`:Y},L.onerror=A.onerror=N});A.readAsDataURL(w),await k}else E.bitmap=await createImageBitmap(w);E.refCounter=1}catch(w){console.error(w),E=null}return this.#r.set(m,E),E&&this.#r.set(E.id,E),E}async getFromFile(m){const{lastModified:S,name:E,size:w,type:T}=m;return this.#n(`${S}_${E}_${w}_${T}`,m)}async getFromUrl(m){return this.#n(m,m)}async getFromId(m){this.#r||=new Map;const S=this.#r.get(m);return S?S.bitmap?(S.refCounter+=1,S):S.file?this.getFromFile(S.file):this.getFromUrl(S.url):null}getSvgUrl(m){const S=this.#r.get(m);return S?.isSvg?S.svgUrl:null}deleteId(m){this.#r||=new Map;const S=this.#r.get(m);S&&(S.refCounter-=1,S.refCounter===0&&(S.bitmap=null))}isValidId(m){return m.startsWith(`image_${this.#e}_`)}}class f{#e=[];#t=!1;#r;#n=-1;constructor(m=128){this.#r=m}add({cmd:m,undo:S,mustExec:E,type:w=NaN,overwriteIfSameType:T=!1,keepUndo:A=!1}){if(E&&m(),this.#t)return;const L={cmd:m,undo:S,type:w};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(L);return}if(T&&this.#e[this.#n].type===w){A&&(L.undo=this.#e[this.#n].undo),this.#e[this.#n]=L;return}const k=this.#n+1;k===this.#r?this.#e.splice(0,1):(this.#n=k,k<this.#e.length&&this.#e.splice(k)),this.#e.push(L)}undo(){this.#n!==-1&&(this.#t=!0,this.#e[this.#n].undo(),this.#t=!1,this.#n-=1)}redo(){this.#n<this.#e.length-1&&(this.#n+=1,this.#t=!0,this.#e[this.#n].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}destroy(){this.#e=null}}t.CommandManager=f;class u{constructor(m){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:S}=a.FeatureTest.platform;for(const[E,w,T={}]of m)for(const A of E){const L=A.startsWith("mac+");S&&L?(this.callbacks.set(A.slice(4),{callback:w,options:T}),this.allKeys.add(A.split("+").at(-1))):!S&&!L&&(this.callbacks.set(A,{callback:w,options:T}),this.allKeys.add(A.split("+").at(-1)))}}#e(m){m.altKey&&this.buffer.push("alt"),m.ctrlKey&&this.buffer.push("ctrl"),m.metaKey&&this.buffer.push("meta"),m.shiftKey&&this.buffer.push("shift"),this.buffer.push(m.key);const S=this.buffer.join("+");return this.buffer.length=0,S}exec(m,S){if(!this.allKeys.has(S.key))return;const E=this.callbacks.get(this.#e(S));if(!E)return;const{callback:w,options:{bubbles:T=!1,args:A=[],checker:L=null}}=E;L&&!L(m,S)||(w.bind(m,...A)(),T||(S.stopPropagation(),S.preventDefault()))}}t.KeyboardManager=u;class p{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const m=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(m),(0,a.shadow)(this,"_colors",m)}convert(m){const S=(0,i.getRGB)(m);if(!window.matchMedia("(forced-colors: active)").matches)return S;for(const[E,w]of this._colors)if(w.every((T,A)=>T===S[A]))return p._colorsMapping.get(E);return S}getHexCode(m){const S=this._colors.get(m);return S?a.Util.makeHexColor(...S):m}}t.ColorManager=p;class g{#e=null;#t=new Map;#r=new Map;#n=null;#o=null;#s=new f;#i=0;#l=new Set;#c=null;#a=null;#h=new Set;#f=null;#d=new c;#p=!1;#v=!1;#g=null;#m=a.AnnotationEditorType.NONE;#u=new Set;#x=null;#w=this.blur.bind(this);#E=this.focus.bind(this);#T=this.copy.bind(this);#C=this.cut.bind(this);#I=this.paste.bind(this);#M=this.keydown.bind(this);#L=this.onEditingAction.bind(this);#y=this.onPageChanging.bind(this);#D=this.onScaleChanging.bind(this);#P=this.onRotationChanging.bind(this);#R={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#_=[0,0];#k=null;#b=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const m=g.prototype,S=T=>{const{activeElement:A}=document;return A&&T.#b.contains(A)&&T.hasSomethingToControl()},E=this.TRANSLATE_SMALL,w=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new u([[["ctrl+a","mac+meta+a"],m.selectAll],[["ctrl+z","mac+meta+z"],m.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],m.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],m.delete],[["Escape","mac+Escape"],m.unselectAll],[["ArrowLeft","mac+ArrowLeft"],m.translateSelectedEditors,{args:[-E,0],checker:S}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],m.translateSelectedEditors,{args:[-w,0],checker:S}],[["ArrowRight","mac+ArrowRight"],m.translateSelectedEditors,{args:[E,0],checker:S}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],m.translateSelectedEditors,{args:[w,0],checker:S}],[["ArrowUp","mac+ArrowUp"],m.translateSelectedEditors,{args:[0,-E],checker:S}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],m.translateSelectedEditors,{args:[0,-w],checker:S}],[["ArrowDown","mac+ArrowDown"],m.translateSelectedEditors,{args:[0,E],checker:S}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],m.translateSelectedEditors,{args:[0,w],checker:S}]]))}constructor(m,S,E,w,T,A){this.#b=m,this.#N=S,this.#n=E,this._eventBus=w,this._eventBus._on("editingaction",this.#L),this._eventBus._on("pagechanging",this.#y),this._eventBus._on("scalechanging",this.#D),this._eventBus._on("rotationchanging",this.#P),this.#o=T.annotationStorage,this.#f=T.filterFactory,this.#x=A,this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#O(),this.#$(),this._eventBus._off("editingaction",this.#L),this._eventBus._off("pagechanging",this.#y),this._eventBus._off("scalechanging",this.#D),this._eventBus._off("rotationchanging",this.#P);for(const m of this.#r.values())m.destroy();this.#r.clear(),this.#t.clear(),this.#h.clear(),this.#e=null,this.#u.clear(),this.#s.destroy(),this.#n.destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",this.#x?this.#f.addHCMFilter(this.#x.foreground,this.#x.background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(this.#b).direction)}editAltText(m){this.#n?.editAltText(this,m)}onPageChanging({pageNumber:m}){this.#i=m-1}focusMainContainer(){this.#b.focus()}findParent(m,S){for(const E of this.#r.values()){const{x:w,y:T,width:A,height:L}=E.div.getBoundingClientRect();if(m>=w&&m<=w+A&&S>=T&&S<=T+L)return E}return null}disableUserSelect(m=!1){this.#N.classList.toggle("noUserSelect",m)}addShouldRescale(m){this.#h.add(m)}removeShouldRescale(m){this.#h.delete(m)}onScaleChanging({scale:m}){this.commitOrRemove(),this.viewParameters.realScale=m*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const S of this.#h)S.onScaleChanging()}onRotationChanging({pagesRotation:m}){this.commitOrRemove(),this.viewParameters.rotation=m}addToAnnotationStorage(m){!m.isEmpty()&&this.#o&&!this.#o.has(m.id)&&this.#o.setValue(m.id,m)}#B(){window.addEventListener("focus",this.#E),window.addEventListener("blur",this.#w)}#$(){window.removeEventListener("focus",this.#E),window.removeEventListener("blur",this.#w)}blur(){if(!this.hasSelection)return;const{activeElement:m}=document;for(const S of this.#u)if(S.div.contains(m)){this.#g=[S,m],S._focusEventsAllowed=!1;break}}focus(){if(!this.#g)return;const[m,S]=this.#g;this.#g=null,S.addEventListener("focusin",()=>{m._focusEventsAllowed=!0},{once:!0}),S.focus()}#j(){window.addEventListener("keydown",this.#M,{capture:!0})}#O(){window.removeEventListener("keydown",this.#M,{capture:!0})}#F(){document.addEventListener("copy",this.#T),document.addEventListener("cut",this.#C),document.addEventListener("paste",this.#I)}#A(){document.removeEventListener("copy",this.#T),document.removeEventListener("cut",this.#C),document.removeEventListener("paste",this.#I)}addEditListeners(){this.#j(),this.#F()}removeEditListeners(){this.#O(),this.#A()}copy(m){if(m.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const S=[];for(const E of this.#u){const w=E.serialize(!0);w&&S.push(w)}S.length!==0&&m.clipboardData.setData("application/pdfjs",JSON.stringify(S))}cut(m){this.copy(m),this.delete()}paste(m){m.preventDefault();const{clipboardData:S}=m;for(const T of S.items)for(const A of this.#a)if(A.isHandlingMimeForPasting(T.type)){A.paste(T,this.currentLayer);return}let E=S.getData("application/pdfjs");if(!E)return;try{E=JSON.parse(E)}catch(T){(0,a.warn)(`paste: "${T.message}".`);return}if(!Array.isArray(E))return;this.unselectAll();const w=this.currentLayer;try{const T=[];for(const k of E){const D=w.deserialize(k);if(!D)return;T.push(D)}const A=()=>{for(const k of T)this.#H(k);this.#z(T)},L=()=>{for(const k of T)k.remove()};this.addCommands({cmd:A,undo:L,mustExec:!0})}catch(T){(0,a.warn)(`paste: "${T.message}".`)}}keydown(m){this.getActive()?.shouldGetKeyboardEvents()||g._keyboardManager.exec(this,m)}onEditingAction(m){["undo","redo","delete","selectAll"].includes(m.name)&&this[m.name]()}#S(m){Object.entries(m).some(([E,w])=>this.#R[E]!==w)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#R,m)})}#U(m){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:m})}setEditingState(m){m?(this.#B(),this.#j(),this.#F(),this.#S({isEditing:this.#m!==a.AnnotationEditorType.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:this.#s.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#$(),this.#O(),this.#A(),this.#S({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(m){if(!this.#a){this.#a=m;for(const S of this.#a)this.#U(S.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#r.get(this.#i)}getLayer(m){return this.#r.get(m)}get currentPageIndex(){return this.#i}addLayer(m){this.#r.set(m.pageIndex,m),this.#p?m.enable():m.disable()}removeLayer(m){this.#r.delete(m.pageIndex)}updateMode(m,S=null){if(this.#m!==m){if(this.#m=m,m===a.AnnotationEditorType.NONE){this.setEditingState(!1),this.#V();return}this.setEditingState(!0),this.#q(),this.unselectAll();for(const E of this.#r.values())E.updateMode(m);if(S){for(const E of this.#t.values())if(E.annotationElementId===S){this.setSelected(E),E.enterInEditMode();break}}}}updateToolbar(m){m!==this.#m&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:m})}updateParams(m,S){if(this.#a){if(m===a.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(m);return}for(const E of this.#u)E.updateParams(m,S);for(const E of this.#a)E.updateDefaultParams(m,S)}}enableWaiting(m=!1){if(this.#v!==m){this.#v=m;for(const S of this.#r.values())m?S.disableClick():S.enableClick(),S.div.classList.toggle("waiting",m)}}#q(){if(!this.#p){this.#p=!0;for(const m of this.#r.values())m.enable()}}#V(){if(this.unselectAll(),this.#p){this.#p=!1;for(const m of this.#r.values())m.disable()}}getEditors(m){const S=[];for(const E of this.#t.values())E.pageIndex===m&&S.push(E);return S}getEditor(m){return this.#t.get(m)}addEditor(m){this.#t.set(m.id,m)}removeEditor(m){this.#t.delete(m.id),this.unselect(m),(!m.annotationElementId||!this.#l.has(m.annotationElementId))&&this.#o?.remove(m.id)}addDeletedAnnotationElement(m){this.#l.add(m.annotationElementId),m.deleted=!0}isDeletedAnnotationElement(m){return this.#l.has(m)}removeDeletedAnnotationElement(m){this.#l.delete(m.annotationElementId),m.deleted=!1}#H(m){const S=this.#r.get(m.pageIndex);S?S.addOrRebuild(m):this.addEditor(m)}setActiveEditor(m){this.#e!==m&&(this.#e=m,m&&this.#U(m.propertiesToUpdate))}toggleSelected(m){if(this.#u.has(m)){this.#u.delete(m),m.unselect(),this.#S({hasSelectedEditor:this.hasSelection});return}this.#u.add(m),m.select(),this.#U(m.propertiesToUpdate),this.#S({hasSelectedEditor:!0})}setSelected(m){for(const S of this.#u)S!==m&&S.unselect();this.#u.clear(),this.#u.add(m),m.select(),this.#U(m.propertiesToUpdate),this.#S({hasSelectedEditor:!0})}isSelected(m){return this.#u.has(m)}unselect(m){m.unselect(),this.#u.delete(m),this.#S({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#u.size!==0}undo(){this.#s.undo(),this.#S({hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#s.redo(),this.#S({hasSomethingToUndo:!0,hasSomethingToRedo:this.#s.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(m){this.#s.add(m),this.#S({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const m of this.#t.values())return m.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const m=[...this.#u],S=()=>{for(const w of m)w.remove()},E=()=>{for(const w of m)this.#H(w)};this.addCommands({cmd:S,undo:E,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#z(m){this.#u.clear();for(const S of m)S.isEmpty()||(this.#u.add(S),S.select());this.#S({hasSelectedEditor:!0})}selectAll(){for(const m of this.#u)m.commit();this.#z(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.hasSelection){for(const m of this.#u)m.unselect();this.#u.clear(),this.#S({hasSelectedEditor:!1})}}translateSelectedEditors(m,S,E=!1){if(E||this.commitOrRemove(),!this.hasSelection)return;this.#_[0]+=m,this.#_[1]+=S;const[w,T]=this.#_,A=[...this.#u],L=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#_[0]=this.#_[1]=0,this.addCommands({cmd:()=>{for(const k of A)this.#t.has(k.id)&&k.translateInPage(w,T)},undo:()=>{for(const k of A)this.#t.has(k.id)&&k.translateInPage(-w,-T)},mustExec:!1})},L);for(const k of A)k.translateInPage(m,S)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const m of this.#u)this.#c.set(m,{savedX:m.x,savedY:m.y,savedPageIndex:m.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const m=this.#c;this.#c=null;let S=!1;for(const[{x:w,y:T,pageIndex:A},L]of m)L.newX=w,L.newY=T,L.newPageIndex=A,S||=w!==L.savedX||T!==L.savedY||A!==L.savedPageIndex;if(!S)return!1;const E=(w,T,A,L)=>{if(this.#t.has(w.id)){const k=this.#r.get(L);k?w._setParentAndPosition(k,T,A):(w.pageIndex=L,w.x=T,w.y=A)}};return this.addCommands({cmd:()=>{for(const[w,{newX:T,newY:A,newPageIndex:L}]of m)E(w,T,A,L)},undo:()=>{for(const[w,{savedX:T,savedY:A,savedPageIndex:L}]of m)E(w,T,A,L)},mustExec:!0}),!0}dragSelectedEditors(m,S){if(this.#c)for(const E of this.#c.keys())E.drag(m,S)}rebuild(m){if(m.parent===null){const S=this.getLayer(m.pageIndex);S?(S.changeParent(m),S.addOrRebuild(m)):(this.addEditor(m),this.addToAnnotationStorage(m),m.rebuild())}else m.parent.addOrRebuild(m)}isActive(m){return this.#e===m}getActive(){return this.#e}getMode(){return this.#m}get imageManager(){return(0,a.shadow)(this,"imageManager",new h)}}t.AnnotationEditorUIManager=g}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=N,t.getColorValues=ne,t.getCurrentTransform=oe,t.getCurrentTransformInverse=le,t.getFilenameFromUrl=w,t.getPdfFilenameFromUrl=T,t.getRGB=Z,t.getXfaPageViewport=te,t.isDataScheme=S,t.isPdfFile=E,t.isValidFetchUrl=L,t.loadScript=D,t.noContextMenu=k,t.setLayerDimensions=pe;var a=n(7),i=n(1);const s="http://www.w3.org/2000/svg";class o{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=o;class c extends a.BaseFilterFactory{#e;#t;#r;#n;#o;#s;#i;#l;#c;#a;#h=0;constructor({docId:J,ownerDocument:V=globalThis.document}={}){super(),this.#r=J,this.#n=V}get#f(){return this.#e||=new Map}get#d(){if(!this.#t){const J=this.#n.createElement("div"),{style:V}=J;V.visibility="hidden",V.contain="strict",V.width=V.height=0,V.position="absolute",V.top=V.left=0,V.zIndex=-1;const C=this.#n.createElementNS(s,"svg");C.setAttribute("width",0),C.setAttribute("height",0),this.#t=this.#n.createElementNS(s,"defs"),J.append(C),C.append(this.#t),this.#n.body.append(J)}return this.#t}addFilter(J){if(!J)return"none";let V=this.#f.get(J);if(V)return V;let C,O,I,M;if(J.length===1){const F=J[0],q=new Array(256);for(let X=0;X<256;X++)q[X]=F[X]/255;M=C=O=I=q.join(",")}else{const[F,q,X]=J,W=new Array(256),K=new Array(256),ae=new Array(256);for(let U=0;U<256;U++)W[U]=F[U]/255,K[U]=q[U]/255,ae[U]=X[U]/255;C=W.join(","),O=K.join(","),I=ae.join(","),M=`${C}${O}${I}`}if(V=this.#f.get(M),V)return this.#f.set(J,V),V;const H=`g_${this.#r}_transfer_map_${this.#h++}`,G=`url(#${H})`;this.#f.set(J,G),this.#f.set(M,G);const j=this.#v(H);return this.#m(C,O,I,j),G}addHCMFilter(J,V){const C=`${J}-${V}`;if(this.#s===C)return this.#i;if(this.#s=C,this.#i="none",this.#o?.remove(),!J||!V)return this.#i;const O=this.#u(J);J=i.Util.makeHexColor(...O);const I=this.#u(V);if(V=i.Util.makeHexColor(...I),this.#d.style.color="",J==="#000000"&&V==="#ffffff"||J===V)return this.#i;const M=new Array(256);for(let q=0;q<=255;q++){const X=q/255;M[q]=X<=.03928?X/12.92:((X+.055)/1.055)**2.4}const H=M.join(","),G=`g_${this.#r}_hcm_filter`,j=this.#l=this.#v(G);this.#m(H,H,H,j),this.#p(j);const F=(q,X)=>{const W=O[q]/255,K=I[q]/255,ae=new Array(X+1);for(let U=0;U<=X;U++)ae[U]=W+U/X*(K-W);return ae.join(",")};return this.#m(F(0,5),F(1,5),F(2,5),j),this.#i=`url(#${G})`,this.#i}addHighlightHCMFilter(J,V,C,O){const I=`${J}-${V}-${C}-${O}`;if(this.#c===I)return this.#a;if(this.#c=I,this.#a="none",this.#l?.remove(),!J||!V)return this.#a;const[M,H]=[J,V].map(this.#u.bind(this));let G=Math.round(.2126*M[0]+.7152*M[1]+.0722*M[2]),j=Math.round(.2126*H[0]+.7152*H[1]+.0722*H[2]),[F,q]=[C,O].map(this.#u.bind(this));j<G&&([G,j,F,q]=[j,G,q,F]),this.#d.style.color="";const X=(ae,U,ve)=>{const be=new Array(256),ye=(j-G)/ve,_e=ae/255,ge=(U-ae)/(255*ve);let Re=0;for(let De=0;De<=ve;De++){const We=Math.round(G+De*ye),ze=_e+De*ge;for(let Je=Re;Je<=We;Je++)be[Je]=ze;Re=We+1}for(let De=Re;De<256;De++)be[De]=be[Re-1];return be.join(",")},W=`g_${this.#r}_hcm_highlight_filter`,K=this.#l=this.#v(W);return this.#p(K),this.#m(X(F[0],q[0],5),X(F[1],q[1],5),X(F[2],q[2],5),K),this.#a=`url(#${W})`,this.#a}destroy(J=!1){J&&(this.#i||this.#a)||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#h=0)}#p(J){const V=this.#n.createElementNS(s,"feColorMatrix");V.setAttribute("type","matrix"),V.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),J.append(V)}#v(J){const V=this.#n.createElementNS(s,"filter");return V.setAttribute("color-interpolation-filters","sRGB"),V.setAttribute("id",J),this.#d.append(V),V}#g(J,V,C){const O=this.#n.createElementNS(s,V);O.setAttribute("type","discrete"),O.setAttribute("tableValues",C),J.append(O)}#m(J,V,C,O){const I=this.#n.createElementNS(s,"feComponentTransfer");O.append(I),this.#g(I,"feFuncR",J),this.#g(I,"feFuncG",V),this.#g(I,"feFuncB",C)}#u(J){return this.#d.style.color=J,Z(getComputedStyle(this.#d).getPropertyValue("color"))}}t.DOMFilterFactory=c;class h extends a.BaseCanvasFactory{constructor({ownerDocument:J=globalThis.document}={}){super(),this._document=J}_createCanvas(J,V){const C=this._document.createElement("canvas");return C.width=J,C.height=V,C}}t.DOMCanvasFactory=h;async function f(de,J=!1){if(L(de,document.baseURI)){const V=await fetch(de);if(!V.ok)throw new Error(V.statusText);return J?new Uint8Array(await V.arrayBuffer()):(0,i.stringToBytes)(await V.text())}return new Promise((V,C)=>{const O=new XMLHttpRequest;O.open("GET",de,!0),J&&(O.responseType="arraybuffer"),O.onreadystatechange=()=>{if(O.readyState===XMLHttpRequest.DONE){if(O.status===200||O.status===0){let I;if(J&&O.response?I=new Uint8Array(O.response):!J&&O.responseText&&(I=(0,i.stringToBytes)(O.responseText)),I){V(I);return}}C(new Error(O.statusText))}},O.send(null)})}class u extends a.BaseCMapReaderFactory{_fetchData(J,V){return f(J,this.isCompressed).then(C=>({cMapData:C,compressionType:V}))}}t.DOMCMapReaderFactory=u;class p extends a.BaseStandardFontDataFactory{_fetchData(J){return f(J,!0)}}t.DOMStandardFontDataFactory=p;class g extends a.BaseSVGFactory{_createSVG(J){return document.createElementNS(s,J)}}t.DOMSVGFactory=g;class v{constructor({viewBox:J,scale:V,rotation:C,offsetX:O=0,offsetY:I=0,dontFlip:M=!1}){this.viewBox=J,this.scale=V,this.rotation=C,this.offsetX=O,this.offsetY=I;const H=(J[2]+J[0])/2,G=(J[3]+J[1])/2;let j,F,q,X;switch(C%=360,C<0&&(C+=360),C){case 180:j=-1,F=0,q=0,X=1;break;case 90:j=0,F=1,q=1,X=0;break;case 270:j=0,F=-1,q=-1,X=0;break;case 0:j=1,F=0,q=0,X=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}M&&(q=-q,X=-X);let W,K,ae,U;j===0?(W=Math.abs(G-J[1])*V+O,K=Math.abs(H-J[0])*V+I,ae=(J[3]-J[1])*V,U=(J[2]-J[0])*V):(W=Math.abs(H-J[0])*V+O,K=Math.abs(G-J[1])*V+I,ae=(J[2]-J[0])*V,U=(J[3]-J[1])*V),this.transform=[j*V,F*V,q*V,X*V,W-j*V*H-q*V*G,K-F*V*H-X*V*G],this.width=ae,this.height=U}get rawDims(){const{viewBox:J}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:J[2]-J[0],pageHeight:J[3]-J[1],pageX:J[0],pageY:J[1]})}clone({scale:J=this.scale,rotation:V=this.rotation,offsetX:C=this.offsetX,offsetY:O=this.offsetY,dontFlip:I=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:J,rotation:V,offsetX:C,offsetY:O,dontFlip:I})}convertToViewportPoint(J,V){return i.Util.applyTransform([J,V],this.transform)}convertToViewportRectangle(J){const V=i.Util.applyTransform([J[0],J[1]],this.transform),C=i.Util.applyTransform([J[2],J[3]],this.transform);return[V[0],V[1],C[0],C[1]]}convertToPdfPoint(J,V){return i.Util.applyInverseTransform([J,V],this.transform)}}t.PageViewport=v;class m extends i.BaseException{constructor(J,V=0){super(J,"RenderingCancelledException"),this.extraDelay=V}}t.RenderingCancelledException=m;function S(de){const J=de.length;let V=0;for(;V<J&&de[V].trim()==="";)V++;return de.substring(V,V+5).toLowerCase()==="data:"}function E(de){return typeof de=="string"&&/\.pdf$/i.test(de)}function w(de,J=!1){return J||([de]=de.split(/[#?]/,1)),de.substring(de.lastIndexOf("/")+1)}function T(de,J="document.pdf"){if(typeof de!="string")return J;if(S(de))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),J;const V=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,C=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,O=V.exec(de);let I=C.exec(O[1])||C.exec(O[2])||C.exec(O[3]);if(I&&(I=I[0],I.includes("%")))try{I=C.exec(decodeURIComponent(I))[0]}catch{}return I||J}class A{started=Object.create(null);times=[];time(J){J in this.started&&(0,i.warn)(`Timer is already running for ${J}`),this.started[J]=Date.now()}timeEnd(J){J in this.started||(0,i.warn)(`Timer has not been started for ${J}`),this.times.push({name:J,start:this.started[J],end:Date.now()}),delete this.started[J]}toString(){const J=[];let V=0;for(const{name:C}of this.times)V=Math.max(C.length,V);for(const{name:C,start:O,end:I}of this.times)J.push(`${C.padEnd(V)} ${I-O}ms
`);return J.join("")}}t.StatTimer=A;function L(de,J){try{const{protocol:V}=J?new URL(de,J):new URL(de);return V==="http:"||V==="https:"}catch{return!1}}function k(de){de.preventDefault()}function D(de,J=!1){return new Promise((V,C)=>{const O=document.createElement("script");O.src=de,O.onload=function(I){J&&O.remove(),V(I)},O.onerror=function(){C(new Error(`Cannot load script at: ${O.src}`))},(document.head||document.documentElement).append(O)})}function N(de){console.log("Deprecated API usage: "+de)}let Y;class z{static toDateObject(J){if(!J||typeof J!="string")return null;Y||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const V=Y.exec(J);if(!V)return null;const C=parseInt(V[1],10);let O=parseInt(V[2],10);O=O>=1&&O<=12?O-1:0;let I=parseInt(V[3],10);I=I>=1&&I<=31?I:1;let M=parseInt(V[4],10);M=M>=0&&M<=23?M:0;let H=parseInt(V[5],10);H=H>=0&&H<=59?H:0;let G=parseInt(V[6],10);G=G>=0&&G<=59?G:0;const j=V[7]||"Z";let F=parseInt(V[8],10);F=F>=0&&F<=23?F:0;let q=parseInt(V[9],10)||0;return q=q>=0&&q<=59?q:0,j==="-"?(M+=F,H+=q):j==="+"&&(M-=F,H-=q),new Date(Date.UTC(C,O,I,M,H,G))}}t.PDFDateString=z;function te(de,{scale:J=1,rotation:V=0}){const{width:C,height:O}=de.attributes.style,I=[0,0,parseInt(C),parseInt(O)];return new v({viewBox:I,scale:J,rotation:V})}function Z(de){if(de.startsWith("#")){const J=parseInt(de.slice(1),16);return[(J&16711680)>>16,(J&65280)>>8,J&255]}return de.startsWith("rgb(")?de.slice(4,-1).split(",").map(J=>parseInt(J)):de.startsWith("rgba(")?de.slice(5,-1).split(",").map(J=>parseInt(J)).slice(0,3):((0,i.warn)(`Not a valid color format: "${de}"`),[0,0,0])}function ne(de){const J=document.createElement("span");J.style.visibility="hidden",document.body.append(J);for(const V of de.keys()){J.style.color=V;const C=window.getComputedStyle(J).color;de.set(V,Z(C))}J.remove()}function oe(de){const{a:J,b:V,c:C,d:O,e:I,f:M}=de.getTransform();return[J,V,C,O,I,M]}function le(de){const{a:J,b:V,c:C,d:O,e:I,f:M}=de.getTransform().invertSelf();return[J,V,C,O,I,M]}function pe(de,J,V=!1,C=!0){if(J instanceof v){const{pageWidth:O,pageHeight:I}=J.rawDims,{style:M}=de,H=i.FeatureTest.isCSSRoundSupported,G=`var(--scale-factor) * ${O}px`,j=`var(--scale-factor) * ${I}px`,F=H?`round(${G}, 1px)`:`calc(${G})`,q=H?`round(${j}, 1px)`:`calc(${j})`;!V||J.rotation%180===0?(M.width=F,M.height=q):(M.width=q,M.height=F)}C&&de.setAttribute("data-main-rotation",J.rotation)}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var a=n(1);class i{constructor(){this.constructor===i&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(u){return"none"}addHCMFilter(u,p){return"none"}addHighlightHCMFilter(u,p,g,v){return"none"}destroy(u=!1){}}t.BaseFilterFactory=i;class s{constructor(){this.constructor===s&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,p){if(u<=0||p<=0)throw new Error("Invalid canvas size");const g=this._createCanvas(u,p);return{canvas:g,context:g.getContext("2d")}}reset(u,p,g){if(!u.canvas)throw new Error("Canvas is not specified");if(p<=0||g<=0)throw new Error("Invalid canvas size");u.canvas.width=p,u.canvas.height=g}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,p){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=s;class o{constructor({baseUrl:u=null,isCompressed:p=!0}){this.constructor===o&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=u,this.isCompressed=p}async fetch({name:u}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!u)throw new Error("CMap name must be specified.");const p=this.baseUrl+u+(this.isCompressed?".bcmap":""),g=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(p,g).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(u,p){(0,a.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=o;class c{constructor({baseUrl:u=null}){this.constructor===c&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=u}async fetch({filename:u}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!u)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${u}`;return this._fetchData(p).catch(g=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(u){(0,a.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=c;class h{constructor(){this.constructor===h&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,p,g=!1){if(u<=0||p<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),g||(v.setAttribute("width",`${u}px`),v.setAttribute("height",`${p}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${u} ${p}`),v}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,a.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=h}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var a=n(1);const i=3285377520,s=4294901760,o=65535;class c{constructor(f){this.h1=f?f&4294967295:i,this.h2=f?f&4294967295:i}update(f){let u,p;if(typeof f=="string"){u=new Uint8Array(f.length*2),p=0;for(let N=0,Y=f.length;N<Y;N++){const z=f.charCodeAt(N);z<=255?u[p++]=z:(u[p++]=z>>>8,u[p++]=z&255)}}else if((0,a.isArrayBuffer)(f))u=f.slice(),p=u.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const g=p>>2,v=p-g*4,m=new Uint32Array(u.buffer,0,g);let S=0,E=0,w=this.h1,T=this.h2;const A=3432918353,L=461845907,k=A&o,D=L&o;for(let N=0;N<g;N++)N&1?(S=m[N],S=S*A&s|S*k&o,S=S<<15|S>>>17,S=S*L&s|S*D&o,w^=S,w=w<<13|w>>>19,w=w*5+3864292196):(E=m[N],E=E*A&s|E*k&o,E=E<<15|E>>>17,E=E*L&s|E*D&o,T^=E,T=T<<13|T>>>19,T=T*5+3864292196);switch(S=0,v){case 3:S^=u[g*4+2]<<16;case 2:S^=u[g*4+1]<<8;case 1:S^=u[g*4],S=S*A&s|S*k&o,S=S<<15|S>>>17,S=S*L&s|S*D&o,g&1?w^=S:T^=S}this.h1=w,this.h2=T}hexdigest(){let f=this.h1,u=this.h2;return f^=u>>>1,f=f*3981806797&s|f*36045&o,u=u*4283543511&s|((u<<16|f>>>16)*2950163797&s)>>>16,f^=u>>>1,f=f*444984403&s|f*60499&o,u=u*3301882366&s|((u<<16|f>>>16)*3120437893&s)>>>16,f^=u>>>1,(f>>>0).toString(16).padStart(8,"0")+(u>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=c}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var a=n(1);class i{#e=new Set;constructor({ownerDocument:c=globalThis.document,styleElement:h=null}){this._document=c,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(c){this.nativeFontFaces.add(c),this._document.fonts.add(c)}removeNativeFontFace(c){this.nativeFontFaces.delete(c),this._document.fonts.delete(c)}insertRule(c){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const h=this.styleElement.sheet;h.insertRule(c,h.cssRules.length)}clear(){for(const c of this.nativeFontFaces)this._document.fonts.delete(c);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(c){if(!(!c||this.#e.has(c.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:h,src:f,style:u}=c,p=new FontFace(h,f,u);this.addNativeFontFace(p);try{await p.load(),this.#e.add(h)}catch{(0,a.warn)(`Cannot load system font: ${c.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(p)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(c){if(c.attached||c.missingFile&&!c.systemFontInfo)return;if(c.attached=!0,c.systemFontInfo){await this.loadSystemFont(c.systemFontInfo);return}if(this.isFontLoadingAPISupported){const f=c.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(u){throw(0,a.warn)(`Failed to load font '${f.family}': '${u}'.`),c.disableFontFace=!0,u}}return}const h=c.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const u=this._queueLoadingCallback(f);this._prepareFontLoadEvent(c,u)})}}get isFontLoadingAPISupported(){const c=!!this._document?.fonts;return(0,a.shadow)(this,"isFontLoadingAPISupported",c)}get isSyncFontLoadingSupported(){let c=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(c=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",c)}_queueLoadingCallback(c){function h(){for((0,a.assert)(!u.done,"completeRequest() cannot be called twice."),u.done=!0;f.length>0&&f[0].done;){const p=f.shift();setTimeout(p.callback,0)}}const{loadingRequests:f}=this,u={done:!1,complete:h,callback:c};return f.push(u),u}get _loadTestFont(){const c=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",c)}_prepareFontLoadEvent(c,h){function f(te,Z){return te.charCodeAt(Z)<<24|te.charCodeAt(Z+1)<<16|te.charCodeAt(Z+2)<<8|te.charCodeAt(Z+3)&255}function u(te,Z,ne,oe){const le=te.substring(0,Z),pe=te.substring(Z+ne);return le+oe+pe}let p,g;const v=this._document.createElement("canvas");v.width=1,v.height=1;const m=v.getContext("2d");let S=0;function E(te,Z){if(++S>30){(0,a.warn)("Load test font never loaded."),Z();return}if(m.font="30px "+te,m.fillText(".",0,20),m.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(E.bind(null,te,Z))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let T=this._loadTestFont;T=u(T,976,w.length,w);const L=16,k=1482184792;let D=f(T,L);for(p=0,g=w.length-3;p<g;p+=4)D=D-k+f(w,p)|0;p<w.length&&(D=D-k+f(w+"XXX",p)|0),T=u(T,L,4,(0,a.string32)(D));const N=`url(data:font/opentype;base64,${btoa(T)});`,Y=`@font-face {font-family:"${w}";src:${N}}`;this.insertRule(Y);const z=this._document.createElement("div");z.style.visibility="hidden",z.style.width=z.style.height="10px",z.style.position="absolute",z.style.top=z.style.left="0px";for(const te of[c.loadedName,w]){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=te,z.append(Z)}this._document.body.append(z),E(w,()=>{z.remove(),h.complete()})}}t.FontLoader=i;class s{constructor(c,{isEvalSupported:h=!0,disableFontFace:f=!1,ignoreErrors:u=!1,inspectFont:p=null}){this.compiledGlyphs=Object.create(null);for(const g in c)this[g]=c[g];this.isEvalSupported=h!==!1,this.disableFontFace=f===!0,this.ignoreErrors=u===!0,this._inspectFont=p}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let c;if(!this.cssFontInfo)c=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),c=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this._inspectFont?.(this),c}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const c=(0,a.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(c)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let u=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(u+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${u}src:${h}}`}return this._inspectFont?.(this,h),f}getPathGenerator(c,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let f;try{f=c.get(this.loadedName+"_path_"+h)}catch(u){if(!this.ignoreErrors)throw u;return(0,a.warn)(`getPathGenerator - ignoring character: "${u}".`),this.compiledGlyphs[h]=function(p,g){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const u=[];for(const p of f){const g=p.args!==void 0?p.args.join(","):"";u.push("c.",p.cmd,"(",g,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",u.join(""))}return this.compiledGlyphs[h]=function(u,p){for(const g of f)g.cmd==="scale"&&(g.args=[p,-p]),u[g.cmd].apply(u,g.args)}}}t.FontFaceObject=s}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var a=n(7);n(1);const i=function(f){return new Promise((u,p)=>{require$$5.readFile(f,(v,m)=>{if(v||!m){p(new Error(v));return}u(new Uint8Array(m))})})};class s extends a.BaseFilterFactory{}t.NodeFilterFactory=s;class o extends a.BaseCanvasFactory{_createCanvas(u,p){return require$$5.createCanvas(u,p)}}t.NodeCanvasFactory=o;class c extends a.BaseCMapReaderFactory{_fetchData(u,p){return i(u).then(g=>({cMapData:g,compressionType:p}))}}t.NodeCMapReaderFactory=c;class h extends a.BaseStandardFontDataFactory{_fetchData(u){return i(u)}}t.NodeStandardFontDataFactory=h}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var a=n(1),i=n(6),s=n(12),o=n(13);const c=16,h=100,f=4096,u=15,p=10,g=1e3,v=16;function m(V,C){if(V._removeMirroring)throw new Error("Context is already forwarding operations.");V.__originalSave=V.save,V.__originalRestore=V.restore,V.__originalRotate=V.rotate,V.__originalScale=V.scale,V.__originalTranslate=V.translate,V.__originalTransform=V.transform,V.__originalSetTransform=V.setTransform,V.__originalResetTransform=V.resetTransform,V.__originalClip=V.clip,V.__originalMoveTo=V.moveTo,V.__originalLineTo=V.lineTo,V.__originalBezierCurveTo=V.bezierCurveTo,V.__originalRect=V.rect,V.__originalClosePath=V.closePath,V.__originalBeginPath=V.beginPath,V._removeMirroring=()=>{V.save=V.__originalSave,V.restore=V.__originalRestore,V.rotate=V.__originalRotate,V.scale=V.__originalScale,V.translate=V.__originalTranslate,V.transform=V.__originalTransform,V.setTransform=V.__originalSetTransform,V.resetTransform=V.__originalResetTransform,V.clip=V.__originalClip,V.moveTo=V.__originalMoveTo,V.lineTo=V.__originalLineTo,V.bezierCurveTo=V.__originalBezierCurveTo,V.rect=V.__originalRect,V.closePath=V.__originalClosePath,V.beginPath=V.__originalBeginPath,delete V._removeMirroring},V.save=function(){C.save(),this.__originalSave()},V.restore=function(){C.restore(),this.__originalRestore()},V.translate=function(I,M){C.translate(I,M),this.__originalTranslate(I,M)},V.scale=function(I,M){C.scale(I,M),this.__originalScale(I,M)},V.transform=function(I,M,H,G,j,F){C.transform(I,M,H,G,j,F),this.__originalTransform(I,M,H,G,j,F)},V.setTransform=function(I,M,H,G,j,F){C.setTransform(I,M,H,G,j,F),this.__originalSetTransform(I,M,H,G,j,F)},V.resetTransform=function(){C.resetTransform(),this.__originalResetTransform()},V.rotate=function(I){C.rotate(I),this.__originalRotate(I)},V.clip=function(I){C.clip(I),this.__originalClip(I)},V.moveTo=function(O,I){C.moveTo(O,I),this.__originalMoveTo(O,I)},V.lineTo=function(O,I){C.lineTo(O,I),this.__originalLineTo(O,I)},V.bezierCurveTo=function(O,I,M,H,G,j){C.bezierCurveTo(O,I,M,H,G,j),this.__originalBezierCurveTo(O,I,M,H,G,j)},V.rect=function(O,I,M,H){C.rect(O,I,M,H),this.__originalRect(O,I,M,H)},V.closePath=function(){C.closePath(),this.__originalClosePath()},V.beginPath=function(){C.beginPath(),this.__originalBeginPath()}}class S{constructor(C){this.canvasFactory=C,this.cache=Object.create(null)}getCanvas(C,O,I){let M;return this.cache[C]!==void 0?(M=this.cache[C],this.canvasFactory.reset(M,O,I)):(M=this.canvasFactory.create(O,I),this.cache[C]=M),M}delete(C){delete this.cache[C]}clear(){for(const C in this.cache){const O=this.cache[C];this.canvasFactory.destroy(O),delete this.cache[C]}}}function E(V,C,O,I,M,H,G,j,F,q){const[X,W,K,ae,U,ve]=(0,i.getCurrentTransform)(V);if(W===0&&K===0){const _e=G*X+U,ge=Math.round(_e),Re=j*ae+ve,De=Math.round(Re),We=(G+F)*X+U,ze=Math.abs(Math.round(We)-ge)||1,Je=(j+q)*ae+ve,Qe=Math.abs(Math.round(Je)-De)||1;return V.setTransform(Math.sign(X),0,0,Math.sign(ae),ge,De),V.drawImage(C,O,I,M,H,0,0,ze,Qe),V.setTransform(X,W,K,ae,U,ve),[ze,Qe]}if(X===0&&ae===0){const _e=j*K+U,ge=Math.round(_e),Re=G*W+ve,De=Math.round(Re),We=(j+q)*K+U,ze=Math.abs(Math.round(We)-ge)||1,Je=(G+F)*W+ve,Qe=Math.abs(Math.round(Je)-De)||1;return V.setTransform(0,Math.sign(W),Math.sign(K),0,ge,De),V.drawImage(C,O,I,M,H,0,0,Qe,ze),V.setTransform(X,W,K,ae,U,ve),[Qe,ze]}V.drawImage(C,O,I,M,H,G,j,F,q);const be=Math.hypot(X,W),ye=Math.hypot(K,ae);return[be*F,ye*q]}function w(V){const{width:C,height:O}=V;if(C>g||O>g)return null;const I=1e3,M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),H=C+1;let G=new Uint8Array(H*(O+1)),j,F,q;const X=C+7&-8;let W=new Uint8Array(X*O),K=0;for(const ye of V.data){let _e=128;for(;_e>0;)W[K++]=ye&_e?0:255,_e>>=1}let ae=0;for(K=0,W[K]!==0&&(G[0]=1,++ae),F=1;F<C;F++)W[K]!==W[K+1]&&(G[F]=W[K]?2:1,++ae),K++;for(W[K]!==0&&(G[F]=2,++ae),j=1;j<O;j++){K=j*X,q=j*H,W[K-X]!==W[K]&&(G[q]=W[K]?1:8,++ae);let ye=(W[K]?4:0)+(W[K-X]?8:0);for(F=1;F<C;F++)ye=(ye>>2)+(W[K+1]?4:0)+(W[K-X+1]?8:0),M[ye]&&(G[q+F]=M[ye],++ae),K++;if(W[K-X]!==W[K]&&(G[q+F]=W[K]?2:4,++ae),ae>I)return null}for(K=X*(O-1),q=j*H,W[K]!==0&&(G[q]=8,++ae),F=1;F<C;F++)W[K]!==W[K+1]&&(G[q+F]=W[K]?4:8,++ae),K++;if(W[K]!==0&&(G[q+F]=4,++ae),ae>I)return null;const U=new Int32Array([0,H,-1,0,-H,0,0,0,1]),ve=new Path2D;for(j=0;ae&&j<=O;j++){let ye=j*H;const _e=ye+C;for(;ye<_e&&!G[ye];)ye++;if(ye===_e)continue;ve.moveTo(ye%H,j);const ge=ye;let Re=G[ye];do{const De=U[Re];do ye+=De;while(!G[ye]);const We=G[ye];We!==5&&We!==10?(Re=We,G[ye]=0):(Re=We&51*Re>>4,G[ye]&=Re>>2|Re<<2),ve.lineTo(ye%H,ye/H|0),G[ye]||--ae}while(ge!==ye);--j}return W=null,G=null,function(ye){ye.save(),ye.scale(1/C,-1/O),ye.translate(0,-O),ye.fill(ve),ye.beginPath(),ye.restore()}}class T{constructor(C,O){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,C,O])}clone(){const C=Object.create(this);return C.clipBox=this.clipBox.slice(),C}setCurrentPoint(C,O){this.x=C,this.y=O}updatePathMinMax(C,O,I){[O,I]=a.Util.applyTransform([O,I],C),this.minX=Math.min(this.minX,O),this.minY=Math.min(this.minY,I),this.maxX=Math.max(this.maxX,O),this.maxY=Math.max(this.maxY,I)}updateRectMinMax(C,O){const I=a.Util.applyTransform(O,C),M=a.Util.applyTransform(O.slice(2),C);this.minX=Math.min(this.minX,I[0],M[0]),this.minY=Math.min(this.minY,I[1],M[1]),this.maxX=Math.max(this.maxX,I[0],M[0]),this.maxY=Math.max(this.maxY,I[1],M[1])}updateScalingPathMinMax(C,O){a.Util.scaleMinMax(C,O),this.minX=Math.min(this.minX,O[0]),this.maxX=Math.max(this.maxX,O[1]),this.minY=Math.min(this.minY,O[2]),this.maxY=Math.max(this.maxY,O[3])}updateCurvePathMinMax(C,O,I,M,H,G,j,F,q,X){const W=a.Util.bezierBoundingBox(O,I,M,H,G,j,F,q);if(X){X[0]=Math.min(X[0],W[0],W[2]),X[1]=Math.max(X[1],W[0],W[2]),X[2]=Math.min(X[2],W[1],W[3]),X[3]=Math.max(X[3],W[1],W[3]);return}this.updateRectMinMax(C,W)}getPathBoundingBox(C=s.PathType.FILL,O=null){const I=[this.minX,this.minY,this.maxX,this.maxY];if(C===s.PathType.STROKE){O||(0,a.unreachable)("Stroke bounding box must include transform.");const M=a.Util.singularValueDecompose2dScale(O),H=M[0]*this.lineWidth/2,G=M[1]*this.lineWidth/2;I[0]-=H,I[1]-=G,I[2]+=H,I[3]+=G}return I}updateClipFromPath(){const C=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(C||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(C){this.clipBox=C,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(C=s.PathType.FILL,O=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(C,O))}}function A(V,C){if(typeof ImageData<"u"&&C instanceof ImageData){V.putImageData(C,0,0);return}const O=C.height,I=C.width,M=O%v,H=(O-M)/v,G=M===0?H:H+1,j=V.createImageData(I,v);let F=0,q;const X=C.data,W=j.data;let K,ae,U,ve;if(C.kind===a.ImageKind.GRAYSCALE_1BPP){const be=X.byteLength,ye=new Uint32Array(W.buffer,0,W.byteLength>>2),_e=ye.length,ge=I+7>>3,Re=4294967295,De=a.FeatureTest.isLittleEndian?4278190080:255;for(K=0;K<G;K++){for(U=K<H?v:M,q=0,ae=0;ae<U;ae++){const We=be-F;let ze=0;const Je=We>ge?I:We*8-7,Qe=Je&-8;let et=0,st=0;for(;ze<Qe;ze+=8)st=X[F++],ye[q++]=st&128?Re:De,ye[q++]=st&64?Re:De,ye[q++]=st&32?Re:De,ye[q++]=st&16?Re:De,ye[q++]=st&8?Re:De,ye[q++]=st&4?Re:De,ye[q++]=st&2?Re:De,ye[q++]=st&1?Re:De;for(;ze<Je;ze++)et===0&&(st=X[F++],et=128),ye[q++]=st&et?Re:De,et>>=1}for(;q<_e;)ye[q++]=0;V.putImageData(j,0,K*v)}}else if(C.kind===a.ImageKind.RGBA_32BPP){for(ae=0,ve=I*v*4,K=0;K<H;K++)W.set(X.subarray(F,F+ve)),F+=ve,V.putImageData(j,0,ae),ae+=v;K<G&&(ve=I*M*4,W.set(X.subarray(F,F+ve)),V.putImageData(j,0,ae))}else if(C.kind===a.ImageKind.RGB_24BPP)for(U=v,ve=I*U,K=0;K<G;K++){for(K>=H&&(U=M,ve=I*U),q=0,ae=ve;ae--;)W[q++]=X[F++],W[q++]=X[F++],W[q++]=X[F++],W[q++]=255;V.putImageData(j,0,K*v)}else throw new Error(`bad image kind: ${C.kind}`)}function L(V,C){if(C.bitmap){V.drawImage(C.bitmap,0,0);return}const O=C.height,I=C.width,M=O%v,H=(O-M)/v,G=M===0?H:H+1,j=V.createImageData(I,v);let F=0;const q=C.data,X=j.data;for(let W=0;W<G;W++){const K=W<H?v:M;({srcPos:F}=(0,o.convertBlackAndWhiteToRGBA)({src:q,srcPos:F,dest:X,width:I,height:K,nonBlackColor:0})),V.putImageData(j,0,W*v)}}function k(V,C){const O=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const I of O)V[I]!==void 0&&(C[I]=V[I]);V.setLineDash!==void 0&&(C.setLineDash(V.getLineDash()),C.lineDashOffset=V.lineDashOffset)}function D(V){if(V.strokeStyle=V.fillStyle="#000000",V.fillRule="nonzero",V.globalAlpha=1,V.lineWidth=1,V.lineCap="butt",V.lineJoin="miter",V.miterLimit=10,V.globalCompositeOperation="source-over",V.font="10px sans-serif",V.setLineDash!==void 0&&(V.setLineDash([]),V.lineDashOffset=0),!a.isNodeJS){const{filter:C}=V;C!=="none"&&C!==""&&(V.filter="none")}}function N(V,C,O,I){const M=V.length;for(let H=3;H<M;H+=4){const G=V[H];if(G===0)V[H-3]=C,V[H-2]=O,V[H-1]=I;else if(G<255){const j=255-G;V[H-3]=V[H-3]*G+C*j>>8,V[H-2]=V[H-2]*G+O*j>>8,V[H-1]=V[H-1]*G+I*j>>8}}}function Y(V,C,O){const I=V.length,M=1/255;for(let H=3;H<I;H+=4){const G=O?O[V[H]]:V[H];C[H]=C[H]*G*M|0}}function z(V,C,O){const I=V.length;for(let M=3;M<I;M+=4){const H=V[M-3]*77+V[M-2]*152+V[M-1]*28;C[M]=O?C[M]*O[H>>8]>>8:C[M]*H>>16}}function te(V,C,O,I,M,H,G,j,F,q,X){const W=!!H,K=W?H[0]:0,ae=W?H[1]:0,U=W?H[2]:0,ve=M==="Luminosity"?z:Y,ye=Math.min(I,Math.ceil(1048576/O));for(let _e=0;_e<I;_e+=ye){const ge=Math.min(ye,I-_e),Re=V.getImageData(j-q,_e+(F-X),O,ge),De=C.getImageData(j,_e+F,O,ge);W&&N(Re.data,K,ae,U),ve(Re.data,De.data,G),C.putImageData(De,j,_e+F)}}function Z(V,C,O,I){const M=I[0],H=I[1],G=I[2]-M,j=I[3]-H;G===0||j===0||(te(C.context,O,G,j,C.subtype,C.backdrop,C.transferMap,M,H,C.offsetX,C.offsetY),V.save(),V.globalAlpha=1,V.globalCompositeOperation="source-over",V.setTransform(1,0,0,1,0,0),V.drawImage(O.canvas,0,0),V.restore())}function ne(V,C){const O=a.Util.singularValueDecompose2dScale(V);O[0]=Math.fround(O[0]),O[1]=Math.fround(O[1]);const I=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return C!==void 0?C:O[0]<=I||O[1]<=I}const oe=["butt","round","square"],le=["miter","round","bevel"],pe={},de={};class J{constructor(C,O,I,M,H,{optionalContentConfig:G,markedContentStack:j=null},F,q){this.ctx=C,this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=O,this.objs=I,this.canvasFactory=M,this.filterFactory=H,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=j||[],this.optionalContentConfig=G,this.cachedCanvases=new S(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=F,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=q,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(C,O=null){return typeof C=="string"?C.startsWith("g_")?this.commonObjs.get(C):this.objs.get(C):O}beginDrawing({transform:C,viewport:O,transparency:I=!1,background:M=null}){const H=this.ctx.canvas.width,G=this.ctx.canvas.height,j=this.ctx.fillStyle;if(this.ctx.fillStyle=M||"#ffffff",this.ctx.fillRect(0,0,H,G),this.ctx.fillStyle=j,I){const F=this.cachedCanvases.getCanvas("transparent",H,G);this.compositeCtx=this.ctx,this.transparentCanvas=F.canvas,this.ctx=F.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),D(this.ctx),C&&(this.ctx.transform(...C),this.outputScaleX=C[0],this.outputScaleY=C[0]),this.ctx.transform(...O.transform),this.viewportScale=O.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(C,O,I,M){const H=C.argsArray,G=C.fnArray;let j=O||0;const F=H.length;if(F===j)return j;const q=F-j>p&&typeof I=="function",X=q?Date.now()+u:0;let W=0;const K=this.commonObjs,ae=this.objs;let U;for(;;){if(M!==void 0&&j===M.nextBreakPoint)return M.breakIt(j,I),j;if(U=G[j],U!==a.OPS.dependency)this[U].apply(this,H[j]);else for(const ve of H[j]){const be=ve.startsWith("g_")?K:ae;if(!be.has(ve))return be.get(ve,I),j}if(j++,j===F)return j;if(q&&++W>p){if(Date.now()>X)return I(),j;W=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const C of this._cachedBitmapsMap.values()){for(const O of C.values())typeof HTMLCanvasElement<"u"&&O instanceof HTMLCanvasElement&&(O.width=O.height=0);C.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const C=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(C!=="none"){const O=this.ctx.filter;this.ctx.filter=C,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=O}}}_scaleImage(C,O){const I=C.width,M=C.height;let H=Math.max(Math.hypot(O[0],O[1]),1),G=Math.max(Math.hypot(O[2],O[3]),1),j=I,F=M,q="prescale1",X,W;for(;H>2&&j>1||G>2&&F>1;){let K=j,ae=F;H>2&&j>1&&(K=j>=16384?Math.floor(j/2)-1||1:Math.ceil(j/2),H/=j/K),G>2&&F>1&&(ae=F>=16384?Math.floor(F/2)-1||1:Math.ceil(F)/2,G/=F/ae),X=this.cachedCanvases.getCanvas(q,K,ae),W=X.context,W.clearRect(0,0,K,ae),W.drawImage(C,0,0,j,F,0,0,K,ae),C=X.canvas,j=K,F=ae,q=q==="prescale1"?"prescale2":"prescale1"}return{img:C,paintWidth:j,paintHeight:F}}_createMaskCanvas(C){const O=this.ctx,{width:I,height:M}=C,H=this.current.fillColor,G=this.current.patternFill,j=(0,i.getCurrentTransform)(O);let F,q,X,W;if((C.bitmap||C.data)&&C.count>1){const ze=C.bitmap||C.data.buffer;q=JSON.stringify(G?j:[j.slice(0,4),H]),F=this._cachedBitmapsMap.get(ze),F||(F=new Map,this._cachedBitmapsMap.set(ze,F));const Je=F.get(q);if(Je&&!G){const Qe=Math.round(Math.min(j[0],j[2])+j[4]),et=Math.round(Math.min(j[1],j[3])+j[5]);return{canvas:Je,offsetX:Qe,offsetY:et}}X=Je}X||(W=this.cachedCanvases.getCanvas("maskCanvas",I,M),L(W.context,C));let K=a.Util.transform(j,[1/I,0,0,-1/M,0,0]);K=a.Util.transform(K,[1,0,0,1,0,-M]);const ae=a.Util.applyTransform([0,0],K),U=a.Util.applyTransform([I,M],K),ve=a.Util.normalizeRect([ae[0],ae[1],U[0],U[1]]),be=Math.round(ve[2]-ve[0])||1,ye=Math.round(ve[3]-ve[1])||1,_e=this.cachedCanvases.getCanvas("fillCanvas",be,ye),ge=_e.context,Re=Math.min(ae[0],U[0]),De=Math.min(ae[1],U[1]);ge.translate(-Re,-De),ge.transform(...K),X||(X=this._scaleImage(W.canvas,(0,i.getCurrentTransformInverse)(ge)),X=X.img,F&&G&&F.set(q,X)),ge.imageSmoothingEnabled=ne((0,i.getCurrentTransform)(ge),C.interpolate),E(ge,X,0,0,X.width,X.height,0,0,I,M),ge.globalCompositeOperation="source-in";const We=a.Util.transform((0,i.getCurrentTransformInverse)(ge),[1,0,0,1,-Re,-De]);return ge.fillStyle=G?H.getPattern(O,this,We,s.PathType.FILL):H,ge.fillRect(0,0,I,M),F&&!G&&(this.cachedCanvases.delete("fillCanvas"),F.set(q,_e.canvas)),{canvas:_e.canvas,offsetX:Math.round(Re),offsetY:Math.round(De)}}setLineWidth(C){C!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=C,this.ctx.lineWidth=C}setLineCap(C){this.ctx.lineCap=oe[C]}setLineJoin(C){this.ctx.lineJoin=le[C]}setMiterLimit(C){this.ctx.miterLimit=C}setDash(C,O){const I=this.ctx;I.setLineDash!==void 0&&(I.setLineDash(C),I.lineDashOffset=O)}setRenderingIntent(C){}setFlatness(C){}setGState(C){for(const[O,I]of C)switch(O){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I[0],I[1]);break;case"CA":this.current.strokeAlpha=I;break;case"ca":this.current.fillAlpha=I,this.ctx.globalAlpha=I;break;case"BM":this.ctx.globalCompositeOperation=I;break;case"SMask":this.current.activeSMask=I?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(I);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const C=this.inSMaskMode;this.current.activeSMask&&!C?this.beginSMaskMode():!this.current.activeSMask&&C&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const C=this.ctx.canvas.width,O=this.ctx.canvas.height,I="smaskGroupAt"+this.groupLevel,M=this.cachedCanvases.getCanvas(I,C,O);this.suspendedCtx=this.ctx,this.ctx=M.context;const H=this.ctx;H.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),k(this.suspendedCtx,H),m(H,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),k(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(C){if(!this.current.activeSMask)return;C?(C[0]=Math.floor(C[0]),C[1]=Math.floor(C[1]),C[2]=Math.ceil(C[2]),C[3]=Math.ceil(C[3])):C=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const O=this.current.activeSMask,I=this.suspendedCtx;Z(I,O,this.ctx,C),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(k(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const C=this.current;this.stateStack.push(C),this.current=C.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),k(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(C,O,I,M,H,G){this.ctx.transform(C,O,I,M,H,G),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(C,O,I){const M=this.ctx,H=this.current;let G=H.x,j=H.y,F,q;const X=(0,i.getCurrentTransform)(M),W=X[0]===0&&X[3]===0||X[1]===0&&X[2]===0,K=W?I.slice(0):null;for(let ae=0,U=0,ve=C.length;ae<ve;ae++)switch(C[ae]|0){case a.OPS.rectangle:G=O[U++],j=O[U++];const be=O[U++],ye=O[U++],_e=G+be,ge=j+ye;M.moveTo(G,j),be===0||ye===0?M.lineTo(_e,ge):(M.lineTo(_e,j),M.lineTo(_e,ge),M.lineTo(G,ge)),W||H.updateRectMinMax(X,[G,j,_e,ge]),M.closePath();break;case a.OPS.moveTo:G=O[U++],j=O[U++],M.moveTo(G,j),W||H.updatePathMinMax(X,G,j);break;case a.OPS.lineTo:G=O[U++],j=O[U++],M.lineTo(G,j),W||H.updatePathMinMax(X,G,j);break;case a.OPS.curveTo:F=G,q=j,G=O[U+4],j=O[U+5],M.bezierCurveTo(O[U],O[U+1],O[U+2],O[U+3],G,j),H.updateCurvePathMinMax(X,F,q,O[U],O[U+1],O[U+2],O[U+3],G,j,K),U+=6;break;case a.OPS.curveTo2:F=G,q=j,M.bezierCurveTo(G,j,O[U],O[U+1],O[U+2],O[U+3]),H.updateCurvePathMinMax(X,F,q,G,j,O[U],O[U+1],O[U+2],O[U+3],K),G=O[U+2],j=O[U+3],U+=4;break;case a.OPS.curveTo3:F=G,q=j,G=O[U+2],j=O[U+3],M.bezierCurveTo(O[U],O[U+1],G,j,G,j),H.updateCurvePathMinMax(X,F,q,O[U],O[U+1],G,j,G,j,K),U+=4;break;case a.OPS.closePath:M.closePath();break}W&&H.updateScalingPathMinMax(X,K),H.setCurrentPoint(G,j)}closePath(){this.ctx.closePath()}stroke(C=!0){const O=this.ctx,I=this.current.strokeColor;O.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof I=="object"&&I?.getPattern?(O.save(),O.strokeStyle=I.getPattern(O,this,(0,i.getCurrentTransformInverse)(O),s.PathType.STROKE),this.rescaleAndStroke(!1),O.restore()):this.rescaleAndStroke(!0)),C&&this.consumePath(this.current.getClippedPathBoundingBox()),O.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(C=!0){const O=this.ctx,I=this.current.fillColor,M=this.current.patternFill;let H=!1;M&&(O.save(),O.fillStyle=I.getPattern(O,this,(0,i.getCurrentTransformInverse)(O),s.PathType.FILL),H=!0);const G=this.current.getClippedPathBoundingBox();this.contentVisible&&G!==null&&(this.pendingEOFill?(O.fill("evenodd"),this.pendingEOFill=!1):O.fill()),H&&O.restore(),C&&this.consumePath(G)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=pe}eoClip(){this.pendingClip=de}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const C=this.pendingTextPaths,O=this.ctx;if(C===void 0){O.beginPath();return}O.save(),O.beginPath();for(const I of C)O.setTransform(...I.transform),O.translate(I.x,I.y),I.addToPath(O,I.fontSize);O.restore(),O.clip(),O.beginPath(),delete this.pendingTextPaths}setCharSpacing(C){this.current.charSpacing=C}setWordSpacing(C){this.current.wordSpacing=C}setHScale(C){this.current.textHScale=C/100}setLeading(C){this.current.leading=-C}setFont(C,O){const I=this.commonObjs.get(C),M=this.current;if(!I)throw new Error(`Can't find font for ${C}`);if(M.fontMatrix=I.fontMatrix||a.FONT_IDENTITY_MATRIX,(M.fontMatrix[0]===0||M.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+C),O<0?(O=-O,M.fontDirection=-1):M.fontDirection=1,this.current.font=I,this.current.fontSize=O,I.isType3Font)return;const H=I.loadedName||"sans-serif",G=I.systemFontInfo?.css||`"${H}", ${I.fallbackName}`;let j="normal";I.black?j="900":I.bold&&(j="bold");const F=I.italic?"italic":"normal";let q=O;O<c?q=c:O>h&&(q=h),this.current.fontSizeScale=O/q,this.ctx.font=`${F} ${j} ${q}px ${G}`}setTextRenderingMode(C){this.current.textRenderingMode=C}setTextRise(C){this.current.textRise=C}moveText(C,O){this.current.x=this.current.lineX+=C,this.current.y=this.current.lineY+=O}setLeadingMoveText(C,O){this.setLeading(-O),this.moveText(C,O)}setTextMatrix(C,O,I,M,H,G){this.current.textMatrix=[C,O,I,M,H,G],this.current.textMatrixScale=Math.hypot(C,O),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(C,O,I,M){const H=this.ctx,G=this.current,j=G.font,F=G.textRenderingMode,q=G.fontSize/G.fontSizeScale,X=F&a.TextRenderingMode.FILL_STROKE_MASK,W=!!(F&a.TextRenderingMode.ADD_TO_PATH_FLAG),K=G.patternFill&&!j.missingFile;let ae;(j.disableFontFace||W||K)&&(ae=j.getPathGenerator(this.commonObjs,C)),j.disableFontFace||K?(H.save(),H.translate(O,I),H.beginPath(),ae(H,q),M&&H.setTransform(...M),(X===a.TextRenderingMode.FILL||X===a.TextRenderingMode.FILL_STROKE)&&H.fill(),(X===a.TextRenderingMode.STROKE||X===a.TextRenderingMode.FILL_STROKE)&&H.stroke(),H.restore()):((X===a.TextRenderingMode.FILL||X===a.TextRenderingMode.FILL_STROKE)&&H.fillText(C,O,I),(X===a.TextRenderingMode.STROKE||X===a.TextRenderingMode.FILL_STROKE)&&H.strokeText(C,O,I)),W&&(this.pendingTextPaths||=[]).push({transform:(0,i.getCurrentTransform)(H),x:O,y:I,fontSize:q,addToPath:ae})}get isFontSubpixelAAEnabled(){const{context:C}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);C.scale(1.5,1),C.fillText("I",0,10);const O=C.getImageData(0,0,10,10).data;let I=!1;for(let M=3;M<O.length;M+=4)if(O[M]>0&&O[M]<255){I=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",I)}showText(C){const O=this.current,I=O.font;if(I.isType3Font)return this.showType3Text(C);const M=O.fontSize;if(M===0)return;const H=this.ctx,G=O.fontSizeScale,j=O.charSpacing,F=O.wordSpacing,q=O.fontDirection,X=O.textHScale*q,W=C.length,K=I.vertical,ae=K?1:-1,U=I.defaultVMetrics,ve=M*O.fontMatrix[0],be=O.textRenderingMode===a.TextRenderingMode.FILL&&!I.disableFontFace&&!O.patternFill;H.save(),H.transform(...O.textMatrix),H.translate(O.x,O.y+O.textRise),q>0?H.scale(X,-1):H.scale(X,1);let ye;if(O.patternFill){H.save();const We=O.fillColor.getPattern(H,this,(0,i.getCurrentTransformInverse)(H),s.PathType.FILL);ye=(0,i.getCurrentTransform)(H),H.restore(),H.fillStyle=We}let _e=O.lineWidth;const ge=O.textMatrixScale;if(ge===0||_e===0){const We=O.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(We===a.TextRenderingMode.STROKE||We===a.TextRenderingMode.FILL_STROKE)&&(_e=this.getSinglePixelWidth())}else _e/=ge;if(G!==1&&(H.scale(G,G),_e/=G),H.lineWidth=_e,I.isInvalidPDFjsFont){const We=[];let ze=0;for(const Je of C)We.push(Je.unicode),ze+=Je.width;H.fillText(We.join(""),0,0),O.x+=ze*ve*X,H.restore(),this.compose();return}let Re=0,De;for(De=0;De<W;++De){const We=C[De];if(typeof We=="number"){Re+=ae*We*M/1e3;continue}let ze=!1;const Je=(We.isSpace?F:0)+j,Qe=We.fontChar,et=We.accent;let st,vt,xt=We.width;if(K){const ft=We.vmetric||U,tt=-(We.vmetric?ft[1]:xt*.5)*ve,ut=ft[2]*ve;xt=ft?-ft[0]:xt,st=tt/G,vt=(Re+ut)/G}else st=Re/G,vt=0;if(I.remeasure&&xt>0){const ft=H.measureText(Qe).width*1e3/M*G;if(xt<ft&&this.isFontSubpixelAAEnabled){const tt=xt/ft;ze=!0,H.save(),H.scale(tt,1),st/=tt}else xt!==ft&&(st+=(xt-ft)/2e3*M/G)}if(this.contentVisible&&(We.isInFont||I.missingFile)){if(be&&!et)H.fillText(Qe,st,vt);else if(this.paintChar(Qe,st,vt,ye),et){const ft=st+M*et.offset.x/G,tt=vt-M*et.offset.y/G;this.paintChar(et.fontChar,ft,tt,ye)}}const ht=K?xt*ve-Je*q:xt*ve+Je*q;Re+=ht,ze&&H.restore()}K?O.y-=Re:O.x+=Re*X,H.restore(),this.compose()}showType3Text(C){const O=this.ctx,I=this.current,M=I.font,H=I.fontSize,G=I.fontDirection,j=M.vertical?1:-1,F=I.charSpacing,q=I.wordSpacing,X=I.textHScale*G,W=I.fontMatrix||a.FONT_IDENTITY_MATRIX,K=C.length,ae=I.textRenderingMode===a.TextRenderingMode.INVISIBLE;let U,ve,be,ye;if(!(ae||H===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,O.save(),O.transform(...I.textMatrix),O.translate(I.x,I.y),O.scale(X,G),U=0;U<K;++U){if(ve=C[U],typeof ve=="number"){ye=j*ve*H/1e3,this.ctx.translate(ye,0),I.x+=ye*X;continue}const _e=(ve.isSpace?q:0)+F,ge=M.charProcOperatorList[ve.operatorListId];if(!ge){(0,a.warn)(`Type3 character "${ve.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=ve,this.save(),O.scale(H,H),O.transform(...W),this.executeOperatorList(ge),this.restore()),be=a.Util.applyTransform([ve.width,0],W)[0]*H+_e,O.translate(be,0),I.x+=be*X}O.restore(),this.processingType3=null}}setCharWidth(C,O){}setCharWidthAndBounds(C,O,I,M,H,G){this.ctx.rect(I,M,H-I,G-M),this.ctx.clip(),this.endPath()}getColorN_Pattern(C){let O;if(C[0]==="TilingPattern"){const I=C[1],M=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),H={createCanvasGraphics:G=>new J(G,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};O=new s.TilingPattern(C,I,this.ctx,H,M)}else O=this._getPattern(C[1],C[2]);return O}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(C,O,I){const M=a.Util.makeHexColor(C,O,I);this.ctx.strokeStyle=M,this.current.strokeColor=M}setFillRGBColor(C,O,I){const M=a.Util.makeHexColor(C,O,I);this.ctx.fillStyle=M,this.current.fillColor=M,this.current.patternFill=!1}_getPattern(C,O=null){let I;return this.cachedPatterns.has(C)?I=this.cachedPatterns.get(C):(I=(0,s.getShadingPattern)(this.getObject(C)),this.cachedPatterns.set(C,I)),O&&(I.matrix=O),I}shadingFill(C){if(!this.contentVisible)return;const O=this.ctx;this.save();const I=this._getPattern(C);O.fillStyle=I.getPattern(O,this,(0,i.getCurrentTransformInverse)(O),s.PathType.SHADING);const M=(0,i.getCurrentTransformInverse)(O);if(M){const{width:H,height:G}=O.canvas,[j,F,q,X]=a.Util.getAxialAlignedBoundingBox([0,0,H,G],M);this.ctx.fillRect(j,F,q-j,X-F)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(C,O){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(C)&&C.length===6&&this.transform(...C),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),O)){const I=O[2]-O[0],M=O[3]-O[1];this.ctx.rect(O[0],O[1],I,M),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),O),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(C){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const O=this.ctx;C.isolated||(0,a.info)("TODO: Support non-isolated groups."),C.knockout&&(0,a.warn)("Knockout groups not supported.");const I=(0,i.getCurrentTransform)(O);if(C.matrix&&O.transform(...C.matrix),!C.bbox)throw new Error("Bounding box is required.");let M=a.Util.getAxialAlignedBoundingBox(C.bbox,(0,i.getCurrentTransform)(O));const H=[0,0,O.canvas.width,O.canvas.height];M=a.Util.intersect(M,H)||[0,0,0,0];const G=Math.floor(M[0]),j=Math.floor(M[1]);let F=Math.max(Math.ceil(M[2])-G,1),q=Math.max(Math.ceil(M[3])-j,1),X=1,W=1;F>f&&(X=F/f,F=f),q>f&&(W=q/f,q=f),this.current.startNewPathAndClipBox([0,0,F,q]);let K="groupAt"+this.groupLevel;C.smask&&(K+="_smask_"+this.smaskCounter++%2);const ae=this.cachedCanvases.getCanvas(K,F,q),U=ae.context;U.scale(1/X,1/W),U.translate(-G,-j),U.transform(...I),C.smask?this.smaskStack.push({canvas:ae.canvas,context:U,offsetX:G,offsetY:j,scaleX:X,scaleY:W,subtype:C.smask.subtype,backdrop:C.smask.backdrop,transferMap:C.smask.transferMap||null,startTransformInverse:null}):(O.setTransform(1,0,0,1,0,0),O.translate(G,j),O.scale(X,W),O.save()),k(O,U),this.ctx=U,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(O),this.groupLevel++}endGroup(C){if(!this.contentVisible)return;this.groupLevel--;const O=this.ctx,I=this.groupStack.pop();if(this.ctx=I,this.ctx.imageSmoothingEnabled=!1,C.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const M=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...M);const H=a.Util.getAxialAlignedBoundingBox([0,0,O.canvas.width,O.canvas.height],M);this.ctx.drawImage(O.canvas,0,0),this.ctx.restore(),this.compose(H)}}beginAnnotation(C,O,I,M,H){if(this.#e(),D(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(O)&&O.length===4){const G=O[2]-O[0],j=O[3]-O[1];if(H&&this.annotationCanvasMap){I=I.slice(),I[4]-=O[0],I[5]-=O[1],O=O.slice(),O[0]=O[1]=0,O[2]=G,O[3]=j;const[F,q]=a.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:X}=this,W=Math.ceil(G*this.outputScaleX*X),K=Math.ceil(j*this.outputScaleY*X);this.annotationCanvas=this.canvasFactory.create(W,K);const{canvas:ae,context:U}=this.annotationCanvas;this.annotationCanvasMap.set(C,ae),this.annotationCanvas.savedCtx=this.ctx,this.ctx=U,this.ctx.save(),this.ctx.setTransform(F,0,0,-q,0,j*q),D(this.ctx)}else D(this.ctx),this.ctx.rect(O[0],O[1],G,j),this.ctx.clip(),this.endPath()}this.current=new T(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...I),this.transform(...M)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(C){if(!this.contentVisible)return;const O=C.count;C=this.getObject(C.data,C),C.count=O;const I=this.ctx,M=this.processingType3;if(M&&(M.compiled===void 0&&(M.compiled=w(C)),M.compiled)){M.compiled(I);return}const H=this._createMaskCanvas(C),G=H.canvas;I.save(),I.setTransform(1,0,0,1,0,0),I.drawImage(G,H.offsetX,H.offsetY),I.restore(),this.compose()}paintImageMaskXObjectRepeat(C,O,I=0,M=0,H,G){if(!this.contentVisible)return;C=this.getObject(C.data,C);const j=this.ctx;j.save();const F=(0,i.getCurrentTransform)(j);j.transform(O,I,M,H,0,0);const q=this._createMaskCanvas(C);j.setTransform(1,0,0,1,q.offsetX-F[4],q.offsetY-F[5]);for(let X=0,W=G.length;X<W;X+=2){const K=a.Util.transform(F,[O,I,M,H,G[X],G[X+1]]),[ae,U]=a.Util.applyTransform([0,0],K);j.drawImage(q.canvas,ae,U)}j.restore(),this.compose()}paintImageMaskXObjectGroup(C){if(!this.contentVisible)return;const O=this.ctx,I=this.current.fillColor,M=this.current.patternFill;for(const H of C){const{data:G,width:j,height:F,transform:q}=H,X=this.cachedCanvases.getCanvas("maskCanvas",j,F),W=X.context;W.save();const K=this.getObject(G,H);L(W,K),W.globalCompositeOperation="source-in",W.fillStyle=M?I.getPattern(W,this,(0,i.getCurrentTransformInverse)(O),s.PathType.FILL):I,W.fillRect(0,0,j,F),W.restore(),O.save(),O.transform(...q),O.scale(1,-1),E(O,X.canvas,0,0,j,F,0,-1,1,1),O.restore()}this.compose()}paintImageXObject(C){if(!this.contentVisible)return;const O=this.getObject(C);if(!O){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(O)}paintImageXObjectRepeat(C,O,I,M){if(!this.contentVisible)return;const H=this.getObject(C);if(!H){(0,a.warn)("Dependent image isn't ready yet");return}const G=H.width,j=H.height,F=[];for(let q=0,X=M.length;q<X;q+=2)F.push({transform:[O,0,0,I,M[q],M[q+1]],x:0,y:0,w:G,h:j});this.paintInlineImageXObjectGroup(H,F)}applyTransferMapsToCanvas(C){return this.current.transferMaps!=="none"&&(C.filter=this.current.transferMaps,C.drawImage(C.canvas,0,0),C.filter="none"),C.canvas}applyTransferMapsToBitmap(C){if(this.current.transferMaps==="none")return C.bitmap;const{bitmap:O,width:I,height:M}=C,H=this.cachedCanvases.getCanvas("inlineImage",I,M),G=H.context;return G.filter=this.current.transferMaps,G.drawImage(O,0,0),G.filter="none",H.canvas}paintInlineImageXObject(C){if(!this.contentVisible)return;const O=C.width,I=C.height,M=this.ctx;if(this.save(),!a.isNodeJS){const{filter:j}=M;j!=="none"&&j!==""&&(M.filter="none")}M.scale(1/O,-1/I);let H;if(C.bitmap)H=this.applyTransferMapsToBitmap(C);else if(typeof HTMLElement=="function"&&C instanceof HTMLElement||!C.data)H=C;else{const F=this.cachedCanvases.getCanvas("inlineImage",O,I).context;A(F,C),H=this.applyTransferMapsToCanvas(F)}const G=this._scaleImage(H,(0,i.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=ne((0,i.getCurrentTransform)(M),C.interpolate),E(M,G.img,0,0,G.paintWidth,G.paintHeight,0,-I,O,I),this.compose(),this.restore()}paintInlineImageXObjectGroup(C,O){if(!this.contentVisible)return;const I=this.ctx;let M;if(C.bitmap)M=C.bitmap;else{const H=C.width,G=C.height,F=this.cachedCanvases.getCanvas("inlineImage",H,G).context;A(F,C),M=this.applyTransferMapsToCanvas(F)}for(const H of O)I.save(),I.transform(...H.transform),I.scale(1,-1),E(I,M,H.x,H.y,H.w,H.h,0,-1,1,1),I.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(C){}markPointProps(C,O){}beginMarkedContent(C){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(C,O){C==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(O)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(C){const O=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(C);const I=this.ctx;this.pendingClip&&(O||(this.pendingClip===de?I.clip("evenodd"):I.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),I.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const C=(0,i.getCurrentTransform)(this.ctx);if(C[1]===0&&C[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(C[0]),Math.abs(C[3]));else{const O=Math.abs(C[0]*C[3]-C[2]*C[1]),I=Math.hypot(C[0],C[2]),M=Math.hypot(C[1],C[3]);this._cachedGetSinglePixelWidth=Math.max(I,M)/O}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:C}=this.current,{a:O,b:I,c:M,d:H}=this.ctx.getTransform();let G,j;if(I===0&&M===0){const F=Math.abs(O),q=Math.abs(H);if(F===q)if(C===0)G=j=1/F;else{const X=F*C;G=j=X<1?1/X:1}else if(C===0)G=1/F,j=1/q;else{const X=F*C,W=q*C;G=X<1?1/X:1,j=W<1?1/W:1}}else{const F=Math.abs(O*H-I*M),q=Math.hypot(O,I),X=Math.hypot(M,H);if(C===0)G=X/F,j=q/F;else{const W=C*F;G=X>W?X/W:1,j=q>W?q/W:1}}this._cachedScaleForStroking[0]=G,this._cachedScaleForStroking[1]=j}return this._cachedScaleForStroking}rescaleAndStroke(C){const{ctx:O}=this,{lineWidth:I}=this.current,[M,H]=this.getScaleForStroking();if(O.lineWidth=I||1,M===1&&H===1){O.stroke();return}const G=O.getLineDash();if(C&&O.save(),O.scale(M,H),G.length>0){const j=Math.max(M,H);O.setLineDash(G.map(F=>F/j)),O.lineDashOffset/=j}O.stroke(),C&&O.restore()}isContentVisible(){for(let C=this.markedContentStack.length-1;C>=0;C--)if(!this.markedContentStack[C].visible)return!1;return!0}}t.CanvasGraphics=J;for(const V in a.OPS)J.prototype[V]!==void 0&&(J.prototype[a.OPS[V]]=J.prototype[V])}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=v;var a=n(1),i=n(6);const s={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=s;function o(E,w){if(!w)return;const T=w[2]-w[0],A=w[3]-w[1],L=new Path2D;L.rect(w[0],w[1],T,A),E.clip(L)}class c{constructor(){this.constructor===c&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class h extends c{constructor(w){super(),this._type=w[1],this._bbox=w[2],this._colorStops=w[3],this._p0=w[4],this._p1=w[5],this._r0=w[6],this._r1=w[7],this.matrix=null}_createGradient(w){let T;this._type==="axial"?T=w.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(T=w.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)T.addColorStop(A[0],A[1]);return T}getPattern(w,T,A,L){let k;if(L===s.STROKE||L===s.FILL){const D=T.current.getClippedPathBoundingBox(L,(0,i.getCurrentTransform)(w))||[0,0,0,0],N=Math.ceil(D[2]-D[0])||1,Y=Math.ceil(D[3]-D[1])||1,z=T.cachedCanvases.getCanvas("pattern",N,Y,!0),te=z.context;te.clearRect(0,0,te.canvas.width,te.canvas.height),te.beginPath(),te.rect(0,0,te.canvas.width,te.canvas.height),te.translate(-D[0],-D[1]),A=a.Util.transform(A,[1,0,0,1,D[0],D[1]]),te.transform(...T.baseTransform),this.matrix&&te.transform(...this.matrix),o(te,this._bbox),te.fillStyle=this._createGradient(te),te.fill(),k=w.createPattern(z.canvas,"no-repeat");const Z=new DOMMatrix(A);k.setTransform(Z)}else o(w,this._bbox),k=this._createGradient(w);return k}}function f(E,w,T,A,L,k,D,N){const Y=w.coords,z=w.colors,te=E.data,Z=E.width*4;let ne;Y[T+1]>Y[A+1]&&(ne=T,T=A,A=ne,ne=k,k=D,D=ne),Y[A+1]>Y[L+1]&&(ne=A,A=L,L=ne,ne=D,D=N,N=ne),Y[T+1]>Y[A+1]&&(ne=T,T=A,A=ne,ne=k,k=D,D=ne);const oe=(Y[T]+w.offsetX)*w.scaleX,le=(Y[T+1]+w.offsetY)*w.scaleY,pe=(Y[A]+w.offsetX)*w.scaleX,de=(Y[A+1]+w.offsetY)*w.scaleY,J=(Y[L]+w.offsetX)*w.scaleX,V=(Y[L+1]+w.offsetY)*w.scaleY;if(le>=V)return;const C=z[k],O=z[k+1],I=z[k+2],M=z[D],H=z[D+1],G=z[D+2],j=z[N],F=z[N+1],q=z[N+2],X=Math.round(le),W=Math.round(V);let K,ae,U,ve,be,ye,_e,ge;for(let Re=X;Re<=W;Re++){if(Re<de){const Qe=Re<le?0:(le-Re)/(le-de);K=oe-(oe-pe)*Qe,ae=C-(C-M)*Qe,U=O-(O-H)*Qe,ve=I-(I-G)*Qe}else{let Qe;Re>V?Qe=1:de===V?Qe=0:Qe=(de-Re)/(de-V),K=pe-(pe-J)*Qe,ae=M-(M-j)*Qe,U=H-(H-F)*Qe,ve=G-(G-q)*Qe}let De;Re<le?De=0:Re>V?De=1:De=(le-Re)/(le-V),be=oe-(oe-J)*De,ye=C-(C-j)*De,_e=O-(O-F)*De,ge=I-(I-q)*De;const We=Math.round(Math.min(K,be)),ze=Math.round(Math.max(K,be));let Je=Z*Re+We*4;for(let Qe=We;Qe<=ze;Qe++)De=(K-Qe)/(K-be),De<0?De=0:De>1&&(De=1),te[Je++]=ae-(ae-ye)*De|0,te[Je++]=U-(U-_e)*De|0,te[Je++]=ve-(ve-ge)*De|0,te[Je++]=255}}function u(E,w,T){const A=w.coords,L=w.colors;let k,D;switch(w.type){case"lattice":const N=w.verticesPerRow,Y=Math.floor(A.length/N)-1,z=N-1;for(k=0;k<Y;k++){let te=k*N;for(let Z=0;Z<z;Z++,te++)f(E,T,A[te],A[te+1],A[te+N],L[te],L[te+1],L[te+N]),f(E,T,A[te+N+1],A[te+1],A[te+N],L[te+N+1],L[te+1],L[te+N])}break;case"triangles":for(k=0,D=A.length;k<D;k+=3)f(E,T,A[k],A[k+1],A[k+2],L[k],L[k+1],L[k+2]);break;default:throw new Error("illegal figure")}}class p extends c{constructor(w){super(),this._coords=w[2],this._colors=w[3],this._figures=w[4],this._bounds=w[5],this._bbox=w[7],this._background=w[8],this.matrix=null}_createMeshCanvas(w,T,A){const N=Math.floor(this._bounds[0]),Y=Math.floor(this._bounds[1]),z=Math.ceil(this._bounds[2])-N,te=Math.ceil(this._bounds[3])-Y,Z=Math.min(Math.ceil(Math.abs(z*w[0]*1.1)),3e3),ne=Math.min(Math.ceil(Math.abs(te*w[1]*1.1)),3e3),oe=z/Z,le=te/ne,pe={coords:this._coords,colors:this._colors,offsetX:-N,offsetY:-Y,scaleX:1/oe,scaleY:1/le},de=Z+4,J=ne+4,V=A.getCanvas("mesh",de,J,!1),C=V.context,O=C.createImageData(Z,ne);if(T){const M=O.data;for(let H=0,G=M.length;H<G;H+=4)M[H]=T[0],M[H+1]=T[1],M[H+2]=T[2],M[H+3]=255}for(const M of this._figures)u(O,M,pe);return C.putImageData(O,2,2),{canvas:V.canvas,offsetX:N-2*oe,offsetY:Y-2*le,scaleX:oe,scaleY:le}}getPattern(w,T,A,L){o(w,this._bbox);let k;if(L===s.SHADING)k=a.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(w));else if(k=a.Util.singularValueDecompose2dScale(T.baseTransform),this.matrix){const N=a.Util.singularValueDecompose2dScale(this.matrix);k=[k[0]*N[0],k[1]*N[1]]}const D=this._createMeshCanvas(k,L===s.SHADING?null:this._background,T.cachedCanvases);return L!==s.SHADING&&(w.setTransform(...T.baseTransform),this.matrix&&w.transform(...this.matrix)),w.translate(D.offsetX,D.offsetY),w.scale(D.scaleX,D.scaleY),w.createPattern(D.canvas,"no-repeat")}}class g extends c{getPattern(){return"hotpink"}}function v(E){switch(E[0]){case"RadialAxial":return new h(E);case"Mesh":return new p(E);case"Dummy":return new g}throw new Error(`Unknown IR type: ${E[0]}`)}const m={COLORED:1,UNCOLORED:2};class S{static MAX_PATTERN_SIZE=3e3;constructor(w,T,A,L,k){this.operatorList=w[2],this.matrix=w[3]||[1,0,0,1,0,0],this.bbox=w[4],this.xstep=w[5],this.ystep=w[6],this.paintType=w[7],this.tilingType=w[8],this.color=T,this.ctx=A,this.canvasGraphicsFactory=L,this.baseTransform=k}createPatternCanvas(w){const T=this.operatorList,A=this.bbox,L=this.xstep,k=this.ystep,D=this.paintType,N=this.tilingType,Y=this.color,z=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+N);const te=A[0],Z=A[1],ne=A[2],oe=A[3],le=a.Util.singularValueDecompose2dScale(this.matrix),pe=a.Util.singularValueDecompose2dScale(this.baseTransform),de=[le[0]*pe[0],le[1]*pe[1]],J=this.getSizeAndScale(L,this.ctx.canvas.width,de[0]),V=this.getSizeAndScale(k,this.ctx.canvas.height,de[1]),C=w.cachedCanvases.getCanvas("pattern",J.size,V.size,!0),O=C.context,I=z.createCanvasGraphics(O);I.groupLevel=w.groupLevel,this.setFillAndStrokeStyleToContext(I,D,Y);let M=te,H=Z,G=ne,j=oe;return te<0&&(M=0,G+=Math.abs(te)),Z<0&&(H=0,j+=Math.abs(Z)),O.translate(-(J.scale*M),-(V.scale*H)),I.transform(J.scale,0,0,V.scale,0,0),O.save(),this.clipBbox(I,M,H,G,j),I.baseTransform=(0,i.getCurrentTransform)(I.ctx),I.executeOperatorList(T),I.endDrawing(),{canvas:C.canvas,scaleX:J.scale,scaleY:V.scale,offsetX:M,offsetY:H}}getSizeAndScale(w,T,A){w=Math.abs(w);const L=Math.max(S.MAX_PATTERN_SIZE,T);let k=Math.ceil(w*A);return k>=L?k=L:A=k/w,{scale:A,size:k}}clipBbox(w,T,A,L,k){const D=L-T,N=k-A;w.ctx.rect(T,A,D,N),w.current.updateRectMinMax((0,i.getCurrentTransform)(w.ctx),[T,A,L,k]),w.clip(),w.endPath()}setFillAndStrokeStyleToContext(w,T,A){const L=w.ctx,k=w.current;switch(T){case m.COLORED:const D=this.ctx;L.fillStyle=D.fillStyle,L.strokeStyle=D.strokeStyle,k.fillColor=D.fillStyle,k.strokeColor=D.strokeStyle;break;case m.UNCOLORED:const N=a.Util.makeHexColor(A[0],A[1],A[2]);L.fillStyle=N,L.strokeStyle=N,k.fillColor=N,k.strokeColor=N;break;default:throw new a.FormatError(`Unsupported paint type: ${T}`)}}getPattern(w,T,A,L){let k=A;L!==s.SHADING&&(k=a.Util.transform(k,T.baseTransform),this.matrix&&(k=a.Util.transform(k,this.matrix)));const D=this.createPatternCanvas(T);let N=new DOMMatrix(k);N=N.translate(D.offsetX,D.offsetY),N=N.scale(1/D.scaleX,1/D.scaleY);const Y=w.createPattern(D.canvas,"repeat");return Y.setTransform(N),Y}}t.TilingPattern=S}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=s,t.convertToRGBA=i,t.grayToRGBA=c;var a=n(1);function i(h){switch(h.kind){case a.ImageKind.GRAYSCALE_1BPP:return s(h);case a.ImageKind.RGB_24BPP:return o(h)}return null}function s({src:h,srcPos:f=0,dest:u,width:p,height:g,nonBlackColor:v=4294967295,inverseDecode:m=!1}){const S=a.FeatureTest.isLittleEndian?4278190080:255,[E,w]=m?[v,S]:[S,v],T=p>>3,A=p&7,L=h.length;u=new Uint32Array(u.buffer);let k=0;for(let D=0;D<g;D++){for(const Y=f+T;f<Y;f++){const z=f<L?h[f]:255;u[k++]=z&128?w:E,u[k++]=z&64?w:E,u[k++]=z&32?w:E,u[k++]=z&16?w:E,u[k++]=z&8?w:E,u[k++]=z&4?w:E,u[k++]=z&2?w:E,u[k++]=z&1?w:E}if(A===0)continue;const N=f<L?h[f++]:255;for(let Y=0;Y<A;Y++)u[k++]=N&1<<7-Y?w:E}return{srcPos:f,destPos:k}}function o({src:h,srcPos:f=0,dest:u,destPos:p=0,width:g,height:v}){let m=0;const S=h.length>>2,E=new Uint32Array(h.buffer,f,S);if(a.FeatureTest.isLittleEndian){for(;m<S-2;m+=3,p+=4){const w=E[m],T=E[m+1],A=E[m+2];u[p]=w|4278190080,u[p+1]=w>>>24|T<<8|4278190080,u[p+2]=T>>>16|A<<16|4278190080,u[p+3]=A>>>8|4278190080}for(let w=m*4,T=h.length;w<T;w+=3)u[p++]=h[w]|h[w+1]<<8|h[w+2]<<16|4278190080}else{for(;m<S-2;m+=3,p+=4){const w=E[m],T=E[m+1],A=E[m+2];u[p]=w|255,u[p+1]=w<<24|T>>>8|255,u[p+2]=T<<16|A>>>16|255,u[p+3]=A<<8|255}for(let w=m*4,T=h.length;w<T;w+=3)u[p++]=h[w]<<24|h[w+1]<<16|h[w+2]<<8|255}return{srcPos:f,destPos:p}}function c(h,f){if(a.FeatureTest.isLittleEndian)for(let u=0,p=h.length;u<p;u++)f[u]=h[u]*65793|4278190080;else for(let u=0,p=h.length;u<p;u++)f[u]=h[u]*16843008|255}}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const n=Object.create(null);t.GlobalWorkerOptions=n,n.workerPort=null,n.workerSrc=""}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var a=n(1);const i={DATA:1,ERROR:2},s={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function o(h){switch(h instanceof Error||typeof h=="object"&&h!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new a.AbortException(h.message);case"MissingPDFException":return new a.MissingPDFException(h.message);case"PasswordException":return new a.PasswordException(h.message,h.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(h.message,h.status);case"UnknownErrorException":return new a.UnknownErrorException(h.message,h.details);default:return new a.UnknownErrorException(h.message,h.toString())}}class c{constructor(f,u,p){this.sourceName=f,this.targetName=u,this.comObj=p,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const v=g.data;if(v.targetName!==this.sourceName)return;if(v.stream){this.#t(v);return}if(v.callback){const S=v.callbackId,E=this.callbackCapabilities[S];if(!E)throw new Error(`Cannot resolve callback ${S}`);if(delete this.callbackCapabilities[S],v.callback===i.DATA)E.resolve(v.data);else if(v.callback===i.ERROR)E.reject(o(v.reason));else throw new Error("Unexpected callback case");return}const m=this.actionHandler[v.action];if(!m)throw new Error(`Unknown action from worker: ${v.action}`);if(v.callbackId){const S=this.sourceName,E=v.sourceName;new Promise(function(w){w(m(v.data))}).then(function(w){p.postMessage({sourceName:S,targetName:E,callback:i.DATA,callbackId:v.callbackId,data:w})},function(w){p.postMessage({sourceName:S,targetName:E,callback:i.ERROR,callbackId:v.callbackId,reason:o(w)})});return}if(v.streamId){this.#e(v);return}m(v.data)},p.addEventListener("message",this._onComObjOnMessage)}on(f,u){const p=this.actionHandler;if(p[f])throw new Error(`There is already an actionName called "${f}"`);p[f]=u}send(f,u,p){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:u},p)}sendWithPromise(f,u,p){const g=this.callbackId++,v=new a.PromiseCapability;this.callbackCapabilities[g]=v;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:g,data:u},p)}catch(m){v.reject(m)}return v.promise}sendWithStream(f,u,p,g){const v=this.streamId++,m=this.sourceName,S=this.targetName,E=this.comObj;return new ReadableStream({start:w=>{const T=new a.PromiseCapability;return this.streamControllers[v]={controller:w,startCall:T,pullCall:null,cancelCall:null,isClosed:!1},E.postMessage({sourceName:m,targetName:S,action:f,streamId:v,data:u,desiredSize:w.desiredSize},g),T.promise},pull:w=>{const T=new a.PromiseCapability;return this.streamControllers[v].pullCall=T,E.postMessage({sourceName:m,targetName:S,stream:s.PULL,streamId:v,desiredSize:w.desiredSize}),T.promise},cancel:w=>{(0,a.assert)(w instanceof Error,"cancel must have a valid reason");const T=new a.PromiseCapability;return this.streamControllers[v].cancelCall=T,this.streamControllers[v].isClosed=!0,E.postMessage({sourceName:m,targetName:S,stream:s.CANCEL,streamId:v,reason:o(w)}),T.promise}},p)}#e(f){const u=f.streamId,p=this.sourceName,g=f.sourceName,v=this.comObj,m=this,S=this.actionHandler[f.action],E={enqueue(w,T=1,A){if(this.isCancelled)return;const L=this.desiredSize;this.desiredSize-=T,L>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),v.postMessage({sourceName:p,targetName:g,stream:s.ENQUEUE,streamId:u,chunk:w},A)},close(){this.isCancelled||(this.isCancelled=!0,v.postMessage({sourceName:p,targetName:g,stream:s.CLOSE,streamId:u}),delete m.streamSinks[u])},error(w){(0,a.assert)(w instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,v.postMessage({sourceName:p,targetName:g,stream:s.ERROR,streamId:u,reason:o(w)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};E.sinkCapability.resolve(),E.ready=E.sinkCapability.promise,this.streamSinks[u]=E,new Promise(function(w){w(S(f.data,E))}).then(function(){v.postMessage({sourceName:p,targetName:g,stream:s.START_COMPLETE,streamId:u,success:!0})},function(w){v.postMessage({sourceName:p,targetName:g,stream:s.START_COMPLETE,streamId:u,reason:o(w)})})}#t(f){const u=f.streamId,p=this.sourceName,g=f.sourceName,v=this.comObj,m=this.streamControllers[u],S=this.streamSinks[u];switch(f.stream){case s.START_COMPLETE:f.success?m.startCall.resolve():m.startCall.reject(o(f.reason));break;case s.PULL_COMPLETE:f.success?m.pullCall.resolve():m.pullCall.reject(o(f.reason));break;case s.PULL:if(!S){v.postMessage({sourceName:p,targetName:g,stream:s.PULL_COMPLETE,streamId:u,success:!0});break}S.desiredSize<=0&&f.desiredSize>0&&S.sinkCapability.resolve(),S.desiredSize=f.desiredSize,new Promise(function(E){E(S.onPull?.())}).then(function(){v.postMessage({sourceName:p,targetName:g,stream:s.PULL_COMPLETE,streamId:u,success:!0})},function(E){v.postMessage({sourceName:p,targetName:g,stream:s.PULL_COMPLETE,streamId:u,reason:o(E)})});break;case s.ENQUEUE:if((0,a.assert)(m,"enqueue should have stream controller"),m.isClosed)break;m.controller.enqueue(f.chunk);break;case s.CLOSE:if((0,a.assert)(m,"close should have stream controller"),m.isClosed)break;m.isClosed=!0,m.controller.close(),this.#r(m,u);break;case s.ERROR:(0,a.assert)(m,"error should have stream controller"),m.controller.error(o(f.reason)),this.#r(m,u);break;case s.CANCEL_COMPLETE:f.success?m.cancelCall.resolve():m.cancelCall.reject(o(f.reason)),this.#r(m,u);break;case s.CANCEL:if(!S)break;new Promise(function(E){E(S.onCancel?.(o(f.reason)))}).then(function(){v.postMessage({sourceName:p,targetName:g,stream:s.CANCEL_COMPLETE,streamId:u,success:!0})},function(E){v.postMessage({sourceName:p,targetName:g,stream:s.CANCEL_COMPLETE,streamId:u,reason:o(E)})}),S.sinkCapability.reject(o(f.reason)),S.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}}async#r(f,u){await Promise.allSettled([f.startCall?.promise,f.pullCall?.promise,f.cancelCall?.promise]),delete this.streamControllers[u]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}t.MessageHandler=c}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var a=n(1);class i{#e;#t;constructor({parsedData:o,rawData:c}){this.#e=o,this.#t=c}getRaw(){return this.#t}get(o){return this.#e.get(o)??null}getAll(){return(0,a.objectFromMap)(this.#e)}has(o){return this.#e.has(o)}}t.Metadata=i}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var a=n(1),i=n(8);const s=Symbol("INTERNAL");class o{#e=!0;constructor(f,u){this.name=f,this.intent=u}get visible(){return this.#e}_setVisible(f,u){f!==s&&(0,a.unreachable)("Internal method `_setVisible` called."),this.#e=u}}class c{#e=null;#t=new Map;#r=null;#n=null;constructor(f){if(this.name=null,this.creator=null,f!==null){this.name=f.name,this.creator=f.creator,this.#n=f.order;for(const u of f.groups)this.#t.set(u.id,new o(u.name,u.intent));if(f.baseState==="OFF")for(const u of this.#t.values())u._setVisible(s,!1);for(const u of f.on)this.#t.get(u)._setVisible(s,!0);for(const u of f.off)this.#t.get(u)._setVisible(s,!1);this.#r=this.getHash()}}#o(f){const u=f.length;if(u<2)return!0;const p=f[0];for(let g=1;g<u;g++){const v=f[g];let m;if(Array.isArray(v))m=this.#o(v);else if(this.#t.has(v))m=this.#t.get(v).visible;else return(0,a.warn)(`Optional content group not found: ${v}`),!0;switch(p){case"And":if(!m)return!1;break;case"Or":if(m)return!0;break;case"Not":return!m;default:return!0}}return p==="And"}isVisible(f){if(this.#t.size===0)return!0;if(!f)return(0,a.warn)("Optional content group not defined."),!0;if(f.type==="OCG")return this.#t.has(f.id)?this.#t.get(f.id).visible:((0,a.warn)(`Optional content group not found: ${f.id}`),!0);if(f.type==="OCMD"){if(f.expression)return this.#o(f.expression);if(!f.policy||f.policy==="AnyOn"){for(const u of f.ids){if(!this.#t.has(u))return(0,a.warn)(`Optional content group not found: ${u}`),!0;if(this.#t.get(u).visible)return!0}return!1}else if(f.policy==="AllOn"){for(const u of f.ids){if(!this.#t.has(u))return(0,a.warn)(`Optional content group not found: ${u}`),!0;if(!this.#t.get(u).visible)return!1}return!0}else if(f.policy==="AnyOff"){for(const u of f.ids){if(!this.#t.has(u))return(0,a.warn)(`Optional content group not found: ${u}`),!0;if(!this.#t.get(u).visible)return!0}return!1}else if(f.policy==="AllOff"){for(const u of f.ids){if(!this.#t.has(u))return(0,a.warn)(`Optional content group not found: ${u}`),!0;if(this.#t.get(u).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${f.policy}.`),!0}return(0,a.warn)(`Unknown group type ${f.type}.`),!0}setVisibility(f,u=!0){if(!this.#t.has(f)){(0,a.warn)(`Optional content group not found: ${f}`);return}this.#t.get(f)._setVisible(s,!!u),this.#e=null}get hasInitialVisibility(){return this.#r===null||this.getHash()===this.#r}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,a.objectFromMap)(this.#t):null}getGroup(f){return this.#t.get(f)||null}getHash(){if(this.#e!==null)return this.#e;const f=new i.MurmurHash3_64;for(const[u,p]of this.#t)f.update(`${u}:${p.visible}`);return this.#e=f.hexdigest()}}t.OptionalContentConfig=c}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var a=n(1),i=n(6);class s{constructor({length:f,initialData:u,progressiveDone:p=!1,contentDispositionFilename:g=null,disableRange:v=!1,disableStream:m=!1},S){if((0,a.assert)(S,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=p,this._contentDispositionFilename=g,u?.length>0){const E=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=S,this._isStreamingSupported=!m,this._isRangeSupported=!v,this._contentLength=f,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((E,w)=>{this._onReceiveData({begin:E,chunk:w})}),this._pdfDataRangeTransport.addProgressListener((E,w)=>{this._onProgress({loaded:E,total:w})}),this._pdfDataRangeTransport.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:f,chunk:u}){const p=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;if(f===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const g=this._rangeReaders.some(function(v){return v._begin!==f?!1:(v._enqueue(p),!0)});(0,a.assert)(g,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(f){f.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:f.loaded}):this._fullRequestReader?.onProgress?.({loaded:f.loaded,total:f.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const u=this._rangeReaders.indexOf(f);u>=0&&this._rangeReaders.splice(u,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new o(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,u){if(u<=this._progressiveDataLength)return null;const p=new c(this,f,u);return this._pdfDataRangeTransport.requestDataRange(f,u),this._rangeReaders.push(p),p}cancelAllRequests(f){this._fullRequestReader?.cancel(f);for(const u of this._rangeReaders.slice(0))u.cancel(f);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=s;class o{constructor(f,u,p=!1,g=null){this._stream=f,this._done=p||!1,this._filename=(0,i.isPdfFile)(g)?g:null,this._queuedChunks=u||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=new a.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class c{constructor(f,u,p){this._stream=f,this._begin=u,this._end=p,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const f=new a.PromiseCapability;return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var a=n(1),i=n(20);function s(p,g,v){return{method:"GET",headers:p,signal:v.signal,mode:"cors",credentials:g?"include":"same-origin",redirect:"follow"}}function o(p){const g=new Headers;for(const v in p){const m=p[v];m!==void 0&&g.append(v,m)}return g}function c(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:((0,a.warn)(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class h{constructor(g){this.source=g,this.isHttp=/^https?:/i.test(g.url),this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new f(this),this._fullRequestReader}getRangeReader(g,v){if(v<=this._progressiveDataLength)return null;const m=new u(this,g,v);return this._rangeRequestReaders.push(m),m}cancelAllRequests(g){this._fullRequestReader?.cancel(g);for(const v of this._rangeRequestReaders.slice(0))v.cancel(g)}}t.PDFFetchStream=h;class f{constructor(g){this._stream=g,this._reader=null,this._loaded=0,this._filename=null;const v=g.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=new a.PromiseCapability,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=o(this._stream.httpHeaders);const m=v.url;fetch(m,s(this._headers,this._withCredentials,this._abortController)).then(S=>{if(!(0,i.validateResponseStatus)(S.status))throw(0,i.createResponseStatusError)(S.status,m);this._reader=S.body.getReader(),this._headersCapability.resolve();const E=A=>S.headers.get(A),{allowRangeRequests:w,suggestedLength:T}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=T||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(E),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:g,done:v}=await this._reader.read();return v?{value:g,done:v}:(this._loaded+=g.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:c(g),done:!1})}cancel(g){this._reader?.cancel(g),this._abortController.abort()}}class u{constructor(g,v,m){this._stream=g,this._reader=null,this._loaded=0;const S=g.source;this._withCredentials=S.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!S.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${m-1}`);const E=S.url;fetch(E,s(this._headers,this._withCredentials,this._abortController)).then(w=>{if(!(0,i.validateResponseStatus)(w.status))throw(0,i.createResponseStatusError)(w.status,E);this._readCapability.resolve(),this._reader=w.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:g,done:v}=await this._reader.read();return v?{value:g,done:v}:(this._loaded+=g.byteLength,this.onProgress?.({loaded:this._loaded}),{value:c(g),done:!1})}cancel(g){this._reader?.cancel(g),this._abortController.abort()}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=h,t.extractFilenameFromHeader=c,t.validateRangeRequestCapabilities=o,t.validateResponseStatus=f;var a=n(1),i=n(21),s=n(6);function o({getResponseHeader:u,isHttp:p,rangeChunkSize:g,disableRange:v}){const m={allowRangeRequests:!1,suggestedLength:void 0},S=parseInt(u("Content-Length"),10);return!Number.isInteger(S)||(m.suggestedLength=S,S<=2*g)||v||!p||u("Accept-Ranges")!=="bytes"||(u("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function c(u){const p=u("Content-Disposition");if(p){let g=(0,i.getFilenameFromContentDispositionHeader)(p);if(g.includes("%"))try{g=decodeURIComponent(g)}catch{}if((0,s.isPdfFile)(g))return g}return null}function h(u,p){return u===404||u===0&&p.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+p+'".'):new a.UnexpectedResponseException(`Unexpected server response (${u}) while retrieving PDF "${p}".`,u)}function f(u){return u===200||u===206}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=i;var a=n(1);function i(s){let o=!0,c=h("filename\\*","i").exec(s);if(c){c=c[1];let S=g(c);return S=unescape(S),S=v(S),S=m(S),u(S)}if(c=p(s),c){const S=m(c);return u(S)}if(c=h("filename","i").exec(s),c){c=c[1];let S=g(c);return S=m(S),u(S)}function h(S,E){return new RegExp("(?:^|;)\\s*"+S+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',E)}function f(S,E){if(S){if(!/^[\x00-\xFF]+$/.test(E))return E;try{const w=new TextDecoder(S,{fatal:!0}),T=(0,a.stringToBytes)(E);E=w.decode(T),o=!1}catch{}}return E}function u(S){return o&&/[\x80-\xff]/.test(S)&&(S=f("utf-8",S),o&&(S=f("iso-8859-1",S))),S}function p(S){const E=[];let w;const T=h("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=T.exec(S))!==null;){let[,L,k,D]=w;if(L=parseInt(L,10),L in E){if(L===0)break;continue}E[L]=[k,D]}const A=[];for(let L=0;L<E.length&&L in E;++L){let[k,D]=E[L];D=g(D),k&&(D=unescape(D),L===0&&(D=v(D))),A.push(D)}return A.join("")}function g(S){if(S.startsWith('"')){const E=S.slice(1).split('\\"');for(let w=0;w<E.length;++w){const T=E[w].indexOf('"');T!==-1&&(E[w]=E[w].slice(0,T),E.length=w+1),E[w]=E[w].replaceAll(/\\(.)/g,"$1")}S=E.join('"')}return S}function v(S){const E=S.indexOf("'");if(E===-1)return S;const w=S.slice(0,E),A=S.slice(E+1).replace(/^[^']*'/,"");return f(w,A)}function m(S){return!S.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(S)?S:S.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(E,w,T,A){if(T==="q"||T==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(L,k){return String.fromCharCode(parseInt(k,16))}),f(w,A);try{A=atob(A)}catch{}return f(w,A)})}return""}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var a=n(1),i=n(20);const s=200,o=206;function c(g){const v=g.response;return typeof v!="string"?v:(0,a.stringToBytes)(v).buffer}class h{constructor(v,m={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,m,S){const E={begin:v,end:m};for(const w in S)E[w]=S[w];return this.request(E)}requestFull(v){return this.request(v)}request(v){const m=new XMLHttpRequest,S=this.currXhrId++,E=this.pendingRequests[S]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const w in this.httpHeaders){const T=this.httpHeaders[w];T!==void 0&&m.setRequestHeader(w,T)}return this.isHttp&&"begin"in v&&"end"in v?(m.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),E.expectedStatus=o):E.expectedStatus=s,m.responseType="arraybuffer",v.onError&&(m.onerror=function(w){v.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,S),m.onprogress=this.onProgress.bind(this,S),E.onHeadersReceived=v.onHeadersReceived,E.onDone=v.onDone,E.onError=v.onError,E.onProgress=v.onProgress,m.send(null),S}onProgress(v,m){const S=this.pendingRequests[v];S&&S.onProgress?.(m)}onStateChange(v,m){const S=this.pendingRequests[v];if(!S)return;const E=S.xhr;if(E.readyState>=2&&S.onHeadersReceived&&(S.onHeadersReceived(),delete S.onHeadersReceived),E.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],E.status===0&&this.isHttp){S.onError?.(E.status);return}const w=E.status||s;if(!(w===s&&S.expectedStatus===o)&&w!==S.expectedStatus){S.onError?.(E.status);return}const A=c(E);if(w===o){const L=E.getResponseHeader("Content-Range"),k=/bytes (\d+)-(\d+)\/(\d+)/.exec(L);S.onDone({begin:parseInt(k[1],10),chunk:A})}else A?S.onDone({begin:0,chunk:A}):S.onError?.(E.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const m=this.pendingRequests[v].xhr;delete this.pendingRequests[v],m.abort()}}class f{constructor(v){this._source=v,this._manager=new h(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const m=this._rangeRequestReaders.indexOf(v);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new u(this._manager,this._source),this._fullRequestReader}getRangeReader(v,m){const S=new p(this._manager,v,m);return S.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(S),S}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(const m of this._rangeRequestReaders.slice(0))m.cancel(v)}}t.PDFNetworkStream=f;class u{constructor(v,m){this._manager=v;const S={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=v.requestFull(S),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,m=this._manager.getRequestXhr(v),S=T=>m.getResponseHeader(T),{allowRangeRequests:E,suggestedLength:w}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:S,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=w||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(S),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,i.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){this.onProgress?.({loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=new a.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class p{constructor(v,m,S){this._manager=v;const E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(m,S,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(v){const m=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,i.createResponseStatusError)(v,this._url);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){this.isStreamingSupported||this.onProgress?.({loaded:v.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const v=new a.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var a=n(1),i=n(20);const s=/^file:\/\/\/[a-zA-Z]:\//;function o(S){const E=require$$5,w=E.parse(S);return w.protocol==="file:"||w.host?w:/^[a-z]:[/\\]/i.test(S)?E.parse(`file:///${S}`):(w.host||(w.protocol="file:"),w)}class c{constructor(E){this.source=E,this.url=o(E.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new v(this):new p(this),this._fullRequestReader}getRangeReader(E,w){if(w<=this._progressiveDataLength)return null;const T=this.isFsUrl?new m(this,E,w):new g(this,E,w);return this._rangeRequestReaders.push(T),T}cancelAllRequests(E){this._fullRequestReader?.cancel(E);for(const w of this._rangeRequestReaders.slice(0))w.cancel(E)}}t.PDFNodeStream=c;class h{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null;const w=E.source;this._contentLength=w.length,this._loaded=0,this._filename=null,this._disableRange=w.disableRange||!1,this._rangeChunkSize=w.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!w.disableStream,this._isRangeSupported=!w.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",w=>{this._error(w)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class f{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const w=E.source;this._isStreamingSupported=!w.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",w=>{this._error(w)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(S,E){return{protocol:S.protocol,auth:S.auth,host:S.hostname,port:S.port,path:S.path,method:"GET",headers:E}}class p extends h{constructor(E){super(E);const w=T=>{if(T.statusCode===404){const D=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=D,this._headersCapability.reject(D);return}this._headersCapability.resolve(),this._setReadableStream(T);const A=D=>this._readableStream.headers[D.toLowerCase()],{allowRangeRequests:L,suggestedLength:k}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:A,isHttp:E.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=L,this._contentLength=k||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(A)};if(this._request=null,this._url.protocol==="http:"){const T=require$$5;this._request=T.request(u(this._url,E.httpHeaders),w)}else{const T=require$$5;this._request=T.request(u(this._url,E.httpHeaders),w)}this._request.on("error",T=>{this._storedError=T,this._headersCapability.reject(T)}),this._request.end()}}class g extends f{constructor(E,w,T){super(E),this._httpHeaders={};for(const L in E.httpHeaders){const k=E.httpHeaders[L];k!==void 0&&(this._httpHeaders[L]=k)}this._httpHeaders.Range=`bytes=${w}-${T-1}`;const A=L=>{if(L.statusCode===404){const k=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=k;return}this._setReadableStream(L)};if(this._request=null,this._url.protocol==="http:"){const L=require$$5;this._request=L.request(u(this._url,this._httpHeaders),A)}else{const L=require$$5;this._request=L.request(u(this._url,this._httpHeaders),A)}this._request.on("error",L=>{this._storedError=L}),this._request.end()}}class v extends h{constructor(E){super(E);let w=decodeURIComponent(this._url.path);s.test(this._url.href)&&(w=w.replace(/^\//,""));const T=require$$5;T.lstat(w,(A,L)=>{if(A){A.code==="ENOENT"&&(A=new a.MissingPDFException(`Missing PDF "${w}".`)),this._storedError=A,this._headersCapability.reject(A);return}this._contentLength=L.size,this._setReadableStream(T.createReadStream(w)),this._headersCapability.resolve()})}}class m extends f{constructor(E,w,T){super(E);let A=decodeURIComponent(this._url.path);s.test(this._url.href)&&(A=A.replace(/^\//,""));const L=require$$5;this._setReadableStream(L.createReadStream(A,{start:w,end:T-1}))}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var a=n(6),i=n(1);const s={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},o="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/1999/xlink",h=["butt","round","square"],f=["miter","round","bevel"],u=function(L,k="",D=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!D)return URL.createObjectURL(new Blob([L],{type:k}));const N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Y=`data:${k};base64,`;for(let z=0,te=L.length;z<te;z+=3){const Z=L[z]&255,ne=L[z+1]&255,oe=L[z+2]&255,le=Z>>2,pe=(Z&3)<<4|ne>>4,de=z+1<te?(ne&15)<<2|oe>>6:64,J=z+2<te?oe&63:64;Y+=N[le]+N[pe]+N[de]+N[J]}return Y},p=(function(){const L=new Uint8Array([137,80,78,71,13,10,26,10]),k=12,D=new Int32Array(256);for(let oe=0;oe<256;oe++){let le=oe;for(let pe=0;pe<8;pe++)le=le&1?3988292384^le>>1&2147483647:le>>1&2147483647;D[oe]=le}function N(oe,le,pe){let de=-1;for(let J=le;J<pe;J++){const V=(de^oe[J])&255,C=D[V];de=de>>>8^C}return de^-1}function Y(oe,le,pe,de){let J=de;const V=le.length;pe[J]=V>>24&255,pe[J+1]=V>>16&255,pe[J+2]=V>>8&255,pe[J+3]=V&255,J+=4,pe[J]=oe.charCodeAt(0)&255,pe[J+1]=oe.charCodeAt(1)&255,pe[J+2]=oe.charCodeAt(2)&255,pe[J+3]=oe.charCodeAt(3)&255,J+=4,pe.set(le,J),J+=le.length;const C=N(pe,de+4,J);pe[J]=C>>24&255,pe[J+1]=C>>16&255,pe[J+2]=C>>8&255,pe[J+3]=C&255}function z(oe,le,pe){let de=1,J=0;for(let V=le;V<pe;++V)de=(de+(oe[V]&255))%65521,J=(J+de)%65521;return J<<16|de}function te(oe){if(!i.isNodeJS)return Z(oe);try{const le=parseInt(process.versions.node)>=8?oe:Buffer.from(oe),pe=require$$5.deflateSync(le,{level:9});return pe instanceof Uint8Array?pe:new Uint8Array(pe)}catch(le){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+le)}return Z(oe)}function Z(oe){let le=oe.length;const pe=65535,de=Math.ceil(le/pe),J=new Uint8Array(2+le+de*5+4);let V=0;J[V++]=120,J[V++]=156;let C=0;for(;le>pe;)J[V++]=0,J[V++]=255,J[V++]=255,J[V++]=0,J[V++]=0,J.set(oe.subarray(C,C+pe),V),V+=pe,C+=pe,le-=pe;J[V++]=1,J[V++]=le&255,J[V++]=le>>8&255,J[V++]=~le&65535&255,J[V++]=(~le&65535)>>8&255,J.set(oe.subarray(C),V),V+=oe.length-C;const O=z(oe,0,oe.length);return J[V++]=O>>24&255,J[V++]=O>>16&255,J[V++]=O>>8&255,J[V++]=O&255,J}function ne(oe,le,pe,de){const J=oe.width,V=oe.height;let C,O,I;const M=oe.data;switch(le){case i.ImageKind.GRAYSCALE_1BPP:O=0,C=1,I=J+7>>3;break;case i.ImageKind.RGB_24BPP:O=2,C=8,I=J*3;break;case i.ImageKind.RGBA_32BPP:O=6,C=8,I=J*4;break;default:throw new Error("invalid format")}const H=new Uint8Array((1+I)*V);let G=0,j=0;for(let ae=0;ae<V;++ae)H[G++]=0,H.set(M.subarray(j,j+I),G),j+=I,G+=I;if(le===i.ImageKind.GRAYSCALE_1BPP&&de){G=0;for(let ae=0;ae<V;ae++){G++;for(let U=0;U<I;U++)H[G++]^=255}}const F=new Uint8Array([J>>24&255,J>>16&255,J>>8&255,J&255,V>>24&255,V>>16&255,V>>8&255,V&255,C,O,0,0,0]),q=te(H),X=L.length+k*3+F.length+q.length,W=new Uint8Array(X);let K=0;return W.set(L,K),K+=L.length,Y("IHDR",F,W,K),K+=k+F.length,Y("IDATA",q,W,K),K+=k+q.length,Y("IEND",new Uint8Array(0),W,K),u(W,"image/png",pe)}return function(le,pe,de){const J=le.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:le.kind;return ne(le,J,pe,de)}})();class g{constructor(){this.fontSizeScale=1,this.fontWeight=s.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=s.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(k,D){this.x=k,this.y=D}}function v(L){let k=[];const D=[];for(const N of L){if(N.fn==="save"){k.push({fnId:92,fn:"group",items:[]}),D.push(k),k=k.at(-1).items;continue}N.fn==="restore"?k=D.pop():k.push(N)}return k}function m(L){if(Number.isInteger(L))return L.toString();const k=L.toFixed(10);let D=k.length-1;if(k[D]!=="0")return k;do D--;while(k[D]==="0");return k.substring(0,k[D]==="."?D:D+1)}function S(L){if(L[4]===0&&L[5]===0){if(L[1]===0&&L[2]===0)return L[0]===1&&L[3]===1?"":`scale(${m(L[0])} ${m(L[3])})`;if(L[0]===L[3]&&L[1]===-L[2]){const k=Math.acos(L[0])*180/Math.PI;return`rotate(${m(k)})`}}else if(L[0]===1&&L[1]===0&&L[2]===0&&L[3]===1)return`translate(${m(L[4])} ${m(L[5])})`;return`matrix(${m(L[0])} ${m(L[1])} ${m(L[2])} ${m(L[3])} ${m(L[4])} ${m(L[5])})`}let E=0,w=0,T=0;class A{constructor(k,D,N=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new g,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=k,this.objs=D,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!N,this._operatorIdMapping=[];for(const Y in i.OPS)this._operatorIdMapping[i.OPS[Y]]=Y}getObject(k,D=null){return typeof k=="string"?k.startsWith("g_")?this.commonObjs.get(k):this.objs.get(k):D}save(){this.transformStack.push(this.transformMatrix);const k=this.current;this.extraStack.push(k),this.current=k.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(k){this.save(),this.executeOpTree(k),this.restore()}loadDependencies(k){const D=k.fnArray,N=k.argsArray;for(let Y=0,z=D.length;Y<z;Y++)if(D[Y]===i.OPS.dependency)for(const te of N[Y]){const Z=te.startsWith("g_")?this.commonObjs:this.objs,ne=new Promise(oe=>{Z.get(te,oe)});this.current.dependencies.push(ne)}return Promise.all(this.current.dependencies)}transform(k,D,N,Y,z,te){const Z=[k,D,N,Y,z,te];this.transformMatrix=i.Util.transform(this.transformMatrix,Z),this.tgrp=null}getSVG(k,D){this.viewport=D;const N=this._initialize(D);return this.loadDependencies(k).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(k)),N))}convertOpList(k){const D=this._operatorIdMapping,N=k.argsArray,Y=k.fnArray,z=[];for(let te=0,Z=Y.length;te<Z;te++){const ne=Y[te];z.push({fnId:ne,fn:D[ne],args:N[te]})}return v(z)}executeOpTree(k){for(const D of k){const N=D.fn,Y=D.fnId,z=D.args;switch(Y|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(z);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(z[0],z[1]);break;case i.OPS.setFont:this.setFont(z);break;case i.OPS.showText:this.showText(z[0]);break;case i.OPS.showSpacedText:this.showText(z[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(z[0],z[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(z[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(z[0]);break;case i.OPS.setHScale:this.setHScale(z[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(z[0],z[1],z[2],z[3],z[4],z[5]);break;case i.OPS.setTextRise:this.setTextRise(z[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(z[0]);break;case i.OPS.setLineWidth:this.setLineWidth(z[0]);break;case i.OPS.setLineJoin:this.setLineJoin(z[0]);break;case i.OPS.setLineCap:this.setLineCap(z[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(z[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(z[0],z[1],z[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(z[0],z[1],z[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(z);break;case i.OPS.setFillColorN:this.setFillColorN(z);break;case i.OPS.shadingFill:this.shadingFill(z[0]);break;case i.OPS.setDash:this.setDash(z[0],z[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(z[0]);break;case i.OPS.setFlatness:this.setFlatness(z[0]);break;case i.OPS.setGState:this.setGState(z[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(z[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(z[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(z[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(z[0],z[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(z[0],z[1],z[2],z[3],z[4],z[5]);break;case i.OPS.constructPath:this.constructPath(z[0],z[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(D.items);break;default:(0,i.warn)(`Unimplemented operator ${N}`);break}}}setWordSpacing(k){this.current.wordSpacing=k}setCharSpacing(k){this.current.charSpacing=k}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(k,D,N,Y,z,te){const Z=this.current;Z.textMatrix=Z.lineMatrix=[k,D,N,Y,z,te],Z.textMatrixScale=Math.hypot(k,D),Z.x=Z.lineX=0,Z.y=Z.lineY=0,Z.xcoords=[],Z.ycoords=[],Z.tspan=this.svgFactory.createElement("svg:tspan"),Z.tspan.setAttributeNS(null,"font-family",Z.fontFamily),Z.tspan.setAttributeNS(null,"font-size",`${m(Z.fontSize)}px`),Z.tspan.setAttributeNS(null,"y",m(-Z.y)),Z.txtElement=this.svgFactory.createElement("svg:text"),Z.txtElement.append(Z.tspan)}beginText(){const k=this.current;k.x=k.lineX=0,k.y=k.lineY=0,k.textMatrix=i.IDENTITY_MATRIX,k.lineMatrix=i.IDENTITY_MATRIX,k.textMatrixScale=1,k.tspan=this.svgFactory.createElement("svg:tspan"),k.txtElement=this.svgFactory.createElement("svg:text"),k.txtgrp=this.svgFactory.createElement("svg:g"),k.xcoords=[],k.ycoords=[]}moveText(k,D){const N=this.current;N.x=N.lineX+=k,N.y=N.lineY+=D,N.xcoords=[],N.ycoords=[],N.tspan=this.svgFactory.createElement("svg:tspan"),N.tspan.setAttributeNS(null,"font-family",N.fontFamily),N.tspan.setAttributeNS(null,"font-size",`${m(N.fontSize)}px`),N.tspan.setAttributeNS(null,"y",m(-N.y))}showText(k){const D=this.current,N=D.font,Y=D.fontSize;if(Y===0)return;const z=D.fontSizeScale,te=D.charSpacing,Z=D.wordSpacing,ne=D.fontDirection,oe=D.textHScale*ne,le=N.vertical,pe=le?1:-1,de=N.defaultVMetrics,J=Y*D.fontMatrix[0];let V=0;for(const I of k){if(I===null){V+=ne*Z;continue}else if(typeof I=="number"){V+=pe*I*Y/1e3;continue}const M=(I.isSpace?Z:0)+te,H=I.fontChar;let G,j,F=I.width;if(le){let X;const W=I.vmetric||de;X=I.vmetric?W[1]:F*.5,X=-X*J;const K=W[2]*J;F=W?-W[0]:F,G=X/z,j=(V+K)/z}else G=V/z,j=0;(I.isInFont||N.missingFile)&&(D.xcoords.push(D.x+G),le&&D.ycoords.push(-D.y+j),D.tspan.textContent+=H);const q=le?F*J-M*ne:F*J+M*ne;V+=q}D.tspan.setAttributeNS(null,"x",D.xcoords.map(m).join(" ")),le?D.tspan.setAttributeNS(null,"y",D.ycoords.map(m).join(" ")):D.tspan.setAttributeNS(null,"y",m(-D.y)),le?D.y-=V:D.x+=V*oe,D.tspan.setAttributeNS(null,"font-family",D.fontFamily),D.tspan.setAttributeNS(null,"font-size",`${m(D.fontSize)}px`),D.fontStyle!==s.fontStyle&&D.tspan.setAttributeNS(null,"font-style",D.fontStyle),D.fontWeight!==s.fontWeight&&D.tspan.setAttributeNS(null,"font-weight",D.fontWeight);const C=D.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(C===i.TextRenderingMode.FILL||C===i.TextRenderingMode.FILL_STROKE?(D.fillColor!==s.fillColor&&D.tspan.setAttributeNS(null,"fill",D.fillColor),D.fillAlpha<1&&D.tspan.setAttributeNS(null,"fill-opacity",D.fillAlpha)):D.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?D.tspan.setAttributeNS(null,"fill","transparent"):D.tspan.setAttributeNS(null,"fill","none"),C===i.TextRenderingMode.STROKE||C===i.TextRenderingMode.FILL_STROKE){const I=1/(D.textMatrixScale||1);this._setStrokeAttributes(D.tspan,I)}let O=D.textMatrix;D.textRise!==0&&(O=O.slice(),O[5]+=D.textRise),D.txtElement.setAttributeNS(null,"transform",`${S(O)} scale(${m(oe)}, -1)`),D.txtElement.setAttributeNS(o,"xml:space","preserve"),D.txtElement.append(D.tspan),D.txtgrp.append(D.txtElement),this._ensureTransformGroup().append(D.txtElement)}setLeadingMoveText(k,D){this.setLeading(-D),this.moveText(k,D)}addFontStyle(k){if(!k.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const D=u(k.data,k.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${k.loadedName}"; src: url(${D}); }
`}setFont(k){const D=this.current,N=this.commonObjs.get(k[0]);let Y=k[1];D.font=N,this.embedFonts&&!N.missingFile&&!this.embeddedFonts[N.loadedName]&&(this.addFontStyle(N),this.embeddedFonts[N.loadedName]=N),D.fontMatrix=N.fontMatrix||i.FONT_IDENTITY_MATRIX;let z="normal";N.black?z="900":N.bold&&(z="bold");const te=N.italic?"italic":"normal";Y<0?(Y=-Y,D.fontDirection=-1):D.fontDirection=1,D.fontSize=Y,D.fontFamily=N.loadedName,D.fontWeight=z,D.fontStyle=te,D.tspan=this.svgFactory.createElement("svg:tspan"),D.tspan.setAttributeNS(null,"y",m(-D.y)),D.xcoords=[],D.ycoords=[]}endText(){const k=this.current;k.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&k.txtElement?.hasChildNodes()&&(k.element=k.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(k){k>0&&(this.current.lineWidth=k)}setLineCap(k){this.current.lineCap=h[k]}setLineJoin(k){this.current.lineJoin=f[k]}setMiterLimit(k){this.current.miterLimit=k}setStrokeAlpha(k){this.current.strokeAlpha=k}setStrokeRGBColor(k,D,N){this.current.strokeColor=i.Util.makeHexColor(k,D,N)}setFillAlpha(k){this.current.fillAlpha=k}setFillRGBColor(k,D,N){this.current.fillColor=i.Util.makeHexColor(k,D,N),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(k){this.current.strokeColor=this._makeColorN_Pattern(k)}setFillColorN(k){this.current.fillColor=this._makeColorN_Pattern(k)}shadingFill(k){const{width:D,height:N}=this.viewport,Y=i.Util.inverseTransform(this.transformMatrix),[z,te,Z,ne]=i.Util.getAxialAlignedBoundingBox([0,0,D,N],Y),oe=this.svgFactory.createElement("svg:rect");oe.setAttributeNS(null,"x",z),oe.setAttributeNS(null,"y",te),oe.setAttributeNS(null,"width",Z-z),oe.setAttributeNS(null,"height",ne-te),oe.setAttributeNS(null,"fill",this._makeShadingPattern(k)),this.current.fillAlpha<1&&oe.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(oe)}_makeColorN_Pattern(k){return k[0]==="TilingPattern"?this._makeTilingPattern(k):this._makeShadingPattern(k)}_makeTilingPattern(k){const D=k[1],N=k[2],Y=k[3]||i.IDENTITY_MATRIX,[z,te,Z,ne]=k[4],oe=k[5],le=k[6],pe=k[7],de=`shading${T++}`,[J,V,C,O]=i.Util.normalizeRect([...i.Util.applyTransform([z,te],Y),...i.Util.applyTransform([Z,ne],Y)]),[I,M]=i.Util.singularValueDecompose2dScale(Y),H=oe*I,G=le*M,j=this.svgFactory.createElement("svg:pattern");j.setAttributeNS(null,"id",de),j.setAttributeNS(null,"patternUnits","userSpaceOnUse"),j.setAttributeNS(null,"width",H),j.setAttributeNS(null,"height",G),j.setAttributeNS(null,"x",`${J}`),j.setAttributeNS(null,"y",`${V}`);const F=this.svg,q=this.transformMatrix,X=this.current.fillColor,W=this.current.strokeColor,K=this.svgFactory.create(C-J,O-V);if(this.svg=K,this.transformMatrix=Y,pe===2){const ae=i.Util.makeHexColor(...D);this.current.fillColor=ae,this.current.strokeColor=ae}return this.executeOpTree(this.convertOpList(N)),this.svg=F,this.transformMatrix=q,this.current.fillColor=X,this.current.strokeColor=W,j.append(K.childNodes[0]),this.defs.append(j),`url(#${de})`}_makeShadingPattern(k){switch(typeof k=="string"&&(k=this.objs.get(k)),k[0]){case"RadialAxial":const D=`shading${T++}`,N=k[3];let Y;switch(k[1]){case"axial":const z=k[4],te=k[5];Y=this.svgFactory.createElement("svg:linearGradient"),Y.setAttributeNS(null,"id",D),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"x1",z[0]),Y.setAttributeNS(null,"y1",z[1]),Y.setAttributeNS(null,"x2",te[0]),Y.setAttributeNS(null,"y2",te[1]);break;case"radial":const Z=k[4],ne=k[5],oe=k[6],le=k[7];Y=this.svgFactory.createElement("svg:radialGradient"),Y.setAttributeNS(null,"id",D),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"cx",ne[0]),Y.setAttributeNS(null,"cy",ne[1]),Y.setAttributeNS(null,"r",le),Y.setAttributeNS(null,"fx",Z[0]),Y.setAttributeNS(null,"fy",Z[1]),Y.setAttributeNS(null,"fr",oe);break;default:throw new Error(`Unknown RadialAxial type: ${k[1]}`)}for(const z of N){const te=this.svgFactory.createElement("svg:stop");te.setAttributeNS(null,"offset",z[0]),te.setAttributeNS(null,"stop-color",z[1]),Y.append(te)}return this.defs.append(Y),`url(#${D})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${k[0]}`)}}setDash(k,D){this.current.dashArray=k,this.current.dashPhase=D}constructPath(k,D){const N=this.current;let Y=N.x,z=N.y,te=[],Z=0;for(const ne of k)switch(ne|0){case i.OPS.rectangle:Y=D[Z++],z=D[Z++];const oe=D[Z++],le=D[Z++],pe=Y+oe,de=z+le;te.push("M",m(Y),m(z),"L",m(pe),m(z),"L",m(pe),m(de),"L",m(Y),m(de),"Z");break;case i.OPS.moveTo:Y=D[Z++],z=D[Z++],te.push("M",m(Y),m(z));break;case i.OPS.lineTo:Y=D[Z++],z=D[Z++],te.push("L",m(Y),m(z));break;case i.OPS.curveTo:Y=D[Z+4],z=D[Z+5],te.push("C",m(D[Z]),m(D[Z+1]),m(D[Z+2]),m(D[Z+3]),m(Y),m(z)),Z+=6;break;case i.OPS.curveTo2:te.push("C",m(Y),m(z),m(D[Z]),m(D[Z+1]),m(D[Z+2]),m(D[Z+3])),Y=D[Z+2],z=D[Z+3],Z+=4;break;case i.OPS.curveTo3:Y=D[Z+2],z=D[Z+3],te.push("C",m(D[Z]),m(D[Z+1]),m(Y),m(z),m(Y),m(z)),Z+=4;break;case i.OPS.closePath:te.push("Z");break}te=te.join(" "),N.path&&k.length>0&&k[0]!==i.OPS.rectangle&&k[0]!==i.OPS.moveTo?te=N.path.getAttributeNS(null,"d")+te:(N.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(N.path)),N.path.setAttributeNS(null,"d",te),N.path.setAttributeNS(null,"fill","none"),N.element=N.path,N.setCurrentPoint(Y,z)}endPath(){const k=this.current;if(k.path=null,!this.pendingClip)return;if(!k.element){this.pendingClip=null;return}const D=`clippath${E++}`,N=this.svgFactory.createElement("svg:clipPath");N.setAttributeNS(null,"id",D),N.setAttributeNS(null,"transform",S(this.transformMatrix));const Y=k.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Y.setAttributeNS(null,"clip-rule","evenodd"):Y.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,N.append(Y),this.defs.append(N),k.activeClipUrl){k.clipGroup=null;for(const z of this.extraStack)z.clipGroup=null;N.setAttributeNS(null,"clip-path",k.activeClipUrl)}k.activeClipUrl=`url(#${D})`,this.tgrp=null}clip(k){this.pendingClip=k}closePath(){const k=this.current;if(k.path){const D=`${k.path.getAttributeNS(null,"d")}Z`;k.path.setAttributeNS(null,"d",D)}}setLeading(k){this.current.leading=-k}setTextRise(k){this.current.textRise=k}setTextRenderingMode(k){this.current.textRenderingMode=k}setHScale(k){this.current.textHScale=k/100}setRenderingIntent(k){}setFlatness(k){}setGState(k){for(const[D,N]of k)switch(D){case"LW":this.setLineWidth(N);break;case"LC":this.setLineCap(N);break;case"LJ":this.setLineJoin(N);break;case"ML":this.setMiterLimit(N);break;case"D":this.setDash(N[0],N[1]);break;case"RI":this.setRenderingIntent(N);break;case"FL":this.setFlatness(N);break;case"Font":this.setFont(N);break;case"CA":this.setStrokeAlpha(N);break;case"ca":this.setFillAlpha(N);break;default:(0,i.warn)(`Unimplemented graphic state operator ${D}`);break}}fill(){const k=this.current;k.element&&(k.element.setAttributeNS(null,"fill",k.fillColor),k.element.setAttributeNS(null,"fill-opacity",k.fillAlpha),this.endPath())}stroke(){const k=this.current;k.element&&(this._setStrokeAttributes(k.element),k.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(k,D=1){const N=this.current;let Y=N.dashArray;D!==1&&Y.length>0&&(Y=Y.map(function(z){return D*z})),k.setAttributeNS(null,"stroke",N.strokeColor),k.setAttributeNS(null,"stroke-opacity",N.strokeAlpha),k.setAttributeNS(null,"stroke-miterlimit",m(N.miterLimit)),k.setAttributeNS(null,"stroke-linecap",N.lineCap),k.setAttributeNS(null,"stroke-linejoin",N.lineJoin),k.setAttributeNS(null,"stroke-width",m(D*N.lineWidth)+"px"),k.setAttributeNS(null,"stroke-dasharray",Y.map(m).join(" ")),k.setAttributeNS(null,"stroke-dashoffset",m(D*N.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width","1px"),k.setAttributeNS(null,"height","1px"),k.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(k)}paintImageXObject(k){const D=this.getObject(k);if(!D){(0,i.warn)(`Dependent image with object ID ${k} is not ready yet`);return}this.paintInlineImageXObject(D)}paintInlineImageXObject(k,D){const N=k.width,Y=k.height,z=p(k,this.forceDataSchema,!!D),te=this.svgFactory.createElement("svg:rect");te.setAttributeNS(null,"x","0"),te.setAttributeNS(null,"y","0"),te.setAttributeNS(null,"width",m(N)),te.setAttributeNS(null,"height",m(Y)),this.current.element=te,this.clip("nonzero");const Z=this.svgFactory.createElement("svg:image");Z.setAttributeNS(c,"xlink:href",z),Z.setAttributeNS(null,"x","0"),Z.setAttributeNS(null,"y",m(-Y)),Z.setAttributeNS(null,"width",m(N)+"px"),Z.setAttributeNS(null,"height",m(Y)+"px"),Z.setAttributeNS(null,"transform",`scale(${m(1/N)} ${m(-1/Y)})`),D?D.append(Z):this._ensureTransformGroup().append(Z)}paintImageMaskXObject(k){const D=this.getObject(k.data,k);if(D.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const N=this.current,Y=D.width,z=D.height,te=N.fillColor;N.maskId=`mask${w++}`;const Z=this.svgFactory.createElement("svg:mask");Z.setAttributeNS(null,"id",N.maskId);const ne=this.svgFactory.createElement("svg:rect");ne.setAttributeNS(null,"x","0"),ne.setAttributeNS(null,"y","0"),ne.setAttributeNS(null,"width",m(Y)),ne.setAttributeNS(null,"height",m(z)),ne.setAttributeNS(null,"fill",te),ne.setAttributeNS(null,"mask",`url(#${N.maskId})`),this.defs.append(Z),this._ensureTransformGroup().append(ne),this.paintInlineImageXObject(D,Z)}paintFormXObjectBegin(k,D){if(Array.isArray(k)&&k.length===6&&this.transform(k[0],k[1],k[2],k[3],k[4],k[5]),D){const N=D[2]-D[0],Y=D[3]-D[1],z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x",D[0]),z.setAttributeNS(null,"y",D[1]),z.setAttributeNS(null,"width",m(N)),z.setAttributeNS(null,"height",m(Y)),this.current.element=z,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(k){const D=this.svgFactory.create(k.width,k.height),N=this.svgFactory.createElement("svg:defs");D.append(N),this.defs=N;const Y=this.svgFactory.createElement("svg:g");return Y.setAttributeNS(null,"transform",S(k.transform)),D.append(Y),this.svg=Y,D}_ensureClipGroup(){if(!this.current.clipGroup){const k=this.svgFactory.createElement("svg:g");k.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(k),this.current.clipGroup=k}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",S(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=A}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class n{static textContent(i){const s=[],o={items:s,styles:Object.create(null)};function c(h){if(!h)return;let f=null;const u=h.name;if(u==="#text")f=h.value;else if(n.shouldBuildText(u))h?.attributes?.textContent?f=h.attributes.textContent:h.value&&(f=h.value);else return;if(f!==null&&s.push({str:f}),!!h.children)for(const p of h.children)c(p)}return c(i),o}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}t.XfaText=n}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=S,t.updateTextLayer=E;var a=n(1),i=n(6);const s=1e5,o=30,c=.8,h=new Map;function f(w,T){let A;if(T&&a.FeatureTest.isOffscreenCanvasSupported)A=new OffscreenCanvas(w,w).getContext("2d",{alpha:!1});else{const L=document.createElement("canvas");L.width=L.height=w,A=L.getContext("2d",{alpha:!1})}return A}function u(w,T){const A=h.get(w);if(A)return A;const L=f(o,T);L.font=`${o}px ${w}`;const k=L.measureText("");let D=k.fontBoundingBoxAscent,N=Math.abs(k.fontBoundingBoxDescent);if(D){const z=D/(D+N);return h.set(w,z),L.canvas.width=L.canvas.height=0,z}L.strokeStyle="red",L.clearRect(0,0,o,o),L.strokeText("g",0,0);let Y=L.getImageData(0,0,o,o).data;N=0;for(let z=Y.length-1-3;z>=0;z-=4)if(Y[z]>0){N=Math.ceil(z/4/o);break}L.clearRect(0,0,o,o),L.strokeText("A",0,o),Y=L.getImageData(0,0,o,o).data,D=0;for(let z=0,te=Y.length;z<te;z+=4)if(Y[z]>0){D=o-Math.floor(z/4/o);break}if(L.canvas.width=L.canvas.height=0,D){const z=D/(D+N);return h.set(w,z),z}return h.set(w,c),c}function p(w,T,A){const L=document.createElement("span"),k={angle:0,canvasWidth:0,hasText:T.str!=="",hasEOL:T.hasEOL,fontSize:0};w._textDivs.push(L);const D=a.Util.transform(w._transform,T.transform);let N=Math.atan2(D[1],D[0]);const Y=A[T.fontName];Y.vertical&&(N+=Math.PI/2);const z=Math.hypot(D[2],D[3]),te=z*u(Y.fontFamily,w._isOffscreenCanvasSupported);let Z,ne;N===0?(Z=D[4],ne=D[5]-te):(Z=D[4]+te*Math.sin(N),ne=D[5]-te*Math.cos(N));const oe="calc(var(--scale-factor)*",le=L.style;w._container===w._rootContainer?(le.left=`${(100*Z/w._pageWidth).toFixed(2)}%`,le.top=`${(100*ne/w._pageHeight).toFixed(2)}%`):(le.left=`${oe}${Z.toFixed(2)}px)`,le.top=`${oe}${ne.toFixed(2)}px)`),le.fontSize=`${oe}${z.toFixed(2)}px)`,le.fontFamily=Y.fontFamily,k.fontSize=z,L.setAttribute("role","presentation"),L.textContent=T.str,L.dir=T.dir,w._fontInspectorEnabled&&(L.dataset.fontName=T.fontName),N!==0&&(k.angle=N*(180/Math.PI));let pe=!1;if(T.str.length>1)pe=!0;else if(T.str!==" "&&T.transform[0]!==T.transform[3]){const de=Math.abs(T.transform[0]),J=Math.abs(T.transform[3]);de!==J&&Math.max(de,J)/Math.min(de,J)>1.5&&(pe=!0)}pe&&(k.canvasWidth=Y.vertical?T.height:T.width),w._textDivProperties.set(L,k),w._isReadableStream&&w._layoutText(L)}function g(w){const{div:T,scale:A,properties:L,ctx:k,prevFontSize:D,prevFontFamily:N}=w,{style:Y}=T;let z="";if(L.canvasWidth!==0&&L.hasText){const{fontFamily:te}=Y,{canvasWidth:Z,fontSize:ne}=L;(D!==ne||N!==te)&&(k.font=`${ne*A}px ${te}`,w.prevFontSize=ne,w.prevFontFamily=te);const{width:oe}=k.measureText(T.textContent);oe>0&&(z=`scaleX(${Z*A/oe})`)}L.angle!==0&&(z=`rotate(${L.angle}deg) ${z}`),z.length>0&&(Y.transform=z)}function v(w){if(w._canceled)return;const T=w._textDivs,A=w._capability;if(T.length>s){A.resolve();return}if(!w._isReadableStream)for(const k of T)w._layoutText(k);A.resolve()}class m{constructor({textContentSource:T,container:A,viewport:L,textDivs:k,textDivProperties:D,textContentItemsStr:N,isOffscreenCanvasSupported:Y}){this._textContentSource=T,this._isReadableStream=T instanceof ReadableStream,this._container=this._rootContainer=A,this._textDivs=k||[],this._textContentItemsStr=N||[],this._isOffscreenCanvasSupported=Y,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=D||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:L.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:f(0,Y)};const{pageWidth:z,pageHeight:te,pageX:Z,pageY:ne}=L.rawDims;this._transform=[1,0,0,-1,-Z,ne+te],this._pageWidth=z,this._pageHeight=te,(0,i.setLayerDimensions)(A,L),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(T,A){for(const L of T){if(L.str===void 0){if(L.type==="beginMarkedContentProps"||L.type==="beginMarkedContent"){const k=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),L.id!==null&&this._container.setAttribute("id",`${L.id}`),k.append(this._container)}else L.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(L.str),p(this,L,A)}}_layoutText(T){const A=this._layoutTextParams.properties=this._textDivProperties.get(T);if(this._layoutTextParams.div=T,g(this._layoutTextParams),A.hasText&&this._container.append(T),A.hasEOL){const L=document.createElement("br");L.setAttribute("role","presentation"),this._container.append(L)}}_render(){const T=new a.PromiseCapability;let A=Object.create(null);if(this._isReadableStream){const L=()=>{this._reader.read().then(({value:k,done:D})=>{if(D){T.resolve();return}Object.assign(A,k.styles),this._processItems(k.items,A),L()},T.reject)};this._reader=this._textContentSource.getReader(),L()}else if(this._textContentSource){const{items:L,styles:k}=this._textContentSource;this._processItems(L,k),T.resolve()}else throw new Error('No "textContentSource" parameter specified.');T.promise.then(()=>{A=null,v(this)},this._capability.reject)}}t.TextLayerRenderTask=m;function S(w){!w.textContentSource&&(w.textContent||w.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),w.textContentSource=w.textContent||w.textContentStream);const{container:T,viewport:A}=w,L=getComputedStyle(T),k=L.getPropertyValue("visibility"),D=parseFloat(L.getPropertyValue("--scale-factor"));k==="visible"&&(!D||Math.abs(D-A.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const N=new m(w);return N._render(),N}function E({container:w,viewport:T,textDivs:A,textDivProperties:L,isOffscreenCanvasSupported:k,mustRotate:D=!0,mustRescale:N=!0}){if(D&&(0,i.setLayerDimensions)(w,{rotation:T.rotation}),N){const Y=f(0,k),te={prevFontSize:null,prevFontFamily:null,div:null,scale:T.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Y};for(const Z of A)te.properties=L.get(Z),te.div=Z,g(te)}}}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var a=n(1),i=n(4),s=n(28),o=n(33),c=n(6),h=n(34);class f{#e;#t=!1;#r=null;#n=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#s=new Map;#i=!1;#l=!1;#c=!1;#a;static _initialized=!1;constructor({uiManager:p,pageIndex:g,div:v,accessibilityManager:m,annotationLayer:S,viewport:E,l10n:w}){const T=[s.FreeTextEditor,o.InkEditor,h.StampEditor];if(!f._initialized){f._initialized=!0;for(const A of T)A.initialize(w)}p.registerEditorTypes(T),this.#a=p,this.pageIndex=g,this.div=v,this.#e=m,this.#r=S,this.viewport=E,this.#a.addLayer(this)}get isEmpty(){return this.#s.size===0}updateToolbar(p){this.#a.updateToolbar(p)}updateMode(p=this.#a.getMode()){this.#p(),p===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),p!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",p===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",p===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",p===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(p){if(!p&&this.#a.getMode()!==a.AnnotationEditorType.INK)return;if(!p){for(const v of this.#s.values())if(v.isEmpty()){v.setInBackground();return}}this.#f({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(p){this.#a.setEditingState(p)}addCommands(p){this.#a.addCommands(p)}enable(){this.div.style.pointerEvents="auto";const p=new Set;for(const v of this.#s.values())v.enableEditing(),v.annotationElementId&&p.add(v.annotationElementId);if(!this.#r)return;const g=this.#r.getEditableAnnotations();for(const v of g){if(v.hide(),this.#a.isDeletedAnnotationElement(v.data.id)||p.has(v.data.id))continue;const m=this.deserialize(v);m&&(this.addOrRebuild(m),m.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const p=new Set;for(const g of this.#s.values()){if(g.disableEditing(),!g.annotationElementId||g.serialize()!==null){p.add(g.annotationElementId);continue}this.getEditableAnnotation(g.annotationElementId)?.show(),g.remove()}if(this.#r){const g=this.#r.getEditableAnnotations();for(const v of g){const{id:m}=v.data;p.has(m)||this.#a.isDeletedAnnotationElement(m)||v.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(p){return this.#r?.getEditableAnnotation(p)||null}setActiveEditor(p){this.#a.getActive()!==p&&this.#a.setActiveEditor(p)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#n)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#n)}attach(p){this.#s.set(p.id,p);const{annotationElementId:g}=p;g&&this.#a.isDeletedAnnotationElement(g)&&this.#a.removeDeletedAnnotationElement(p)}detach(p){this.#s.delete(p.id),this.#e?.removePointerInTextLayer(p.contentDiv),!this.#c&&p.annotationElementId&&this.#a.addDeletedAnnotationElement(p)}remove(p){this.detach(p),this.#a.removeEditor(p),p.div.contains(document.activeElement)&&setTimeout(()=>{this.#a.focusMainContainer()},0),p.div.remove(),p.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(p){p.parent!==this&&(p.annotationElementId&&(this.#a.addDeletedAnnotationElement(p.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(p),p.annotationElementId=null),this.attach(p),p.parent?.detach(p),p.setParent(this),p.div&&p.isAttachedToDOM&&(p.div.remove(),this.div.append(p.div)))}add(p){if(this.changeParent(p),this.#a.addEditor(p),this.attach(p),!p.isAttachedToDOM){const g=p.render();this.div.append(g),p.isAttachedToDOM=!0}p.fixAndSetPosition(),p.onceAdded(),this.#a.addToAnnotationStorage(p)}moveEditorInDOM(p){if(!p.isAttachedToDOM)return;const{activeElement:g}=document;p.div.contains(g)&&(p._focusEventsAllowed=!1,setTimeout(()=>{p.div.contains(document.activeElement)?p._focusEventsAllowed=!0:(p.div.addEventListener("focusin",()=>{p._focusEventsAllowed=!0},{once:!0}),g.focus())},0)),p._structTreeParentId=this.#e?.moveElementInDOM(this.div,p.div,p.contentDiv,!0)}addOrRebuild(p){p.needsToBeRebuilt()?p.rebuild():this.add(p)}addUndoableEditor(p){const g=()=>p._uiManager.rebuild(p),v=()=>{p.remove()};this.addCommands({cmd:g,undo:v,mustExec:!1})}getNextId(){return this.#a.getId()}#h(p){switch(this.#a.getMode()){case a.AnnotationEditorType.FREETEXT:return new s.FreeTextEditor(p);case a.AnnotationEditorType.INK:return new o.InkEditor(p);case a.AnnotationEditorType.STAMP:return new h.StampEditor(p)}return null}pasteEditor(p,g){this.#a.updateToolbar(p),this.#a.updateMode(p);const{offsetX:v,offsetY:m}=this.#d(),S=this.getNextId(),E=this.#h({parent:this,id:S,x:v,y:m,uiManager:this.#a,isCentered:!0,...g});E&&this.add(E)}deserialize(p){switch(p.annotationType??p.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return s.FreeTextEditor.deserialize(p,this,this.#a);case a.AnnotationEditorType.INK:return o.InkEditor.deserialize(p,this,this.#a);case a.AnnotationEditorType.STAMP:return h.StampEditor.deserialize(p,this,this.#a)}return null}#f(p,g){const v=this.getNextId(),m=this.#h({parent:this,id:v,x:p.offsetX,y:p.offsetY,uiManager:this.#a,isCentered:g});return m&&this.add(m),m}#d(){const{x:p,y:g,width:v,height:m}=this.div.getBoundingClientRect(),S=Math.max(0,p),E=Math.max(0,g),w=Math.min(window.innerWidth,p+v),T=Math.min(window.innerHeight,g+m),A=(S+w)/2-p,L=(E+T)/2-g,[k,D]=this.viewport.rotation%180===0?[A,L]:[L,A];return{offsetX:k,offsetY:D}}addNewEditor(){this.#f(this.#d(),!0)}setSelected(p){this.#a.setSelected(p)}toggleSelected(p){this.#a.toggleSelected(p)}isSelected(p){return this.#a.isSelected(p)}unselect(p){this.#a.unselect(p)}pointerup(p){const{isMac:g}=a.FeatureTest.platform;if(!(p.button!==0||p.ctrlKey&&g)&&p.target===this.div&&this.#i){if(this.#i=!1,!this.#t){this.#t=!0;return}if(this.#a.getMode()===a.AnnotationEditorType.STAMP){this.#a.unselectAll();return}this.#f(p,!1)}}pointerdown(p){if(this.#i){this.#i=!1;return}const{isMac:g}=a.FeatureTest.platform;if(p.button!==0||p.ctrlKey&&g||p.target!==this.div)return;this.#i=!0;const v=this.#a.getActive();this.#t=!v||v.isEmpty()}findNewParent(p,g,v){const m=this.#a.findParent(g,v);return m===null||m===this?!1:(m.changeParent(p),!0)}destroy(){this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null));for(const p of this.#s.values())this.#e?.removePointerInTextLayer(p.contentDiv),p.setParent(null),p.isAttachedToDOM=!1,p.div.remove();this.div=null,this.#s.clear(),this.#a.removeLayer(this)}#p(){this.#l=!0;for(const p of this.#s.values())p.isEmpty()&&p.remove();this.#l=!1}render({viewport:p}){this.viewport=p,(0,c.setLayerDimensions)(this.div,p);for(const g of this.#a.getEditors(this.pageIndex))this.add(g);this.updateMode()}update({viewport:p}){this.#a.commitOrRemove(),this.viewport=p,(0,c.setLayerDimensions)(this.div,{rotation:p.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:p,pageHeight:g}=this.viewport.rawDims;return[p,g]}}t.AnnotationEditorLayer=f}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var a=n(1),i=n(5),s=n(4),o=n(29);class c extends s.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#r=this.editorDivInput.bind(this);#n=this.editorDivKeydown.bind(this);#o;#s="";#i=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const f=c.prototype,u=v=>v.isEmpty(),p=i.AnnotationEditorUIManager.TRANSLATE_SMALL,g=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],f.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],f.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],f._translateEmpty,{args:[-p,0],checker:u}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],f._translateEmpty,{args:[-g,0],checker:u}],[["ArrowRight","mac+ArrowRight"],f._translateEmpty,{args:[p,0],checker:u}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],f._translateEmpty,{args:[g,0],checker:u}],[["ArrowUp","mac+ArrowUp"],f._translateEmpty,{args:[0,-p],checker:u}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],f._translateEmpty,{args:[0,-g],checker:u}],[["ArrowDown","mac+ArrowDown"],f._translateEmpty,{args:[0,p],checker:u}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],f._translateEmpty,{args:[0,g],checker:u}]]))}static _type="freetext";constructor(f){super({...f,name:"freeTextEditor"}),this.#o=f.color||c._defaultColor||s.AnnotationEditor._defaultLineColor,this.#l=f.fontSize||c._defaultFontSize}static initialize(f){s.AnnotationEditor.initialize(f,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const u=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(u.getPropertyValue("--freetext-padding"))}static updateDefaultParams(f,u){switch(f){case a.AnnotationEditorParamsType.FREETEXT_SIZE:c._defaultFontSize=u;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:c._defaultColor=u;break}}updateParams(f,u){switch(f){case a.AnnotationEditorParamsType.FREETEXT_SIZE:this.#a(u);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:this.#h(u);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,c._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,c._defaultColor||s.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[a.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#a(f){const u=g=>{this.editorDiv.style.fontSize=`calc(${g}px * var(--scale-factor))`,this.translate(0,-(g-this.#l)*this.parentScale),this.#l=g,this.#d()},p=this.#l;this.addCommands({cmd:()=>{u(f)},undo:()=>{u(p)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#h(f){const u=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=f},undo:()=>{this.#o=this.editorDiv.style.color=u},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(f,u){this._uiManager.translateSelectedEditors(f,u,!0)}getInitialTranslation(){const f=this.parentScale;return[-c._internalPadding*f,-(c._internalPadding+this.#l)*f]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#n),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#r))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#n),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#r),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(f){this._focusEventsAllowed&&(super.focusin(f),f.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#g();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#f(){const f=this.editorDiv.getElementsByTagName("div");if(f.length===0)return this.editorDiv.innerText;const u=[];for(const p of f)u.push(p.innerText.replace(/\r\n?|\n/,""));return u.join(`
`)}#d(){const[f,u]=this.parentDimensions;let p;if(this.isAttachedToDOM)p=this.div.getBoundingClientRect();else{const{currentLayer:g,div:v}=this,m=v.style.display;v.style.display="hidden",g.div.append(this.div),p=v.getBoundingClientRect(),v.remove(),v.style.display=m}this.rotation%180===this.parentRotation%180?(this.width=p.width/f,this.height=p.height/u):(this.width=p.height/f,this.height=p.width/u),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const f=this.#s,u=this.#s=this.#f().trimEnd();if(f===u)return;const p=g=>{if(this.#s=g,!g){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{p(u)},undo:()=>{p(f)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(f){this.enterInEditMode()}keydown(f){f.target===this.div&&f.key==="Enter"&&(this.enterInEditMode(),f.preventDefault())}editorDivKeydown(f){c._keyboardManager.exec(this,f)}editorDivFocus(f){this.isEditing=!0}editorDivBlur(f){this.isEditing=!1}editorDivInput(f){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let f,u;this.width&&(f=this.x,u=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.enableEditing(),s.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(g=>this.editorDiv?.setAttribute("aria-label",g)),s.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(g=>this.editorDiv?.setAttribute("default-content",g)),this.editorDiv.contentEditable=!0;const{style:p}=this.editorDiv;if(p.fontSize=`calc(${this.#l}px * var(--scale-factor))`,p.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[g,v]=this.parentDimensions;if(this.annotationElementId){const{position:m}=this.#c;let[S,E]=this.getInitialTranslation();[S,E]=this.pageTranslationToScreen(S,E);const[w,T]=this.pageDimensions,[A,L]=this.pageTranslation;let k,D;switch(this.rotation){case 0:k=f+(m[0]-A)/w,D=u+this.height-(m[1]-L)/T;break;case 90:k=f+(m[0]-A)/w,D=u-(m[1]-L)/T,[S,E]=[E,-S];break;case 180:k=f-this.width+(m[0]-A)/w,D=u-(m[1]-L)/T,[S,E]=[-S,-E];break;case 270:k=f+(m[0]-A-this.height*T)/w,D=u+(m[1]-L-this.width*w)/T,[S,E]=[-E,S];break}this.setAt(k*g,D*v,S,E)}else this.setAt(f*g,u*v,this.width*g,this.height*v);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#s)for(const f of this.#s.split(`
`)){const u=document.createElement("div");u.append(f?document.createTextNode(f):document.createElement("br")),this.editorDiv.append(u)}}get contentDiv(){return this.editorDiv}static deserialize(f,u,p){let g=null;if(f instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:m,fontColor:S},rect:E,rotation:w,id:T},textContent:A,textPosition:L,parent:{page:{pageNumber:k}}}=f;if(!A||A.length===0)return null;g=f={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(S),fontSize:m,value:A.join(`
`),position:L,pageIndex:k-1,rect:E,rotation:w,id:T,deleted:!1}}const v=super.deserialize(f,u,p);return v.#l=f.fontSize,v.#o=a.Util.makeHexColor(...f.color),v.#s=f.value,v.annotationElementId=f.id||null,v.#c=g,v}serialize(f=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const u=c._internalPadding*this.parentScale,p=this.getRect(u,u),g=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),v={annotationType:a.AnnotationEditorType.FREETEXT,color:g,fontSize:this.#l,value:this.#s,pageIndex:this.pageIndex,rect:p,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return f?v:this.annotationElementId&&!this.#v(v)?null:(v.id=this.annotationElementId,v)}#v(f){const{value:u,fontSize:p,color:g,rect:v,pageIndex:m}=this.#c;return f.value!==u||f.fontSize!==p||f.rect.some((S,E)=>Math.abs(S-v[E])>=1)||f.color.some((S,E)=>S!==g[E])||f.pageIndex!==m}#g(f=!1){if(!this.annotationElementId)return;if(this.#d(),!f&&(this.width===0||this.height===0)){setTimeout(()=>this.#g(!0),0);return}const u=c._internalPadding*this.parentScale;this.#c.rect=this.getRect(u,u)}}t.FreeTextEditor=c}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var a=n(1),i=n(6),s=n(3),o=n(30),c=n(31),h=n(32);const f=1e3,u=9,p=new WeakSet;function g(j){return{width:j[2]-j[0],height:j[3]-j[1]}}class v{static create(F){switch(F.data.annotationType){case a.AnnotationType.LINK:return new S(F);case a.AnnotationType.TEXT:return new E(F);case a.AnnotationType.WIDGET:switch(F.data.fieldType){case"Tx":return new T(F);case"Btn":return F.data.radioButton?new k(F):F.data.checkBox?new L(F):new D(F);case"Ch":return new N(F);case"Sig":return new A(F)}return new w(F);case a.AnnotationType.POPUP:return new Y(F);case a.AnnotationType.FREETEXT:return new te(F);case a.AnnotationType.LINE:return new Z(F);case a.AnnotationType.SQUARE:return new ne(F);case a.AnnotationType.CIRCLE:return new oe(F);case a.AnnotationType.POLYLINE:return new le(F);case a.AnnotationType.CARET:return new de(F);case a.AnnotationType.INK:return new J(F);case a.AnnotationType.POLYGON:return new pe(F);case a.AnnotationType.HIGHLIGHT:return new V(F);case a.AnnotationType.UNDERLINE:return new C(F);case a.AnnotationType.SQUIGGLY:return new O(F);case a.AnnotationType.STRIKEOUT:return new I(F);case a.AnnotationType.STAMP:return new M(F);case a.AnnotationType.FILEATTACHMENT:return new H(F);default:return new m(F)}}}class m{#e=!1;constructor(F,{isRenderable:q=!1,ignoreBorder:X=!1,createQuadrilaterals:W=!1}={}){this.isRenderable=q,this.data=F.data,this.layer=F.layer,this.linkService=F.linkService,this.downloadManager=F.downloadManager,this.imageResourcesPath=F.imageResourcesPath,this.renderForms=F.renderForms,this.svgFactory=F.svgFactory,this.annotationStorage=F.annotationStorage,this.enableScripting=F.enableScripting,this.hasJSActions=F.hasJSActions,this._fieldObjects=F.fieldObjects,this.parent=F.parent,q&&(this.container=this._createContainer(X)),W&&this._createQuadrilaterals()}static _hasPopupData({titleObj:F,contentsObj:q,richText:X}){return!!(F?.str||q?.str||X?.str)}get hasPopupData(){return m._hasPopupData(this.data)}_createContainer(F){const{data:q,parent:{page:X,viewport:W}}=this,K=document.createElement("section");K.setAttribute("data-annotation-id",q.id),this instanceof w||(K.tabIndex=f),K.style.zIndex=this.parent.zIndex++,this.data.popupRef&&K.setAttribute("aria-haspopup","dialog"),q.noRotate&&K.classList.add("norotate");const{pageWidth:ae,pageHeight:U,pageX:ve,pageY:be}=W.rawDims;if(!q.rect||this instanceof Y){const{rotation:De}=q;return!q.hasOwnCanvas&&De!==0&&this.setRotation(De,K),K}const{width:ye,height:_e}=g(q.rect),ge=a.Util.normalizeRect([q.rect[0],X.view[3]-q.rect[1]+X.view[1],q.rect[2],X.view[3]-q.rect[3]+X.view[1]]);if(!F&&q.borderStyle.width>0){K.style.borderWidth=`${q.borderStyle.width}px`;const De=q.borderStyle.horizontalCornerRadius,We=q.borderStyle.verticalCornerRadius;if(De>0||We>0){const Je=`calc(${De}px * var(--scale-factor)) / calc(${We}px * var(--scale-factor))`;K.style.borderRadius=Je}else if(this instanceof k){const Je=`calc(${ye}px * var(--scale-factor)) / calc(${_e}px * var(--scale-factor))`;K.style.borderRadius=Je}switch(q.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:K.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:K.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:K.style.borderBottomStyle="solid";break}const ze=q.borderColor||null;ze?(this.#e=!0,K.style.borderColor=a.Util.makeHexColor(ze[0]|0,ze[1]|0,ze[2]|0)):K.style.borderWidth=0}K.style.left=`${100*(ge[0]-ve)/ae}%`,K.style.top=`${100*(ge[1]-be)/U}%`;const{rotation:Re}=q;return q.hasOwnCanvas||Re===0?(K.style.width=`${100*ye/ae}%`,K.style.height=`${100*_e/U}%`):this.setRotation(Re,K),K}setRotation(F,q=this.container){if(!this.data.rect)return;const{pageWidth:X,pageHeight:W}=this.parent.viewport.rawDims,{width:K,height:ae}=g(this.data.rect);let U,ve;F%180===0?(U=100*K/X,ve=100*ae/W):(U=100*ae/X,ve=100*K/W),q.style.width=`${U}%`,q.style.height=`${ve}%`,q.setAttribute("data-main-rotation",(360-F)%360)}get _commonActions(){const F=(q,X,W)=>{const K=W.detail[q],ae=K[0],U=K.slice(1);W.target.style[X]=o.ColorConverters[`${ae}_HTML`](U),this.annotationStorage.setValue(this.data.id,{[X]:o.ColorConverters[`${ae}_rgb`](U)})};return(0,a.shadow)(this,"_commonActions",{display:q=>{const{display:X}=q.detail,W=X%2===1;this.container.style.visibility=W?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:W,noPrint:X===1||X===2})},print:q=>{this.annotationStorage.setValue(this.data.id,{noPrint:!q.detail.print})},hidden:q=>{const{hidden:X}=q.detail;this.container.style.visibility=X?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:X,noView:X})},focus:q=>{setTimeout(()=>q.target.focus({preventScroll:!1}),0)},userName:q=>{q.target.title=q.detail.userName},readonly:q=>{q.target.disabled=q.detail.readonly},required:q=>{this._setRequired(q.target,q.detail.required)},bgColor:q=>{F("bgColor","backgroundColor",q)},fillColor:q=>{F("fillColor","backgroundColor",q)},fgColor:q=>{F("fgColor","color",q)},textColor:q=>{F("textColor","color",q)},borderColor:q=>{F("borderColor","borderColor",q)},strokeColor:q=>{F("strokeColor","borderColor",q)},rotation:q=>{const X=q.detail.rotation;this.setRotation(X),this.annotationStorage.setValue(this.data.id,{rotation:X})}})}_dispatchEventFromSandbox(F,q){const X=this._commonActions;for(const W of Object.keys(q.detail))(F[W]||X[W])?.(q)}_setDefaultPropertiesFromJS(F){if(!this.enableScripting)return;const q=this.annotationStorage.getRawValue(this.data.id);if(!q)return;const X=this._commonActions;for(const[W,K]of Object.entries(q)){const ae=X[W];if(ae){const U={detail:{[W]:K},target:F};ae(U),delete q[W]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:F}=this.data;if(!F)return;const[q,X,W,K]=this.data.rect;if(F.length===1){const[,{x:We,y:ze},{x:Je,y:Qe}]=F[0];if(W===We&&K===ze&&q===Je&&X===Qe)return}const{style:ae}=this.container;let U;if(this.#e){const{borderColor:We,borderWidth:ze}=ae;ae.borderWidth=0,U=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${We}" stroke-width="${ze}">`],this.container.classList.add("hasBorder")}const ve=W-q,be=K-X,{svgFactory:ye}=this,_e=ye.createElement("svg");_e.classList.add("quadrilateralsContainer"),_e.setAttribute("width",0),_e.setAttribute("height",0);const ge=ye.createElement("defs");_e.append(ge);const Re=ye.createElement("clipPath"),De=`clippath_${this.data.id}`;Re.setAttribute("id",De),Re.setAttribute("clipPathUnits","objectBoundingBox"),ge.append(Re);for(const[,{x:We,y:ze},{x:Je,y:Qe}]of F){const et=ye.createElement("rect"),st=(Je-q)/ve,vt=(K-ze)/be,xt=(We-Je)/ve,ht=(ze-Qe)/be;et.setAttribute("x",st),et.setAttribute("y",vt),et.setAttribute("width",xt),et.setAttribute("height",ht),Re.append(et),U?.push(`<rect vector-effect="non-scaling-stroke" x="${st}" y="${vt}" width="${xt}" height="${ht}"/>`)}this.#e&&(U.push("</g></svg>')"),ae.backgroundImage=U.join("")),this.container.append(_e),this.container.style.clipPath=`url(#${De})`}_createPopup(){const{container:F,data:q}=this;F.setAttribute("aria-haspopup","dialog");const X=new Y({data:{color:q.color,titleObj:q.titleObj,modificationDate:q.modificationDate,contentsObj:q.contentsObj,richText:q.richText,parentRect:q.rect,borderStyle:0,id:`popup_${q.id}`,rotation:q.rotation},parent:this.parent,elements:[this]});this.parent.div.append(X.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(F,q=null){const X=[];if(this._fieldObjects){const W=this._fieldObjects[F];if(W)for(const{page:K,id:ae,exportValues:U}of W){if(K===-1||ae===q)continue;const ve=typeof U=="string"?U:null,be=document.querySelector(`[data-element-id="${ae}"]`);if(be&&!p.has(be)){(0,a.warn)(`_getElementsByName - element not allowed: ${ae}`);continue}X.push({id:ae,exportValue:ve,domElement:be})}return X}for(const W of document.getElementsByName(F)){const{exportValue:K}=W,ae=W.getAttribute("data-element-id");ae!==q&&p.has(W)&&X.push({id:ae,exportValue:K,domElement:W})}return X}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const F=this.getElementsToTriggerPopup();if(Array.isArray(F))for(const q of F)q.classList.add("highlightArea");else F.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:F,data:{id:q}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:F,editId:q})})}}class S extends m{constructor(F,q=null){super(F,{isRenderable:!0,ignoreBorder:!!q?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=F.data.isTooltipOnly}render(){const{data:F,linkService:q}=this,X=document.createElement("a");X.setAttribute("data-element-id",F.id);let W=!1;return F.url?(q.addLinkAttributes(X,F.url,F.newWindow),W=!0):F.action?(this._bindNamedAction(X,F.action),W=!0):F.attachment?(this._bindAttachment(X,F.attachment),W=!0):F.setOCGState?(this.#t(X,F.setOCGState),W=!0):F.dest?(this._bindLink(X,F.dest),W=!0):(F.actions&&(F.actions.Action||F.actions["Mouse Up"]||F.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(X,F),W=!0),F.resetForm?(this._bindResetFormAction(X,F.resetForm),W=!0):this.isTooltipOnly&&!W&&(this._bindLink(X,""),W=!0)),this.container.classList.add("linkAnnotation"),W&&this.container.append(X),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(F,q){F.href=this.linkService.getDestinationHash(q),F.onclick=()=>(q&&this.linkService.goToDestination(q),!1),(q||q==="")&&this.#e()}_bindNamedAction(F,q){F.href=this.linkService.getAnchorUrl(""),F.onclick=()=>(this.linkService.executeNamedAction(q),!1),this.#e()}_bindAttachment(F,q){F.href=this.linkService.getAnchorUrl(""),F.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,q.content,q.filename),!1),this.#e()}#t(F,q){F.href=this.linkService.getAnchorUrl(""),F.onclick=()=>(this.linkService.executeSetOCGState(q),!1),this.#e()}_bindJSAction(F,q){F.href=this.linkService.getAnchorUrl("");const X=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const W of Object.keys(q.actions)){const K=X.get(W);K&&(F[K]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q.id,name:W}}),!1))}F.onclick||(F.onclick=()=>!1),this.#e()}_bindResetFormAction(F,q){const X=F.onclick;if(X||(F.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),X||(F.onclick=()=>!1);return}F.onclick=()=>{X?.();const{fields:W,refs:K,include:ae}=q,U=[];if(W.length!==0||K.length!==0){const ye=new Set(K);for(const _e of W){const ge=this._fieldObjects[_e]||[];for(const{id:Re}of ge)ye.add(Re)}for(const _e of Object.values(this._fieldObjects))for(const ge of _e)ye.has(ge.id)===ae&&U.push(ge)}else for(const ye of Object.values(this._fieldObjects))U.push(...ye);const ve=this.annotationStorage,be=[];for(const ye of U){const{id:_e}=ye;switch(be.push(_e),ye.type){case"text":{const Re=ye.defaultValue||"";ve.setValue(_e,{value:Re});break}case"checkbox":case"radiobutton":{const Re=ye.defaultValue===ye.exportValues;ve.setValue(_e,{value:Re});break}case"combobox":case"listbox":{const Re=ye.defaultValue||"";ve.setValue(_e,{value:Re});break}default:continue}const ge=document.querySelector(`[data-element-id="${_e}"]`);if(ge){if(!p.has(ge)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${_e}`);continue}}else continue;ge.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:be,name:"ResetForm"}}),!1}}}class E extends m{constructor(F){super(F,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const F=document.createElement("img");return F.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",F.alt="[{{type}} Annotation]",F.dataset.l10nId="text_annotation_type",F.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(F),this.container}}class w extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(F){this.data.hasOwnCanvas&&(F.previousSibling?.nodeName==="CANVAS"&&(F.previousSibling.hidden=!0),F.hidden=!1)}_getKeyModifier(F){const{isWin:q,isMac:X}=a.FeatureTest.platform;return q&&F.ctrlKey||X&&F.metaKey}_setEventListener(F,q,X,W,K){X.includes("mouse")?F.addEventListener(X,ae=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:W,value:K(ae),shift:ae.shiftKey,modifier:this._getKeyModifier(ae)}})}):F.addEventListener(X,ae=>{if(X==="blur"){if(!q.focused||!ae.relatedTarget)return;q.focused=!1}else if(X==="focus"){if(q.focused)return;q.focused=!0}K&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:W,value:K(ae)}})})}_setEventListeners(F,q,X,W){for(const[K,ae]of X)(ae==="Action"||this.data.actions?.[ae])&&((ae==="Focus"||ae==="Blur")&&(q||={focused:!1}),this._setEventListener(F,q,K,ae,W),ae==="Focus"&&!this.data.actions?.Blur?this._setEventListener(F,q,"blur","Blur",null):ae==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(F,q,"focus","Focus",null))}_setBackgroundColor(F){const q=this.data.backgroundColor||null;F.style.backgroundColor=q===null?"transparent":a.Util.makeHexColor(q[0],q[1],q[2])}_setTextStyle(F){const q=["left","center","right"],{fontColor:X}=this.data.defaultAppearanceData,W=this.data.defaultAppearanceData.fontSize||u,K=F.style;let ae;const U=2,ve=be=>Math.round(10*be)/10;if(this.data.multiLine){const be=Math.abs(this.data.rect[3]-this.data.rect[1]-U),ye=Math.round(be/(a.LINE_FACTOR*W))||1,_e=be/ye;ae=Math.min(W,ve(_e/a.LINE_FACTOR))}else{const be=Math.abs(this.data.rect[3]-this.data.rect[1]-U);ae=Math.min(W,ve(be/a.LINE_FACTOR))}K.fontSize=`calc(${ae}px * var(--scale-factor))`,K.color=a.Util.makeHexColor(X[0],X[1],X[2]),this.data.textAlignment!==null&&(K.textAlign=q[this.data.textAlignment])}_setRequired(F,q){q?F.setAttribute("required",!0):F.removeAttribute("required"),F.setAttribute("aria-required",q)}}class T extends w{constructor(F){const q=F.renderForms||!F.data.hasAppearance&&!!F.data.fieldValue;super(F,{isRenderable:q})}setPropertyOnSiblings(F,q,X,W){const K=this.annotationStorage;for(const ae of this._getElementsByName(F.name,F.id))ae.domElement&&(ae.domElement[q]=X),K.setValue(ae.id,{[W]:X})}render(){const F=this.annotationStorage,q=this.data.id;this.container.classList.add("textWidgetAnnotation");let X=null;if(this.renderForms){const W=F.getValue(q,{value:this.data.fieldValue});let K=W.value||"";const ae=F.getValue(q,{charLimit:this.data.maxLen}).charLimit;ae&&K.length>ae&&(K=K.slice(0,ae));let U=W.formattedValue||this.data.textContent?.join(`
`)||null;U&&this.data.comb&&(U=U.replaceAll(/\s+/g,""));const ve={userValue:K,formattedValue:U,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(X=document.createElement("textarea"),X.textContent=U??K,this.data.doNotScroll&&(X.style.overflowY="hidden")):(X=document.createElement("input"),X.type="text",X.setAttribute("value",U??K),this.data.doNotScroll&&(X.style.overflowX="hidden")),this.data.hasOwnCanvas&&(X.hidden=!0),p.add(X),X.setAttribute("data-element-id",q),X.disabled=this.data.readOnly,X.name=this.data.fieldName,X.tabIndex=f,this._setRequired(X,this.data.required),ae&&(X.maxLength=ae),X.addEventListener("input",ye=>{F.setValue(q,{value:ye.target.value}),this.setPropertyOnSiblings(X,"value",ye.target.value,"value"),ve.formattedValue=null}),X.addEventListener("resetform",ye=>{const _e=this.data.defaultFieldValue??"";X.value=ve.userValue=_e,ve.formattedValue=null});let be=ye=>{const{formattedValue:_e}=ve;_e!=null&&(ye.target.value=_e),ye.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){X.addEventListener("focus",_e=>{if(ve.focused)return;const{target:ge}=_e;ve.userValue&&(ge.value=ve.userValue),ve.lastCommittedValue=ge.value,ve.commitKey=1,ve.focused=!0}),X.addEventListener("updatefromsandbox",_e=>{this.showElementAndHideCanvas(_e.target);const ge={value(Re){ve.userValue=Re.detail.value??"",F.setValue(q,{value:ve.userValue.toString()}),Re.target.value=ve.userValue},formattedValue(Re){const{formattedValue:De}=Re.detail;ve.formattedValue=De,De!=null&&Re.target!==document.activeElement&&(Re.target.value=De),F.setValue(q,{formattedValue:De})},selRange(Re){Re.target.setSelectionRange(...Re.detail.selRange)},charLimit:Re=>{const{charLimit:De}=Re.detail,{target:We}=Re;if(De===0){We.removeAttribute("maxLength");return}We.setAttribute("maxLength",De);let ze=ve.userValue;!ze||ze.length<=De||(ze=ze.slice(0,De),We.value=ve.userValue=ze,F.setValue(q,{value:ze}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:ze,willCommit:!0,commitKey:1,selStart:We.selectionStart,selEnd:We.selectionEnd}}))}};this._dispatchEventFromSandbox(ge,_e)}),X.addEventListener("keydown",_e=>{ve.commitKey=1;let ge=-1;if(_e.key==="Escape"?ge=0:_e.key==="Enter"&&!this.data.multiLine?ge=2:_e.key==="Tab"&&(ve.commitKey=3),ge===-1)return;const{value:Re}=_e.target;ve.lastCommittedValue!==Re&&(ve.lastCommittedValue=Re,ve.userValue=Re,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:Re,willCommit:!0,commitKey:ge,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}}))});const ye=be;be=null,X.addEventListener("blur",_e=>{if(!ve.focused||!_e.relatedTarget)return;ve.focused=!1;const{value:ge}=_e.target;ve.userValue=ge,ve.lastCommittedValue!==ge&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:ge,willCommit:!0,commitKey:ve.commitKey,selStart:_e.target.selectionStart,selEnd:_e.target.selectionEnd}}),ye(_e)}),this.data.actions?.Keystroke&&X.addEventListener("beforeinput",_e=>{ve.lastCommittedValue=null;const{data:ge,target:Re}=_e,{value:De,selectionStart:We,selectionEnd:ze}=Re;let Je=We,Qe=ze;switch(_e.inputType){case"deleteWordBackward":{const et=De.substring(0,We).match(/\w*[^\w]*$/);et&&(Je-=et[0].length);break}case"deleteWordForward":{const et=De.substring(We).match(/^[^\w]*\w*/);et&&(Qe+=et[0].length);break}case"deleteContentBackward":We===ze&&(Je-=1);break;case"deleteContentForward":We===ze&&(Qe+=1);break}_e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:De,change:ge||"",willCommit:!1,selStart:Je,selEnd:Qe}})}),this._setEventListeners(X,ve,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_e=>_e.target.value)}if(be&&X.addEventListener("blur",be),this.data.comb){const _e=(this.data.rect[2]-this.data.rect[0])/ae;X.classList.add("comb"),X.style.letterSpacing=`calc(${_e}px * var(--scale-factor) - 1ch)`}}else X=document.createElement("div"),X.textContent=this.data.fieldValue,X.style.verticalAlign="middle",X.style.display="table-cell";return this._setTextStyle(X),this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class A extends w{constructor(F){super(F,{isRenderable:!!F.data.hasOwnCanvas})}}class L extends w{constructor(F){super(F,{isRenderable:F.renderForms})}render(){const F=this.annotationStorage,q=this.data,X=q.id;let W=F.getValue(X,{value:q.exportValue===q.fieldValue}).value;typeof W=="string"&&(W=W!=="Off",F.setValue(X,{value:W})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const K=document.createElement("input");return p.add(K),K.setAttribute("data-element-id",X),K.disabled=q.readOnly,this._setRequired(K,this.data.required),K.type="checkbox",K.name=q.fieldName,W&&K.setAttribute("checked",!0),K.setAttribute("exportValue",q.exportValue),K.tabIndex=f,K.addEventListener("change",ae=>{const{name:U,checked:ve}=ae.target;for(const be of this._getElementsByName(U,X)){const ye=ve&&be.exportValue===q.exportValue;be.domElement&&(be.domElement.checked=ye),F.setValue(be.id,{value:ye})}F.setValue(X,{value:ve})}),K.addEventListener("resetform",ae=>{const U=q.defaultFieldValue||"Off";ae.target.checked=U===q.exportValue}),this.enableScripting&&this.hasJSActions&&(K.addEventListener("updatefromsandbox",ae=>{const U={value(ve){ve.target.checked=ve.detail.value!=="Off",F.setValue(X,{value:ve.target.checked})}};this._dispatchEventFromSandbox(U,ae)}),this._setEventListeners(K,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ae=>ae.target.checked)),this._setBackgroundColor(K),this._setDefaultPropertiesFromJS(K),this.container.append(K),this.container}}class k extends w{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const F=this.annotationStorage,q=this.data,X=q.id;let W=F.getValue(X,{value:q.fieldValue===q.buttonValue}).value;typeof W=="string"&&(W=W!==q.buttonValue,F.setValue(X,{value:W}));const K=document.createElement("input");if(p.add(K),K.setAttribute("data-element-id",X),K.disabled=q.readOnly,this._setRequired(K,this.data.required),K.type="radio",K.name=q.fieldName,W&&K.setAttribute("checked",!0),K.tabIndex=f,K.addEventListener("change",ae=>{const{name:U,checked:ve}=ae.target;for(const be of this._getElementsByName(U,X))F.setValue(be.id,{value:!1});F.setValue(X,{value:ve})}),K.addEventListener("resetform",ae=>{const U=q.defaultFieldValue;ae.target.checked=U!=null&&U===q.buttonValue}),this.enableScripting&&this.hasJSActions){const ae=q.buttonValue;K.addEventListener("updatefromsandbox",U=>{const ve={value:be=>{const ye=ae===be.detail.value;for(const _e of this._getElementsByName(be.target.name)){const ge=ye&&_e.id===X;_e.domElement&&(_e.domElement.checked=ge),F.setValue(_e.id,{value:ge})}}};this._dispatchEventFromSandbox(ve,U)}),this._setEventListeners(K,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)}return this._setBackgroundColor(K),this._setDefaultPropertiesFromJS(K),this.container.append(K),this.container}}class D extends S{constructor(F){super(F,{ignoreBorder:F.data.hasAppearance})}render(){const F=super.render();F.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(F.title=this.data.alternativeText);const q=F.lastChild;return this.enableScripting&&this.hasJSActions&&q&&(this._setDefaultPropertiesFromJS(q),q.addEventListener("updatefromsandbox",X=>{this._dispatchEventFromSandbox({},X)})),F}}class N extends w{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const F=this.annotationStorage,q=this.data.id,X=F.getValue(q,{value:this.data.fieldValue}),W=document.createElement("select");p.add(W),W.setAttribute("data-element-id",q),W.disabled=this.data.readOnly,this._setRequired(W,this.data.required),W.name=this.data.fieldName,W.tabIndex=f;let K=this.data.combo&&this.data.options.length>0;this.data.combo||(W.size=this.data.options.length,this.data.multiSelect&&(W.multiple=!0)),W.addEventListener("resetform",ye=>{const _e=this.data.defaultFieldValue;for(const ge of W.options)ge.selected=ge.value===_e});for(const ye of this.data.options){const _e=document.createElement("option");_e.textContent=ye.displayValue,_e.value=ye.exportValue,X.value.includes(ye.exportValue)&&(_e.setAttribute("selected",!0),K=!1),W.append(_e)}let ae=null;if(K){const ye=document.createElement("option");ye.value=" ",ye.setAttribute("hidden",!0),ye.setAttribute("selected",!0),W.prepend(ye),ae=()=>{ye.remove(),W.removeEventListener("input",ae),ae=null},W.addEventListener("input",ae)}const U=ye=>{const _e=ye?"value":"textContent",{options:ge,multiple:Re}=W;return Re?Array.prototype.filter.call(ge,De=>De.selected).map(De=>De[_e]):ge.selectedIndex===-1?null:ge[ge.selectedIndex][_e]};let ve=U(!1);const be=ye=>{const _e=ye.target.options;return Array.prototype.map.call(_e,ge=>({displayValue:ge.textContent,exportValue:ge.value}))};return this.enableScripting&&this.hasJSActions?(W.addEventListener("updatefromsandbox",ye=>{const _e={value(ge){ae?.();const Re=ge.detail.value,De=new Set(Array.isArray(Re)?Re:[Re]);for(const We of W.options)We.selected=De.has(We.value);F.setValue(q,{value:U(!0)}),ve=U(!1)},multipleSelection(ge){W.multiple=!0},remove(ge){const Re=W.options,De=ge.detail.remove;Re[De].selected=!1,W.remove(De),Re.length>0&&Array.prototype.findIndex.call(Re,ze=>ze.selected)===-1&&(Re[0].selected=!0),F.setValue(q,{value:U(!0),items:be(ge)}),ve=U(!1)},clear(ge){for(;W.length!==0;)W.remove(0);F.setValue(q,{value:null,items:[]}),ve=U(!1)},insert(ge){const{index:Re,displayValue:De,exportValue:We}=ge.detail.insert,ze=W.children[Re],Je=document.createElement("option");Je.textContent=De,Je.value=We,ze?ze.before(Je):W.append(Je),F.setValue(q,{value:U(!0),items:be(ge)}),ve=U(!1)},items(ge){const{items:Re}=ge.detail;for(;W.length!==0;)W.remove(0);for(const De of Re){const{displayValue:We,exportValue:ze}=De,Je=document.createElement("option");Je.textContent=We,Je.value=ze,W.append(Je)}W.options.length>0&&(W.options[0].selected=!0),F.setValue(q,{value:U(!0),items:be(ge)}),ve=U(!1)},indices(ge){const Re=new Set(ge.detail.indices);for(const De of ge.target.options)De.selected=Re.has(De.index);F.setValue(q,{value:U(!0)}),ve=U(!1)},editable(ge){ge.target.disabled=!ge.detail.editable}};this._dispatchEventFromSandbox(_e,ye)}),W.addEventListener("input",ye=>{const _e=U(!0);F.setValue(q,{value:_e}),ye.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:ve,changeEx:_e,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(W,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ye=>ye.target.value)):W.addEventListener("input",function(ye){F.setValue(q,{value:U(!0)})}),this.data.combo&&this._setTextStyle(W),this._setBackgroundColor(W),this._setDefaultPropertiesFromJS(W),this.container.append(W),this.container}}class Y extends m{constructor(F){const{data:q,elements:X}=F;super(F,{isRenderable:m._hasPopupData(q)}),this.elements=X}render(){this.container.classList.add("popupAnnotation");const F=new z({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),q=[];for(const X of this.elements)X.popup=F,q.push(X.data.id),X.addHighlightArea();return this.container.setAttribute("aria-controls",q.map(X=>`${a.AnnotationPrefix}${X}`).join(",")),this.container}}class z{#e=null;#t=this.#u.bind(this);#r=this.#E.bind(this);#n=this.#w.bind(this);#o=this.#x.bind(this);#s=null;#i=null;#l=null;#c=null;#a=null;#h=null;#f=!1;#d=null;#p=null;#v=null;#g=null;#m=!1;constructor({container:F,color:q,elements:X,titleObj:W,modificationDate:K,contentsObj:ae,richText:U,parent:ve,rect:be,parentRect:ye,open:_e}){this.#i=F,this.#g=W,this.#l=ae,this.#v=U,this.#a=ve,this.#s=q,this.#p=be,this.#h=ye,this.#c=X;const ge=i.PDFDateString.toDateObject(K);ge&&(this.#e=ve.l10n.get("annotation_date_string",{date:ge.toLocaleDateString(),time:ge.toLocaleTimeString()})),this.trigger=X.flatMap(Re=>Re.getElementsToTriggerPopup());for(const Re of this.trigger)Re.addEventListener("click",this.#o),Re.addEventListener("mouseenter",this.#n),Re.addEventListener("mouseleave",this.#r),Re.classList.add("popupTriggerArea");for(const Re of X)Re.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,_e&&this.#x()}render(){if(this.#d)return;const{page:{view:F},viewport:{rawDims:{pageWidth:q,pageHeight:X,pageX:W,pageY:K}}}=this.#a,ae=this.#d=document.createElement("div");if(ae.className="popup",this.#s){const et=ae.style.outlineColor=a.Util.makeHexColor(...this.#s);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?ae.style.backgroundColor=`color-mix(in srgb, ${et} 30%, white)`:ae.style.backgroundColor=a.Util.makeHexColor(...this.#s.map(vt=>Math.floor(.7*(255-vt)+vt)))}const U=document.createElement("span");U.className="header";const ve=document.createElement("h1");if(U.append(ve),{dir:ve.dir,str:ve.textContent}=this.#g,ae.append(U),this.#e){const et=document.createElement("span");et.classList.add("popupDate"),this.#e.then(st=>{et.textContent=st}),U.append(et)}const be=this.#l,ye=this.#v;if(ye?.str&&(!be?.str||be.str===ye.str))h.XfaLayer.render({xfaHtml:ye.html,intent:"richText",div:ae}),ae.lastChild.classList.add("richText","popupContent");else{const et=this._formatContents(be);ae.append(et)}let _e=!!this.#h,ge=_e?this.#h:this.#p;for(const et of this.#c)if(!ge||a.Util.intersect(et.data.rect,ge)!==null){ge=et.data.rect,_e=!0;break}const Re=a.Util.normalizeRect([ge[0],F[3]-ge[1]+F[1],ge[2],F[3]-ge[3]+F[1]]),We=_e?ge[2]-ge[0]+5:0,ze=Re[0]+We,Je=Re[1],{style:Qe}=this.#i;Qe.left=`${100*(ze-W)/q}%`,Qe.top=`${100*(Je-K)/X}%`,this.#i.append(ae)}_formatContents({str:F,dir:q}){const X=document.createElement("p");X.classList.add("popupContent"),X.dir=q;const W=F.split(/(?:\r\n?|\n)/);for(let K=0,ae=W.length;K<ae;++K){const U=W[K];X.append(document.createTextNode(U)),K<ae-1&&X.append(document.createElement("br"))}return X}#u(F){F.altKey||F.shiftKey||F.ctrlKey||F.metaKey||(F.key==="Enter"||F.key==="Escape"&&this.#f)&&this.#x()}#x(){this.#f=!this.#f,this.#f?(this.#w(),this.#i.addEventListener("click",this.#o),this.#i.addEventListener("keydown",this.#t)):(this.#E(),this.#i.removeEventListener("click",this.#o),this.#i.removeEventListener("keydown",this.#t))}#w(){this.#d||this.render(),this.isVisible?this.#f&&this.#i.classList.add("focused"):(this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#E(){this.#i.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#m=this.isVisible,this.#m&&(this.#i.hidden=!0)}maybeShow(){this.#m&&(this.#m=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class te extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.textContent=F.data.textContent,this.textPosition=F.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const F=document.createElement("div");F.classList.add("annotationTextContent"),F.setAttribute("role","comment");for(const q of this.textContent){const X=document.createElement("span");X.textContent=q,F.append(X)}this.container.append(F)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=te;class Z extends m{#e=null;constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const F=this.data,{width:q,height:X}=g(F.rect),W=this.svgFactory.create(q,X,!0),K=this.#e=this.svgFactory.createElement("svg:line");return K.setAttribute("x1",F.rect[2]-F.lineCoordinates[0]),K.setAttribute("y1",F.rect[3]-F.lineCoordinates[1]),K.setAttribute("x2",F.rect[2]-F.lineCoordinates[2]),K.setAttribute("y2",F.rect[3]-F.lineCoordinates[3]),K.setAttribute("stroke-width",F.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),W.append(K),this.container.append(W),!F.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ne extends m{#e=null;constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const F=this.data,{width:q,height:X}=g(F.rect),W=this.svgFactory.create(q,X,!0),K=F.borderStyle.width,ae=this.#e=this.svgFactory.createElement("svg:rect");return ae.setAttribute("x",K/2),ae.setAttribute("y",K/2),ae.setAttribute("width",q-K),ae.setAttribute("height",X-K),ae.setAttribute("stroke-width",K||1),ae.setAttribute("stroke","transparent"),ae.setAttribute("fill","transparent"),W.append(ae),this.container.append(W),!F.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class oe extends m{#e=null;constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const F=this.data,{width:q,height:X}=g(F.rect),W=this.svgFactory.create(q,X,!0),K=F.borderStyle.width,ae=this.#e=this.svgFactory.createElement("svg:ellipse");return ae.setAttribute("cx",q/2),ae.setAttribute("cy",X/2),ae.setAttribute("rx",q/2-K/2),ae.setAttribute("ry",X/2-K/2),ae.setAttribute("stroke-width",K||1),ae.setAttribute("stroke","transparent"),ae.setAttribute("fill","transparent"),W.append(ae),this.container.append(W),!F.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class le extends m{#e=null;constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const F=this.data,{width:q,height:X}=g(F.rect),W=this.svgFactory.create(q,X,!0);let K=[];for(const U of F.vertices){const ve=U.x-F.rect[0],be=F.rect[3]-U.y;K.push(ve+","+be)}K=K.join(" ");const ae=this.#e=this.svgFactory.createElement(this.svgElementName);return ae.setAttribute("points",K),ae.setAttribute("stroke-width",F.borderStyle.width||1),ae.setAttribute("stroke","transparent"),ae.setAttribute("fill","transparent"),W.append(ae),this.container.append(W),!F.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class pe extends le{constructor(F){super(F),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class de extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class J extends m{#e=[];constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const F=this.data,{width:q,height:X}=g(F.rect),W=this.svgFactory.create(q,X,!0);for(const K of F.inkLists){let ae=[];for(const ve of K){const be=ve.x-F.rect[0],ye=F.rect[3]-ve.y;ae.push(`${be},${ye}`)}ae=ae.join(" ");const U=this.svgFactory.createElement(this.svgElementName);this.#e.push(U),U.setAttribute("points",ae),U.setAttribute("stroke-width",F.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),!F.popupRef&&this.hasPopupData&&this._createPopup(),W.append(U)}return this.container.append(W),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=J;class V extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class C extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class O extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class I extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class M extends m{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=M;class H extends m{#e=null;constructor(F){super(F,{isRenderable:!0});const{filename:q,content:X}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(q,!0),this.content=X,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:q,content:X})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:F,data:q}=this;let X;q.hasAppearance||q.fillAlpha===0?X=document.createElement("div"):(X=document.createElement("img"),X.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(q.name)?"paperclip":"pushpin"}.svg`,q.fillAlpha&&q.fillAlpha<1&&(X.style=`filter: opacity(${Math.round(q.fillAlpha*100)}%);`)),X.addEventListener("dblclick",this.#t.bind(this)),this.#e=X;const{isMac:W}=a.FeatureTest.platform;return F.addEventListener("keydown",K=>{K.key==="Enter"&&(W?K.metaKey:K.ctrlKey)&&this.#t()}),!q.popupRef&&this.hasPopupData?this._createPopup():X.classList.add("popupTriggerArea"),F.append(X),F}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class G{#e=null;#t=null;#r=new Map;constructor({div:F,accessibilityManager:q,annotationCanvasMap:X,l10n:W,page:K,viewport:ae}){this.div=F,this.#e=q,this.#t=X,this.l10n=W,this.page=K,this.viewport=ae,this.zIndex=0,this.l10n||=c.NullL10n}#n(F,q){const X=F.firstChild||F;X.id=`${a.AnnotationPrefix}${q}`,this.div.append(F),this.#e?.moveElementInDOM(this.div,F,X,!1)}async render(F){const{annotations:q}=F,X=this.div;(0,i.setLayerDimensions)(X,this.viewport);const W=new Map,K={data:null,layer:X,linkService:F.linkService,downloadManager:F.downloadManager,imageResourcesPath:F.imageResourcesPath||"",renderForms:F.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:F.annotationStorage||new s.AnnotationStorage,enableScripting:F.enableScripting===!0,hasJSActions:F.hasJSActions,fieldObjects:F.fieldObjects,parent:this,elements:null};for(const ae of q){if(ae.noHTML)continue;const U=ae.annotationType===a.AnnotationType.POPUP;if(U){const ye=W.get(ae.id);if(!ye)continue;K.elements=ye}else{const{width:ye,height:_e}=g(ae.rect);if(ye<=0||_e<=0)continue}K.data=ae;const ve=v.create(K);if(!ve.isRenderable)continue;if(!U&&ae.popupRef){const ye=W.get(ae.popupRef);ye?ye.push(ve):W.set(ae.popupRef,[ve])}ve.annotationEditorType>0&&this.#r.set(ve.data.id,ve);const be=ve.render();ae.hidden&&(be.style.visibility="hidden"),this.#n(be,ae.id)}this.#o(),await this.l10n.translate(X)}update({viewport:F}){const q=this.div;this.viewport=F,(0,i.setLayerDimensions)(q,{rotation:F.rotation}),this.#o(),q.hidden=!1}#o(){if(!this.#t)return;const F=this.div;for(const[q,X]of this.#t){const W=F.querySelector(`[data-annotation-id="${q}"]`);if(!W)continue;const{firstChild:K}=W;K?K.nodeName==="CANVAS"?K.replaceWith(X):K.before(X):W.append(X)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#r.values())}getEditableAnnotation(F){return this.#r.get(F)}}t.AnnotationLayer=G}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function n(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function a(s){return Math.max(0,Math.min(255,255*s))}class i{static CMYK_G([o,c,h,f]){return["G",1-Math.min(1,.3*o+.59*h+.11*c+f)]}static G_CMYK([o]){return["CMYK",0,0,0,1-o]}static G_RGB([o]){return["RGB",o,o,o]}static G_rgb([o]){return o=a(o),[o,o,o]}static G_HTML([o]){const c=n(o);return`#${c}${c}${c}`}static RGB_G([o,c,h]){return["G",.3*o+.59*c+.11*h]}static RGB_rgb(o){return o.map(a)}static RGB_HTML(o){return`#${o.map(n).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([o,c,h,f]){return["RGB",1-Math.min(1,o+f),1-Math.min(1,h+f),1-Math.min(1,c+f)]}static CMYK_rgb([o,c,h,f]){return[a(1-Math.min(1,o+f)),a(1-Math.min(1,h+f)),a(1-Math.min(1,c+f))]}static CMYK_HTML(o){const c=this.CMYK_RGB(o).slice(1);return this.RGB_HTML(c)}static RGB_CMYK([o,c,h]){const f=1-o,u=1-c,p=1-h,g=Math.min(f,u,p);return["CMYK",f,u,p,g]}}t.ColorConverters=i}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=a;const n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};n.print_progress_percent="{{progress}}%";function a(o,c){switch(o){case"find_match_count":o=`find_match_count[${c.total===1?"one":"other"}]`;break;case"find_match_count_limit":o=`find_match_count_limit[${c.limit===1?"one":"other"}]`;break}return n[o]||""}function i(o,c){return c?o.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,f)=>f in c?c[f]:"{{"+f+"}}"):o}const s={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(o,c=null,h=a(o,c)){return i(h,c)},async translate(o){}};t.NullL10n=s}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var a=n(25);class i{static setupStorage(o,c,h,f,u){const p=f.getValue(c,{value:null});switch(h.name){case"textarea":if(p.value!==null&&(o.textContent=p.value),u==="print")break;o.addEventListener("input",g=>{f.setValue(c,{value:g.target.value})});break;case"input":if(h.attributes.type==="radio"||h.attributes.type==="checkbox"){if(p.value===h.attributes.xfaOn?o.setAttribute("checked",!0):p.value===h.attributes.xfaOff&&o.removeAttribute("checked"),u==="print")break;o.addEventListener("change",g=>{f.setValue(c,{value:g.target.checked?g.target.getAttribute("xfaOn"):g.target.getAttribute("xfaOff")})})}else{if(p.value!==null&&o.setAttribute("value",p.value),u==="print")break;o.addEventListener("input",g=>{f.setValue(c,{value:g.target.value})})}break;case"select":if(p.value!==null){o.setAttribute("value",p.value);for(const g of h.children)g.attributes.value===p.value?g.attributes.selected=!0:g.attributes.hasOwnProperty("selected")&&delete g.attributes.selected}o.addEventListener("input",g=>{const v=g.target.options,m=v.selectedIndex===-1?"":v[v.selectedIndex].value;f.setValue(c,{value:m})});break}}static setAttributes({html:o,element:c,storage:h=null,intent:f,linkService:u}){const{attributes:p}=c,g=o instanceof HTMLAnchorElement;p.type==="radio"&&(p.name=`${p.name}-${f}`);for(const[v,m]of Object.entries(p))if(m!=null)switch(v){case"class":m.length&&o.setAttribute(v,m.join(" "));break;case"dataId":break;case"id":o.setAttribute("data-element-id",m);break;case"style":Object.assign(o.style,m);break;case"textContent":o.textContent=m;break;default:(!g||v!=="href"&&v!=="newWindow")&&o.setAttribute(v,m)}g&&u.addLinkAttributes(o,p.href,p.newWindow),h&&p.dataId&&this.setupStorage(o,p.dataId,c,h)}static render(o){const c=o.annotationStorage,h=o.linkService,f=o.xfaHtml,u=o.intent||"display",p=document.createElement(f.name);f.attributes&&this.setAttributes({html:p,element:f,intent:u,linkService:h});const g=[[f,-1,p]],v=o.div;if(v.append(p),o.viewport){const S=`matrix(${o.viewport.transform.join(",")})`;v.style.transform=S}u!=="richText"&&v.setAttribute("class","xfaLayer xfaFont");const m=[];for(;g.length>0;){const[S,E,w]=g.at(-1);if(E+1===S.children.length){g.pop();continue}const T=S.children[++g.at(-1)[1]];if(T===null)continue;const{name:A}=T;if(A==="#text"){const k=document.createTextNode(T.value);m.push(k),w.append(k);continue}const L=T?.attributes?.xmlns?document.createElementNS(T.attributes.xmlns,A):document.createElement(A);if(w.append(L),T.attributes&&this.setAttributes({html:L,element:T,storage:c,intent:u,linkService:h}),T.children&&T.children.length>0)g.push([T,-1,L]);else if(T.value){const k=document.createTextNode(T.value);a.XfaText.shouldBuildText(A)&&m.push(k),L.append(k)}}for(const S of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))S.setAttribute("readOnly",!0);return{textDivs:m}}static update(o){const c=`matrix(${o.viewport.transform.join(",")})`;o.div.style.transform=c,o.div.hidden=!1}}t.XfaLayer=i}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var a=n(1),i=n(4),s=n(29),o=n(6),c=n(5);class h extends i.AnnotationEditor{#e=0;#t=0;#r=this.canvasPointermove.bind(this);#n=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#s=this.canvasPointerdown.bind(this);#i=new Path2D;#l=!1;#c=!1;#a=!1;#h=null;#f=0;#d=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(u){super({...u,name:"inkEditor"}),this.color=u.color||null,this.thickness=u.thickness||null,this.opacity=u.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(u){i.AnnotationEditor.initialize(u,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(u,p){switch(u){case a.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=p;break;case a.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=p;break;case a.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=p/100;break}}updateParams(u,p){switch(u){case a.AnnotationEditorParamsType.INK_THICKNESS:this.#v(p);break;case a.AnnotationEditorParamsType.INK_COLOR:this.#g(p);break;case a.AnnotationEditorParamsType.INK_OPACITY:this.#m(p);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||i.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(h._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||i.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#v(u){const p=this.thickness;this.addCommands({cmd:()=>{this.thickness=u,this.#A()},undo:()=>{this.thickness=p,this.#A()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#g(u){const p=this.color;this.addCommands({cmd:()=>{this.color=u,this.#y()},undo:()=>{this.color=p,this.#y()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#m(u){u/=100;const p=this.opacity;this.addCommands({cmd:()=>{this.opacity=u,this.#y()},undo:()=>{this.opacity=p,this.#y()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#P(),this.#R()),this.isAttachedToDOM||(this.parent.add(this),this.#_()),this.#A()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#h.disconnect(),this.#h=null,super.remove())}setParent(u){!this.parent&&u?this._uiManager.removeShouldRescale(this):this.parent&&u===null&&this._uiManager.addShouldRescale(this),super.setParent(u)}onScaleChanging(){const[u,p]=this.parentDimensions,g=this.width*u,v=this.height*p;this.setDimensions(g,v)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#s))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#s))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#u(){const{parentRotation:u,parentDimensions:[p,g]}=this;switch(u){case 90:return[0,g,g,p];case 180:return[p,g,p,g];case 270:return[p,0,g,p];default:return[0,0,p,g]}}#x(){const{ctx:u,color:p,opacity:g,thickness:v,parentScale:m,scaleFactor:S}=this;u.lineWidth=v*m/S,u.lineCap="round",u.lineJoin="round",u.miterLimit=10,u.strokeStyle=`${p}${(0,c.opacityToHex)(g)}`}#w(u,p){this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",this.#n),this.canvas.addEventListener("pointermove",this.#r),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#s),this.isEditing=!0,this.#a||(this.#a=!0,this.#_(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||i.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([u,p]),this.#c=!1,this.#x(),this.#p=()=>{this.#I(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#E(u,p){const[g,v]=this.currentPath.at(-1);if(this.currentPath.length>1&&u===g&&p===v)return;const m=this.currentPath;let S=this.#i;if(m.push([u,p]),this.#c=!0,m.length<=2){S.moveTo(...m[0]),S.lineTo(u,p);return}m.length===3&&(this.#i=S=new Path2D,S.moveTo(...m[0])),this.#M(S,...m.at(-3),...m.at(-2),u,p)}#T(){if(this.currentPath.length===0)return;const u=this.currentPath.at(-1);this.#i.lineTo(...u)}#C(u,p){this.#p=null,u=Math.min(Math.max(u,0),this.canvas.width),p=Math.min(Math.max(p,0),this.canvas.height),this.#E(u,p),this.#T();let g;if(this.currentPath.length!==1)g=this.#L();else{const w=[u,p];g=[[w,w.slice(),w.slice(),w]]}const v=this.#i,m=this.currentPath;this.currentPath=[],this.#i=new Path2D;const S=()=>{this.allRawPaths.push(m),this.paths.push(g),this.bezierPath2D.push(v),this.rebuild()},E=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#P(),this.#R()),this.#A())};this.addCommands({cmd:S,undo:E,mustExec:!0})}#I(){if(!this.#c)return;this.#c=!1;const u=Math.ceil(this.thickness*this.parentScale),p=this.currentPath.slice(-3),g=p.map(S=>S[0]),v=p.map(S=>S[1]);Math.min(...g)-u,Math.max(...g)+u,Math.min(...v)-u,Math.max(...v)+u;const{ctx:m}=this;m.save(),m.clearRect(0,0,this.canvas.width,this.canvas.height);for(const S of this.bezierPath2D)m.stroke(S);m.stroke(this.#i),m.restore()}#M(u,p,g,v,m,S,E){const w=(p+v)/2,T=(g+m)/2,A=(v+S)/2,L=(m+E)/2;u.bezierCurveTo(w+2*(v-w)/3,T+2*(m-T)/3,A+2*(v-A)/3,L+2*(m-L)/3,A,L)}#L(){const u=this.currentPath;if(u.length<=2)return[[u[0],u[0],u.at(-1),u.at(-1)]];const p=[];let g,[v,m]=u[0];for(g=1;g<u.length-2;g++){const[k,D]=u[g],[N,Y]=u[g+1],z=(k+N)/2,te=(D+Y)/2,Z=[v+2*(k-v)/3,m+2*(D-m)/3],ne=[z+2*(k-z)/3,te+2*(D-te)/3];p.push([[v,m],Z,ne,[z,te]]),[v,m]=[z,te]}const[S,E]=u[g],[w,T]=u[g+1],A=[v+2*(S-v)/3,m+2*(E-m)/3],L=[w+2*(S-w)/3,T+2*(E-T)/3];return p.push([[v,m],A,L,[w,T]]),p}#y(){if(this.isEmpty()){this.#b();return}this.#x();const{canvas:u,ctx:p}=this;p.setTransform(1,0,0,1,0,0),p.clearRect(0,0,u.width,u.height),this.#b();for(const g of this.bezierPath2D)p.stroke(g)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#A(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(u){this._focusEventsAllowed&&(super.focusin(u),this.enableEditMode())}canvasPointerdown(u){u.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),u.preventDefault(),u.type!=="mouse"&&this.div.focus(),this.#w(u.offsetX,u.offsetY))}canvasPointermove(u){u.preventDefault(),this.#E(u.offsetX,u.offsetY)}canvasPointerup(u){u.preventDefault(),this.#D(u)}canvasPointerleave(u){this.#D(u)}#D(u){this.canvas.removeEventListener("pointerleave",this.#n),this.canvas.removeEventListener("pointermove",this.#r),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#s),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)},10),this.#C(u.offsetX,u.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#P(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(u=>this.canvas?.setAttribute("aria-label",u)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#R(){this.#h=new ResizeObserver(u=>{const p=u[0].contentRect;p.width&&p.height&&this.setDimensions(p.width,p.height)}),this.#h.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let u,p;this.width&&(u=this.x,p=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(E=>this.div?.setAttribute("aria-label",E));const[g,v,m,S]=this.#u();if(this.setAt(g,v,0,0),this.setDims(m,S),this.#P(),this.width){const[E,w]=this.parentDimensions;this.setAspectRatio(this.width*E,this.height*w),this.setAt(u*E,p*w,this.width*E,this.height*w),this.#a=!0,this.#_(),this.setDims(this.width*E,this.height*w),this.#y(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#R(),this.div}#_(){if(!this.#a)return;const[u,p]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*u),this.canvas.height=Math.ceil(this.height*p),this.#b()}setDimensions(u,p){const g=Math.round(u),v=Math.round(p);if(this.#f===g&&this.#d===v)return;this.#f=g,this.#d=v,this.canvas.style.visibility="hidden";const[m,S]=this.parentDimensions;this.width=u/m,this.height=p/S,this.fixAndSetPosition(),this.#l&&this.#k(u,p),this.#_(),this.#y(),this.canvas.style.visibility="visible",this.fixDims()}#k(u,p){const g=this.#F(),v=(u-g)/this.#t,m=(p-g)/this.#e;this.scaleFactor=Math.min(v,m)}#b(){const u=this.#F()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+u,this.translationY*this.scaleFactor+u)}static#N(u){const p=new Path2D;for(let g=0,v=u.length;g<v;g++){const[m,S,E,w]=u[g];g===0&&p.moveTo(...m),p.bezierCurveTo(S[0],S[1],E[0],E[1],w[0],w[1])}return p}static#B(u,p,g){const[v,m,S,E]=p;switch(g){case 0:for(let w=0,T=u.length;w<T;w+=2)u[w]+=v,u[w+1]=E-u[w+1];break;case 90:for(let w=0,T=u.length;w<T;w+=2){const A=u[w];u[w]=u[w+1]+v,u[w+1]=A+m}break;case 180:for(let w=0,T=u.length;w<T;w+=2)u[w]=S-u[w],u[w+1]+=m;break;case 270:for(let w=0,T=u.length;w<T;w+=2){const A=u[w];u[w]=S-u[w+1],u[w+1]=E-A}break;default:throw new Error("Invalid rotation")}return u}static#$(u,p,g){const[v,m,S,E]=p;switch(g){case 0:for(let w=0,T=u.length;w<T;w+=2)u[w]-=v,u[w+1]=E-u[w+1];break;case 90:for(let w=0,T=u.length;w<T;w+=2){const A=u[w];u[w]=u[w+1]-m,u[w+1]=A-v}break;case 180:for(let w=0,T=u.length;w<T;w+=2)u[w]=S-u[w],u[w+1]-=m;break;case 270:for(let w=0,T=u.length;w<T;w+=2){const A=u[w];u[w]=E-u[w+1],u[w+1]=S-A}break;default:throw new Error("Invalid rotation")}return u}#j(u,p,g,v){const m=[],S=this.thickness/2,E=u*p+S,w=u*g+S;for(const T of this.paths){const A=[],L=[];for(let k=0,D=T.length;k<D;k++){const[N,Y,z,te]=T[k],Z=u*N[0]+E,ne=u*N[1]+w,oe=u*Y[0]+E,le=u*Y[1]+w,pe=u*z[0]+E,de=u*z[1]+w,J=u*te[0]+E,V=u*te[1]+w;k===0&&(A.push(Z,ne),L.push(Z,ne)),A.push(oe,le,pe,de,J,V),L.push(oe,le),k===D-1&&L.push(J,V)}m.push({bezier:h.#B(A,v,this.rotation),points:h.#B(L,v,this.rotation)})}return m}#O(){let u=1/0,p=-1/0,g=1/0,v=-1/0;for(const m of this.paths)for(const[S,E,w,T]of m){const A=a.Util.bezierBoundingBox(...S,...E,...w,...T);u=Math.min(u,A[0]),g=Math.min(g,A[1]),p=Math.max(p,A[2]),v=Math.max(v,A[3])}return[u,g,p,v]}#F(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#A(u=!1){if(this.isEmpty())return;if(!this.#l){this.#y();return}const p=this.#O(),g=this.#F();this.#t=Math.max(i.AnnotationEditor.MIN_SIZE,p[2]-p[0]),this.#e=Math.max(i.AnnotationEditor.MIN_SIZE,p[3]-p[1]);const v=Math.ceil(g+this.#t*this.scaleFactor),m=Math.ceil(g+this.#e*this.scaleFactor),[S,E]=this.parentDimensions;this.width=v/S,this.height=m/E,this.setAspectRatio(v,m);const w=this.translationX,T=this.translationY;this.translationX=-p[0],this.translationY=-p[1],this.#_(),this.#y(),this.#f=v,this.#d=m,this.setDims(v,m);const A=u?g/this.scaleFactor/2:0;this.translate(w-this.translationX-A,T-this.translationY-A)}static deserialize(u,p,g){if(u instanceof s.InkAnnotationElement)return null;const v=super.deserialize(u,p,g);v.thickness=u.thickness,v.color=a.Util.makeHexColor(...u.color),v.opacity=u.opacity;const[m,S]=v.pageDimensions,E=v.width*m,w=v.height*S,T=v.parentScale,A=u.thickness/2;v.#l=!0,v.#f=Math.round(E),v.#d=Math.round(w);const{paths:L,rect:k,rotation:D}=u;for(let{bezier:Y}of L){Y=h.#$(Y,k,D);const z=[];v.paths.push(z);let te=T*(Y[0]-A),Z=T*(Y[1]-A);for(let oe=2,le=Y.length;oe<le;oe+=6){const pe=T*(Y[oe]-A),de=T*(Y[oe+1]-A),J=T*(Y[oe+2]-A),V=T*(Y[oe+3]-A),C=T*(Y[oe+4]-A),O=T*(Y[oe+5]-A);z.push([[te,Z],[pe,de],[J,V],[C,O]]),te=C,Z=O}const ne=this.#N(z);v.bezierPath2D.push(ne)}const N=v.#O();return v.#t=Math.max(i.AnnotationEditor.MIN_SIZE,N[2]-N[0]),v.#e=Math.max(i.AnnotationEditor.MIN_SIZE,N[3]-N[1]),v.#k(E,w),v}serialize(){if(this.isEmpty())return null;const u=this.getRect(0,0),p=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:p,thickness:this.thickness,opacity:this.opacity,paths:this.#j(this.scaleFactor/this.parentScale,this.translationX,this.translationY,u),pageIndex:this.pageIndex,rect:u,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}t.InkEditor=h}),((e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var a=n(1),i=n(4),s=n(6),o=n(29);class c extends i.AnnotationEditor{#e=null;#t=null;#r=null;#n=null;#o=null;#s=null;#i=null;#l=null;#c=!1;#a=!1;static _type="stamp";constructor(f){super({...f,name:"stampEditor"}),this.#n=f.bitmapUrl,this.#o=f.bitmapFile}static initialize(f){i.AnnotationEditor.initialize(f)}static get supportedTypes(){const f=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,a.shadow)(this,"supportedTypes",f.map(u=>`image/${u}`))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(f){return this.supportedTypes.includes(f)}static paste(f,u){u.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:f.getAsFile()})}#h(f,u=!1){if(!f){this.remove();return}this.#e=f.bitmap,u||(this.#t=f.id,this.#c=f.isSvg),this.#p()}#f(){this.#r=null,this._uiManager.enableWaiting(!1),this.#s&&this.div.focus()}#d(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(u=>this.#h(u,!0)).finally(()=>this.#f());return}if(this.#n){const u=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromUrl(u).then(p=>this.#h(p)).finally(()=>this.#f());return}if(this.#o){const u=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromFile(u).then(p=>this.#h(p)).finally(()=>this.#f());return}const f=document.createElement("input");f.type="file",f.accept=c.supportedTypesStr,this.#r=new Promise(u=>{f.addEventListener("change",async()=>{if(!f.files||f.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const p=await this._uiManager.imageManager.getFromFile(f.files[0]);this.#h(p)}u()}),f.addEventListener("cancel",()=>{this.remove(),u()})}).finally(()=>this.#f()),f.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#i?.disconnect(),this.#i=null),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#d();return}super.rebuild(),this.div!==null&&(this.#t&&this.#d(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#r||this.#e||this.#n||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let f,u;if(this.width&&(f=this.x,u=this.y),super.render(),this.div.hidden=!0,this.#e?this.#p():this.#d(),this.width){const[p,g]=this.parentDimensions;this.setAt(f*p,u*g,this.width*p,this.height*g)}return this.div}#p(){const{div:f}=this;let{width:u,height:p}=this.#e;const[g,v]=this.pageDimensions,m=.75;if(this.width)u=this.width*g,p=this.height*v;else if(u>m*g||p>m*v){const T=Math.min(m*g/u,m*v/p);u*=T,p*=T}const[S,E]=this.parentDimensions;this.setDims(u*S/g,p*E/v),this._uiManager.enableWaiting(!1);const w=this.#s=document.createElement("canvas");f.append(w),f.hidden=!1,this.#m(u,p),this.#x(),this.#a||(this.parent.addUndoableEditor(this),this.#a=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#v(f,u){const[p,g]=this.parentDimensions;this.width=f/p,this.height=u/g,this.setDims(f,u),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const v=200;this.#l=setTimeout(()=>{this.#l=null,this.#m(f,u)},v)}#g(f,u){const{width:p,height:g}=this.#e;let v=p,m=g,S=this.#e;for(;v>2*f||m>2*u;){const E=v,w=m;v>2*f&&(v=v>=16384?Math.floor(v/2)-1:Math.ceil(v/2)),m>2*u&&(m=m>=16384?Math.floor(m/2)-1:Math.ceil(m/2));const T=new OffscreenCanvas(v,m);T.getContext("2d").drawImage(S,0,0,E,w,0,0,v,m),S=T.transferToImageBitmap()}return S}#m(f,u){f=Math.ceil(f),u=Math.ceil(u);const p=this.#s;if(!p||p.width===f&&p.height===u)return;p.width=f,p.height=u;const g=this.#c?this.#e:this.#g(f,u),v=p.getContext("2d");v.filter=this._uiManager.hcmFilter,v.drawImage(g,0,0,g.width,g.height,0,0,f,u)}#u(f){if(f){if(this.#c){const g=this._uiManager.imageManager.getSvgUrl(this.#t);if(g)return g}const u=document.createElement("canvas");return{width:u.width,height:u.height}=this.#e,u.getContext("2d").drawImage(this.#e,0,0),u.toDataURL()}if(this.#c){const[u,p]=this.pageDimensions,g=Math.round(this.width*u*s.PixelsPerInch.PDF_TO_CSS_UNITS),v=Math.round(this.height*p*s.PixelsPerInch.PDF_TO_CSS_UNITS),m=new OffscreenCanvas(g,v);return m.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,g,v),m.transferToImageBitmap()}return structuredClone(this.#e)}#x(){this.#i=new ResizeObserver(f=>{const u=f[0].contentRect;u.width&&u.height&&this.#v(u.width,u.height)}),this.#i.observe(this.div)}static deserialize(f,u,p){if(f instanceof o.StampAnnotationElement)return null;const g=super.deserialize(f,u,p),{rect:v,bitmapUrl:m,bitmapId:S,isSvg:E,accessibilityData:w}=f;S&&p.imageManager.isValidId(S)?g.#t=S:g.#n=m,g.#c=E;const[T,A]=g.pageDimensions;return g.width=(v[2]-v[0])/T,g.height=(v[3]-v[1])/A,w&&(g.altTextData=w),g}serialize(f=!1,u=null){if(this.isEmpty())return null;const p={annotationType:a.AnnotationEditorType.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(f)return p.bitmapUrl=this.#u(!0),p.accessibilityData=this.altTextData,p;const{decorative:g,altText:v}=this.altTextData;if(!g&&v&&(p.accessibilityData={type:"Figure",alt:v}),u===null)return p;u.stamps||=new Map;const m=this.#c?(p.rect[2]-p.rect[0])*(p.rect[3]-p.rect[1]):null;if(!u.stamps.has(this.#t))u.stamps.set(this.#t,{area:m,serialized:p}),p.bitmap=this.#u(!1);else if(this.#c){const S=u.stamps.get(this.#t);m>S.area&&(S.area=m,S.serialized.bitmap.close(),S.serialized.bitmap=this.#u(!1))}return p}}t.StampEditor=c})],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__w_pdfjs_require__),n.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return s.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return c.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return a.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return h.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return n.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return n.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return n.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return n.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return a.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return n.version}});var t=__w_pdfjs_require__(1),n=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),s=__w_pdfjs_require__(27),o=__w_pdfjs_require__(5),c=__w_pdfjs_require__(29),h=__w_pdfjs_require__(14),f=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf)),pdf.exports}var pdfExports=requirePdf();const pdfjsWorker="/assets/pdf.worker-BgPpApnW.js";var runtime={exports:{}},hasRequiredRuntime;function requireRuntime(){return hasRequiredRuntime||(hasRequiredRuntime=1,(function(e){var t=(function(n){var a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(C,O,I){C[O]=I.value},o,c=typeof Symbol=="function"?Symbol:{},h=c.iterator||"@@iterator",f=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function p(C,O,I){return Object.defineProperty(C,O,{value:I,enumerable:!0,configurable:!0,writable:!0}),C[O]}try{p({},"")}catch{p=function(O,I,M){return O[I]=M}}function g(C,O,I,M){var H=O&&O.prototype instanceof A?O:A,G=Object.create(H.prototype),j=new de(M||[]);return s(G,"_invoke",{value:ne(C,I,j)}),G}n.wrap=g;function v(C,O,I){try{return{type:"normal",arg:C.call(O,I)}}catch(M){return{type:"throw",arg:M}}}var m="suspendedStart",S="suspendedYield",E="executing",w="completed",T={};function A(){}function L(){}function k(){}var D={};p(D,h,function(){return this});var N=Object.getPrototypeOf,Y=N&&N(N(J([])));Y&&Y!==a&&i.call(Y,h)&&(D=Y);var z=k.prototype=A.prototype=Object.create(D);L.prototype=k,s(z,"constructor",{value:k,configurable:!0}),s(k,"constructor",{value:L,configurable:!0}),L.displayName=p(k,u,"GeneratorFunction");function te(C){["next","throw","return"].forEach(function(O){p(C,O,function(I){return this._invoke(O,I)})})}n.isGeneratorFunction=function(C){var O=typeof C=="function"&&C.constructor;return O?O===L||(O.displayName||O.name)==="GeneratorFunction":!1},n.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,k):(C.__proto__=k,p(C,u,"GeneratorFunction")),C.prototype=Object.create(z),C},n.awrap=function(C){return{__await:C}};function Z(C,O){function I(G,j,F,q){var X=v(C[G],C,j);if(X.type==="throw")q(X.arg);else{var W=X.arg,K=W.value;return K&&typeof K=="object"&&i.call(K,"__await")?O.resolve(K.__await).then(function(ae){I("next",ae,F,q)},function(ae){I("throw",ae,F,q)}):O.resolve(K).then(function(ae){W.value=ae,F(W)},function(ae){return I("throw",ae,F,q)})}}var M;function H(G,j){function F(){return new O(function(q,X){I(G,j,q,X)})}return M=M?M.then(F,F):F()}s(this,"_invoke",{value:H})}te(Z.prototype),p(Z.prototype,f,function(){return this}),n.AsyncIterator=Z,n.async=function(C,O,I,M,H){H===void 0&&(H=Promise);var G=new Z(g(C,O,I,M),H);return n.isGeneratorFunction(O)?G:G.next().then(function(j){return j.done?j.value:G.next()})};function ne(C,O,I){var M=m;return function(G,j){if(M===E)throw new Error("Generator is already running");if(M===w){if(G==="throw")throw j;return V()}for(I.method=G,I.arg=j;;){var F=I.delegate;if(F){var q=oe(F,I);if(q){if(q===T)continue;return q}}if(I.method==="next")I.sent=I._sent=I.arg;else if(I.method==="throw"){if(M===m)throw M=w,I.arg;I.dispatchException(I.arg)}else I.method==="return"&&I.abrupt("return",I.arg);M=E;var X=v(C,O,I);if(X.type==="normal"){if(M=I.done?w:S,X.arg===T)continue;return{value:X.arg,done:I.done}}else X.type==="throw"&&(M=w,I.method="throw",I.arg=X.arg)}}}function oe(C,O){var I=O.method,M=C.iterator[I];if(M===o)return O.delegate=null,I==="throw"&&C.iterator.return&&(O.method="return",O.arg=o,oe(C,O),O.method==="throw")||I!=="return"&&(O.method="throw",O.arg=new TypeError("The iterator does not provide a '"+I+"' method")),T;var H=v(M,C.iterator,O.arg);if(H.type==="throw")return O.method="throw",O.arg=H.arg,O.delegate=null,T;var G=H.arg;if(!G)return O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,T;if(G.done)O[C.resultName]=G.value,O.next=C.nextLoc,O.method!=="return"&&(O.method="next",O.arg=o);else return G;return O.delegate=null,T}te(z),p(z,u,"Generator"),p(z,h,function(){return this}),p(z,"toString",function(){return"[object Generator]"});function le(C){var O={tryLoc:C[0]};1 in C&&(O.catchLoc=C[1]),2 in C&&(O.finallyLoc=C[2],O.afterLoc=C[3]),this.tryEntries.push(O)}function pe(C){var O=C.completion||{};O.type="normal",delete O.arg,C.completion=O}function de(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(le,this),this.reset(!0)}n.keys=function(C){var O=Object(C),I=[];for(var M in O)I.push(M);return I.reverse(),function H(){for(;I.length;){var G=I.pop();if(G in O)return H.value=G,H.done=!1,H}return H.done=!0,H}};function J(C){if(C){var O=C[h];if(O)return O.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var I=-1,M=function H(){for(;++I<C.length;)if(i.call(C,I))return H.value=C[I],H.done=!1,H;return H.value=o,H.done=!0,H};return M.next=M}}return{next:V}}n.values=J;function V(){return{value:o,done:!0}}return de.prototype={constructor:de,reset:function(C){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(pe),!C)for(var O in this)O.charAt(0)==="t"&&i.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=o)},stop:function(){this.done=!0;var C=this.tryEntries[0],O=C.completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(C){if(this.done)throw C;var O=this;function I(q,X){return G.type="throw",G.arg=C,O.next=q,X&&(O.method="next",O.arg=o),!!X}for(var M=this.tryEntries.length-1;M>=0;--M){var H=this.tryEntries[M],G=H.completion;if(H.tryLoc==="root")return I("end");if(H.tryLoc<=this.prev){var j=i.call(H,"catchLoc"),F=i.call(H,"finallyLoc");if(j&&F){if(this.prev<H.catchLoc)return I(H.catchLoc,!0);if(this.prev<H.finallyLoc)return I(H.finallyLoc)}else if(j){if(this.prev<H.catchLoc)return I(H.catchLoc,!0)}else if(F){if(this.prev<H.finallyLoc)return I(H.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(C,O){for(var I=this.tryEntries.length-1;I>=0;--I){var M=this.tryEntries[I];if(M.tryLoc<=this.prev&&i.call(M,"finallyLoc")&&this.prev<M.finallyLoc){var H=M;break}}H&&(C==="break"||C==="continue")&&H.tryLoc<=O&&O<=H.finallyLoc&&(H=null);var G=H?H.completion:{};return G.type=C,G.arg=O,H?(this.method="next",this.next=H.finallyLoc,T):this.complete(G)},complete:function(C,O){if(C.type==="throw")throw C.arg;return C.type==="break"||C.type==="continue"?this.next=C.arg:C.type==="return"?(this.rval=this.arg=C.arg,this.method="return",this.next="end"):C.type==="normal"&&O&&(this.next=O),T},finish:function(C){for(var O=this.tryEntries.length-1;O>=0;--O){var I=this.tryEntries[O];if(I.finallyLoc===C)return this.complete(I.completion,I.afterLoc),pe(I),T}},catch:function(C){for(var O=this.tryEntries.length-1;O>=0;--O){var I=this.tryEntries[O];if(I.tryLoc===C){var M=I.completion;if(M.type==="throw"){var H=M.arg;pe(I)}return H}}throw new Error("illegal catch attempt")},delegateYield:function(C,O,I){return this.delegate={iterator:J(C),resultName:O,nextLoc:I},this.method==="next"&&(this.arg=o),T}},n})(e.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(runtime)),runtime.exports}var getId,hasRequiredGetId;function requireGetId(){return hasRequiredGetId||(hasRequiredGetId=1,getId=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`),getId}var createJob,hasRequiredCreateJob;function requireCreateJob(){if(hasRequiredCreateJob)return createJob;hasRequiredCreateJob=1;const e=requireGetId();let t=0;return createJob=({id:n,action:a,payload:i={}})=>{let s=n;return typeof s>"u"&&(s=e("Job",t),t+=1),{id:s,action:a,payload:i}},createJob}var log$1={},hasRequiredLog;function requireLog(){if(hasRequiredLog)return log$1;hasRequiredLog=1;let e=!1;return log$1.logging=e,log$1.setLogging=t=>{e=t},log$1.log=(...t)=>e?console.log.apply(this,t):null,log$1}var createScheduler,hasRequiredCreateScheduler;function requireCreateScheduler(){if(hasRequiredCreateScheduler)return createScheduler;hasRequiredCreateScheduler=1;const e=requireCreateJob(),{log:t}=requireLog(),n=requireGetId();let a=0;return createScheduler=()=>{const i=n("Scheduler",a),s={},o={};let c=[];a+=1;const h=()=>c.length,f=()=>Object.keys(s).length,u=()=>{if(c.length!==0){const S=Object.keys(s);for(let E=0;E<S.length;E+=1)if(typeof o[S[E]]>"u"){c[0](s[S[E]]);break}}},p=(S,E)=>new Promise((w,T)=>{const A=e({action:S,payload:E});c.push(async L=>{c.shift(),o[L.id]=A;try{w(await L[S].apply(this,[...E,A.id]))}catch(k){T(k)}finally{delete o[L.id],u()}}),t(`[${i}]: Add ${A.id} to JobQueue`),t(`[${i}]: JobQueue length=${c.length}`),u()});return{addWorker:S=>(s[S.id]=S,t(`[${i}]: Add ${S.id}`),t(`[${i}]: Number of workers=${f()}`),u(),S.id),addJob:async(S,...E)=>{if(f()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(S,E)},terminate:async()=>{Object.keys(s).forEach(async S=>{await s[S].terminate()}),c=[]},getQueueLen:h,getNumWorkers:f}},createScheduler}var getEnvironment,hasRequiredGetEnvironment;function requireGetEnvironment(){return hasRequiredGetEnvironment||(hasRequiredGetEnvironment=1,getEnvironment=e=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof commonjsRequire=="function"&&(t.type="node"),typeof e>"u"?t:t[e]}),getEnvironment}var resolvePaths,hasRequiredResolvePaths;function requireResolvePaths(){if(hasRequiredResolvePaths)return resolvePaths;hasRequiredResolvePaths=1;const t=requireGetEnvironment()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return resolvePaths=n=>{const a={...n};return["corePath","workerPath","langPath"].forEach(i=>{n[i]&&(a[i]=t(a[i]))}),a},resolvePaths}var OEM,hasRequiredOEM;function requireOEM(){return hasRequiredOEM||(hasRequiredOEM=1,OEM={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),OEM}const version="6.0.1",require$$0={version};var defaultOptions,hasRequiredDefaultOptions$1;function requireDefaultOptions$1(){return hasRequiredDefaultOptions$1||(hasRequiredDefaultOptions$1=1,defaultOptions={workerBlobURL:!0,logger:()=>{}}),defaultOptions}var defaultOptions_1,hasRequiredDefaultOptions;function requireDefaultOptions(){if(hasRequiredDefaultOptions)return defaultOptions_1;hasRequiredDefaultOptions=1;const e=require$$0.version;return defaultOptions_1={...requireDefaultOptions$1(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${e}/dist/worker.min.js`},defaultOptions_1}var spawnWorker,hasRequiredSpawnWorker;function requireSpawnWorker(){return hasRequiredSpawnWorker||(hasRequiredSpawnWorker=1,spawnWorker=({workerPath:e,workerBlobURL:t})=>{let n;if(Blob&&URL&&t){const a=new Blob([`importScripts("${e}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(a))}else n=new Worker(e);return n}),spawnWorker}var terminateWorker,hasRequiredTerminateWorker;function requireTerminateWorker(){return hasRequiredTerminateWorker||(hasRequiredTerminateWorker=1,terminateWorker=e=>{e.terminate()}),terminateWorker}var onMessage,hasRequiredOnMessage;function requireOnMessage(){return hasRequiredOnMessage||(hasRequiredOnMessage=1,onMessage=(e,t)=>{e.onmessage=({data:n})=>{t(n)}}),onMessage}var send,hasRequiredSend;function requireSend(){return hasRequiredSend||(hasRequiredSend=1,send=async(e,t)=>{e.postMessage(t)}),send}var loadImage_1,hasRequiredLoadImage;function requireLoadImage(){if(hasRequiredLoadImage)return loadImage_1;hasRequiredLoadImage=1;const e=n=>new Promise((a,i)=>{const s=new FileReader;s.onload=()=>{a(s.result)},s.onerror=({target:{error:{code:o}}})=>{i(Error(`File could not be read! Code=${o}`))},s.readAsArrayBuffer(n)}),t=async n=>{let a=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?a=atob(n.split(",")[1]).split("").map(i=>i.charCodeAt(0)):a=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(a=await t(n.src)),n.tagName==="VIDEO"&&(a=await t(n.poster)),n.tagName==="CANVAS"&&await new Promise(i=>{n.toBlob(async s=>{a=await e(s),i()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const i=await n.convertToBlob();a=await e(i)}else(n instanceof File||n instanceof Blob)&&(a=await e(n));return new Uint8Array(a)};return loadImage_1=t,loadImage_1}var browser,hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser;hasRequiredBrowser=1;const e=requireDefaultOptions(),t=requireSpawnWorker(),n=requireTerminateWorker(),a=requireOnMessage(),i=requireSend(),s=requireLoadImage();return browser={defaultOptions:e,spawnWorker:t,terminateWorker:n,onMessage:a,send:i,loadImage:s},browser}var createWorker,hasRequiredCreateWorker;function requireCreateWorker(){if(hasRequiredCreateWorker)return createWorker;hasRequiredCreateWorker=1;const e=requireResolvePaths(),t=requireCreateJob(),{log:n}=requireLog(),a=requireGetId(),i=requireOEM(),{defaultOptions:s,spawnWorker:o,terminateWorker:c,onMessage:h,loadImage:f,send:u}=requireBrowser();let p=0;return createWorker=async(g="eng",v=i.LSTM_ONLY,m={},S={})=>{const E=a("Worker",p),{logger:w,errorHandler:T,...A}=e({...s,...m}),L={},k=typeof g=="string"?g.split("+"):g;let D=v,N=S;const Y=[i.DEFAULT,i.LSTM_ONLY].includes(v)&&!A.legacyCore;let z,te;const Z=new Promise((W,K)=>{te=W,z=K}),ne=W=>{z(W.message)};let oe=o(A);oe.onerror=ne,p+=1;const le=({id:W,action:K,payload:ae})=>new Promise((U,ve)=>{n(`[${E}]: Start ${W}, action=${K}`);const be=`${K}-${W}`;L[be]={resolve:U,reject:ve},u(oe,{workerId:E,jobId:W,action:K,payload:ae})}),pe=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),de=W=>le(t({id:W,action:"load",payload:{options:{lstmOnly:Y,corePath:A.corePath,logging:A.logging}}})),J=(W,K,ae)=>le(t({id:ae,action:"FS",payload:{method:"writeFile",args:[W,K]}})),V=(W,K)=>le(t({id:K,action:"FS",payload:{method:"readFile",args:[W,{encoding:"utf8"}]}})),C=(W,K)=>le(t({id:K,action:"FS",payload:{method:"unlink",args:[W]}})),O=(W,K,ae)=>le(t({id:ae,action:"FS",payload:{method:W,args:K}})),I=(W,K)=>le(t({id:K,action:"loadLanguage",payload:{langs:W,options:{langPath:A.langPath,dataPath:A.dataPath,cachePath:A.cachePath,cacheMethod:A.cacheMethod,gzip:A.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(D)&&!A.legacyLang}}})),M=(W,K,ae,U)=>le(t({id:U,action:"initialize",payload:{langs:W,oem:K,config:ae}})),H=(W="eng",K,ae,U)=>{if(Y&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(K))throw Error("Legacy model requested but code missing.");const ve=K||D;D=ve;const be=ae||N;N=be;const _e=(typeof W=="string"?W.split("+"):W).filter(ge=>!k.includes(ge));return k.push(..._e),_e.length>0?I(_e,U).then(()=>M(W,ve,be,U)):M(W,ve,be,U)},G=(W={},K)=>le(t({id:K,action:"setParameters",payload:{params:W}})),j=async(W,K={},ae={text:!0},U)=>le(t({id:U,action:"recognize",payload:{image:await f(W),options:K,output:ae}})),F=async(W,K)=>{if(Y)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return le(t({id:K,action:"detect",payload:{image:await f(W)}}))},q=async()=>(oe!==null&&(c(oe),oe=null),Promise.resolve());h(oe,({workerId:W,jobId:K,status:ae,action:U,data:ve})=>{const be=`${U}-${K}`;if(ae==="resolve")n(`[${W}]: Complete ${K}`),L[be].resolve({jobId:K,data:ve}),delete L[be];else if(ae==="reject")if(L[be].reject(ve),delete L[be],U==="load"&&z(ve),T)T(ve);else throw Error(ve);else ae==="progress"&&w({...ve,userJobId:K})});const X={id:E,worker:oe,load:pe,writeText:J,readText:V,removeFile:C,FS:O,reinitialize:H,setParameters:G,recognize:j,detect:F,terminate:q};return de().then(()=>I(g)).then(()=>M(g,v,S)).then(()=>te(X)).catch(()=>{}),Z},createWorker}var Tesseract$1,hasRequiredTesseract;function requireTesseract(){if(hasRequiredTesseract)return Tesseract$1;hasRequiredTesseract=1;const e=requireCreateWorker();return Tesseract$1={recognize:async(a,i,s)=>{const o=await e(i,1,s);return o.recognize(a).finally(async()=>{await o.terminate()})},detect:async(a,i)=>{const s=await e("osd",0,i);return s.detect(a).finally(async()=>{await s.terminate()})}},Tesseract$1}var languages,hasRequiredLanguages;function requireLanguages(){return hasRequiredLanguages||(hasRequiredLanguages=1,languages={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),languages}var PSM,hasRequiredPSM;function requirePSM(){return hasRequiredPSM||(hasRequiredPSM=1,PSM={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),PSM}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1,requireRuntime();const e=requireCreateScheduler(),t=requireCreateWorker(),n=requireTesseract(),a=requireLanguages(),i=requireOEM(),s=requirePSM(),{setLogging:o}=requireLog();return src={languages:a,OEM:i,PSM:s,createScheduler:e,createWorker:t,setLogging:o,...n},src}var srcExports=requireSrc();const Tesseract=getDefaultExportFromCjs(srcExports);function ProjectConfirmModal({open:e,initialData:t={},onConfirm:n,onClose:a}){const[i,s]=reactExports.useState({siteName:"",installed:"",location:"",cod:"",module:"",inverter:"",tempCoeff:"0.34",degr:"0.5"});if(reactExports.useEffect(()=>{e&&s(c=>({...c,...t}))},[e,t]),!e)return null;const o=c=>h=>s(f=>({...f,[c]:h.target.value}));return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-xl p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Confirm Project Information"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Site Name"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.siteName,onChange:o("siteName")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Installed Capacity"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.installed,onChange:o("installed")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Location (GPS)"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.location,onChange:o("location")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"COD / Report Date"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.cod,onChange:o("cod")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"PV Module"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.module,onChange:o("module")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-2 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Inverter"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.inverter,onChange:o("inverter")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Temperature Coefficient (, %/C)"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.tempCoeff,onChange:o("tempCoeff")})]}),jsxRuntimeExports.jsxs("label",{className:"col-span-1 text-sm",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Annual Degradation (%/year)"}),jsxRuntimeExports.jsx("input",{className:"mt-1 w-full border rounded-lg px-3 py-2",value:i.degr,onChange:o("degr")})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3 mt-5",children:[jsxRuntimeExports.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:()=>n(i),className:"px-5 py-2 rounded-lg font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Confirm"})]})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var t=[],n=0,a=e.length;n<a;++n)t[n]=e.charCodeAt(n);return t}function utf16leread(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function utf16beread(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var debom=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?utf16leread(e.slice(2)):t==254&&n==255?utf16beread(e.slice(2)):t==65279?e.slice(1):e},_getchar=function e(t){return String.fromCharCode(t)},_getansi=function e(t){return String.fromCharCode(t)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var t="",n=0,a=0,i=0,s=0,o=0,c=0,h=0,f=0;f<e.length;)n=e.charCodeAt(f++),s=n>>2,a=e.charCodeAt(f++),o=(n&3)<<4|a>>4,i=e.charCodeAt(f++),c=(a&15)<<2|i>>6,h=i&63,isNaN(a)?c=h=64:isNaN(i)&&(h=64),t+=Base64_map.charAt(s)+Base64_map.charAt(o)+Base64_map.charAt(c)+Base64_map.charAt(h);return t}function Base64_decode(e){var t="",n=0,a=0,i=0,s=0,o=0,c=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)s=Base64_map.indexOf(e.charAt(f++)),o=Base64_map.indexOf(e.charAt(f++)),n=s<<2|o>>4,t+=String.fromCharCode(n),c=Base64_map.indexOf(e.charAt(f++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),h=Base64_map.indexOf(e.charAt(f++)),i=(c&3)<<6|h,h!==64&&(t+=String.fromCharCode(i));return t}var has_buf=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Buffer_from=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function e(t){return has_buf?Buffer_from(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function a2s(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var a=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),n)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function utf8decode(e){for(var t=[],n=0,a=e.length+250,i=new_raw_buf(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|c>>6&15|(o&3)<<4,i[n++]=128|c&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>a&&(t.push(i.slice(0,n)),n=0,i=new_raw_buf(65535),a=65530)}return t.push(i.slice(0,n)),bconcat(t)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function pad0(e,t){var n=""+e;return n.length>=t?n:fill("0",t-n.length)+n}function pad_(e,t){var n=""+e;return n.length>=t?n:fill(" ",t-n.length)+n}function rpad_(e,t){var n=""+e;return n.length>=t?n:n+fill(" ",t-n.length)}function pad0r1(e,t){var n=""+Math.round(e);return n.length>=t?n:fill("0",t-n.length)+n}function pad0r2(e,t){var n=""+e;return n.length>=t?n:fill("0",t-n.length)+n}var p2_32=Math.pow(2,32);function pad0r(e,t){if(e>p2_32||e<-p2_32)return pad0r1(e,t);var n=Math.round(e);return pad0r2(n,t)}function SSF_isgeneral(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,t,n){for(var a=e<0?-1:1,i=e*a,s=0,o=1,c=0,h=1,f=0,u=0,p=Math.floor(i);f<t&&(p=Math.floor(i),c=p*o+s,u=p*f+h,!(i-p<5e-8));)i=1/(i-p),s=o,o=c,h=f,f=u;if(u>t&&(f>t?(u=h,c=s):(u=f,c=o)),!n)return[0,a*c,u];var g=Math.floor(a*c/u);return[g,a*c-g*u,u]}function SSF_parse_date_code(e,t,n){if(e>2958465||e<0)return null;var a=e|0,i=Math.floor(86400*(e-a)),s=0,o=[],c={D:a,T:i,u:86400*(e-a)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++a,++c.D)),a===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],s=h.getDay(),a<60&&(s=(s+6)%7),n&&(s=SSF_fix_hijri(h,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=s,c}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=SSFbase1904&&(n+=1440*60*1e3),(n-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(1440*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var t=e<0?12:11,n=SSF_strip_decimal(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function SSF_large_exp(e){var t=SSF_strip_decimal(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function SSF_general_num(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=SSF_small_exp(e):t===10?n=e.toFixed(10).substr(0,12):n=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(n.toUpperCase()))}function SSF_general(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function SSF_write_date(e,t,n,a){var i="",s=0,o=0,c=n.y,h,f=0;switch(e){case 98:c=n.y+543;case 121:switch(t.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:h=n.m,f=t.length;break;case 3:return months[n.m-1][1];case 5:return months[n.m-1][0];default:return months[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=n.d,f=t.length;break;case 3:return days[n.q][0];default:return days[n.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(n.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=n.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=n.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?pad0(n.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=pad0(s,2+a),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=n.D*24+n.H;break;case"[m]":case"[mm]":h=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":h=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:h=c,f=1;break}var u=f>0?pad0(h,f):"";return u}function commaify(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,a=e.substr(0,n);n!=e.length;n+=t)a+=(a.length>0?",":"")+e.substr(n,t);return a}var pct1=/%/g;function write_num_pct(e,t,n){var a=t.replace(pct1,""),i=t.length-a.length;return write_num(e,a,n*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return write_num(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function write_num_exp(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(a+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,u){return h+f+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,t,n){var a=parseInt(e[4],10),i=Math.round(t*a),s=Math.floor(i/a),o=i-s*a,c=a;return n+(s===0?"":""+s)+" "+(o===0?fill(" ",e[1].length+1+e[4].length):pad_(o,e[1].length)+e[2]+"/"+e[3]+pad0(c,e[4].length))}function write_num_f2(e,t,n){return n+(t===0?"":""+t)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var t="",n,a=0;a!=e.length;++a)switch(n=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function rnd(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function dec(e,t){var n=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(n*a)).length?0:Math.round(n*a)}function carry(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,t,n){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?write_num_flt("n",a,n):"("+write_num_flt("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm(e,t,n);if(t.indexOf("%")!==-1)return write_num_pct(e,t,n);if(t.indexOf("E")!==-1)return write_num_exp(t,n);if(t.charCodeAt(0)===36)return"$"+write_num_flt(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,c,h=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+pad0r(h,t.length);if(t.match(/^[#?]+$/))return i=pad0r(n,0),i==="0"&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(s=t.match(frac1))return write_num_f1(s,h,f);if(t.match(/^#+0+$/))return f+pad0r(h,t.length-t.indexOf("0"));if(s=t.match(dec1))return i=rnd(n,s[1].length).replace(/^([^\.]+)$/,"$1."+hashq(s[1])).replace(/\.$/,"."+hashq(s[1])).replace(/\.(\d*)$/,function(m,S){return"."+S+fill("0",hashq(s[1]).length-S.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+rnd(h,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+commaify(pad0r(h,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+write_num_flt(e,t,-n):commaify(""+(Math.floor(n)+carry(n,s[1].length)))+"."+pad0(dec(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return write_num_flt(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(e,t.replace(/[\\-]/g,""),n)),o=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(phone))return i=write_num_flt(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=SSF_frac(h,Math.pow(10,o)-1,!1),i=""+f,u=write_num("n",s[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rpad_(c[2],o),u.length<s[4].length&&(u=hashq(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=SSF_frac(h,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?pad_(c[1],o)+s[2]+"/"+s[3]+rpad_(c[2],o):fill(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=pad0r(n,0),t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,g=t.length-i.length-p;return hashq(t.substr(0,p)+i+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=dec(n,s[1].length),n<0?"-"+write_num_flt(e,t,-n):commaify(flr(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?pad0(0,3-m.length):"")+m})+"."+pad0(o,s[1].length);switch(t){case"###,##0.00":return write_num_flt(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var v=commaify(pad0r(h,0));return v!=="0"?f+v:"";case"###,###.00":return write_num_flt(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function write_num_cm2(e,t,n){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return write_num(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}function write_num_pct2(e,t,n){var a=t.replace(pct1,""),i=t.length-a.length;return write_num(e,a,n*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(e,t){var n,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(a+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,u){return h+f+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=t.toExponential(a);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function write_num_int(e,t,n){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?write_num_int("n",a,n):"("+write_num_int("n",a,-n)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm2(e,t,n);if(t.indexOf("%")!==-1)return write_num_pct2(e,t,n);if(t.indexOf("E")!==-1)return write_num_exp2(t,n);if(t.charCodeAt(0)===36)return"$"+write_num_int(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,c,h=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+pad0(h,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:hashq(t.substr(0,t.length-i.length))+i;if(s=t.match(frac1))return write_num_f2(s,h,f);if(t.match(/^#+0+$/))return f+pad0(h,t.length-t.indexOf("0"));if(s=t.match(dec1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+hashq(s[1])).replace(/\.$/,"."+hashq(s[1])),i=i.replace(/\.(\d*)$/,function(m,S){return"."+S+fill("0",hashq(s[1]).length-S.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+commaify(""+h);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+write_num_int(e,t,-n):commaify(""+n)+"."+fill("0",s[1].length);if(s=t.match(/^#,#*,#0/))return write_num_int(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(e,t.replace(/[\\-]/g,""),n)),o=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(phone))return i=write_num_int(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=SSF_frac(h,Math.pow(10,o)-1,!1),i=""+f,u=write_num("n",s[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rpad_(c[2],o),u.length<s[4].length&&(u=hashq(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=SSF_frac(h,Math.pow(10,o)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?pad_(c[1],o)+s[2]+"/"+s[3]+rpad_(c[2],o):fill(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:hashq(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,g=t.length-i.length-p;return hashq(t.substr(0,p)+i+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+write_num_int(e,t,-n):commaify(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?pad0(0,3-m.length):"")+m})+"."+pad0(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=commaify(""+h);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return write_num_int(e,t.slice(0,t.lastIndexOf(".")),n)+hashq(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function write_num(e,t,n){return(n|0)===n?write_num_int(e,t,n):write_num_flt(e,t,n)}function SSF_split_fmt(e){for(var t=[],n=!1,a=0,i=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(i,a-i),i=a+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":SSF_isgeneral(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=n;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function eval_fmt(e,t,n,a){for(var i=[],s="",o=0,c="",h="t",f,u,p,g="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!SSF_isgeneral(e,o))throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(p=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++o;break;case"\\":var v=e.charAt(++o),m=v==="("||v===")"?v:"t";i[i.length]={t:m,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(f==null&&(f=SSF_parse_date_code(t,n,e.charAt(o+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},h=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=SSF_parse_date_code(t,n),f==null))return"";for(s=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)s+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),i[i.length]={t:c,v:s},h=c;break;case"A":case"a":case"":var S={t:c,v:c};if(f==null&&(f=SSF_parse_date_code(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",g="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",o+=5,g="h"):e.substr(o,5).toUpperCase()==="/"?(f!=null&&(S.v=f.H>=12?"":""),S.t="T",o+=5,g="h"):(S.t="t",++o),f==null&&S.t==="T")return"";i[i.length]=S,h=c;break;case"[":for(s=c;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(SSF_abstime)){if(f==null&&(f=SSF_parse_date_code(t,n),f==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(i[i.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=c;++o<e.length&&(c=e.charAt(o))==="0";)s+=c;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)s+=c;i[i.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++o)===c;)s+=c;i[i.length]={t:c,v:s},h=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);i[i.length]={t:"t",v:c},++o;break}var E=0,w=0,T;for(o=i.length-1,h="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=g,h="h",E<1&&(E=1);break;case"s":(T=i[o].v.match(/\.0+$/))&&(w=Math.max(w,T[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=i[o].t;break;case"m":h==="s"&&(i[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[o].v.match(/[Hh]/)&&(E=1),E<2&&i[o].v.match(/[Mm]/)&&(E=2),E<3&&i[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var A="",L;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=SSF_write_date(i[o].t.charCodeAt(0),i[o].v,f,w),i[o].t="t";break;case"n":case"?":for(L=o+1;i[L]!=null&&((c=i[L].t)==="?"||c==="D"||(c===" "||c==="t")&&i[L+1]!=null&&(i[L+1].t==="?"||i[L+1].t==="t"&&i[L+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[L].v==="/"||i[L].v===" "&&i[L+1]!=null&&i[L+1].t=="?"));)i[o].v+=i[L].v,i[L]={v:"",t:";"},++L;A+=i[o].v,o=L-1;break;case"G":i[o].t="t",i[o].v=SSF_general(t,n);break}var k="",D,N;if(A.length>0){A.charCodeAt(0)==40?(D=t<0&&A.charCodeAt(0)===45?-t:t,N=write_num("n",A,D)):(D=t<0&&a>1?-t:t,N=write_num("n",A,D),D<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),L=N.length-1;var Y=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){Y=o;break}var z=i.length;if(Y===i.length&&N.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(L>=i[o].v.length-1?(L-=i[o].v.length,i[o].v=N.substr(L+1,i[o].v.length)):L<0?i[o].v="":(i[o].v=N.substr(0,L+1),L=-1),i[o].t="t",z=o);L>=0&&z<i.length&&(i[z].v=N.substr(0,L+1)+i[z].v)}else if(Y!==i.length&&N.indexOf("E")===-1){for(L=N.indexOf(".")-1,o=Y;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===Y?i[o].v.indexOf(".")-1:i[o].v.length-1,k=i[o].v.substr(u+1);u>=0;--u)L>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(k=N.charAt(L--)+k);i[o].v=k,i[o].t="t",z=o}for(L>=0&&z<i.length&&(i[z].v=N.substr(0,L+1)+i[z].v),L=N.indexOf(".")+1,o=Y;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==Y)){for(u=i[o].v.indexOf(".")>-1&&o===Y?i[o].v.indexOf(".")+1:0,k=i[o].v.substr(0,u);u<i[o].v.length;++u)L<N.length&&(k+=N.charAt(L++));i[o].v=k,i[o].t="t",z=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(D=a>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=write_num(i[o].t,i[o].v,D),i[o].t="t");var te="";for(o=0;o!==i.length;++o)i[o]!=null&&(te+=i[o].v);return te}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function choose_fmt(e,t){var n=SSF_split_fmt(e),a=n.length,i=n[a-1].indexOf("@");if(a<4&&i>-1&&--a,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[a,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(cfregex2),c=n[1].match(cfregex2);return chkcond(t,o)?[a,n[0]]:chkcond(t,c)?[a,n[1]]:[a,n[o!=null&&c!=null?2:1]]}return[a,s]}function SSF_format(e,t,n){n==null&&(n={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?a=n.dateNF:a=e;break;case"number":e==14&&n.dateNF?a=n.dateNF:a=(n.table!=null?n.table:table_fmt)[e],a==null&&(a=n.table&&n.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),a==null&&(a=SSF_default_str[e]||"General");break}if(SSF_isgeneral(a,0))return SSF_general(t,n);t instanceof Date&&(t=datenum_local(t,n.date1904));var i=choose_fmt(a,t);if(SSF_isgeneral(i[1]))return SSF_general(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return eval_fmt(i[1],t,n,i[0])}function SSF_load(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(table_fmt[n]==null){t<0&&(t=n);continue}if(table_fmt[n]==e){t=n;break}}t<0&&(t=391)}return table_fmt[t]=e,t}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var t=typeof e=="number"?table_fmt[e]:e;return t=t.replace(dateNFregex,"(\\d+)"),new RegExp("^"+t+"$")}function dateNF_fix(e,t,n){var a=-1,i=-1,s=-1,o=-1,c=-1,h=-1;(t.match(dateNFregex)||[]).forEach(function(p,g){var v=parseInt(n[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=v;break;case"d":s=v;break;case"h":o=v;break;case"s":h=v;break;case"m":o>=0?c=v:i=v;break}}),h>=0&&c==-1&&i>=0&&(c=i,i=-1);var f=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&c==-1&&h==-1?f:a==-1&&i==-1&&s==-1?u:f+"T"+u}var CRC32=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,Y=new Array(256),z=0;z!=256;++z)N=z,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,Y[z]=N;return typeof Int32Array<"u"?new Int32Array(Y):Y}var n=t();function a(N){var Y=0,z=0,te=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)Z[te]=N[te];for(te=0;te!=256;++te)for(z=N[te],Y=256+te;Y<4096;Y+=256)z=Z[Y]=z>>>8^N[z&255];var ne=[];for(te=1;te!=16;++te)ne[te-1]=typeof Int32Array<"u"?Z.subarray(te*256,te*256+256):Z.slice(te*256,te*256+256);return ne}var i=a(n),s=i[0],o=i[1],c=i[2],h=i[3],f=i[4],u=i[5],p=i[6],g=i[7],v=i[8],m=i[9],S=i[10],E=i[11],w=i[12],T=i[13],A=i[14];function L(N,Y){for(var z=Y^-1,te=0,Z=N.length;te<Z;)z=z>>>8^n[(z^N.charCodeAt(te++))&255];return~z}function k(N,Y){for(var z=Y^-1,te=N.length-15,Z=0;Z<te;)z=A[N[Z++]^z&255]^T[N[Z++]^z>>8&255]^w[N[Z++]^z>>16&255]^E[N[Z++]^z>>>24]^S[N[Z++]]^m[N[Z++]]^v[N[Z++]]^g[N[Z++]]^p[N[Z++]]^u[N[Z++]]^f[N[Z++]]^h[N[Z++]]^c[N[Z++]]^o[N[Z++]]^s[N[Z++]]^n[N[Z++]];for(te+=15;Z<te;)z=z>>>8^n[(z^N[Z++])&255];return~z}function D(N,Y){for(var z=Y^-1,te=0,Z=N.length,ne=0,oe=0;te<Z;)ne=N.charCodeAt(te++),ne<128?z=z>>>8^n[(z^ne)&255]:ne<2048?(z=z>>>8^n[(z^(192|ne>>6&31))&255],z=z>>>8^n[(z^(128|ne&63))&255]):ne>=55296&&ne<57344?(ne=(ne&1023)+64,oe=N.charCodeAt(te++)&1023,z=z>>>8^n[(z^(240|ne>>8&7))&255],z=z>>>8^n[(z^(128|ne>>2&63))&255],z=z>>>8^n[(z^(128|oe>>6&15|(ne&3)<<4))&255],z=z>>>8^n[(z^(128|oe&63))&255]):(z=z>>>8^n[(z^(224|ne>>12&15))&255],z=z>>>8^n[(z^(128|ne>>6&63))&255],z=z>>>8^n[(z^(128|ne&63))&255]);return~z}return e.table=n,e.bstr=L,e.buf=k,e.str=D,e})(),CFB=(function e(){var t={};t.version="1.2.1";function n(ee,ce){for(var ie=ee.split("/"),se=ce.split("/"),ue=0,fe=0,ke=Math.min(ie.length,se.length);ue<ke;++ue){if(fe=ie[ue].length-se[ue].length)return fe;if(ie[ue]!=se[ue])return ie[ue]<se[ue]?-1:1}return ie.length-se.length}function a(ee){if(ee.charAt(ee.length-1)=="/")return ee.slice(0,-1).indexOf("/")===-1?ee:a(ee.slice(0,-1));var ce=ee.lastIndexOf("/");return ce===-1?ee:ee.slice(0,ce+1)}function i(ee){if(ee.charAt(ee.length-1)=="/")return i(ee.slice(0,-1));var ce=ee.lastIndexOf("/");return ce===-1?ee:ee.slice(ce+1)}function s(ee,ce){typeof ce=="string"&&(ce=new Date(ce));var ie=ce.getHours();ie=ie<<6|ce.getMinutes(),ie=ie<<5|ce.getSeconds()>>>1,ee.write_shift(2,ie);var se=ce.getFullYear()-1980;se=se<<4|ce.getMonth()+1,se=se<<5|ce.getDate(),ee.write_shift(2,se)}function o(ee){var ce=ee.read_shift(2)&65535,ie=ee.read_shift(2)&65535,se=new Date,ue=ie&31;ie>>>=5;var fe=ie&15;ie>>>=4,se.setMilliseconds(0),se.setFullYear(ie+1980),se.setMonth(fe-1),se.setDate(ue);var ke=ce&31;ce>>>=5;var Fe=ce&63;return ce>>>=6,se.setHours(ce),se.setMinutes(Fe),se.setSeconds(ke<<1),se}function c(ee){prep_blob(ee,0);for(var ce={},ie=0;ee.l<=ee.length-4;){var se=ee.read_shift(2),ue=ee.read_shift(2),fe=ee.l+ue,ke={};switch(se){case 21589:ie=ee.read_shift(1),ie&1&&(ke.mtime=ee.read_shift(4)),ue>5&&(ie&2&&(ke.atime=ee.read_shift(4)),ie&4&&(ke.ctime=ee.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}ee.l=fe,ce[se]=ke}return ce}var h;function f(){return h||(h={})}function u(ee,ce){if(ee[0]==80&&ee[1]==75)return wt(ee,ce);if((ee[0]|32)==109&&(ee[1]|32)==105)return Or(ee,ce);if(ee.length<512)throw new Error("CFB file size "+ee.length+" < 512");var ie=3,se=512,ue=0,fe=0,ke=0,Fe=0,Te=0,Ce=[],Pe=ee.slice(0,512);prep_blob(Pe,0);var Ne=p(Pe);switch(ie=Ne[0],ie){case 3:se=512;break;case 4:se=4096;break;case 0:if(Ne[1]==0)return wt(ee,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+ie)}se!==512&&(Pe=ee.slice(0,se),prep_blob(Pe,28));var He=ee.slice(0,se);g(Pe,ie);var Ge=Pe.read_shift(4,"i");if(ie===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);Pe.l+=4,ke=Pe.read_shift(4,"i"),Pe.l+=4,Pe.chk("00100000","Mini Stream Cutoff Size: "),Fe=Pe.read_shift(4,"i"),ue=Pe.read_shift(4,"i"),Te=Pe.read_shift(4,"i"),fe=Pe.read_shift(4,"i");for(var je=-1,$e=0;$e<109&&(je=Pe.read_shift(4,"i"),!(je<0));++$e)Ce[$e]=je;var it=v(ee,se);E(Te,fe,it,se,Ce);var pt=T(it,ke,Ce,se);pt[ke].name="!Directory",ue>0&&Fe!==oe&&(pt[Fe].name="!MiniFAT"),pt[Ce[0]].name="!FAT",pt.fat_addrs=Ce,pt.ssz=se;var mt={},Rt=[],un=[],Wr=[];A(ke,pt,it,Rt,ue,mt,un,Fe),m(un,Wr,Rt),Rt.shift();var Ar={FileIndex:un,FullPaths:Wr};return ce&&ce.raw&&(Ar.raw={header:He,sectors:it}),Ar}function p(ee){if(ee[ee.l]==80&&ee[ee.l+1]==75)return[0,0];ee.chk(le,"Header Signature: "),ee.l+=16;var ce=ee.read_shift(2,"u");return[ee.read_shift(2,"u"),ce]}function g(ee,ce){var ie=9;switch(ee.l+=2,ie=ee.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+ie);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+ie);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ie)}ee.chk("0600","Mini Sector Shift: "),ee.chk("000000000000","Reserved: ")}function v(ee,ce){for(var ie=Math.ceil(ee.length/ce)-1,se=[],ue=1;ue<ie;++ue)se[ue-1]=ee.slice(ue*ce,(ue+1)*ce);return se[ie-1]=ee.slice(ie*ce),se}function m(ee,ce,ie){for(var se=0,ue=0,fe=0,ke=0,Fe=0,Te=ie.length,Ce=[],Pe=[];se<Te;++se)Ce[se]=Pe[se]=se,ce[se]=ie[se];for(;Fe<Pe.length;++Fe)se=Pe[Fe],ue=ee[se].L,fe=ee[se].R,ke=ee[se].C,Ce[se]===se&&(ue!==-1&&Ce[ue]!==ue&&(Ce[se]=Ce[ue]),fe!==-1&&Ce[fe]!==fe&&(Ce[se]=Ce[fe])),ke!==-1&&(Ce[ke]=se),ue!==-1&&se!=Ce[se]&&(Ce[ue]=Ce[se],Pe.lastIndexOf(ue)<Fe&&Pe.push(ue)),fe!==-1&&se!=Ce[se]&&(Ce[fe]=Ce[se],Pe.lastIndexOf(fe)<Fe&&Pe.push(fe));for(se=1;se<Te;++se)Ce[se]===se&&(fe!==-1&&Ce[fe]!==fe?Ce[se]=Ce[fe]:ue!==-1&&Ce[ue]!==ue&&(Ce[se]=Ce[ue]));for(se=1;se<Te;++se)if(ee[se].type!==0){if(Fe=se,Fe!=Ce[Fe])do Fe=Ce[Fe],ce[se]=ce[Fe]+"/"+ce[se];while(Fe!==0&&Ce[Fe]!==-1&&Fe!=Ce[Fe]);Ce[se]=-1}for(ce[0]+="/",se=1;se<Te;++se)ee[se].type!==2&&(ce[se]+="/")}function S(ee,ce,ie){for(var se=ee.start,ue=ee.size,fe=[],ke=se;ie&&ue>0&&ke>=0;)fe.push(ce.slice(ke*ne,ke*ne+ne)),ue-=ne,ke=__readInt32LE(ie,ke*4);return fe.length===0?new_buf(0):bconcat(fe).slice(0,ee.size)}function E(ee,ce,ie,se,ue){var fe=oe;if(ee===oe){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(ee!==-1){var ke=ie[ee],Fe=(se>>>2)-1;if(!ke)return;for(var Te=0;Te<Fe&&(fe=__readInt32LE(ke,Te*4))!==oe;++Te)ue.push(fe);E(__readInt32LE(ke,se-4),ce-1,ie,se,ue)}}function w(ee,ce,ie,se,ue){var fe=[],ke=[];ue||(ue=[]);var Fe=se-1,Te=0,Ce=0;for(Te=ce;Te>=0;){ue[Te]=!0,fe[fe.length]=Te,ke.push(ee[Te]);var Pe=ie[Math.floor(Te*4/se)];if(Ce=Te*4&Fe,se<4+Ce)throw new Error("FAT boundary crossed: "+Te+" 4 "+se);if(!ee[Pe])break;Te=__readInt32LE(ee[Pe],Ce)}return{nodes:fe,data:__toBuffer([ke])}}function T(ee,ce,ie,se){var ue=ee.length,fe=[],ke=[],Fe=[],Te=[],Ce=se-1,Pe=0,Ne=0,He=0,Ge=0;for(Pe=0;Pe<ue;++Pe)if(Fe=[],He=Pe+ce,He>=ue&&(He-=ue),!ke[He]){Te=[];var je=[];for(Ne=He;Ne>=0;){je[Ne]=!0,ke[Ne]=!0,Fe[Fe.length]=Ne,Te.push(ee[Ne]);var $e=ie[Math.floor(Ne*4/se)];if(Ge=Ne*4&Ce,se<4+Ge)throw new Error("FAT boundary crossed: "+Ne+" 4 "+se);if(!ee[$e]||(Ne=__readInt32LE(ee[$e],Ge),je[Ne]))break}fe[He]={nodes:Fe,data:__toBuffer([Te])}}return fe}function A(ee,ce,ie,se,ue,fe,ke,Fe){for(var Te=0,Ce=se.length?2:0,Pe=ce[ee].data,Ne=0,He=0,Ge;Ne<Pe.length;Ne+=128){var je=Pe.slice(Ne,Ne+128);prep_blob(je,64),He=je.read_shift(2),Ge=__utf16le(je,0,He-Ce),se.push(Ge);var $e={name:Ge,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},it=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);it!==0&&($e.ct=L(je,je.l-8));var pt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);pt!==0&&($e.mt=L(je,je.l-8)),$e.start=je.read_shift(4,"i"),$e.size=je.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=oe,$e.name=""),$e.type===5?(Te=$e.start,ue>0&&Te!==oe&&(ce[Te].name="!StreamData")):$e.size>=4096?($e.storage="fat",ce[$e.start]===void 0&&(ce[$e.start]=w(ie,$e.start,ce.fat_addrs,ce.ssz)),ce[$e.start].name=$e.name,$e.content=ce[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:Te!==oe&&$e.start!==oe&&ce[Te]&&($e.content=S($e,ce[Te].data,(ce[Fe]||{}).data))),$e.content&&prep_blob($e.content,0),fe[Ge]=$e,ke.push($e)}}function L(ee,ce){return new Date((__readUInt32LE(ee,ce+4)/1e7*Math.pow(2,32)+__readUInt32LE(ee,ce)/1e7-11644473600)*1e3)}function k(ee,ce){return f(),u(h.readFileSync(ee),ce)}function D(ee,ce){var ie=ce&&ce.type;switch(ie||has_buf&&Buffer.isBuffer(ee)&&(ie="buffer"),ie||"base64"){case"file":return k(ee,ce);case"base64":return u(s2a(Base64_decode(ee)),ce);case"binary":return u(s2a(ee),ce)}return u(ee,ce)}function N(ee,ce){var ie=ce||{},se=ie.root||"Root Entry";if(ee.FullPaths||(ee.FullPaths=[]),ee.FileIndex||(ee.FileIndex=[]),ee.FullPaths.length!==ee.FileIndex.length)throw new Error("inconsistent CFB structure");ee.FullPaths.length===0&&(ee.FullPaths[0]=se+"/",ee.FileIndex[0]={name:se,type:5}),ie.CLSID&&(ee.FileIndex[0].clsid=ie.CLSID),Y(ee)}function Y(ee){var ce="Sh33tJ5";if(!CFB.find(ee,"/"+ce)){var ie=new_buf(4);ie[0]=55,ie[1]=ie[3]=50,ie[2]=54,ee.FileIndex.push({name:ce,type:2,content:ie,size:4,L:69,R:69,C:69}),ee.FullPaths.push(ee.FullPaths[0]+ce),z(ee)}}function z(ee,ce){N(ee);for(var ie=!1,se=!1,ue=ee.FullPaths.length-1;ue>=0;--ue){var fe=ee.FileIndex[ue];switch(fe.type){case 0:se?ie=!0:(ee.FileIndex.pop(),ee.FullPaths.pop());break;case 1:case 2:case 5:se=!0,isNaN(fe.R*fe.L*fe.C)&&(ie=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(ie=!0);break;default:ie=!0;break}}if(!(!ie&&!ce)){var ke=new Date(1987,1,19),Fe=0,Te=Object.create?Object.create(null):{},Ce=[];for(ue=0;ue<ee.FullPaths.length;++ue)Te[ee.FullPaths[ue]]=!0,ee.FileIndex[ue].type!==0&&Ce.push([ee.FullPaths[ue],ee.FileIndex[ue]]);for(ue=0;ue<Ce.length;++ue){var Pe=a(Ce[ue][0]);se=Te[Pe],se||(Ce.push([Pe,{name:i(Pe).replace("/",""),type:1,clsid:de,ct:ke,mt:ke,content:null}]),Te[Pe]=!0)}for(Ce.sort(function(Ge,je){return n(Ge[0],je[0])}),ee.FullPaths=[],ee.FileIndex=[],ue=0;ue<Ce.length;++ue)ee.FullPaths[ue]=Ce[ue][0],ee.FileIndex[ue]=Ce[ue][1];for(ue=0;ue<Ce.length;++ue){var Ne=ee.FileIndex[ue],He=ee.FullPaths[ue];if(Ne.name=i(He).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||de,ue===0)Ne.C=Ce.length>1?1:-1,Ne.size=0,Ne.type=5;else if(He.slice(-1)=="/"){for(Fe=ue+1;Fe<Ce.length&&a(ee.FullPaths[Fe])!=He;++Fe);for(Ne.C=Fe>=Ce.length?-1:Fe,Fe=ue+1;Fe<Ce.length&&a(ee.FullPaths[Fe])!=a(He);++Fe);Ne.R=Fe>=Ce.length?-1:Fe,Ne.type=1}else a(ee.FullPaths[ue+1]||"")==a(He)&&(Ne.R=ue+1),Ne.type=2}}}function te(ee,ce){var ie=ce||{};if(ie.fileType=="mad")return ur(ee,ie);switch(z(ee),ie.fileType){case"zip":return Kt(ee,ie)}var se=(function(Ge){for(var je=0,$e=0,it=0;it<Ge.FileIndex.length;++it){var pt=Ge.FileIndex[it];if(pt.content){var mt=pt.content.length;mt>0&&(mt<4096?je+=mt+63>>6:$e+=mt+511>>9)}}for(var Rt=Ge.FullPaths.length+3>>2,un=je+7>>3,Wr=je+127>>7,Ar=un+$e+Rt+Wr,Nt=Ar+127>>7,qn=Nt<=109?0:Math.ceil((Nt-109)/127);Ar+Nt+qn+127>>7>Nt;)qn=++Nt<=109?0:Math.ceil((Nt-109)/127);var Ot=[1,qn,Nt,Wr,Rt,$e,je,0];return Ge.FileIndex[0].size=je<<6,Ot[7]=(Ge.FileIndex[0].start=Ot[0]+Ot[1]+Ot[2]+Ot[3]+Ot[4]+Ot[5])+(Ot[6]+7>>3),Ot})(ee),ue=new_buf(se[7]<<9),fe=0,ke=0;{for(fe=0;fe<8;++fe)ue.write_shift(1,pe[fe]);for(fe=0;fe<8;++fe)ue.write_shift(2,0);for(ue.write_shift(2,62),ue.write_shift(2,3),ue.write_shift(2,65534),ue.write_shift(2,9),ue.write_shift(2,6),fe=0;fe<3;++fe)ue.write_shift(2,0);for(ue.write_shift(4,0),ue.write_shift(4,se[2]),ue.write_shift(4,se[0]+se[1]+se[2]+se[3]-1),ue.write_shift(4,0),ue.write_shift(4,4096),ue.write_shift(4,se[3]?se[0]+se[1]+se[2]-1:oe),ue.write_shift(4,se[3]),ue.write_shift(-4,se[1]?se[0]-1:oe),ue.write_shift(4,se[1]),fe=0;fe<109;++fe)ue.write_shift(-4,fe<se[2]?se[1]+fe:-1)}if(se[1])for(ke=0;ke<se[1];++ke){for(;fe<236+ke*127;++fe)ue.write_shift(-4,fe<se[2]?se[1]+fe:-1);ue.write_shift(-4,ke===se[1]-1?oe:ke+1)}var Fe=function(Ge){for(ke+=Ge;fe<ke-1;++fe)ue.write_shift(-4,fe+1);Ge&&(++fe,ue.write_shift(-4,oe))};for(ke=fe=0,ke+=se[1];fe<ke;++fe)ue.write_shift(-4,J.DIFSECT);for(ke+=se[2];fe<ke;++fe)ue.write_shift(-4,J.FATSECT);Fe(se[3]),Fe(se[4]);for(var Te=0,Ce=0,Pe=ee.FileIndex[0];Te<ee.FileIndex.length;++Te)Pe=ee.FileIndex[Te],Pe.content&&(Ce=Pe.content.length,!(Ce<4096)&&(Pe.start=ke,Fe(Ce+511>>9)));for(Fe(se[6]+7>>3);ue.l&511;)ue.write_shift(-4,J.ENDOFCHAIN);for(ke=fe=0,Te=0;Te<ee.FileIndex.length;++Te)Pe=ee.FileIndex[Te],Pe.content&&(Ce=Pe.content.length,!(!Ce||Ce>=4096)&&(Pe.start=ke,Fe(Ce+63>>6)));for(;ue.l&511;)ue.write_shift(-4,J.ENDOFCHAIN);for(fe=0;fe<se[4]<<2;++fe){var Ne=ee.FullPaths[fe];if(!Ne||Ne.length===0){for(Te=0;Te<17;++Te)ue.write_shift(4,0);for(Te=0;Te<3;++Te)ue.write_shift(4,-1);for(Te=0;Te<12;++Te)ue.write_shift(4,0);continue}Pe=ee.FileIndex[fe],fe===0&&(Pe.start=Pe.size?Pe.start-1:oe);var He=fe===0&&ie.root||Pe.name;if(Ce=2*(He.length+1),ue.write_shift(64,He,"utf16le"),ue.write_shift(2,Ce),ue.write_shift(1,Pe.type),ue.write_shift(1,Pe.color),ue.write_shift(-4,Pe.L),ue.write_shift(-4,Pe.R),ue.write_shift(-4,Pe.C),Pe.clsid)ue.write_shift(16,Pe.clsid,"hex");else for(Te=0;Te<4;++Te)ue.write_shift(4,0);ue.write_shift(4,Pe.state||0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,Pe.start),ue.write_shift(4,Pe.size),ue.write_shift(4,0)}for(fe=1;fe<ee.FileIndex.length;++fe)if(Pe=ee.FileIndex[fe],Pe.size>=4096)if(ue.l=Pe.start+1<<9,has_buf&&Buffer.isBuffer(Pe.content))Pe.content.copy(ue,ue.l,0,Pe.size),ue.l+=Pe.size+511&-512;else{for(Te=0;Te<Pe.size;++Te)ue.write_shift(1,Pe.content[Te]);for(;Te&511;++Te)ue.write_shift(1,0)}for(fe=1;fe<ee.FileIndex.length;++fe)if(Pe=ee.FileIndex[fe],Pe.size>0&&Pe.size<4096)if(has_buf&&Buffer.isBuffer(Pe.content))Pe.content.copy(ue,ue.l,0,Pe.size),ue.l+=Pe.size+63&-64;else{for(Te=0;Te<Pe.size;++Te)ue.write_shift(1,Pe.content[Te]);for(;Te&63;++Te)ue.write_shift(1,0)}if(has_buf)ue.l=ue.length;else for(;ue.l<ue.length;)ue.write_shift(1,0);return ue}function Z(ee,ce){var ie=ee.FullPaths.map(function(Te){return Te.toUpperCase()}),se=ie.map(function(Te){var Ce=Te.split("/");return Ce[Ce.length-(Te.slice(-1)=="/"?2:1)]}),ue=!1;ce.charCodeAt(0)===47?(ue=!0,ce=ie[0].slice(0,-1)+ce):ue=ce.indexOf("/")!==-1;var fe=ce.toUpperCase(),ke=ue===!0?ie.indexOf(fe):se.indexOf(fe);if(ke!==-1)return ee.FileIndex[ke];var Fe=!fe.match(chr1);for(fe=fe.replace(chr0,""),Fe&&(fe=fe.replace(chr1,"!")),ke=0;ke<ie.length;++ke)if((Fe?ie[ke].replace(chr1,"!"):ie[ke]).replace(chr0,"")==fe||(Fe?se[ke].replace(chr1,"!"):se[ke]).replace(chr0,"")==fe)return ee.FileIndex[ke];return null}var ne=64,oe=-2,le="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:oe,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(ee,ce,ie){f();var se=te(ee,ie);h.writeFileSync(ce,se)}function C(ee){for(var ce=new Array(ee.length),ie=0;ie<ee.length;++ie)ce[ie]=String.fromCharCode(ee[ie]);return ce.join("")}function O(ee,ce){var ie=te(ee,ce);switch(ce&&ce.type||"buffer"){case"file":return f(),h.writeFileSync(ce.filename,ie),ie;case"binary":return typeof ie=="string"?ie:C(ie);case"base64":return Base64_encode(typeof ie=="string"?ie:C(ie));case"buffer":if(has_buf)return Buffer.isBuffer(ie)?ie:Buffer_from(ie);case"array":return typeof ie=="string"?s2a(ie):ie}return ie}var I;function M(ee){try{var ce=ee.InflateRaw,ie=new ce;if(ie._processChunk(new Uint8Array([3,0]),ie._finishFlushFlag),ie.bytesRead)I=ee;else throw new Error("zlib does not expose bytesRead")}catch(se){console.error("cannot use native zlib: "+(se.message||se))}}function H(ee,ce){if(!I)return ot(ee,ce);var ie=I.InflateRaw,se=new ie,ue=se._processChunk(ee.slice(ee.l),se._finishFlushFlag);return ee.l+=se.bytesRead,ue}function G(ee){return I?I.deflateRawSync(ee):tt(ee)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(ee){var ce=(ee<<1|ee<<11)&139536|(ee<<5|ee<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var W=typeof Uint8Array<"u",K=W?new Uint8Array(256):[],ae=0;ae<256;++ae)K[ae]=X(ae);function U(ee,ce){var ie=K[ee&255];return ce<=8?ie>>>8-ce:(ie=ie<<8|K[ee>>8&255],ce<=16?ie>>>16-ce:(ie=ie<<8|K[ee>>16&255],ie>>>24-ce))}function ve(ee,ce){var ie=ce&7,se=ce>>>3;return(ee[se]|(ie<=6?0:ee[se+1]<<8))>>>ie&3}function be(ee,ce){var ie=ce&7,se=ce>>>3;return(ee[se]|(ie<=5?0:ee[se+1]<<8))>>>ie&7}function ye(ee,ce){var ie=ce&7,se=ce>>>3;return(ee[se]|(ie<=4?0:ee[se+1]<<8))>>>ie&15}function _e(ee,ce){var ie=ce&7,se=ce>>>3;return(ee[se]|(ie<=3?0:ee[se+1]<<8))>>>ie&31}function ge(ee,ce){var ie=ce&7,se=ce>>>3;return(ee[se]|(ie<=1?0:ee[se+1]<<8))>>>ie&127}function Re(ee,ce,ie){var se=ce&7,ue=ce>>>3,fe=(1<<ie)-1,ke=ee[ue]>>>se;return ie<8-se||(ke|=ee[ue+1]<<8-se,ie<16-se)||(ke|=ee[ue+2]<<16-se,ie<24-se)||(ke|=ee[ue+3]<<24-se),ke&fe}function De(ee,ce,ie){var se=ce&7,ue=ce>>>3;return se<=5?ee[ue]|=(ie&7)<<se:(ee[ue]|=ie<<se&255,ee[ue+1]=(ie&7)>>8-se),ce+3}function We(ee,ce,ie){var se=ce&7,ue=ce>>>3;return ie=(ie&1)<<se,ee[ue]|=ie,ce+1}function ze(ee,ce,ie){var se=ce&7,ue=ce>>>3;return ie<<=se,ee[ue]|=ie&255,ie>>>=8,ee[ue+1]=ie,ce+8}function Je(ee,ce,ie){var se=ce&7,ue=ce>>>3;return ie<<=se,ee[ue]|=ie&255,ie>>>=8,ee[ue+1]=ie&255,ee[ue+2]=ie>>>8,ce+16}function Qe(ee,ce){var ie=ee.length,se=2*ie>ce?2*ie:ce+5,ue=0;if(ie>=ce)return ee;if(has_buf){var fe=new_unsafe_buf(se);if(ee.copy)ee.copy(fe);else for(;ue<ee.length;++ue)fe[ue]=ee[ue];return fe}else if(W){var ke=new Uint8Array(se);if(ke.set)ke.set(ee);else for(;ue<ie;++ue)ke[ue]=ee[ue];return ke}return ee.length=se,ee}function et(ee){for(var ce=new Array(ee),ie=0;ie<ee;++ie)ce[ie]=0;return ce}function st(ee,ce,ie){var se=1,ue=0,fe=0,ke=0,Fe=0,Te=ee.length,Ce=W?new Uint16Array(32):et(32);for(fe=0;fe<32;++fe)Ce[fe]=0;for(fe=Te;fe<ie;++fe)ee[fe]=0;Te=ee.length;var Pe=W?new Uint16Array(Te):et(Te);for(fe=0;fe<Te;++fe)Ce[ue=ee[fe]]++,se<ue&&(se=ue),Pe[fe]=0;for(Ce[0]=0,fe=1;fe<=se;++fe)Ce[fe+16]=Fe=Fe+Ce[fe-1]<<1;for(fe=0;fe<Te;++fe)Fe=ee[fe],Fe!=0&&(Pe[fe]=Ce[Fe+16]++);var Ne=0;for(fe=0;fe<Te;++fe)if(Ne=ee[fe],Ne!=0)for(Fe=U(Pe[fe],se)>>se-Ne,ke=(1<<se+4-Ne)-1;ke>=0;--ke)ce[Fe|ke<<Ne]=Ne&15|fe<<4;return se}var vt=W?new Uint16Array(512):et(512),xt=W?new Uint16Array(32):et(32);if(!W){for(var ht=0;ht<512;++ht)vt[ht]=0;for(ht=0;ht<32;++ht)xt[ht]=0}(function(){for(var ee=[],ce=0;ce<32;ce++)ee.push(5);st(ee,xt,32);var ie=[];for(ce=0;ce<=143;ce++)ie.push(8);for(;ce<=255;ce++)ie.push(9);for(;ce<=279;ce++)ie.push(7);for(;ce<=287;ce++)ie.push(8);st(ie,vt,288)})();var ft=(function(){for(var ce=W?new Uint8Array(32768):[],ie=0,se=0;ie<q.length-1;++ie)for(;se<q[ie+1];++se)ce[se]=ie;for(;se<32768;++se)ce[se]=29;var ue=W?new Uint8Array(259):[];for(ie=0,se=0;ie<F.length-1;++ie)for(;se<F[ie+1];++se)ue[se]=ie;function fe(Fe,Te){for(var Ce=0;Ce<Fe.length;){var Pe=Math.min(65535,Fe.length-Ce),Ne=Ce+Pe==Fe.length;for(Te.write_shift(1,+Ne),Te.write_shift(2,Pe),Te.write_shift(2,~Pe&65535);Pe-- >0;)Te[Te.l++]=Fe[Ce++]}return Te.l}function ke(Fe,Te){for(var Ce=0,Pe=0,Ne=W?new Uint16Array(32768):[];Pe<Fe.length;){var He=Math.min(65535,Fe.length-Pe);if(He<10){for(Ce=De(Te,Ce,+(Pe+He==Fe.length)),Ce&7&&(Ce+=8-(Ce&7)),Te.l=Ce/8|0,Te.write_shift(2,He),Te.write_shift(2,~He&65535);He-- >0;)Te[Te.l++]=Fe[Pe++];Ce=Te.l*8;continue}Ce=De(Te,Ce,+(Pe+He==Fe.length)+2);for(var Ge=0;He-- >0;){var je=Fe[Pe];Ge=(Ge<<5^je)&32767;var $e=-1,it=0;if(($e=Ne[Ge])&&($e|=Pe&-32768,$e>Pe&&($e-=32768),$e<Pe))for(;Fe[$e+it]==Fe[Pe+it]&&it<250;)++it;if(it>2){je=ue[it],je<=22?Ce=ze(Te,Ce,K[je+1]>>1)-1:(ze(Te,Ce,3),Ce+=5,ze(Te,Ce,K[je-23]>>5),Ce+=3);var pt=je<8?0:je-4>>2;pt>0&&(Je(Te,Ce,it-F[je]),Ce+=pt),je=ce[Pe-$e],Ce=ze(Te,Ce,K[je]>>3),Ce-=3;var mt=je<4?0:je-2>>1;mt>0&&(Je(Te,Ce,Pe-$e-q[je]),Ce+=mt);for(var Rt=0;Rt<it;++Rt)Ne[Ge]=Pe&32767,Ge=(Ge<<5^Fe[Pe])&32767,++Pe;He-=it-1}else je<=143?je=je+48:Ce=We(Te,Ce,1),Ce=ze(Te,Ce,K[je]),Ne[Ge]=Pe&32767,++Pe}Ce=ze(Te,Ce,0)-1}return Te.l=(Ce+7)/8|0,Te.l}return function(Te,Ce){return Te.length<8?fe(Te,Ce):ke(Te,Ce)}})();function tt(ee){var ce=new_buf(50+Math.floor(ee.length*1.1)),ie=ft(ee,ce);return ce.slice(0,ie)}var ut=W?new Uint16Array(32768):et(32768),Ht=W?new Uint16Array(32768):et(32768),St=W?new Uint16Array(128):et(128),Ie=1,we=1;function Se(ee,ce){var ie=_e(ee,ce)+257;ce+=5;var se=_e(ee,ce)+1;ce+=5;var ue=ye(ee,ce)+4;ce+=4;for(var fe=0,ke=W?new Uint8Array(19):et(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Te=1,Ce=W?new Uint8Array(8):et(8),Pe=W?new Uint8Array(8):et(8),Ne=ke.length,He=0;He<ue;++He)ke[j[He]]=fe=be(ee,ce),Te<fe&&(Te=fe),Ce[fe]++,ce+=3;var Ge=0;for(Ce[0]=0,He=1;He<=Te;++He)Pe[He]=Ge=Ge+Ce[He-1]<<1;for(He=0;He<Ne;++He)(Ge=ke[He])!=0&&(Fe[He]=Pe[Ge]++);var je=0;for(He=0;He<Ne;++He)if(je=ke[He],je!=0){Ge=K[Fe[He]]>>8-je;for(var $e=(1<<7-je)-1;$e>=0;--$e)St[Ge|$e<<je]=je&7|He<<3}var it=[];for(Te=1;it.length<ie+se;)switch(Ge=St[ge(ee,ce)],ce+=Ge&7,Ge>>>=3){case 16:for(fe=3+ve(ee,ce),ce+=2,Ge=it[it.length-1];fe-- >0;)it.push(Ge);break;case 17:for(fe=3+be(ee,ce),ce+=3;fe-- >0;)it.push(0);break;case 18:for(fe=11+ge(ee,ce),ce+=7;fe-- >0;)it.push(0);break;default:it.push(Ge),Te<Ge&&(Te=Ge);break}var pt=it.slice(0,ie),mt=it.slice(ie);for(He=ie;He<286;++He)pt[He]=0;for(He=se;He<30;++He)mt[He]=0;return Ie=st(pt,ut,286),we=st(mt,Ht,30),ce}function qe(ee,ce){if(ee[0]==3&&!(ee[1]&3))return[new_raw_buf(ce),2];for(var ie=0,se=0,ue=new_unsafe_buf(ce||1<<18),fe=0,ke=ue.length>>>0,Fe=0,Te=0;(se&1)==0;){if(se=be(ee,ie),ie+=3,se>>>1)se>>1==1?(Fe=9,Te=5):(ie=Se(ee,ie),Fe=Ie,Te=we);else{ie&7&&(ie+=8-(ie&7));var Ce=ee[ie>>>3]|ee[(ie>>>3)+1]<<8;if(ie+=32,Ce>0)for(!ce&&ke<fe+Ce&&(ue=Qe(ue,fe+Ce),ke=ue.length);Ce-- >0;)ue[fe++]=ee[ie>>>3],ie+=8;continue}for(;;){!ce&&ke<fe+32767&&(ue=Qe(ue,fe+32767),ke=ue.length);var Pe=Re(ee,ie,Fe),Ne=se>>>1==1?vt[Pe]:ut[Pe];if(ie+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)ue[fe++]=Ne;else{if(Ne==256)break;Ne-=257;var He=Ne<8?0:Ne-4>>2;He>5&&(He=0);var Ge=fe+F[Ne];He>0&&(Ge+=Re(ee,ie,He),ie+=He),Pe=Re(ee,ie,Te),Ne=se>>>1==1?xt[Pe]:Ht[Pe],ie+=Ne&15,Ne>>>=4;var je=Ne<4?0:Ne-2>>1,$e=q[Ne];for(je>0&&($e+=Re(ee,ie,je),ie+=je),!ce&&ke<Ge&&(ue=Qe(ue,Ge+100),ke=ue.length);fe<Ge;)ue[fe]=ue[fe-$e],++fe}}}return ce?[ue,ie+7>>>3]:[ue.slice(0,fe),ie+7>>>3]}function ot(ee,ce){var ie=ee.slice(ee.l||0),se=qe(ie,ce);return ee.l+=se[1],se[0]}function Et(ee,ce){if(ee)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function wt(ee,ce){var ie=ee;prep_blob(ie,0);var se=[],ue=[],fe={FileIndex:se,FullPaths:ue};N(fe,{root:ce.root});for(var ke=ie.length-4;(ie[ke]!=80||ie[ke+1]!=75||ie[ke+2]!=5||ie[ke+3]!=6)&&ke>=0;)--ke;ie.l=ke+4,ie.l+=4;var Fe=ie.read_shift(2);ie.l+=6;var Te=ie.read_shift(4);for(ie.l=Te,ke=0;ke<Fe;++ke){ie.l+=20;var Ce=ie.read_shift(4),Pe=ie.read_shift(4),Ne=ie.read_shift(2),He=ie.read_shift(2),Ge=ie.read_shift(2);ie.l+=8;var je=ie.read_shift(4),$e=c(ie.slice(ie.l+Ne,ie.l+Ne+He));ie.l+=Ne+He+Ge;var it=ie.l;ie.l=je+4,Xt(ie,Ce,Pe,fe,$e),ie.l=it}return fe}function Xt(ee,ce,ie,se,ue){ee.l+=2;var fe=ee.read_shift(2),ke=ee.read_shift(2),Fe=o(ee);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var Te=ee.read_shift(4),Ce=ee.read_shift(4),Pe=ee.read_shift(4),Ne=ee.read_shift(2),He=ee.read_shift(2),Ge="",je=0;je<Ne;++je)Ge+=String.fromCharCode(ee[ee.l++]);if(He){var $e=c(ee.slice(ee.l,ee.l+He));($e[21589]||{}).mt&&(Fe=$e[21589].mt),((ue||{})[21589]||{}).mt&&(Fe=ue[21589].mt)}ee.l+=He;var it=ee.slice(ee.l,ee.l+Ce);switch(ke){case 8:it=H(ee,Pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var pt=!1;fe&8&&(Te=ee.read_shift(4),Te==134695760&&(Te=ee.read_shift(4),pt=!0),Ce=ee.read_shift(4),Pe=ee.read_shift(4)),Ce!=ce&&Et(pt,"Bad compressed size: "+ce+" != "+Ce),Pe!=ie&&Et(pt,"Bad uncompressed size: "+ie+" != "+Pe),ir(se,Ge,it,{unsafe:!0,mt:Fe})}function Kt(ee,ce){var ie=ce||{},se=[],ue=[],fe=new_buf(1),ke=ie.compression?8:0,Fe=0,Te=0,Ce=0,Pe=0,Ne=0,He=ee.FullPaths[0],Ge=He,je=ee.FileIndex[0],$e=[],it=0;for(Te=1;Te<ee.FullPaths.length;++Te)if(Ge=ee.FullPaths[Te].slice(He.length),je=ee.FileIndex[Te],!(!je.size||!je.content||Ge=="Sh33tJ5")){var pt=Pe,mt=new_buf(Ge.length);for(Ce=0;Ce<Ge.length;++Ce)mt.write_shift(1,Ge.charCodeAt(Ce)&127);mt=mt.slice(0,mt.l),$e[Ne]=CRC32.buf(je.content,0);var Rt=je.content;ke==8&&(Rt=G(Rt)),fe=new_buf(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,Fe),fe.write_shift(2,ke),je.mt?s(fe,je.mt):fe.write_shift(4,0),fe.write_shift(-4,$e[Ne]),fe.write_shift(4,Rt.length),fe.write_shift(4,je.content.length),fe.write_shift(2,mt.length),fe.write_shift(2,0),Pe+=fe.length,se.push(fe),Pe+=mt.length,se.push(mt),Pe+=Rt.length,se.push(Rt),fe=new_buf(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,Fe),fe.write_shift(2,ke),fe.write_shift(4,0),fe.write_shift(-4,$e[Ne]),fe.write_shift(4,Rt.length),fe.write_shift(4,je.content.length),fe.write_shift(2,mt.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,pt),it+=fe.l,ue.push(fe),it+=mt.length,ue.push(mt),++Ne}return fe=new_buf(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,Ne),fe.write_shift(2,Ne),fe.write_shift(4,it),fe.write_shift(4,Pe),fe.write_shift(2,0),bconcat([bconcat(se),bconcat(ue),fe])}var Yt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function It(ee,ce){if(ee.ctype)return ee.ctype;var ie=ee.name||"",se=ie.match(/\.([^\.]+)$/);return se&&Yt[se[1]]||ce&&(se=(ie=ce).match(/[\.\\]([^\.\\])+$/),se&&Yt[se[1]])?Yt[se[1]]:"application/octet-stream"}function xr(ee){for(var ce=Base64_encode(ee),ie=[],se=0;se<ce.length;se+=76)ie.push(ce.slice(se,se+76));return ie.join(`\r
`)+`\r
`}function ar(ee){var ce=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ce){var Pe=Ce.charCodeAt(0).toString(16).toUpperCase();return"="+(Pe.length==1?"0"+Pe:Pe)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ie=[],se=ce.split(`\r
`),ue=0;ue<se.length;++ue){var fe=se[ue];if(fe.length==0){ie.push("");continue}for(var ke=0;ke<fe.length;){var Fe=76,Te=fe.slice(ke,ke+Fe);Te.charAt(Fe-1)=="="?Fe--:Te.charAt(Fe-2)=="="?Fe-=2:Te.charAt(Fe-3)=="="&&(Fe-=3),Te=fe.slice(ke,ke+Fe),ke+=Fe,ke<fe.length&&(Te+="="),ie.push(Te)}}return ie.join(`\r
`)}function Rr(ee){for(var ce=[],ie=0;ie<ee.length;++ie){for(var se=ee[ie];ie<=ee.length&&se.charAt(se.length-1)=="=";)se=se.slice(0,se.length-1)+ee[++ie];ce.push(se)}for(var ue=0;ue<ce.length;++ue)ce[ue]=ce[ue].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return s2a(ce.join(`\r
`))}function bt(ee,ce,ie){for(var se="",ue="",fe="",ke,Fe=0;Fe<10;++Fe){var Te=ce[Fe];if(!Te||Te.match(/^\s*$/))break;var Ce=Te.match(/^(.*?):\s*([^\s].*)$/);if(Ce)switch(Ce[1].toLowerCase()){case"content-location":se=Ce[2].trim();break;case"content-type":fe=Ce[2].trim();break;case"content-transfer-encoding":ue=Ce[2].trim();break}}switch(++Fe,ue.toLowerCase()){case"base64":ke=s2a(Base64_decode(ce.slice(Fe).join("")));break;case"quoted-printable":ke=Rr(ce.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ue)}var Pe=ir(ee,se.slice(ie.length),ke,{unsafe:!0});fe&&(Pe.ctype=fe)}function Or(ee,ce){if(C(ee.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ie=ce&&ce.root||"",se=(has_buf&&Buffer.isBuffer(ee)?ee.toString("binary"):C(ee)).split(`\r
`),ue=0,fe="";for(ue=0;ue<se.length;++ue)if(fe=se[ue],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),ie||(ie=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,ie.length)!=ie))for(;ie.length>0&&(ie=ie.slice(0,ie.length-1),ie=ie.slice(0,ie.lastIndexOf("/")+1),fe.slice(0,ie.length)!=ie););var ke=(se[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Fe="--"+(ke[1]||""),Te=[],Ce=[],Pe={FileIndex:Te,FullPaths:Ce};N(Pe);var Ne,He=0;for(ue=0;ue<se.length;++ue){var Ge=se[ue];Ge!==Fe&&Ge!==Fe+"--"||(He++&&bt(Pe,se.slice(Ne,ue),ie),Ne=ue)}return Pe}function ur(ee,ce){var ie=ce||{},se=ie.boundary||"SheetJS";se="------="+se;for(var ue=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+se.slice(2)+'"',"","",""],fe=ee.FullPaths[0],ke=fe,Fe=ee.FileIndex[0],Te=1;Te<ee.FullPaths.length;++Te)if(ke=ee.FullPaths[Te].slice(fe.length),Fe=ee.FileIndex[Te],!(!Fe.size||!Fe.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var Ce=Fe.content,Pe=has_buf&&Buffer.isBuffer(Ce)?Ce.toString("binary"):C(Ce),Ne=0,He=Math.min(1024,Pe.length),Ge=0,je=0;je<=He;++je)(Ge=Pe.charCodeAt(je))>=32&&Ge<128&&++Ne;var $e=Ne>=He*4/5;ue.push(se),ue.push("Content-Location: "+(ie.root||"file:///C:/SheetJS/")+ke),ue.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),ue.push("Content-Type: "+It(Fe,ke)),ue.push(""),ue.push($e?ar(Pe):xr(Pe))}return ue.push(se+`--\r
`),ue.join(`\r
`)}function Fr(ee){var ce={};return N(ce,ee),ce}function ir(ee,ce,ie,se){var ue=se&&se.unsafe;ue||N(ee);var fe=!ue&&CFB.find(ee,ce);if(!fe){var ke=ee.FullPaths[0];ce.slice(0,ke.length)==ke?ke=ce:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+ce).replace("//","/")),fe={name:i(ce),type:2},ee.FileIndex.push(fe),ee.FullPaths.push(ke),ue||CFB.utils.cfb_gc(ee)}return fe.content=ie,fe.size=ie?ie.length:0,se&&(se.CLSID&&(fe.clsid=se.CLSID),se.mt&&(fe.mt=se.mt),se.ct&&(fe.ct=se.ct)),fe}function Dr(ee,ce){N(ee);var ie=CFB.find(ee,ce);if(ie){for(var se=0;se<ee.FileIndex.length;++se)if(ee.FileIndex[se]==ie)return ee.FileIndex.splice(se,1),ee.FullPaths.splice(se,1),!0}return!1}function Pt(ee,ce,ie){N(ee);var se=CFB.find(ee,ce);if(se){for(var ue=0;ue<ee.FileIndex.length;++ue)if(ee.FileIndex[ue]==se)return ee.FileIndex[ue].name=i(ie),ee.FullPaths[ue]=ie,!0}return!1}function fr(ee){z(ee,!0)}return t.find=Z,t.read=D,t.parse=u,t.write=O,t.writeFile=V,t.utils={cfb_new:Fr,cfb_add:ir,cfb_del:Dr,cfb_mov:Pt,cfb_gc:fr,ReadShift,CheckField,prep_blob,bconcat,use_zlib:M,_deflateRaw:tt,_inflateRaw:ot,consts:J},t})();function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function keys(e){for(var t=Object.keys(e),n=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&n.push(t[a]);return n}function evert(e){for(var t=[],n=keys(e),a=0;a!==n.length;++a)t[e[n[a]]]=n[a];return t}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,t){var n=e.getTime(),a=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(n-a)/(1440*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var t=new Date;return t.setTime(e*24*60*60*1e3+dnthresh),t.getTimezoneOffset()!==refoffset&&t.setTime(t.getTime()+(t.getTimezoneOffset()-refoffset)*6e4),t}function parse_isodur(e){var t=0,n=0,a=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(n=1,s>3&&(a=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(a)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(i[s],10)}return t}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,t){var n=new Date(e);if(good_pd)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(n.getFullYear())){var a=n.getFullYear();return e.indexOf(""+a)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function cc2str(e,t){if(has_buf&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var a=[],i=0;i!=e.length;++i)a.push(String.fromCharCode(e[i]));return a.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=dup(e[n]));return t}function fill(e,t){for(var n="";n.length<t;)n+=e;return n}function fuzzynum(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(a)))?t/n:t}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var t=new Date(e),n=new Date(NaN),a=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&lower_months.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return a<0||a>8099?n:(i>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var split_regex=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,a,i){if(e||typeof a=="string")return n.split(a);for(var s=n.split(a),o=[s[0]],c=1;c<s.length;++c)o.push(i),o.push(s[c]);return o}})();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?char_codes(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,t){for(var n=e.FullPaths||keys(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),i=a.replace(/\\/g,"/"),s=0;s<n.length;++s){var o=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||i==o)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function getzipfile(e,t){var n=safegetzipfile(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function getzipdata(e,t,n){if(!n)return getdata(getzipfile(e,t));if(!t)return null;try{return getzipdata(e,t)}catch{return null}}function getzipstr(e,t,n){if(!n)return getdatastr(getzipfile(e,t));if(!t)return null;try{return getzipstr(e,t)}catch{return null}}function getzipbin(e,t,n){return getdatabin(getzipfile(e,t))}function zipentries(e){for(var t=e.FullPaths||keys(e.files),n=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&n.push(t[a].replace(/^Root Entry[\/]/,""));return n.sort()}function zip_add_file(e,t,n){if(e.FullPaths){if(typeof n=="string"){var a;return has_buf?a=Buffer_from(n):a=utf8decode(n),CFB.utils.cfb_add(e,t,a)}CFB.utils.cfb_add(e,t,n)}else e.file(t,n)}function zip_read(e,t){switch(t.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function resolve_path(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var a=e.split("/");a.length!==0;){var i=a.shift();i===".."?n.pop():i!=="."&&n.push(i)}return n.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,t,n){for(var a={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(a[0]=e.slice(0,i)),i===e.length)return a;var o=e.match(attregexg),c=0,h="",f=0,u="",p="",g=1;if(o)for(f=0;f!=o.length;++f){for(p=o[f],s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(u=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;for(g=(i=p.charCodeAt(s+1))==34||i==39?1:0,h=p.slice(s+1+g,p.length-g),c=0;c!=u.length&&u.charCodeAt(c)!==58;++c);if(c===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=h,a[u.toLowerCase()]=h;else{var v=(c===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(c+1);if(a[v]&&u.slice(c-3,c)=="ext")continue;a[v]=h,a[v.toLowerCase()]=h}}return a}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(a){var i=a+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(c,h){return encodings[c]||String.fromCharCode(parseInt(h,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,h){return String.fromCharCode(parseInt(h,16))});var o=i.indexOf("]]>");return n(i.slice(0,s))+i.slice(s+9,o)+n(i.slice(o+3))}})(),decregex=/[&<>'"]/g,htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var t=e+"";return t.replace(decregex,function(n){return rencoding[n]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var xlml_fixstr=(function(){var e=/&#(\d+);/g;function t(n,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var t="",n=0,a=0,i=0,s=0,o=0,c=0;n<e.length;){if(a=e.charCodeAt(n++),a<128){t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(n++),a>191&&a<224){o=(a&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),a<240){t+=String.fromCharCode((a&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),c=((a&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function utf8readb(e){var t=new_raw_buf(2*e.length),n,a,i=1,s=0,o=0,c;for(a=0;a<e.length;a+=i)i=1,(c=e.charCodeAt(a))<128?n=c:c<224?(n=(c&31)*64+(e.charCodeAt(a+1)&63),i=2):c<240?(n=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),i=3):(i=4,n=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,a=0,i=0;n<e.length;)switch(a=e.charCodeAt(n++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,i=e.charCodeAt(n++)-56320+(a<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},matchtag=(function(){var e={};return function(n,a){var i=n+"|"+(a||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",a||"")}})(),htmldecode=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var a=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)a=a.replace(e[i][0],e[i][1]);return a}})(),vtregex=(function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}})(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,t){var n=parsexmltag(e),a=e.match(vtregex(n.baseType))||[],i=[];if(a.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+n.size);return i}return a.forEach(function(s){var o=s.replace(vtvregex,"").match(vtmregex);o&&i.push({v:utf8read(o[2]),t:o[1]})}),i}var wtregex=/(^\s|\s$|\n)/;function wxt_helper(e){return keys(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function writextag(e,t,n){return"<"+e+(n!=null?wxt_helper(n):"")+(t!=null?(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function read_double_le(e,t){for(var n=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return a==2047?i==0?n*(1/0):NaN:(a==0?a=-1022:(a-=1023,i+=Math.pow(2,52)),n*Math.pow(2,a-52)*i)}function write_double_le(e,t,n){var a=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=a?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)e[n+c]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|a}var ___toBuffer=function(e){for(var t=[],n=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var i=0,s=e[0][a].length;i<s;i+=n)t.push.apply(t,e[0][a].slice(i,i+n));return t},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,t,n){for(var a=[],i=t;i<n;i+=2)a.push(String.fromCharCode(__readUInt16LE(e,i)));return a.join("").replace(chr0,"")},__utf16le=has_buf?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(chr0,""):___utf16le(e,t,n)}:___utf16le,___hexlify=function(e,t,n){for(var a=[],i=t;i<t+n;++i)a.push(("0"+e[i].toString(16)).slice(-2));return a.join("")},__hexlify=has_buf?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):___hexlify(e,t,n)}:___hexlify,___utf8=function(e,t,n){for(var a=[],i=t;i<n;i++)a.push(String.fromCharCode(__readUInt8(e,i)));return a.join("")},__utf8=has_buf?function e(t,n,a){return Buffer.isBuffer(t)?t.toString("utf8",n,a):___utf8(t,n,a)}:___utf8,___lpstr=function(e,t){var n=__readUInt32LE(e,t);return n>0?__utf8(e,t+4,t+4+n-1):""},__lpstr=___lpstr,___cpstr=function(e,t){var n=__readUInt32LE(e,t);return n>0?__utf8(e,t+4,t+4+n-1):""},__cpstr=___cpstr,___lpwstr=function(e,t){var n=2*__readUInt32LE(e,t);return n>0?__utf8(e,t+4,t+4+n-1):""},__lpwstr=___lpwstr,___lpp4=function e(t,n){var a=__readUInt32LE(t,n);return a>0?__utf16le(t,n+4,n+4+a):""},__lpp4=___lpp4,___8lpp4=function(e,t){var n=__readUInt32LE(e,t);return n>0?__utf8(e,t+4,t+4+n):""},__8lpp4=___8lpp4,___double=function(e,t){return read_double_le(e,t)},__double=___double,is_buf=function e(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};has_buf&&(__lpstr=function(t,n){if(!Buffer.isBuffer(t))return ___lpstr(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},__cpstr=function(t,n){if(!Buffer.isBuffer(t))return ___cpstr(t,n);var a=t.readUInt32LE(n);return a>0?t.toString("utf8",n+4,n+4+a-1):""},__lpwstr=function(t,n){if(!Buffer.isBuffer(t))return ___lpwstr(t,n);var a=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a-1)},__lpp4=function(t,n){if(!Buffer.isBuffer(t))return ___lpp4(t,n);var a=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+a)},__8lpp4=function(t,n){if(!Buffer.isBuffer(t))return ___8lpp4(t,n);var a=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+a)},__double=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):___double(t,n)},is_buf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var __readUInt8=function(e,t){return e[t]},__readUInt16LE=function(e,t){return e[t+1]*256+e[t]},__readInt16LE=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},__readUInt32LE=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},__readInt32LE=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},__readInt32BE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ReadShift(e,t){var n="",a,i,s=[],o,c,h,f;switch(t){case"dbcs":if(f=this.l,has_buf&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)n+=String.fromCharCode(__readUInt16LE(this,f)),f+=2;e*=2;break;case"utf8":n=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,n=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":n=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":n=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":n=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),n=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),n=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=__readUInt8(this,this.l+e++))!==0;)s.push(_getchar(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=__readUInt16LE(this,this.l+e))!==0;)s.push(_getchar(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",f=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return o=__readUInt8(this,f),this.l=f+1,c=ReadShift.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_getchar(__readUInt16LE(this,f))),f+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return o=__readUInt8(this,f),this.l=f+1,c=ReadShift.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(_getchar(__readUInt8(this,f))),f+=1}n=s.join("");break;default:switch(e){case 1:return a=__readUInt8(this,this.l),this.l++,a;case 2:return a=(t==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,a):(i=__readUInt32LE(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=__double(this,this.l):i=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=__hexlify(this,this.l,e);break}}return this.l+=e,n}var __writeUInt32LE=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},__writeInt32LE=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},__writeUInt16LE=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function WriteShift(e,t,n){var a=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)__writeUInt16LE(this,t.charCodeAt(i),this.l+2*i);a=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;a=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,__writeUInt32LE(this,t,this.l);break;case 8:if(a=8,n==="f"){write_double_le(this,t,this.l);break}case 16:break;case-4:a=4,__writeInt32LE(this,t,this.l);break}return this.l+=a,this}function CheckField(e,t){var n=__hexlify(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function prep_blob(e,t){e.l=t,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,t){e.l+=t}function new_buf(e){var t=new_raw_buf(e);return prep_blob(t,0),t}function recordhopper(e,t,n){if(e){var a,i,s;prep_blob(e,e.l||0);for(var o=e.length,c=0,h=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=XLSBRecordEnum[c]||XLSBRecordEnum[65535];for(a=e.read_shift(1),s=a&127,i=1;i<4&&a&128;++i)s+=((a=e.read_shift(1))&127)<<7*i;h=e.l+s;var u=f.f&&f.f(e,s,n);if(e.l=h,t(u,f,c))return}}}function buf_array(){var e=[],t=has_buf?256:2048,n=function(f){var u=new_buf(f);return prep_blob(u,0),u},a=n(t),i=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(f){return a&&f<a.length-a.l?a:(i(),a=n(Math.max(f+1,t)))},o=function(){return i(),bconcat(e)},c=function(f){i(),a=f,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:c,end:o,_bufs:e}}function shift_cell_xls(e,t,n){var a=dup(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!n||n.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function shift_range_xls(e,t,n){var a=dup(e);return a.s=shift_cell_xls(a.s,t.s,n),a.e=shift_cell_xls(a.e,t.s,n),a}function encode_cell_xls(e,t){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=encode_cell(e);return!e.cRel&&e.cRel!=null&&(n=fix_col(n)),!e.rRel&&e.rRel!=null&&(n=fix_row(n)),n}function encode_range_xls(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,t.biff)+":"+encode_cell_xls(e.e,t.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var t=unfix_col(e),n=0,a=0;a!==t.length;++a)n=26*n+t.charCodeAt(a)-64;return n-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var t=0,n=0,a=0;a<e.length;++a){var i=e.charCodeAt(a);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function encode_cell(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function decode_range(e){var t=e.indexOf(":");return t==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,t)),e:decode_cell(e.slice(t+1))}}function encode_range(e,t){return typeof t>"u"||typeof t=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof t!="string"&&(t=encode_cell(t)),e==t?e:e+":"+t)}function safe_decode_range(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,a=0,i=0,s=e.length;for(n=0;a<s&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)n=26*n+i;for(t.s.c=--n,n=0;a<s&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)n=10*n+i;if(t.s.r=--n,a===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,n=0;a!=s&&!((i=e.charCodeAt(a)-64)<1||i>26);++a)n=26*n+i;for(t.e.c=--n,n=0;a!=s&&!((i=e.charCodeAt(a)-48)<0||i>9);++a)n=10*n+i;return t.e.r=--n,t}function safe_format_cell(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,n?datenum(t):t)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(n?14:0),n?datenum(t):t)}catch{return""+t}}function format_cell(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?BErr[e.v]||e.v:t==null?safe_format_cell(e,e.v):safe_format_cell(e,t))}function sheet_to_workbook(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",a={};return a[n]=e,{SheetNames:[n],Sheets:a}}function sheet_add_aoa(e,t,n){var a=n||{},i=e?Array.isArray(e):a.dense,s=e||(i?[]:{}),o=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?decode_cell(a.origin):a.origin;o=h.r,c=h.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=safe_decode_range(s["!ref"]);f.s.c=u.s.c,f.s.r=u.s.r,f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),o==-1&&(f.e.r=o=u.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var v={v:t[p][g]},m=o+p,S=c+g;if(f.s.r>m&&(f.s.r=m),f.s.c>S&&(f.s.c=S),f.e.r<m&&(f.e.r=m),f.e.c<S&&(f.e.c=S),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))v=t[p][g];else if(Array.isArray(v.v)&&(v.f=t[p][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(a.nullError)v.t="e",v.v=0;else if(a.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=a.dateNF||table_fmt[14],a.cellDates?(v.t="d",v.w=SSF_format(v.z,datenum(v.v))):(v.t="n",v.v=datenum(v.v),v.w=SSF_format(v.z,v.v))):v.t="s";if(i)s[m]||(s[m]=[]),s[m][S]&&s[m][S].z&&(v.z=s[m][S].z),s[m][S]=v;else{var E=encode_cell({c:S,r:m});s[E]&&s[E].z&&(v.z=s[E].z),s[E]=v}}}return f.s.c<1e7&&(s["!ref"]=encode_range(f)),s}function aoa_to_sheet(e,t){return sheet_add_aoa(null,e,t)}function parse_Int32LE(e){return e.read_shift(4,"i")}function parse_XLWideString(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function parse_RichStr(e,t){var n=e.l,a=e.read_shift(1),i=parse_XLWideString(e),s=[],o={t:i,h:i};if((a&1)!==0){for(var c=e.read_shift(4),h=0;h!=c;++h)s.push(parse_StrRun(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}var parse_BrtCommentText=parse_RichStr;function parse_XLSBCell(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function parse_XLSBShortCell(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var parse_XLSBCodeName=parse_XLWideString;function parse_XLNullableWideString(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString;function parse_RkNumber(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,a=t[0]&2;e.l+=4;var i=a===0?__double([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):__readInt32LE(t,0)>>2;return n?i/100:i}function parse_RfX(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var parse_UncheckedRfX=parse_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function parse_BrtColor(e){var t={},n=e.read_shift(1),a=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=i;var f=XLSIcv[i];f&&(t.rgb=rgb2Hex(f));break;case 2:t.rgb=rgb2Hex([o,c,h]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function parse_FontFlags(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function parse_ClipboardFormatOrString(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var t=new_ct();if(!e||!e.match)return t;var n={};if((e.match(tagregex)||[]).forEach(function(a){var i=parsexmltag(a);switch(i[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":t[ct2type[i.ContentType]]!==void 0&&t[ct2type[i.ContentType]].push(i.PartName);break}}),t.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function parse_rels(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(tagregex)||[]).forEach(function(i){var s=parsexmltag(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:resolve_path(s.Target,t);n[c]=o,a[s.Id]=o}}),n["!id"]=a,n}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,t){for(var n=xlml_normalize(e),a,i;a=xlmlregex.exec(n);)switch(a[3]){case"manifest":break;case"file-entry":if(i=parsexmltag(a[0],!1),i.path=="/"&&i.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=(function(){for(var e=new Array(CORE_PROPS.length),t=0;t<CORE_PROPS.length;++t){var n=CORE_PROPS[t],a="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function parse_core_props(e){var t={};e=utf8read(e);for(var n=0;n<CORE_PROPS.length;++n){var a=CORE_PROPS[n],i=e.match(CORE_PROPS_REGEX[n]);i!=null&&i.length>0&&(t[a[1]]=unescapexml(i[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=parseDate(t[a[1]]))}return t}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function load_props_pairs(e,t,n,a){var i=[];if(typeof e=="string")i=parseVector(e,a);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var o=typeof t=="string"?parseVector(t,a).map(function(u){return u.v}):t,c=0,h=0;if(o.length>0)for(var f=0;f!==i.length;f+=2){switch(h=+i[f+1].v,i[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=h,n.SheetNames=o.slice(c,c+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=h,n.DefinedNames=o.slice(c,c+h);break;case"Charts":case"Diagramme":n.Chartsheets=h,n.ChartNames=o.slice(c,c+h);break}c+=h}}function parse_ext_props(e,t,n){var a={};return t||(t={}),e=utf8read(e),EXT_PROPS.forEach(function(i){var s=(e.match(matchtag(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=unescapexml(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(a[i[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&load_props_pairs(a.HeadingPairs,a.TitlesOfParts,t,n),t}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,t){var n={},a="",i=e.match(custregex);if(i)for(var s=0;s!=i.length;++s){var o=i[s],c=parsexmltag(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=unescapexml(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),f=h[0].slice(4),u=h[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[a]=unescapexml(u);break;case"bool":n[a]=parsexmlbool(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[a]=parseFloat(u);break;case"filetime":case"date":n[a]=parseDate(u);break;case"cy":case"error":n[a]=unescapexml(u);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,f,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return n}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,t,n){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),t=evert_XLMLDPM[t]||t,e[t]=n}function parse_FILETIME(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function parse_lpstr(e,t,n){var a=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-a&3;)++e.l;return i}function parse_lpwstr(e,t,n){var a=e.read_shift(0,"lpwstr");return a}function parse_VtStringBase(e,t,n){return t===31?parse_lpwstr(e):parse_lpstr(e,t,n)}function parse_VtString(e,t,n){return parse_VtStringBase(e,t,n===!1?0:4)}function parse_VtUnalignedString(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,t,0)}function parse_VtVecLpwstrValue(e){for(var t=e.read_shift(4),n=[],a=0;a!=t;++a){var i=e.l;n[a]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-i&2&&(e.l+=2)}return n}function parse_VtVecUnalignedLpstrValue(e){for(var t=e.read_shift(4),n=[],a=0;a!=t;++a)n[a]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return n}function parse_VtHeadingPair(e){var t=e.l,n=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=parse_TypedPropertyValue(e,VT_I4);return[n,a]}function parse_VtVecHeadingPairValue(e){for(var t=e.read_shift(4),n=[],a=0;a<t/2;++a)n.push(parse_VtHeadingPair(e));return n}function parse_dictionary(e,t){for(var n=e.read_shift(4),a={},i=0;i!=n;++i){var s=e.read_shift(4),o=e.read_shift(4);a[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function parse_BLOB(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function parse_ClipboardData(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function parse_TypedPropertyValue(e,t,n){var a=e.read_shift(2),i,s=n||{};if(e.l+=2,t!==VT_VARIANT&&a!==t&&VT_CUSTOM.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===VT_VARIANT?a:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return parse_lpstr(e,a,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,a,!s.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,a).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return a==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function parse_PropertySet(e,t){var n=e.l,a=e.read_shift(4),i=e.read_shift(4),s=[],o=0,c=0,h=-1,f={};for(o=0;o!=i;++o){var u=e.read_shift(4),p=e.read_shift(4);s[o]=[u,p+n]}s.sort(function(T,A){return T[1]-A[1]});var g={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var v=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,v=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],v=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(v=!1,e.l=s[o][1]),v)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(g[m.n]=parse_TypedPropertyValue(e,m.t,{raw:!0}),m.p==="version"&&(g[m.n]=String(g[m.n]>>16)+"."+("0000"+String(g[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(g[m.n]){case 0:g[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(c=g[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[m.n])}}else if(s[o][0]===1){if(c=g.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(c),h!==-1){var S=e.l;e.l=s[h][1],f=parse_dictionary(e,c),e.l=S}}else if(s[o][0]===0){if(c===0){h=o,e.l=s[o+1][1];continue}f=parse_dictionary(e,c)}else{var E=f[s[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=parse_BLOB(e);break;case 30:e.l+=4,w=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=parsebool(e,4);break;case 64:e.l+=4,w=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[E]=w}}return e.l=n+a,g}function parse_PropertySetStream(e,t,n){var a=e.content;if(!a)return{};prep_blob(a,0);var i,s,o,c,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var f=a.read_shift(4),u=a.read_shift(16);if(u!==CFB.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(i=a.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=a.read_shift(16),c=a.read_shift(4),i===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);i===2&&(o=a.read_shift(16),h=a.read_shift(4));var p=parse_PropertySet(a,t),g={SystemIdentifier:f};for(var v in p)g[v]=p[v];if(g.FMTID=s,i===1)return g;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var m;try{m=parse_PropertySet(a,null)}catch{}for(v in m)g[v]=m[v];return g.FMTID=[s,o],g}function parsenoop2(e,t){return e.read_shift(t),null}function parslurp(e,t,n){for(var a=[],i=e.l+t;e.l<i;)a.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return a}function parsebool(e,t){return e.read_shift(t)===1}function parseuint16(e){return e.read_shift(2,"u")}function parseuint16a(e,t){return parslurp(e,t,parseuint16)}function parse_Bes(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function parse_ShortXLUnicodeString(e,t,n){var a=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=a?e.read_shift(a,i):"";return o}function parse_XLUnicodeRichExtendedString(e){var t=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,c,h={};i&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,f);return i&&(e.l+=4*o),a&&(e.l+=c),h.t=u,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function parse_XLUnicodeStringNoCch(e,t,n){var a;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function parse_XLUnicodeString(e,t,n){var a=e.read_shift(n&&n.biff==2?1:2);return a===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,a,n)}function parse_XLUnicodeString2(e,t,n){if(n.biff>5)return parse_XLUnicodeString(e,t,n);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function parse_ControlInfo(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function parse_URLMoniker(e){var t=e.read_shift(4),n=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=n);var i=e.read_shift((a?t-24:t)>>1,"utf16le").replace(chr0,"");return a&&(e.l+=24),i}function parse_FileMoniker(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return n+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(chr0,"");return n+o}function parse_HyperlinkMoniker(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+n)}}function parse_HyperlinkString(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(chr0,""):"";return n}function parse_Hyperlink(e,t){var n=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var i=e.read_shift(2);e.l+=2;var s,o,c,h,f="",u,p;i&16&&(s=parse_HyperlinkString(e,n-e.l)),i&128&&(o=parse_HyperlinkString(e,n-e.l)),(i&257)===257&&(c=parse_HyperlinkString(e,n-e.l)),(i&257)===1&&(h=parse_HyperlinkMoniker(e,n-e.l)),i&8&&(f=parse_HyperlinkString(e,n-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(p=parse_FILETIME(e)),e.l=n;var g=o||c||h||"";g&&f&&(g+="#"+f),g||(g="#"+f),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return u&&(v.guid=u),p&&(v.time=p),s&&(v.Tooltip=s),v}function parse_LongRGBA(e){var t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1),i=e.read_shift(1);return[t,n,a,i]}function parse_LongRGB(e,t){var n=parse_LongRGBA(e);return n[3]=0,n}function parse_XLSCell(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{r:t,c:n,ixfe:a}}function parse_frtHeader(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function parse_OptXLUnicodeString(e,t,n){return t===0?"":parse_XLUnicodeString2(e,t,n)}function parse_XTI(e,t,n){var a=n.biff>8?4:2,i=e.read_shift(a),s=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[i,s,o]}function parse_RkRec(e){var t=e.read_shift(2),n=parse_RkNumber(e);return[t,n]}function parse_AddinUdf(e,t,n){e.l+=4,t-=4;var a=e.l+t,i=parse_ShortXLUnicodeString(e,t,n),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,i}function parse_Ref8U(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);return{s:{c:a,r:t},e:{c:i,r:n}}}function parse_RefU(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1);return{s:{c:a,r:t},e:{c:i,r:n}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[n,t,a]}function parse_FtNts(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function parse_FtCf(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,t){for(var n=e.l+t,a=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{a.push(FtTab[i](e,n-e.l))}catch{return e.l=n,a}}return e.l!=n&&(e.l=n),a}function parse_BOF(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function parse_InterfaceHdr(e,t){return t===0||e.read_shift(2),1200}function parse_WriteAccess(e,t,n){if(n.enc)return e.l+=t,"";var a=e.l,i=parse_XLUnicodeString2(e,0,n);return e.read_shift(t+a-e.l),i}function parse_WsBool(e,t,n){var a=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function parse_BoundSheet8(e,t,n){var a=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=parse_ShortXLUnicodeString(e,0,n);return o.length===0&&(o="Sheet1"),{pos:a,hs:i,dt:s,name:o}}function parse_SST(e,t){for(var n=e.l+t,a=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<n;++o)s.push(parse_XLUnicodeRichExtendedString(e));return s.Count=a,s.Unique=i,s}function parse_ExtSST(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function parse_Row(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=n/20),t}function parse_ForceFullCalculation(e){var t=parse_frtHeader(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,t,n){var a=0;n&&n.biff==2||(a=e.read_shift(2));var i=e.read_shift(2);n&&n.biff==2&&(a=1-(i>>15),i&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,i]}function parse_Window1(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),h=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,n],Dim:[a,i],Flags:s,CurTab:o,FirstTab:c,Selected:h,TabRatio:f}}function parse_Window2(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function parse_Pane(){}function parse_Font(e,t,n){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=parse_ShortXLUnicodeString(e,0,n),a}function parse_LabelSst(e){var t=parse_XLSCell(e);return t.isst=e.read_shift(4),t}function parse_Label(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var a=e.l+t,i=parse_XLSCell(e);n.biff==2&&e.l++;var s=parse_XLUnicodeString(e,a-e.l,n);return i.val=s,i}function parse_Format(e,t,n){var a=e.read_shift(2),i=parse_XLUnicodeString2(e,0,n);return[a,i]}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,t,n){var a=e.l+t,i=n.biff==8||!n.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),c=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:s,c},e:{r:o,c:h}}}function parse_RK(e){var t=e.read_shift(2),n=e.read_shift(2),a=parse_RkRec(e);return{r:t,c:n,ixfe:a[0],rknum:a[1]}}function parse_MulRk(e,t){for(var n=e.l+t-2,a=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(parse_RkRec(e));if(e.l!==n)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:a,c:i,C:o,rkrec:s}}function parse_MulBlank(e,t){for(var n=e.l+t-2,a=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:a,c:i,C:o,ixfe:s}}function parse_CellStyleXF(e,t,n,a){var i={},s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),h=e.read_shift(2);return i.patternType=XLSFillPattern[c>>26],a.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function parse_XF(e,t,n){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=parse_CellStyleXF(e,t,a.fStyle,n),a}function parse_Guts(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function parse_BoolErr(e,t,n){var a=parse_XLSCell(e);(n.biff==2||t==9)&&++e.l;var i=parse_Bes(e);return a.val=i,a.t=i===!0||i===!1?"b":"e",a}function parse_Number(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var a=parse_XLSCell(e),i=parse_Xnum(e);return a.val=i,a}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,t,n){var a=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=parse_XLUnicodeStringNoCch(e,s),c=[];a>e.l;)c.push(parse_XLUnicodeString(e));return[s,i,o,c]}function parse_ExternName(e,t,n){var a=e.read_shift(2),i,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return n.sbcch===14849&&(i=parse_AddinUdf(e,t-2,n)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,t,n){var a=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(n&&n.biff==2?1:2),h=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),h=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var f=parse_XLUnicodeStringNoCch(e,o,n);i&32&&(f=XLSLblBuiltIn[f.charCodeAt(0)]);var u=a-e.l;n&&n.biff==2&&--u;var p=a==e.l||c===0||!(u>0)?[]:parse_NameParsedFormula(e,u,n,c);return{chKey:s,Name:f,itab:h,rgce:p}}function parse_ExternSheet(e,t,n){if(n.biff<8)return parse_BIFF5ExternSheet(e,t,n);for(var a=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)a.push(parse_XTI(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return a}function parse_BIFF5ExternSheet(e,t,n){e[e.l+1]==3&&e[e.l]++;var a=parse_ShortXLUnicodeString(e,t,n);return a.charCodeAt(0)==3?a.slice(1):a}function parse_NameCmt(e,t,n){if(n.biff<8){e.l+=t;return}var a=e.read_shift(2),i=e.read_shift(2),s=parse_XLUnicodeStringNoCch(e,a,n),o=parse_XLUnicodeStringNoCch(e,i,n);return[s,o]}function parse_ShrFmla(e,t,n){var a=parse_RefU(e);e.l++;var i=e.read_shift(1);return t-=8,[parse_SharedParsedFormula(e,t,n),i,a]}function parse_Array(e,t,n){var a=parse_Ref(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,parse_ArrayParsedFormula(e,t,n)]}function parse_MTRSettings(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,a=e.read_shift(4);return[t,n,a]}function parse_NoteSh(e,t,n){if(!(n.biff<8)){var a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=parse_XLUnicodeString2(e,0,n);return n.biff<8&&e.read_shift(1),[{r:a,c:i},c,o,s]}}function parse_Note(e,t,n){return parse_NoteSh(e,t,n)}function parse_MergeCells(e,t){for(var n=[],a=e.read_shift(2);a--;)n.push(parse_Ref8U(e));return n}function parse_Obj(e,t,n){if(n&&n.biff<8)return parse_BIFF5Obj(e,t,n);var a=parse_FtCmo(e),i=parse_FtArray(e,t-22,a[1]);return{cmo:a,ft:i}}var parse_BIFF5OT={8:function(e,t){var n=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:a}}};function parse_BIFF5Obj(e,t,n){e.l+=4;var a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((parse_BIFF5OT[a]||parsenoop)(e,t,n)),{cmo:[i,a,s],ft:o}}function parse_TxO(e,t,n){var a=e.l,i="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=parse_ControlInfo(e,6,n);var c=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var h=e.read_shift(2);e.l+=h;for(var f=1;f<e.lens.length-1;++f){if(e.l-a!=e.lens[f])throw new Error("TxO: bad continue record");var u=e[e.l],p=parse_XLUnicodeStringNoCch(e,e.lens[f+1]-e.lens[f]-1);if(i+=p,i.length>=(u?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return e.l=a+t,{t:i}}catch{return e.l=a+t,{t:i}}}function parse_HLink(e,t){var n=parse_Ref8U(e);e.l+=16;var a=parse_Hyperlink(e,t-24);return[n,a]}function parse_HLinkTooltip(e,t){e.read_shift(2);var n=parse_Ref8U(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(chr0,""),[n,a]}function parse_Country(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=CountryEnum[n]||n,n=e.read_shift(2),t[1]=CountryEnum[n]||n,t}function parse_ClrtClient(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(parse_LongRGB(e));return n}function parse_Palette(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(parse_LongRGB(e));return n}function parse_XFCRC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function parse_ColInfo(e,t,n){if(!n.cellStyles)return parsenoop(e,t);var a=n&&n.biff>=12?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var f={s:i,e:s,w:o,ixfe:c,flags:h};return(n.biff>=5||!n.biff)&&(f.level=h>>8&7),f}function parse_Setup(e,t){var n={};return t<32||(e.l+=16,n.header=parse_Xnum(e),n.footer=parse_Xnum(e),e.l+=2),n}function parse_ShtProps(e,t,n){var a={area:!1};if(n.biff!=5)return e.l+=t,a;var i=e.read_shift(1);return e.l+=3,i&16&&(a.area=!0),a}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(4),i={fmt:t,env:n,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,i}function parse_BIFF2STR(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var a=parse_XLSCell(e);++e.l;var i=parse_XLUnicodeString2(e,t-7,n);return a.t="str",a.val=i,a}function parse_BIFF2NUM(e){var t=parse_XLSCell(e);++e.l;var n=parse_Xnum(e);return t.t="n",t.val=n,t}function parse_BIFF2INT(e){var t=parse_XLSCell(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function parse_BIFF2STRING(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function parse_RString(e,t,n){var a=e.l+t,i=parse_XLSCell(e),s=e.read_shift(2),o=parse_XLUnicodeStringNoCch(e,s,n);return e.l=a,i.t="str",i.val=o,i}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,h){var f=[],u=new_raw_buf(1);switch(h.type){case"base64":u=s2a(Base64_decode(c));break;case"binary":u=s2a(c);break;case"buffer":case"array":u=c;break}prep_blob(u,0);var p=u.read_shift(1),g=!!(p&136),v=!1,m=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var S=0,E=521;p==2&&(S=u.read_shift(2)),u.l+=3,p!=2&&(S=u.read_shift(4)),S>1048576&&(S=1e6),p!=2&&(E=u.read_shift(2));var w=u.read_shift(2),T=h.codepage||1252;p!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var A=[],L={},k=Math.min(u.length,p==2?521:E-10-(v?264:0)),D=m?32:11;u.l<k&&u[u.l]!=13;)switch(L={},L.name=$cptable.utils.decode(T,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,L.type=String.fromCharCode(u.read_shift(1)),p!=2&&!m&&(L.offset=u.read_shift(4)),L.len=u.read_shift(1),p==2&&(L.offset=u.read_shift(2)),L.dec=u.read_shift(1),L.name.length&&A.push(L),p!=2&&(u.l+=m?13:14),L.type){case"B":(!v||L.len!=8)&&h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(u[u.l]!==13&&(u.l=E-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=E;var N=0,Y=0;for(f[0]=[],Y=0;Y!=A.length;++Y)f[0][Y]=A[Y].name;for(;S-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,f[++N]=[],Y=0,Y=0;Y!=A.length;++Y){var z=u.slice(u.l,u.l+A[Y].len);u.l+=A[Y].len,prep_blob(z,0);var te=$cptable.utils.decode(T,z);switch(A[Y].type){case"C":te.trim().length&&(f[N][Y]=te.replace(/\s+$/,""));break;case"D":te.length===8?f[N][Y]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):f[N][Y]=te;break;case"F":f[N][Y]=parseFloat(te.trim());break;case"+":case"I":f[N][Y]=m?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":f[N][Y]=!0;break;case"N":case"F":f[N][Y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][Y]="##MEMO##"+(m?parseInt(te.trim(),10):z.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(f[N][Y]=+te||0);break;case"@":f[N][Y]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":f[N][Y]=new Date((z.read_shift(4)-2440588)*864e5+z.read_shift(4));break;case"Y":f[N][Y]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][Y]=-z.read_shift(-8,"f");break;case"B":if(v&&A[Y].len==8){f[N][Y]=z.read_shift(8,"f");break}case"G":case"P":z.l+=A[Y].len;break;case"0":if(A[Y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[Y].type)}}}if(p!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return h&&h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=A,f}function a(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var u=aoa_to_sheet(n(c,f),f);return u["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,u}function i(c,h){try{return sheet_to_workbook(a(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,h){var f=h||{};if(+f.codepage>=0&&set_cp(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var u=buf_array(),p=sheet_to_json(c,{header:1,raw:!0,cellDates:!0}),g=p[0],v=p.slice(1),m=c["!cols"]||[],S=0,E=0,w=0,T=1;for(S=0;S<g.length;++S){if(((m[S]||{}).DBF||{}).name){g[S]=m[S].DBF.name,++w;continue}if(g[S]!=null){if(++w,typeof g[S]=="number"&&(g[S]=g[S].toString(10)),typeof g[S]!="string")throw new Error("DBF Invalid column name "+g[S]+" |"+typeof g[S]+"|");if(g.indexOf(g[S])!==S){for(E=0;E<1024;++E)if(g.indexOf(g[S]+"_"+E)==-1){g[S]+="_"+E;break}}}}var A=safe_decode_range(c["!ref"]),L=[],k=[],D=[];for(S=0;S<=A.e.c-A.s.c;++S){var N="",Y="",z=0,te=[];for(E=0;E<v.length;++E)v[E][S]!=null&&te.push(v[E][S]);if(te.length==0||g[S]==null){L[S]="?";continue}for(E=0;E<te.length;++E){switch(typeof te[E]){case"number":Y="B";break;case"string":Y="C";break;case"boolean":Y="L";break;case"object":Y=te[E]instanceof Date?"D":"C";break;default:Y="C"}z=Math.max(z,String(te[E]).length),N=N&&N!=Y?"C":Y}z>250&&(z=250),Y=((m[S]||{}).DBF||{}).type,Y=="C"&&m[S].DBF.len>z&&(z=m[S].DBF.len),N=="B"&&Y=="N"&&(N="N",D[S]=m[S].DBF.dec,z=m[S].DBF.len),k[S]=N=="C"||Y=="N"?z:s[N]||0,T+=k[S],L[S]=N}var Z=u.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,v.length),Z.write_shift(2,296+32*w),Z.write_shift(2,T),S=0;S<4;++S)Z.write_shift(4,0);for(Z.write_shift(4,0|(+t[current_ansi]||3)<<8),S=0,E=0;S<g.length;++S)if(g[S]!=null){var ne=u.next(32),oe=(g[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ne.write_shift(1,oe,"sbcs"),ne.write_shift(1,L[S]=="?"?"C":L[S],"sbcs"),ne.write_shift(4,E),ne.write_shift(1,k[S]||s[L[S]]||0),ne.write_shift(1,D[S]||0),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(1,0),ne.write_shift(4,0),ne.write_shift(4,0),E+=k[S]||s[L[S]]||0}var le=u.next(264);for(le.write_shift(4,13),S=0;S<65;++S)le.write_shift(4,0);for(S=0;S<v.length;++S){var pe=u.next(T);for(pe.write_shift(1,0),E=0;E<g.length;++E)if(g[E]!=null)switch(L[E]){case"L":pe.write_shift(1,v[S][E]==null?63:v[S][E]?84:70);break;case"B":pe.write_shift(8,v[S][E]||0,"f");break;case"N":var de="0";for(typeof v[S][E]=="number"&&(de=v[S][E].toFixed(D[E]||0)),w=0;w<k[E]-de.length;++w)pe.write_shift(1,32);pe.write_shift(1,de,"sbcs");break;case"D":v[S][E]?(pe.write_shift(4,("0000"+v[S][E].getFullYear()).slice(-4),"sbcs"),pe.write_shift(2,("00"+(v[S][E].getMonth()+1)).slice(-2),"sbcs"),pe.write_shift(2,("00"+v[S][E].getDate()).slice(-2),"sbcs")):pe.write_shift(8,"00000000","sbcs");break;case"C":var J=String(v[S][E]!=null?v[S][E]:"").slice(0,k[E]);for(pe.write_shift(1,J,"sbcs"),w=0;w<k[E]-J.length;++w)pe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:a,from_sheet:o}})(),SYLK=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(g,v){var m=e[v];return typeof m=="number"?_getansi(m):m},a=function(g,v,m){var S=v.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return S==59?g:_getansi(S)};e["|"]=254;function i(g,v){switch(v.type){case"base64":return s(Base64_decode(g),v);case"binary":return s(g,v);case"buffer":return s(has_buf&&Buffer.isBuffer(g)?g.toString("binary"):a2s(g),v);case"array":return s(cc2str(g),v)}throw new Error("Unrecognized type "+v.type)}function s(g,v){var m=g.split(/[\n\r]+/),S=-1,E=-1,w=0,T=0,A=[],L=[],k=null,D={},N=[],Y=[],z=[],te=0,Z;for(+v.codepage>=0&&set_cp(+v.codepage);w!==m.length;++w){te=0;var ne=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,n),oe=ne.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),le=oe[0],pe;if(ne.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":oe[1].charAt(0)=="P"&&L.push(ne.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,J=!1,V=!1,C=!1,O=-1,I=-1;for(T=1;T<oe.length;++T)switch(oe[T].charAt(0)){case"A":break;case"X":E=parseInt(oe[T].slice(1))-1,J=!0;break;case"Y":for(S=parseInt(oe[T].slice(1))-1,J||(E=0),Z=A.length;Z<=S;++Z)A[Z]=[];break;case"K":pe=oe[T].slice(1),pe.charAt(0)==='"'?pe=pe.slice(1,pe.length-1):pe==="TRUE"?pe=!0:pe==="FALSE"?pe=!1:isNaN(fuzzynum(pe))?isNaN(fuzzydate(pe).getDate())||(pe=parseDate(pe)):(pe=fuzzynum(pe),k!==null&&fmt_is_date(k)&&(pe=numdate(pe))),de=!0;break;case"E":C=!0;var M=rc_to_a1(oe[T].slice(1),{r:S,c:E});A[S][E]=[A[S][E],M];break;case"S":V=!0,A[S][E]=[A[S][E],"S5S"];break;case"G":break;case"R":O=parseInt(oe[T].slice(1))-1;break;case"C":I=parseInt(oe[T].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ne)}if(de&&(A[S][E]&&A[S][E].length==2?A[S][E][0]=pe:A[S][E]=pe,k=null),V){if(C)throw new Error("SYLK shared formula cannot have own formula");var H=O>-1&&A[O][I];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");A[S][E][1]=shift_formula_str(H[1],{r:S-O,c:E-I})}break;case"F":var G=0;for(T=1;T<oe.length;++T)switch(oe[T].charAt(0)){case"X":E=parseInt(oe[T].slice(1))-1,++G;break;case"Y":for(S=parseInt(oe[T].slice(1))-1,Z=A.length;Z<=S;++Z)A[Z]=[];break;case"M":te=parseInt(oe[T].slice(1))/20;break;case"F":break;case"G":break;case"P":k=L[parseInt(oe[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(z=oe[T].slice(1).split(" "),Z=parseInt(z[0],10);Z<=parseInt(z[1],10);++Z)te=parseInt(z[2],10),Y[Z-1]=te===0?{hidden:!0}:{wch:te},process_col(Y[Z-1]);break;case"C":E=parseInt(oe[T].slice(1))-1,Y[E]||(Y[E]={});break;case"R":S=parseInt(oe[T].slice(1))-1,N[S]||(N[S]={}),te>0?(N[S].hpt=te,N[S].hpx=pt2px(te)):te===0&&(N[S].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ne)}G<1&&(k=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ne)}}return N.length>0&&(D["!rows"]=N),Y.length>0&&(D["!cols"]=Y),v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),[A,D]}function o(g,v){var m=i(g,v),S=m[0],E=m[1],w=aoa_to_sheet(S,v);return keys(E).forEach(function(T){w[T]=E[T]}),w}function c(g,v){return sheet_to_workbook(o(g,v),v)}function h(g,v,m,S){var E="C;Y"+(m+1)+";X"+(S+1)+";K";switch(g.t){case"n":E+=g.v||0,g.f&&!g.F&&(E+=";E"+a1_to_rc(g.f,{r:m,c:S}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||g.v;break;case"d":E+='"'+(g.w||g.v)+'"';break;case"s":E+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(g,v){v.forEach(function(m,S){var E="F;W"+(S+1)+" "+(S+1)+" ";m.hidden?E+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=width2px(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=px2char(m.wpx)),typeof m.wch=="number"&&(E+=Math.round(m.wch))),E.charAt(E.length-1)!=" "&&g.push(E)})}function u(g,v){v.forEach(function(m,S){var E="F;";m.hidden?E+="M0;":m.hpt?E+="M"+20*m.hpt+";":m.hpx&&(E+="M"+20*px2pt(m.hpx)+";"),E.length>2&&g.push(E+"R"+(S+1))})}function p(g,v){var m=["ID;PWXL;N;E"],S=[],E=safe_decode_range(g["!ref"]),w,T=Array.isArray(g),A=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),g["!cols"]&&f(m,g["!cols"]),g["!rows"]&&u(m,g["!rows"]),m.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var L=E.s.r;L<=E.e.r;++L)for(var k=E.s.c;k<=E.e.c;++k){var D=encode_cell({r:L,c:k});w=T?(g[L]||[])[k]:g[D],!(!w||w.v==null&&(!w.f||w.F))&&S.push(h(w,g,L,k))}return m.join(A)+A+S.join(A)+A+"E"+A}return{to_workbook:c,to_sheet:o,from_sheet:p}})(),DIF=(function(){function e(s,o){switch(o.type){case"base64":return t(Base64_decode(s),o);case"binary":return t(s,o);case"buffer":return t(has_buf&&Buffer.isBuffer(s)?s.toString("binary"):a2s(s),o);case"array":return t(cc2str(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var c=s.split(`
`),h=-1,f=-1,u=0,p=[];u!==c.length;++u){if(c[u].trim()==="BOT"){p[++h]=[],f=0;continue}if(!(h<0)){var g=c[u].trim().split(","),v=g[0],m=g[1];++u;for(var S=c[u]||"";(S.match(/["]/g)||[]).length&1&&u<c.length-1;)S+=`
`+c[++u];switch(S=S.trim(),+v){case-1:if(S==="BOT"){p[++h]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?p[h][f]=!0:S==="FALSE"?p[h][f]=!1:isNaN(fuzzynum(m))?isNaN(fuzzydate(m).getDate())?p[h][f]=m:p[h][f]=parseDate(m):p[h][f]=fuzzynum(m),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),p[h][f++]=S!==""?S:null;break}if(S==="EOD")break}}return o&&o.sheetRows&&(p=p.slice(0,o.sheetRows)),p}function n(s,o){return aoa_to_sheet(e(s,o),o)}function a(s,o){return sheet_to_workbook(n(s,o),o)}var i=(function(){var s=function(h,f,u,p,g){h.push(f),h.push(u+","+p),h.push('"'+g.replace(/"/g,'""')+'"')},o=function(h,f,u,p){h.push(f+","+u),h.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(h){var f=[],u=safe_decode_range(h["!ref"]),p,g=Array.isArray(h);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,u.e.r-u.s.r+1,""),s(f,"TUPLES",0,u.e.c-u.s.c+1,""),s(f,"DATA",0,0,"");for(var v=u.s.r;v<=u.e.r;++v){o(f,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var S=encode_cell({r:v,c:m});if(p=g?(h[v]||[])[m]:h[S],!p){o(f,1,0,"");continue}switch(p.t){case"n":var E=p.w;!E&&p.v!=null&&(E=p.v),E==null?p.f&&!p.F?o(f,1,0,"="+p.f):o(f,1,0,""):o(f,0,E,"V");break;case"b":o(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=SSF_format(p.z||table_fmt[14],datenum(parseDate(p.v)))),o(f,0,p.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var w=`\r
`,T=f.join(w);return T}})();return{to_workbook:a,to_sheet:n,from_sheet:i}})(),ETH=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(p,g){for(var v=p.split(`
`),m=-1,S=-1,E=0,w=[];E!==v.length;++E){var T=v[E].trim().split(":");if(T[0]==="cell"){var A=decode_cell(T[1]);if(w.length<=A.r)for(m=w.length;m<=A.r;++m)w[m]||(w[m]=[]);switch(m=A.r,S=A.c,T[2]){case"t":w[m][S]=e(T[3]);break;case"v":w[m][S]=+T[3];break;case"vtf":var L=T[T.length-1];case"vtc":switch(T[3]){case"nl":w[m][S]=!!+T[4];break;default:w[m][S]=+T[4];break}T[2]=="vtf"&&(w[m][S]=[w[m][S],L])}}}return g&&g.sheetRows&&(w=w.slice(0,g.sheetRows)),w}function a(p,g){return aoa_to_sheet(n(p,g),g)}function i(p,g){return sheet_to_workbook(a(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],m,S="",E=decode_range(p["!ref"]),w=Array.isArray(p),T=E.s.r;T<=E.e.r;++T)for(var A=E.s.c;A<=E.e.c;++A)if(S=encode_cell({r:T,c:A}),m=w?(p[T]||[])[A]:p[S],!(!m||m.v==null||m.t==="z")){switch(v=["cell",S,"t"],m.t){case"s":case"str":v.push(t(m.v));break;case"n":m.f?(v[2]="vtf",v[3]="n",v[4]=m.v,v[5]=t(m.f)):(v[2]="v",v[3]=m.v);break;case"b":v[2]="vt"+(m.f?"f":"c"),v[3]="nl",v[4]=m.v?"1":"0",v[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var L=datenum(parseDate(m.v));v[2]="vtc",v[3]="nd",v[4]=""+L,v[5]=m.w||SSF_format(m.z||table_fmt[14],L);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function u(p){return[s,o,c,o,f(p),h].join(`
`)}return{to_workbook:i,to_sheet:a,from_sheet:u}})(),PRN=(function(){function e(u,p,g,v,m){m.raw?p[g][v]=u:u===""||(u==="TRUE"?p[g][v]=!0:u==="FALSE"?p[g][v]=!1:isNaN(fuzzynum(u))?isNaN(fuzzydate(u).getDate())?p[g][v]=u:p[g][v]=parseDate(u):p[g][v]=fuzzynum(u))}function t(u,p){var g=p||{},v=[];if(!u||u.length===0)return v;for(var m=u.split(/[\r\n]/),S=m.length-1;S>=0&&m[S].length===0;)--S;for(var E=10,w=0,T=0;T<=S;++T)w=m[T].indexOf(" "),w==-1?w=m[T].length:w++,E=Math.max(E,w);for(T=0;T<=S;++T){v[T]=[];var A=0;for(e(m[T].slice(0,E).trim(),v,T,A,g),A=1;A<=(m[T].length-E)/10+1;++A)e(m[T].slice(E+(A-1)*10,E+A*10).trim(),v,T,A,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var n={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function i(u){for(var p={},g=!1,v=0,m=0;v<u.length;++v)(m=u.charCodeAt(v))==34?g=!g:!g&&m in n&&(p[m]=(p[m]||0)+1);m=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v]);if(!m.length){p=a;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&m.push([p[v],v])}return m.sort(function(S,E){return S[0]-E[0]||a[S[1]]-a[E[1]]}),n[m.pop()[1]]||44}function s(u,p){var g=p||{},v="",m=g.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(v=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(v=u.charAt(4),u=u.slice(6)):v=i(u.slice(0,1024)):g&&g.FS?v=g.FS:v=i(u.slice(0,1024));var E=0,w=0,T=0,A=0,L=0,k=v.charCodeAt(0),D=!1,N=0,Y=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var z=g.dateNF!=null?dateNF_regex(g.dateNF):null;function te(){var Z=u.slice(A,L),ne={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)ne.t="z";else if(g.raw)ne.t="s",ne.v=Z;else if(Z.trim().length===0)ne.t="s",ne.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(ne.t="s",ne.v=Z.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(Z)?(ne.t="n",ne.f=Z.slice(1)):(ne.t="s",ne.v=Z);else if(Z=="TRUE")ne.t="b",ne.v=!0;else if(Z=="FALSE")ne.t="b",ne.v=!1;else if(!isNaN(T=fuzzynum(Z)))ne.t="n",g.cellText!==!1&&(ne.w=Z),ne.v=T;else if(!isNaN(fuzzydate(Z).getDate())||z&&Z.match(z)){ne.z=g.dateNF||table_fmt[14];var oe=0;z&&Z.match(z)&&(Z=dateNF_fix(Z,g.dateNF,Z.match(z)||[]),oe=1),g.cellDates?(ne.t="d",ne.v=parseDate(Z,oe)):(ne.t="n",ne.v=datenum(parseDate(Z,oe))),g.cellText!==!1&&(ne.w=SSF_format(ne.z,ne.v instanceof Date?datenum(ne.v):ne.v)),g.cellNF||delete ne.z}else ne.t="s",ne.v=Z;if(ne.t=="z"||(g.dense?(m[E]||(m[E]=[]),m[E][w]=ne):m[encode_cell({c:w,r:E})]=ne),A=L+1,Y=u.charCodeAt(A),S.e.c<w&&(S.e.c=w),S.e.r<E&&(S.e.r=E),N==k)++w;else if(w=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;L<u.length;++L)switch(N=u.charCodeAt(L)){case 34:Y===34&&(D=!D);break;case k:case 10:case 13:if(!D&&te())break e;break}return L-A>0&&te(),m["!ref"]=encode_range(S),m}function o(u,p){return!(p&&p.PRN)||p.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,p):aoa_to_sheet(t(u,p),p)}function c(u,p){var g="",v=p.type=="string"?[0,0,0,0]:firstbyte(u,p);switch(p.type){case"base64":g=Base64_decode(u);break;case"binary":g=u;break;case"buffer":p.codepage==65001?g=u.toString("utf8"):p.codepage&&typeof $cptable<"u"||(g=has_buf&&Buffer.isBuffer(u)?u.toString("binary"):a2s(u));break;case"array":g=cc2str(u);break;case"string":g=u;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=utf8read(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=utf8read(g):p.type=="binary"&&typeof $cptable<"u",g.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(p.type=="string"?g:utf8read(g),p):o(g,p)}function h(u,p){return sheet_to_workbook(c(u,p),p)}function f(u){for(var p=[],g=safe_decode_range(u["!ref"]),v,m=Array.isArray(u),S=g.s.r;S<=g.e.r;++S){for(var E=[],w=g.s.c;w<=g.e.c;++w){var T=encode_cell({r:S,c:w});if(v=m?(u[S]||[])[w]:u[T],!v||v.v==null){E.push("          ");continue}for(var A=(v.w||(format_cell(v),v.w)||"").slice(0,10);A.length<10;)A+=" ";E.push(A+(w===0?" ":""))}p.push(E.join(""))}return p.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}})();function read_wb_ID(e,t){var n=t||{},a=!!n.WTF;n.WTF=!0;try{var i=SYLK.to_workbook(e,n);return n.WTF=a,i}catch(s){if(n.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return PRN.to_workbook(e,t)}}var WK_=(function(){function e(M,H,G){if(M){prep_blob(M,M.l||0);for(var j=G.Enum||O;M.l<M.length;){var F=M.read_shift(2),q=j[F]||j[65535],X=M.read_shift(2),W=M.l+X,K=q.f&&q.f(M,X,G);if(M.l=W,H(K,q,F))return}}}function t(M,H){switch(H.type){case"base64":return n(s2a(Base64_decode(M)),H);case"binary":return n(s2a(M),H);case"buffer":case"array":return n(M,H)}throw"Unsupported type "+H.type}function n(M,H){if(!M)return M;var G=H||{},j=G.dense?[]:{},F="Sheet1",q="",X=0,W={},K=[],ae=[],U={s:{r:0,c:0},e:{r:0,c:0}},ve=G.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)G.Enum=O,e(M,function(ge,Re,De){switch(De){case 0:G.vers=ge,ge>=4096&&(G.qpro=!0);break;case 6:U=ge;break;case 204:ge&&(q=ge);break;case 222:q=ge;break;case 15:case 51:G.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:De==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=G.dateNF||table_fmt[14],G.cellDates&&(ge[1].t="d",ge[1].v=numdate(ge[1].v))),G.qpro&&ge[3]>X&&(j["!ref"]=encode_range(U),W[F]=j,K.push(F),j=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},X=ge[3],F=q||"Sheet"+(X+1),q="");var We=G.dense?(j[ge[0].r]||[])[ge[0].c]:j[encode_cell(ge[0])];if(We){We.t=ge[1].t,We.v=ge[1].v,ge[1].z!=null&&(We.z=ge[1].z),ge[1].f!=null&&(We.f=ge[1].f);break}G.dense?(j[ge[0].r]||(j[ge[0].r]=[]),j[ge[0].r][ge[0].c]=ge[1]):j[encode_cell(ge[0])]=ge[1];break}},G);else if(M[2]==26||M[2]==14)G.Enum=I,M[2]==14&&(G.qpro=!0,M.l=0),e(M,function(ge,Re,De){switch(De){case 204:F=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>X&&(j["!ref"]=encode_range(U),W[F]=j,K.push(F),j=G.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},X=ge[3],F="Sheet"+(X+1)),ve>0&&ge[0].r>=ve)break;G.dense?(j[ge[0].r]||(j[ge[0].r]=[]),j[ge[0].r][ge[0].c]=ge[1]):j[encode_cell(ge[0])]=ge[1],U.e.c<ge[0].c&&(U.e.c=ge[0].c),U.e.r<ge[0].r&&(U.e.r=ge[0].r);break;case 27:ge[14e3]&&(ae[ge[14e3][0]]=ge[14e3][1]);break;case 1537:ae[ge[0]]=ge[1],ge[0]==X&&(F=ge[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(j["!ref"]=encode_range(U),W[q||F]=j,K.push(q||F),!ae.length)return{SheetNames:K,Sheets:W};for(var be={},ye=[],_e=0;_e<ae.length;++_e)W[K[_e]]?(ye.push(ae[_e]||K[_e]),be[ae[_e]]=W[ae[_e]]||W[K[_e]]):(ye.push(ae[_e]),be[ae[_e]]={"!ref":"A1"});return{SheetNames:ye,Sheets:be}}function a(M,H){var G=H||{};if(+G.codepage>=0&&set_cp(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var j=buf_array(),F=safe_decode_range(M["!ref"]),q=Array.isArray(M),X=[];write_biff_rec(j,0,s(1030)),write_biff_rec(j,6,h(F));for(var W=Math.min(F.e.r,8191),K=F.s.r;K<=W;++K)for(var ae=encode_row(K),U=F.s.c;U<=F.e.c;++U){K===F.s.r&&(X[U]=encode_col(U));var ve=X[U]+ae,be=q?(M[K]||[])[U]:M[ve];if(!(!be||be.t=="z"))if(be.t=="n")(be.v|0)==be.v&&be.v>=-32768&&be.v<=32767?write_biff_rec(j,13,v(K,U,be.v)):write_biff_rec(j,14,S(K,U,be.v));else{var ye=format_cell(be);write_biff_rec(j,15,p(K,U,ye.slice(0,239)))}}return write_biff_rec(j,1),j.end()}function i(M,H){var G=H||{};if(+G.codepage>=0&&set_cp(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var j=buf_array();write_biff_rec(j,0,o(M));for(var F=0,q=0;F<M.SheetNames.length;++F)(M.Sheets[M.SheetNames[F]]||{})["!ref"]&&write_biff_rec(j,27,C(M.SheetNames[F],q++));var X=0;for(F=0;F<M.SheetNames.length;++F){var W=M.Sheets[M.SheetNames[F]];if(!(!W||!W["!ref"])){for(var K=safe_decode_range(W["!ref"]),ae=Array.isArray(W),U=[],ve=Math.min(K.e.r,8191),be=K.s.r;be<=ve;++be)for(var ye=encode_row(be),_e=K.s.c;_e<=K.e.c;++_e){be===K.s.r&&(U[_e]=encode_col(_e));var ge=U[_e]+ye,Re=ae?(W[be]||[])[_e]:W[ge];if(!(!Re||Re.t=="z"))if(Re.t=="n")write_biff_rec(j,23,te(be,_e,X,Re.v));else{var De=format_cell(Re);write_biff_rec(j,22,N(be,_e,X,De.slice(0,239)))}}++X}}return write_biff_rec(j,1),j.end()}function s(M){var H=new_buf(2);return H.write_shift(2,M),H}function o(M){var H=new_buf(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var G=0,j=0,F=0,q=0;q<M.SheetNames.length;++q){var X=M.SheetNames[q],W=M.Sheets[X];if(!(!W||!W["!ref"])){++F;var K=decode_range(W["!ref"]);G<K.e.r&&(G=K.e.r),j<K.e.c&&(j=K.e.c)}}return G>8191&&(G=8191),H.write_shift(2,G),H.write_shift(1,F),H.write_shift(1,j),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function c(M,H,G){var j={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&G.qpro?(j.s.c=M.read_shift(1),M.l++,j.s.r=M.read_shift(2),j.e.c=M.read_shift(1),M.l++,j.e.r=M.read_shift(2),j):(j.s.c=M.read_shift(2),j.s.r=M.read_shift(2),H==12&&G.qpro&&(M.l+=2),j.e.c=M.read_shift(2),j.e.r=M.read_shift(2),H==12&&G.qpro&&(M.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function h(M){var H=new_buf(8);return H.write_shift(2,M.s.c),H.write_shift(2,M.s.r),H.write_shift(2,M.e.c),H.write_shift(2,M.e.r),H}function f(M,H,G){var j=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(j[0].c=M.read_shift(1),j[3]=M.read_shift(1),j[0].r=M.read_shift(2),M.l+=2):(j[2]=M.read_shift(1),j[0].c=M.read_shift(2),j[0].r=M.read_shift(2)),j}function u(M,H,G){var j=M.l+H,F=f(M,H,G);if(F[1].t="s",G.vers==20768){M.l++;var q=M.read_shift(1);return F[1].v=M.read_shift(q,"utf8"),F}return G.qpro&&M.l++,F[1].v=M.read_shift(j-M.l,"cstr"),F}function p(M,H,G){var j=new_buf(7+G.length);j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,M),j.write_shift(1,39);for(var F=0;F<j.length;++F){var q=G.charCodeAt(F);j.write_shift(1,q>=128?95:q)}return j.write_shift(1,0),j}function g(M,H,G){var j=f(M,H,G);return j[1].v=M.read_shift(2,"i"),j}function v(M,H,G){var j=new_buf(7);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,M),j.write_shift(2,G,"i"),j}function m(M,H,G){var j=f(M,H,G);return j[1].v=M.read_shift(8,"f"),j}function S(M,H,G){var j=new_buf(13);return j.write_shift(1,255),j.write_shift(2,H),j.write_shift(2,M),j.write_shift(8,G,"f"),j}function E(M,H,G){var j=M.l+H,F=f(M,H,G);if(F[1].v=M.read_shift(8,"f"),G.qpro)M.l=j;else{var q=M.read_shift(2);L(M.slice(M.l,M.l+q),F),M.l+=q}return F}function w(M,H,G){var j=H&32768;return H&=-32769,H=(j?M:0)+(H>=8192?H-16384:H),(j?"":"$")+(G?encode_col(H):encode_row(H))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(M,H){prep_blob(M,0);for(var G=[],j=0,F="",q="",X="",W="";M.l<M.length;){var K=M[M.l++];switch(K){case 0:G.push(M.read_shift(8,"f"));break;case 1:q=w(H[0].c,M.read_shift(2),!0),F=w(H[0].r,M.read_shift(2),!1),G.push(q+F);break;case 2:{var ae=w(H[0].c,M.read_shift(2),!0),U=w(H[0].r,M.read_shift(2),!1);q=w(H[0].c,M.read_shift(2),!0),F=w(H[0].r,M.read_shift(2),!1),G.push(ae+U+":"+q+F)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(M.read_shift(2));break;case 6:{for(var ve="";K=M[M.l++];)ve+=String.fromCharCode(K);G.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:W=G.pop(),X=G.pop(),G.push(["AND","OR"][K-20]+"("+X+","+W+")");break;default:if(K<32&&A[K])W=G.pop(),X=G.pop(),G.push(X+A[K]+W);else if(T[K]){if(j=T[K][1],j==69&&(j=M[M.l++]),j>G.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+G.join("|")+"|");return}var be=G.slice(-j);G.length-=j,G.push(T[K][0]+"("+be.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}G.length==1?H[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function k(M){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=M.read_shift(2),H[3]=M[M.l++],H[0].c=M[M.l++],H}function D(M,H){var G=k(M);return G[1].t="s",G[1].v=M.read_shift(H-4,"cstr"),G}function N(M,H,G,j){var F=new_buf(6+j.length);F.write_shift(2,M),F.write_shift(1,G),F.write_shift(1,H),F.write_shift(1,39);for(var q=0;q<j.length;++q){var X=j.charCodeAt(q);F.write_shift(1,X>=128?95:X)}return F.write_shift(1,0),F}function Y(M,H){var G=k(M);G[1].v=M.read_shift(2);var j=G[1].v>>1;if(G[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return G[1].v=j,G}function z(M,H){var G=k(M),j=M.read_shift(4),F=M.read_shift(4),q=M.read_shift(2);if(q==65535)return j===0&&F===3221225472?(G[1].t="e",G[1].v=15):j===0&&F===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var X=q&32768;return q=(q&32767)-16446,G[1].v=(1-X*2)*(F*Math.pow(2,q+32)+j*Math.pow(2,q)),G}function te(M,H,G,j){var F=new_buf(14);if(F.write_shift(2,M),F.write_shift(1,G),F.write_shift(1,H),j==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var q=0,X=0,W=0,K=0;return j<0&&(q=1,j=-j),X=Math.log2(j)|0,j/=Math.pow(2,X-31),K=j>>>0,(K&2147483648)==0&&(j/=2,++X,K=j>>>0),j-=K,K|=2147483648,K>>>=0,j*=Math.pow(2,32),W=j>>>0,F.write_shift(4,W),F.write_shift(4,K),X+=16383+(q?32768:0),F.write_shift(2,X),F}function Z(M,H){var G=z(M);return M.l+=H-14,G}function ne(M,H){var G=k(M),j=M.read_shift(4);return G[1].v=j>>6,G}function oe(M,H){var G=k(M),j=M.read_shift(8,"f");return G[1].v=j,G}function le(M,H){var G=oe(M);return M.l+=H-10,G}function pe(M,H){return M[M.l+H-1]==0?M.read_shift(H,"cstr"):""}function de(M,H){var G=M[M.l++];G>H-1&&(G=H-1);for(var j="";j.length<G;)j+=String.fromCharCode(M[M.l++]);return j}function J(M,H,G){if(!(!G.qpro||H<21)){var j=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var F=M.read_shift(H-21,"cstr");return[j,F]}}function V(M,H){for(var G={},j=M.l+H;M.l<j;){var F=M.read_shift(2);if(F==14e3){for(G[F]=[0,""],G[F][0]=M.read_shift(2);M[M.l];)G[F][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return G}function C(M,H){var G=new_buf(5+M.length);G.write_shift(2,14e3),G.write_shift(2,H);for(var j=0;j<M.length;++j){var F=M.charCodeAt(j);G[G.l++]=F>127?95:F}return G[G.l++]=0,G}var O={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pe},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:z},24:{n:"NUMBER18",f:Y},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ne},38:{n:"??"},39:{n:"NUMBER27",f:oe},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})();function parse_rpr(e){var t={},n=e.match(tagregex),a=0,i=!1;if(n)for(;a!=n.length;++a){var s=parsexmltag(n[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=CS2CP[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var parse_rs=(function(){var e=matchtag("t"),t=matchtag("rPr");function n(s){var o=s.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:unescapexml(o[1])},h=s.match(t);return h&&(c.s=parse_rpr(h[1])),c}var a=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(i).map(n).filter(function(c){return c.v})}})(),rs_to_html=(function e(){var t=/(\r\n|\n)/g;function n(i,s,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(s.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),i}function a(i){var s=[[],i.v,[]];return i.v?(i.s&&n(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}})(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,t){var n=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=utf8read(e),n&&(a.h=escapehtml(a.t))):e.match(sirregex)&&(a.r=utf8read(e),a.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),n&&(a.h=rs_to_html(parse_rs(a.r)))),a):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,t){var n=[],a="";if(!e)return n;var i=e.match(sstr0);if(i){a=i[2].replace(sstr1,"").split(sstr2);for(var s=0;s!=a.length;++s){var o=parse_si(a[s].trim(),t);o!=null&&(n[n.length]=o)}i=parsexmltag(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,t){var n=[],a=!1;return recordhopper(e,function(s,o,c){switch(c){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function _JS2ANSI(e){for(var t=[],n=e.split(""),a=0;a<n.length;++a)t[a]=n[a].charCodeAt(0);return t}function parse_CRYPTOVersion(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function parse_DataSpaceVersionInfo(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_DataSpaceMapEntry(e){for(var t=e.read_shift(4),n=e.l+t-4,a={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return a}function parse_DataSpaceMap(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(parse_DataSpaceMapEntry(e));return t}function parse_DataSpaceDefinition(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function parse_TransformInfoHeader(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_Primary(e){var t=parse_TransformInfoHeader(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function parse_EncryptionHeader(e,t){var n=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var i=!1;switch(a.AlgID){case 26126:case 26127:case 26128:i=a.Flags==36;break;case 26625:i=a.Flags==4;break;case 0:i=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,a}function parse_EncryptionVerifier(e,t){var n={},a=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,a),e.l=a,n}function parse_EncryptionInfo(e){var t=parse_CRYPTOVersion(e);switch(t.Minor){case 2:return[t.Minor,parse_EncInfoStd(e)];case 3:return[t.Minor,parse_EncInfoExt()];case 4:return[t.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function parse_EncInfoStd(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),a=parse_EncryptionHeader(e,n),i=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:a,v:i}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),a={};return n.replace(tagregex,function(s){var o=parsexmltag(s);switch(strip_ns(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function parse_RC4CryptoHeader(e,t){var n={},a=n.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=parse_EncryptionHeader(e,i),t-=i,n.EncryptionVerifier=parse_EncryptionVerifier(e,t),n}function parse_RC4Header(e){var t={},n=t.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function crypto_CreatePasswordVerifier_Method1(e){var t=0,n,a=_JS2ANSI(e),i=a.length+1,s,o,c,h,f;for(n=new_raw_buf(i),n[0]=a.length,s=1;s!=i;++s)n[s]=a[s-1];for(s=i-1;s>=0;--s)o=n[s],c=(t&16384)===0?0:1,h=t<<1&32767,f=c|h,t=f^o;return t^52811}var crypto_CreateXorArray_Method1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},i=function(o,c){return a(o^c)},s=function(o){for(var c=t[o.length-1],h=104,f=o.length-1;f>=0;--f)for(var u=o[f],p=0;p!=7;++p)u&64&&(c^=n[h]),u*=2,--h;return c};return function(o){for(var c=_JS2ANSI(o),h=s(c),f=c.length,u=new_raw_buf(16),p=0;p!=16;++p)u[p]=0;var g,v,m;for((f&1)===1&&(g=h>>8,u[f]=i(e[0],g),--f,g=h&255,v=c[c.length-1],u[f]=i(v,g));f>0;)--f,g=h>>8,u[f]=i(c[f],g),--f,g=h&255,u[f]=i(c[f],g);for(f=15,m=15-c.length;m>0;)g=h>>8,u[f]=i(e[m],g),--f,--m,g=h&255,u[f]=i(c[f],g),--f,--m;return u}})(),crypto_DecryptData_Method1=function(e,t,n,a,i){i||(i=t),a||(a=crypto_CreateXorArray_Method1(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=a[n],o=(o>>5|o<<3)&255,i[s]=o,++n;return[i,n,a]},crypto_MakeXorDecryptor=function(e){var t=0,n=crypto_CreateXorArray_Method1(e);return function(a){var i=crypto_DecryptData_Method1("",a,t,n);return t=i[1],i[0]}};function parse_XORObfuscation(e,t,n,a){var i={key:parseuint16(e),verificationBytes:parseuint16(e)};return n.password&&(i.verifier=crypto_CreatePasswordVerifier_Method1(n.password)),a.valid=i.verificationBytes===i.verifier,a.valid&&(a.insitu=crypto_MakeXorDecryptor(n.password)),i}function parse_FilePassHeader(e,t,n){var a=n||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=parse_RC4Header(e):a.Data=parse_RC4CryptoHeader(e,t),a}function parse_FilePass(e,t,n){var a={Type:n.biff>=8?e.read_shift(2):0};return a.Type?parse_FilePassHeader(e,t-2,a):parse_XORObfuscation(e,n.biff>=8?t:t-2,n,a),a}var RTF=(function(){function e(i,s){switch(s.type){case"base64":return t(Base64_decode(i),s);case"binary":return t(i,s);case"buffer":return t(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),s);case"array":return t(cc2str(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},c=o.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(u,p){Array.isArray(c)&&(c[p]=[]);for(var g=/\\\w+\b/g,v=0,m,S=-1;m=g.exec(u);){switch(m[0]){case"\\cell":var E=u.slice(v,g.lastIndex-m[0].length);if(E[0]==" "&&(E=E.slice(1)),++S,E.length){var w={v:E,t:"s"};Array.isArray(c)?c[p][S]=w:c[encode_cell({r:p,c:S})]=w}break}v=g.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=encode_range(f),c}function n(i,s){return sheet_to_workbook(e(i,s),s)}function a(i){for(var s=["{\\rtf1\\ansi"],o=safe_decode_range(i["!ref"]),c,h=Array.isArray(i),f=o.s.r;f<=o.e.r;++f){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var p=encode_cell({r:f,c:u});c=h?(i[f]||[])[u]:i[p],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(format_cell(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:a}})();function hex2RGB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rgb2Hex(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var t=e[0]/255,n=e[1]/255,a=e[2]/255,i=Math.max(t,n,a),s=Math.min(t,n,a),o=i-s;if(o===0)return[0,0,t];var c=0,h=0,f=i+s;switch(h=o/(f>1?2-f:f),i){case t:c=((n-a)/o+6)%6;break;case n:c=(a-t)/o+2;break;case a:c=(t-n)/o+4;break}return[c/6,h,f/2]}function hsl2RGB(e){var t=e[0],n=e[1],a=e[2],i=n*2*(a<.5?a:1-a),s=a-i/2,o=[s,s,s],c=6*t,h;if(n!==0)switch(c|0){case 0:case 6:h=i*c,o[0]+=i,o[1]+=h;break;case 1:h=i*(2-c),o[0]+=h,o[1]+=i;break;case 2:h=i*(c-2),o[1]+=i,o[2]+=h;break;case 3:h=i*(4-c),o[1]+=h,o[2]+=i;break;case 4:h=i*(c-4),o[2]+=i,o[0]+=h;break;case 5:h=i*(6-c),o[2]+=h,o[0]+=i;break}for(var f=0;f!=3;++f)o[f]=Math.round(o[f]*255);return o}function rgb_tint(e,t){if(t===0)return e;var n=rgb2HSL(hex2RGB(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),rgb2Hex(hsl2RGB(n))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var t=Math.abs(e-cycle_width(e)),n=MDW;if(t>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=t&&(t=Math.abs(e-cycle_width(e)),n=MDW);MDW=n}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,t,n,a){t.Borders=[];var i={},s=!1;(e[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=parsexmlbool(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=parsexmlbool(c.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function parse_fills(e,t,n,a){t.Fills=[];var i={},s=!1;(e[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function parse_fonts(e,t,n,a){t.Fonts=[];var i={},s=!1;(e[0].match(tagregex)||[]).forEach(function(o){var c=parsexmltag(o);switch(strip_ns(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=utf8read(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?parsexmlbool(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?parsexmlbool(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?parsexmlbool(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?parsexmlbool(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?parsexmlbool(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?parsexmlbool(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?parsexmlbool(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=CS2CP[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=parsexmlbool(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var h=XLSIcv[i.color.index];i.color.index==81&&(h=XLSIcv[1]),h||(h=XLSIcv[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=rgb_tint(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function parse_numFmts(e,t,n){t.NumberFmt=[];for(var a=keys(table_fmt),i=0;i<a.length;++i)t.NumberFmt[a[i]]=table_fmt[a[i]];var s=e[0].match(tagregex);if(s)for(i=0;i<s.length;++i){var o=parsexmltag(s[i]);switch(strip_ns(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=unescapexml(utf8read(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=c,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=c}SSF_load(c,h)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,t,n){t.CellXf=[];var a,i=!1;(e[0].match(tagregex)||[]).forEach(function(s){var o=parsexmltag(s),c=0;switch(strip_ns(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<cellXF_uint.length;++c)a[cellXF_uint[c]]&&(a[cellXF_uint[c]]=parseInt(a[cellXF_uint[c]],10));for(c=0;c<cellXF_bool.length;++c)a[cellXF_bool[c]]&&(a[cellXF_bool[c]]=parsexmlbool(a[cellXF_bool[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=parsexmlbool(o.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var parse_sty_xml=(function e(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,h,f){var u={};if(!c)return u;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=c.match(t))&&parse_numFmts(p,u,f),(p=c.match(i))&&parse_fonts(p,u,h,f),(p=c.match(a))&&parse_fills(p,u,h,f),(p=c.match(s))&&parse_borders(p,u,h,f),(p=c.match(n))&&parse_cellXfs(p,u,f),u}})();function parse_BrtFmt(e,t){var n=e.read_shift(2),a=parse_XLWideString(e);return[n,a]}function parse_BrtFont(e,t,n){var a={};a.sz=e.read_shift(2)/20;var i=parse_FontFlags(e);i.fItalic&&(a.italic=1),i.fCondense&&(a.condense=1),i.fExtend&&(a.extend=1),i.fShadow&&(a.shadow=1),i.fOutline&&(a.outline=1),i.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var c=e.read_shift(1);c>0&&(a.family=c);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=parse_BrtColor(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=parse_XLWideString(e),a}var parse_BrtFill=parsenoop;function parse_BrtXF(e,t){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:a,numFmtId:i}}var parse_BrtBorder=parsenoop;function parse_sty_bin(e,t,n){var a={};a.NumberFmt=[];for(var i in table_fmt)a.NumberFmt[i]=table_fmt[i];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return recordhopper(e,function(h,f,u){switch(u){case 44:a.NumberFmt[h[0]]=h[1],SSF_load(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=rgb_tint(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(f.T>0)s.push(u);else if(f.T<0)s.pop();else if(!o||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,t,n){t.themeElements.clrScheme=[];var a={};(e[0].match(tagregex)||[]).forEach(function(i){var s=parsexmltag(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,t,n){t.themeElements={};var a;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(i){if(!(a=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](a,t,n)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,t){(!e||e.length===0)&&(e=write_theme());var n,a={};if(!(n=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(n[0],a,t),a.raw=e,a}function write_theme(e,t){var n=[XML_HEADER];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function parse_Theme(e,t,n){var a=e.l+t,i=e.read_shift(4);if(i!==124226){if(!n.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var o;try{o=zip_read(s,{type:"array"})}catch{return}var c=getzipstr(o,"theme/theme/theme1.xml",!0);if(c)return parse_theme_xml(c,n)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=parse_IcvXF(e,4);break;case 2:t.xclrValue=parse_LongRGBA(e);break;case 3:t.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,t}function parse_IcvXF(e,t){return parsenoop(e,t)}function parse_XFExtGradient(e,t){return parsenoop(e,t)}function parse_ExtProp(e){var t=e.read_shift(2),n=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=parse_FullColorExt(e);break;case 6:a[1]=parse_XFExtGradient(e,n);break;case 14:case 15:a[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return a}function parse_XFExt(e,t){var n=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(parse_ExtProp(e,n-e.l));return{ixfe:a,ext:s}}function update_xfext(e,t){t.forEach(function(n){n[0]})}function parse_BrtMdtinfo(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function parse_BrtMdb(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function parse_xlmeta_bin(e,t,n){var a={Types:[],Cell:[],Value:[]},i=n||{},s=[],o=!1,c=2;return recordhopper(e,function(h,f,u){switch(u){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(p){c==1?a.Cell.push({type:a.Types[p[0]-1].name,index:p[1]}):c==0&&a.Value.push({type:a.Types[p[0]-1].name,index:p[1]})});break;case 337:c=h?1:0;break;case 338:c=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!f.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function parse_xlmeta_xml(e,t,n){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var i=!1,s=2,o;return e.replace(tagregex,function(c){var h=parsexmltag(c);switch(strip_ns(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<a.Types.length;++f)a.Types[f].name==h.name&&(o=a.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):s==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return c}),a}function parse_cc_xml(e){var t=[];if(!e)return t;var n=1;return(e.match(tagregex)||[]).forEach(function(a){var i=parsexmltag(a);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,t.push(i);break}}),t}function parse_BrtCalcChainItem$(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=encode_cell(n);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function parse_cc_bin(e,t,n){var a=[];return recordhopper(e,function(s,o,c){switch(c){case 63:a.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function parse_xlink_xml(){}function parse_xlink_bin(e,t,n,a){if(!e)return e;var i=a||{},s=!1;recordhopper(e,function(c,h,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!h.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},i)}function parse_drawing(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}function sheet_insert_comments(e,t,n,a){var i=Array.isArray(e),s;t.forEach(function(o){var c=decode_cell(o.ref);if(i?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[o.ref],!s){s={t:"z"},i?e[c.r][c.c]=s:e[o.ref]=s;var h=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");h.s.r>c.r&&(h.s.r=c.r),h.e.r<c.r&&(h.e.r=c.r),h.s.c>c.c&&(h.s.c=c.c),h.e.c<c.c&&(h.e.c=c.c);var f=encode_range(h);f!==e["!ref"]&&(e["!ref"]=f)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:n};o.h&&(u.h=o.h);for(var p=s.c.length-1;p>=0;--p){if(!n&&s.c[p].T)return;n&&!s.c[p].T&&s.c.splice(p,1)}if(n&&a){for(p=0;p<a.length;++p)if(u.a==a[p].id){u.a=a[p].name||u.a;break}}s.c.push(u)})}function parse_comments_xml(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],a=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var h=parsexmltag(c[0]),f={author:h.authorId&&n[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},u=decode_cell(h.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var p=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&parse_si(p[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),a.push(f)}}}}),a}function parse_tcmnt_xml(e,t){var n=[],a=!1,i={},s=0;return e.replace(tagregex,function(c,h){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":i.t!=null&&n.push(i);break;case"<text>":case"<text":s=h+c.length;break;case"</text>":i.t=e.slice(s,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function parse_people_xml(e,t){var n=[],a=!1;return e.replace(tagregex,function(s){var o=parsexmltag(s);switch(strip_ns(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),n}function parse_BrtBeginComment(e){var t={};t.iauthor=e.read_shift(4);var n=parse_UncheckedRfX(e);return t.rfx=n.s,t.ref=encode_cell(n.s),e.l+=16,t}var parse_BrtCommentAuthor=parse_XLWideString;function parse_comments_bin(e,t){var n=[],a=[],i={},s=!1;return recordhopper(e,function(c,h,f){switch(f){case 632:a.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=a[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var t=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,a){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(t,i,e.FileIndex[a].content)}}),CFB.write(t)}function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(a,i,s,o){var c=!1,h=!1;s.length==0?h=!0:s.charAt(0)=="["&&(h=!0,s=s.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return c?u+=t.c:--u,h?f+=t.r:--f,i+(c?"":"$")+encode_col(u)+(h?"":"$")+encode_row(f)}return function(i,s){return t=s,i.replace(e,n)}})(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=(function(){return function(t,n){return t.replace(crefregex,function(a,i,s,o,c,h){var f=decode_col(o)-(s?0:n.c),u=decode_row(h)-(c?0:n.r),p=u==0?"":c?u+1:"["+u+"]",g=f==0?"":s?f+1:"["+f+"]";return i+"R"+p+"C"+g})}})();function shift_formula_str(e,t){return e.replace(crefregex,function(n,a,i,s,o,c){return a+(i=="$"?i+s:encode_col(decode_col(s)+t.c))+(o=="$"?o+c:encode_row(decode_row(c)+t.r))})}function shift_formula_xlsx(e,t,n){var a=decode_range(t),i=a.s,s=decode_cell(n),o={r:s.r-i.r,c:s.c-i.c};return shift_formula_str(e,o)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function parse_RgceArea(e,t,n){var a=2;if(n){if(n.biff>=2&&n.biff<=5)return parse_RgceArea_BIFF2(e);n.biff==12&&(a=4)}var i=e.read_shift(a),s=e.read_shift(a),o=parse_ColRelU(e),c=parse_ColRelU(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function parse_RgceArea_BIFF2(e){var t=parse_ColRelU(e),n=parse_ColRelU(e),a=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function parse_RgceAreaRel(e,t,n){if(n.biff<8)return parse_RgceArea_BIFF2(e);var a=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=parse_ColRelU(e),o=parse_ColRelU(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function parse_RgceLoc(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return parse_RgceLoc_BIFF2(e);var a=e.read_shift(n&&n.biff==12?4:2),i=parse_ColRelU(e);return{r:a,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(e){var t=parse_ColRelU(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function parse_RgceElfLoc(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function parse_RgceLocRel(e,t,n){var a=n&&n.biff?n.biff:8;if(a>=2&&a<=5)return parse_RgceLocRel_BIFF2(e);var i=e.read_shift(a>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:c}}function parse_RgceLocRel_BIFF2(e){var t=e.read_shift(2),n=e.read_shift(1),a=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:a}}function parse_PtgArea(e,t,n){var a=(e[e.l++]&96)>>5,i=parse_RgceArea(e,n.biff>=2&&n.biff<=5?6:8,n);return[a,i]}function parse_PtgArea3d(e,t,n){var a=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=parse_RgceArea(e,s,n);return[a,i,o]}function parse_PtgAreaErr(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[a]}function parse_PtgAreaErr3d(e,t,n){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,i]}function parse_PtgAreaN(e,t,n){var a=(e[e.l++]&96)>>5,i=parse_RgceAreaRel(e,t-1,n);return[a,i]}function parse_PtgArray(e,t,n){var a=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[a]}function parse_PtgAttrBaxcel(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function parse_PtgAttrChoose(e,t,n){e.l+=2;for(var a=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=a;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function parse_PtgAttrGoto(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function parse_PtgAttrIf(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(n&&n.biff==2?1:2)]}function parse_PtgAttrIfError(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function parse_PtgAttrSemi(e,t,n){var a=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[a]}function parse_PtgAttrSpaceType(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLoc(e,0,n);return[a,i]}function parse_PtgRefN(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLocRel(e,0,n);return[a,i]}function parse_PtgRef3d(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=parse_RgceLoc(e,0,n);return[a,i,s]}function parse_PtgFunc(e,t,n){var a=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[FtabArgc[i],Ftab[i],a]}function parse_PtgFuncVar(e,t,n){var a=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[a==88?-1:0,e.read_shift(1)]:parsetab(e);return[i,(s[0]===0?Ftab:Cetab)[s[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,t,n){e.l+=n&&n.biff==2?3:4}function parse_PtgExp(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[a,i]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,t,n){return e.l++,parse_ShortXLUnicodeString(e,t-1,n)}function parse_SerAr(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=parsebool(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=BErr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=parse_Xnum(e);break;case 2:n[1]=parse_XLUnicodeString2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function parse_PtgExtraMem(e,t,n){for(var a=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=a;++s)i.push((n.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return i}function parse_PtgExtraArray(e,t,n){var a=0,i=0;n.biff==12?(a=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),a=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--a,--i==0&&(i=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var c=0;c!=i;++c)o[s][c]=parse_SerAr(e,n.biff);return o}function parse_PtgName(e,t,n){var a=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function parse_PtgNameX(e,t,n){if(n.biff==5)return parse_PtgNameX_BIFF5(e);var a=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[a,i,s]}function parse_PtgNameX_BIFF5(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,n,a]}function parse_PtgMemArea(e,t,n){var a=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[a,i]}function parse_PtgMemFunc(e,t,n){var a=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[a,i]}function parse_PtgRefErr(e,t,n){var a=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[a]}function parse_PtgRefErr3d(e,t,n){var a=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,t,n){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=PtgListRT[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:a,c:i,C:s}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function parse_PtgMemNoMemN(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,t,n,a){if(a.biff<8)return parsenoop(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=parse_PtgExtraArray(e,0,a),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=parse_PtgExtraMem(e,n[o][1],a),s.push(n[o][2]);break;case"PtgExp":a&&a.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(parsenoop(e,t)),s}function parse_Rgce(e,t,n){for(var a=e.l+t,i,s,o=[];a!=e.l;)t=a-e.l,s=e[e.l],i=PtgTypes[s]||PtgTypes[PtgDupes[s]],(s===24||s===25)&&(i=(s===24?Ptg18:Ptg19)[e[e.l+1]]),!i||!i.f?parsenoop(e,t):o.push([i.n,i.f(e,t,n)]);return o}function stringify_array(e){for(var t=[],n=0;n<e.length;++n){for(var a=e[n],i=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[a[0]][0]){case 357:return i=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return i=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?i:i+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(i=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?i:i+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function get_ixti(e,t,n){var a=get_ixti_raw(e,t,n);return a=="#REF"?a:formula_quote_sheet_name(a,n)}function stringify_formula(e,t,n,a,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},c=[],h,f,u,p=0,g=0,v,m="";if(!e[0]||!e[0][0])return"";for(var S=-1,E="",w=0,T=e[0].length;w<T;++w){var A=e[0][w];switch(A[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),S>=0){switch(e[0][S][1][0]){case 0:E=fill(" ",e[0][S][1][1]);break;case 1:E=fill("\r",e[0][S][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}f=f+E,S=-1}c.push(f+PtgBinOp[A[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=shift_cell_xls(A[1][1],o,i),c.push(encode_cell_xls(u,s));break;case"PtgRefN":u=n?shift_cell_xls(A[1][1],n,i):A[1][1],c.push(encode_cell_xls(u,s));break;case"PtgRef3d":p=A[1][1],u=shift_cell_xls(A[1][2],o,i),m=get_ixti(a,p,i),c.push(m+"!"+encode_cell_xls(u,s));break;case"PtgFunc":case"PtgFuncVar":var L=A[1][0],k=A[1][1];L||(L=0),L&=127;var D=L==0?[]:c.slice(-L);c.length-=L,k==="User"&&(k=D.shift()),c.push(k+"("+D.join(",")+")");break;case"PtgBool":c.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(A[1]);break;case"PtgNum":c.push(String(A[1]));break;case"PtgStr":c.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(A[1]);break;case"PtgAreaN":v=shift_range_xls(A[1][1],n?{s:n}:o,i),c.push(encode_range_xls(v,i));break;case"PtgArea":v=shift_range_xls(A[1][1],o,i),c.push(encode_range_xls(v,i));break;case"PtgArea3d":p=A[1][1],v=A[1][2],m=get_ixti(a,p,i),c.push(m+"!"+encode_range_xls(v,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=A[1][2];var N=(a.names||[])[g-1]||(a[0]||[])[g],Y=N?N.Name:"SH33TJSNAME"+String(g);Y&&Y.slice(0,6)=="_xlfn."&&!i.xlfn&&(Y=Y.slice(6)),c.push(Y);break;case"PtgNameX":var z=A[1][1];g=A[1][2];var te;if(i.biff<=5)z<0&&(z=-z),a[z]&&(te=a[z][g]);else{var Z="";if(((a[z]||[])[0]||[])[0]==14849||(((a[z]||[])[0]||[])[0]==1025?a[z][g]&&a[z][g].itab>0&&(Z=a.SheetNames[a[z][g].itab-1]+"!"):Z=a.SheetNames[g-1]+"!"),a[z]&&a[z][g])Z+=a[z][g].Name;else if(a[0]&&a[0][g])Z+=a[0][g].Name;else{var ne=(get_ixti_raw(a,z,i)||"").split(";;");ne[g-1]?Z=ne[g-1]:Z+="SH33TJSERRX"}c.push(Z);break}te||(te={Name:"SH33TJSERRY"}),c.push(te.Name);break;case"PtgParen":var oe="(",le=")";if(S>=0){switch(E="",e[0][S][1][0]){case 2:oe=fill(" ",e[0][S][1][1])+oe;break;case 3:oe=fill("\r",e[0][S][1][1])+oe;break;case 4:le=fill(" ",e[0][S][1][1])+le;break;case 5:le=fill("\r",e[0][S][1][1])+le;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}c.push(oe+c.pop()+le);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":u={c:A[1][1],r:A[1][0]};var pe={c:n.c,r:n.r};if(a.sharedf[encode_cell(u)]){var de=a.sharedf[encode_cell(u)];c.push(stringify_formula(de,o,pe,a,i))}else{var J=!1;for(h=0;h!=a.arrayf.length;++h)if(f=a.arrayf[h],!(u.c<f[0].s.c||u.c>f[0].e.c)&&!(u.r<f[0].s.r||u.r>f[0].e.r)){c.push(stringify_formula(f[1],o,pe,a,i)),J=!0;break}J||c.push(A[1])}break;case"PtgArray":c.push("{"+stringify_array(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&S>=0&&V.indexOf(e[0][w][0])==-1){A=e[0][S];var C=!0;switch(A[1][0]){case 4:C=!1;case 0:E=fill(" ",A[1][1]);break;case 5:C=!1;case 1:E=fill("\r",A[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}c.push((C?E:"")+c.pop()+(C?"":E)),S=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function parse_ArrayParsedFormula(e,t,n){var a=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],parsenoop(e,t-2)];var c=parse_Rgce(e,o,n);return t!==o+i&&(s=parse_RgbExtra(e,t-o-i,c,n)),e.l=a,[c,s]}function parse_XLSCellParsedFormula(e,t,n){var a=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],parsenoop(e,t-2)];var c=parse_Rgce(e,o,n);return t!==o+i&&(s=parse_RgbExtra(e,t-o-i,c,n)),e.l=a,[c,s]}function parse_NameParsedFormula(e,t,n,a){var i=e.l+t,s=parse_Rgce(e,a,n),o;return i!==e.l&&(o=parse_RgbExtra(e,i-e.l,s,n)),[s,o]}function parse_SharedParsedFormula(e,t,n){var a=e.l+t,i,s=e.read_shift(2),o=parse_Rgce(e,s,n);return s==65535?[[],parsenoop(e,t-2)]:(t!==s+2&&(i=parse_RgbExtra(e,a-s-2,o,n)),[o,i])}function parse_FormulaValue(e){var t;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function parse_Formula(e,t,n){var a=e.l+t,i=parse_XLSCell(e);n.biff==2&&++e.l;var s=parse_FormulaValue(e),o=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var c=parse_XLSCellParsedFormula(e,a-e.l,n);return{cell:i,val:s[0],formula:c,shared:o>>3&1,tt:s[1]}}function parse_XLSBParsedFormula(e,t,n){var a=e.read_shift(4),i=parse_Rgce(e,a,n),s=e.read_shift(4),o=s>0?parse_RgbExtra(e,s,i,n):null;return[i,o]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ods_to_csf_3D(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var strs={},_ssfopts={};function default_margins(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function safe_format(e,t,n,a,i,s){try{a.cellNF&&(e.z=table_fmt[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(table_fmt[t]==null&&SSF_load(SSFImplicit[t]||"General",t),e.t==="e")e.w=e.w||BErr[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var o=datenum(e.v);(o|0)===o?e.w=o.toString(10):e.w=SSF_general_num(o)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(t,datenum(e.v),_ssfopts):e.w=SSF_format(t,e.v,_ssfopts)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&n!=null)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function parse_ws_xml_dim(e,t){var n=safe_decode_range(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=encode_range(n))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,t,n,a,i,s,o){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",u="",p=e.match(sheetdataregex);p?(f=e.slice(0,p.index),u=e.slice(p.index+p[0].length)):f=u=e;var g=f.match(sheetprregex);g?parse_ws_xml_sheetpr(g[0],c,i,n):(g=f.match(sheetprregex2))&&parse_ws_xml_sheetpr2(g[0],g[1]||"",c,i,n);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var m=f.slice(v,v+50).match(dimregex);m&&parse_ws_xml_dim(c,m[1])}var S=f.match(svsregex);S&&S[1]&&parse_ws_xml_sheetviews(S[1],i);var E=[];if(t.cellStyles){var w=f.match(colregex);w&&parse_ws_xml_cols(E,w)}p&&parse_ws_xml_data(p[1],c,t,h,s,o);var T=u.match(afregex);T&&(c["!autofilter"]=parse_ws_xml_autofilter(T[0]));var A=[],L=u.match(mergecregex);if(L)for(v=0;v!=L.length;++v)A[v]=safe_decode_range(L[v].slice(L[v].indexOf('"')+1));var k=u.match(hlinkregex);k&&parse_ws_xml_hlinks(c,k,a);var D=u.match(marginregex);if(D&&(c["!margins"]=parse_ws_xml_margins(parsexmltag(D[0]))),!c["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(c["!ref"]=encode_range(h)),t.sheetRows>0&&c["!ref"]){var N=safe_decode_range(c["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>h.e.r&&(N.e.r=h.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>h.e.c&&(N.e.c=h.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),c["!fullref"]=c["!ref"],c["!ref"]=encode_range(N))}return E.length>0&&(c["!cols"]=E),A.length>0&&(c["!merges"]=A),c}function parse_ws_xml_sheetpr(e,t,n,a){var i=parsexmltag(e);n.Sheets[a]||(n.Sheets[a]={}),i.codeName&&(n.Sheets[a].CodeName=unescapexml(utf8read(i.codeName)))}function parse_ws_xml_sheetpr2(e,t,n,a,i){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),n,a,i)}function parse_ws_xml_hlinks(e,t,n){for(var a=Array.isArray(e),i=0;i!=t.length;++i){var s=parsexmltag(utf8read(t[i]),!0);if(!s.ref)return;var o=((n||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+unescapexml(s.location))):(s.Target="#"+unescapexml(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=safe_decode_range(s.ref),h=c.s.r;h<=c.e.r;++h)for(var f=c.s.c;f<=c.e.c;++f){var u=encode_cell({c:f,r:h});a?(e[h]||(e[h]=[]),e[h][f]||(e[h][f]={t:"z",v:void 0}),e[h][f].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function parse_ws_xml_margins(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function parse_ws_xml_cols(e,t){for(var n=!1,a=0;a!=t.length;++a){var i=parsexmltag(t[a],!0);i.hidden&&(i.hidden=parsexmlbool(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,find_mdw_colw(i.width)),process_col(i);s<=o;)e[s++]=dup(i)}}function parse_ws_xml_autofilter(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,t){t.Views||(t.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(n,a){var i=parsexmltag(n);t.Views[a]||(t.Views[a]={}),+i.zoomScale&&(t.Views[a].zoom=+i.zoomScale),parsexmlbool(i.rightToLeft)&&(t.Views[a].RTL=!0)})}var parse_ws_xml_data=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=matchtag("v"),o=matchtag("f");return function(h,f,u,p,g,v){for(var m=0,S="",E=[],w=[],T=0,A=0,L=0,k="",D,N,Y=0,z=0,te,Z,ne=0,oe=0,le=Array.isArray(v.CellXf),pe,de=[],J=[],V=Array.isArray(f),C=[],O={},I=!1,M=!!u.sheetStubs,H=h.split(t),G=0,j=H.length;G!=j;++G){S=H[G].trim();var F=S.length;if(F!==0){var q=0;e:for(m=0;m<F;++m)switch(S[m]){case">":if(S[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(N=parsexmltag(S.slice(q,m),!0),Y=N.r!=null?parseInt(N.r,10):Y+1,z=-1,u.sheetRows&&u.sheetRows<Y)continue;O={},I=!1,N.ht&&(I=!0,O.hpt=parseFloat(N.ht),O.hpx=pt2px(O.hpt)),N.hidden=="1"&&(I=!0,O.hidden=!0),N.outlineLevel!=null&&(I=!0,O.level=+N.outlineLevel),I&&(C[Y-1]=O)}break;case"<":q=m;break}if(q>=m)break;if(N=parsexmltag(S.slice(q,m),!0),Y=N.r!=null?parseInt(N.r,10):Y+1,z=-1,!(u.sheetRows&&u.sheetRows<Y)){p.s.r>Y-1&&(p.s.r=Y-1),p.e.r<Y-1&&(p.e.r=Y-1),u&&u.cellStyles&&(O={},I=!1,N.ht&&(I=!0,O.hpt=parseFloat(N.ht),O.hpx=pt2px(O.hpt)),N.hidden=="1"&&(I=!0,O.hidden=!0),N.outlineLevel!=null&&(I=!0,O.level=+N.outlineLevel),I&&(C[Y-1]=O)),E=S.slice(m).split(e);for(var X=0;X!=E.length&&E[X].trim().charAt(0)=="<";++X);for(E=E.slice(X),m=0;m!=E.length;++m)if(S=E[m].trim(),S.length!==0){if(w=S.match(n),T=m,A=0,L=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,w!=null&&w.length===2){for(T=0,k=w[1],A=0;A!=k.length&&!((L=k.charCodeAt(A)-64)<1||L>26);++A)T=26*T+L;--T,z=T}else++z;for(A=0;A!=S.length&&S.charCodeAt(A)!==62;++A);if(++A,N=parsexmltag(S.slice(0,A),!0),N.r||(N.r=encode_cell({r:Y-1,c:z})),k=S.slice(A),D={t:""},(w=k.match(s))!=null&&w[1]!==""&&(D.v=unescapexml(w[1])),u.cellFormula){if((w=k.match(o))!=null&&w[1]!==""){if(D.f=unescapexml(utf8read(w[1])).replace(/\r\n/g,`
`),u.xlfn||(D.f=_xlfn(D.f)),w[0].indexOf('t="array"')>-1)D.F=(k.match(i)||[])[1],D.F.indexOf(":")>-1&&de.push([safe_decode_range(D.F),D.F]);else if(w[0].indexOf('t="shared"')>-1){Z=parsexmltag(w[0]);var W=unescapexml(utf8read(w[1]));u.xlfn||(W=_xlfn(W)),J[parseInt(Z.si,10)]=[Z,W,N.r]}}else(w=k.match(/<f[^>]*\/>/))&&(Z=parsexmltag(w[0]),J[Z.si]&&(D.f=shift_formula_xlsx(J[Z.si][1],J[Z.si][2],N.r)));var K=decode_cell(N.r);for(A=0;A<de.length;++A)K.r>=de[A][0].s.r&&K.r<=de[A][0].e.r&&K.c>=de[A][0].s.c&&K.c<=de[A][0].e.c&&(D.F=de[A][1])}if(N.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(M)D.t="z";else continue;else D.t=N.t||"n";switch(p.s.c>z&&(p.s.c=z),p.e.c<z&&(p.e.c=z),D.t){case"n":if(D.v==""||D.v==null){if(!M)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!M)continue;D.t="z"}else te=strs[parseInt(D.v,10)],D.v=te.t,D.r=te.r,u.cellHTML&&(D.h=te.h);break;case"str":D.t="s",D.v=D.v!=null?utf8read(D.v):"",u.cellHTML&&(D.h=escapehtml(D.v));break;case"inlineStr":w=k.match(a),D.t="s",w!=null&&(te=parse_si(w[1]))?(D.v=te.t,u.cellHTML&&(D.h=te.h)):D.v="";break;case"b":D.v=parsexmlbool(D.v);break;case"d":u.cellDates?D.v=parseDate(D.v,1):(D.v=datenum(parseDate(D.v,1)),D.t="n");break;case"e":(!u||u.cellText!==!1)&&(D.w=D.v),D.v=RBErr[D.v];break}if(ne=oe=0,pe=null,le&&N.s!==void 0&&(pe=v.CellXf[N.s],pe!=null&&(pe.numFmtId!=null&&(ne=pe.numFmtId),u.cellStyles&&pe.fillId!=null&&(oe=pe.fillId))),safe_format(D,ne,oe,u,g,v),u.cellDates&&le&&D.t=="n"&&fmt_is_date(table_fmt[ne])&&(D.t="d",D.v=numdate(D.v)),N.cm&&u.xlmeta){var ae=(u.xlmeta.Cell||[])[+N.cm-1];ae&&ae.type=="XLDAPR"&&(D.D=!0)}if(V){var U=decode_cell(N.r);f[U.r]||(f[U.r]=[]),f[U.r][U.c]=D}else f[N.r]=D}}}}C.length>0&&(f["!rows"]=C)}})();function parse_BrtRowHdr(e,t){var n={},a=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}var parse_BrtWsDim=parse_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,t){var n={},a=e[e.l];return++e.l,n.above=!(a&64),n.left=!(a&128),e.l+=18,n.name=parse_XLSBCodeName(e),n}function parse_BrtCellBlank(e){var t=parse_XLSBCell(e);return[t]}function parse_BrtShortBlank(e){var t=parse_XLSBShortCell(e);return[t]}function parse_BrtCellBool(e){var t=parse_XLSBCell(e),n=e.read_shift(1);return[t,n,"b"]}function parse_BrtShortBool(e){var t=parse_XLSBShortCell(e),n=e.read_shift(1);return[t,n,"b"]}function parse_BrtCellError(e){var t=parse_XLSBCell(e),n=e.read_shift(1);return[t,n,"e"]}function parse_BrtShortError(e){var t=parse_XLSBShortCell(e),n=e.read_shift(1);return[t,n,"e"]}function parse_BrtCellIsst(e){var t=parse_XLSBCell(e),n=e.read_shift(4);return[t,n,"s"]}function parse_BrtShortIsst(e){var t=parse_XLSBShortCell(e),n=e.read_shift(4);return[t,n,"s"]}function parse_BrtCellReal(e){var t=parse_XLSBCell(e),n=parse_Xnum(e);return[t,n,"n"]}function parse_BrtShortReal(e){var t=parse_XLSBShortCell(e),n=parse_Xnum(e);return[t,n,"n"]}function parse_BrtCellRk(e){var t=parse_XLSBCell(e),n=parse_RkNumber(e);return[t,n,"n"]}function parse_BrtShortRk(e){var t=parse_XLSBShortCell(e),n=parse_RkNumber(e);return[t,n,"n"]}function parse_BrtCellRString(e){var t=parse_XLSBCell(e),n=parse_RichStr(e);return[t,n,"is"]}function parse_BrtCellSt(e){var t=parse_XLSBCell(e),n=parse_XLWideString(e);return[t,n,"str"]}function parse_BrtShortSt(e){var t=parse_XLSBShortCell(e),n=parse_XLWideString(e);return[t,n,"str"]}function parse_BrtFmlaBool(e,t,n){var a=e.l+t,i=parse_XLSBCell(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var c=parse_XLSBCellParsedFormula(e,a-e.l,n);o[3]=stringify_formula(c,null,i,n.supbooks,n)}else e.l=a;return o}function parse_BrtFmlaError(e,t,n){var a=e.l+t,i=parse_XLSBCell(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var c=parse_XLSBCellParsedFormula(e,a-e.l,n);o[3]=stringify_formula(c,null,i,n.supbooks,n)}else e.l=a;return o}function parse_BrtFmlaNum(e,t,n){var a=e.l+t,i=parse_XLSBCell(e);i.r=n["!row"];var s=parse_Xnum(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var c=parse_XLSBCellParsedFormula(e,a-e.l,n);o[3]=stringify_formula(c,null,i,n.supbooks,n)}else e.l=a;return o}function parse_BrtFmlaString(e,t,n){var a=e.l+t,i=parse_XLSBCell(e);i.r=n["!row"];var s=parse_XLWideString(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var c=parse_XLSBCellParsedFormula(e,a-e.l,n);o[3]=stringify_formula(c,null,i,n.supbooks,n)}else e.l=a;return o}var parse_BrtMergeCell=parse_UncheckedRfX;function parse_BrtHLink(e,t){var n=e.l+t,a=parse_UncheckedRfX(e),i=parse_XLNullableWideString(e),s=parse_XLWideString(e),o=parse_XLWideString(e),c=parse_XLWideString(e);e.l=n;var h={rfx:a,relId:i,loc:s,display:c};return o&&(h.Tooltip=o),h}function parse_BrtPane(){}function parse_BrtArrFmla(e,t,n){var a=e.l+t,i=parse_RfX(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var c=parse_XLSBArrayParsedFormula(e,a-e.l,n);o[1]=c}else e.l=a;return o}function parse_BrtShrFmla(e,t,n){var a=e.l+t,i=parse_UncheckedRfX(e),s=[i];if(n.cellFormula){var o=parse_XLSBSharedParsedFormula(e,a-e.l,n);s[1]=o,e.l=a}else e.l=a;return s}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var t={};return BrtMarginKeys.forEach(function(n){t[n]=parse_Xnum(e)}),t}function parse_BrtBeginWsView(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,t,n,a,i,s,o){if(!e)return e;var c=t||{};a||(a={"!id":{}});var h=c.dense?[]:{},f,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,v,m,S,E,w,T,A,L,k,D=[];c.biff=12,c["!row"]=0;var N=0,Y=!1,z=[],te={},Z=c.supbooks||i.supbooks||[[]];if(Z.sharedf=te,Z.arrayf=z,Z.SheetNames=i.SheetNames||i.Sheets.map(function(V){return V.name}),!c.supbooks&&(c.supbooks=Z,i.Names))for(var ne=0;ne<i.Names.length;++ne)Z[0][ne+1]=i.Names[ne];var oe=[],le=[],pe=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var de;if(recordhopper(e,function(C,O,I){if(!g)switch(I){case 148:f=C;break;case 0:v=C,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),L=encode_row(E=v.r),c["!row"]=v.r,(C.hidden||C.hpt||C.level!=null)&&(C.hpt&&(C.hpx=pt2px(C.hpt)),le[C.r]=C);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:C[2]},C[2]){case"n":m.v=C[1];break;case"s":A=strs[C[1]],m.v=A.t,m.r=A.r;break;case"b":m.v=!!C[1];break;case"e":m.v=C[1],c.cellText!==!1&&(m.w=BErr[m.v]);break;case"str":m.t="s",m.v=C[1];break;case"is":m.t="s",m.v=C[1].t;break}if((S=o.CellXf[C[0].iStyleRef])&&safe_format(m,S.numFmtId,null,c,s,o),w=C[0].c==-1?w+1:C[0].c,c.dense?(h[E]||(h[E]=[]),h[E][w]=m):h[encode_col(w)+L]=m,c.cellFormula){for(Y=!1,N=0;N<z.length;++N){var M=z[N];v.r>=M[0].s.r&&v.r<=M[0].e.r&&w>=M[0].s.c&&w<=M[0].e.c&&(m.F=encode_range(M[0]),Y=!0)}!Y&&C.length>3&&(m.f=C[3])}if(u.s.r>v.r&&(u.s.r=v.r),u.s.c>w&&(u.s.c=w),u.e.r<v.r&&(u.e.r=v.r),u.e.c<w&&(u.e.c=w),c.cellDates&&S&&m.t=="n"&&fmt_is_date(table_fmt[S.numFmtId])){var H=SSF_parse_date_code(m.v);H&&(m.t="d",m.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}de&&(de.type=="XLDAPR"&&(m.D=!0),de=void 0);break;case 1:case 12:if(!c.sheetStubs||p)break;m={t:"z",v:void 0},w=C[0].c==-1?w+1:C[0].c,c.dense?(h[E]||(h[E]=[]),h[E][w]=m):h[encode_col(w)+L]=m,u.s.r>v.r&&(u.s.r=v.r),u.s.c>w&&(u.s.c=w),u.e.r<v.r&&(u.e.r=v.r),u.e.c<w&&(u.e.c=w),de&&(de.type=="XLDAPR"&&(m.D=!0),de=void 0);break;case 176:D.push(C);break;case 49:de=((c.xlmeta||{}).Cell||[])[C-1];break;case 494:var G=a["!id"][C.relId];for(G?(C.Target=G.Target,C.loc&&(C.Target+="#"+C.loc),C.Rel=G):C.relId==""&&(C.Target="#"+C.loc),E=C.rfx.s.r;E<=C.rfx.e.r;++E)for(w=C.rfx.s.c;w<=C.rfx.e.c;++w)c.dense?(h[E]||(h[E]=[]),h[E][w]||(h[E][w]={t:"z",v:void 0}),h[E][w].l=C):(T=encode_cell({c:w,r:E}),h[T]||(h[T]={t:"z",v:void 0}),h[T].l=C);break;case 426:if(!c.cellFormula)break;z.push(C),k=c.dense?h[E][w]:h[encode_col(w)+L],k.f=stringify_formula(C[1],u,{r:v.r,c:w},Z,c),k.F=encode_range(C[0]);break;case 427:if(!c.cellFormula)break;te[encode_cell(C[0].s)]=C[1],k=c.dense?h[E][w]:h[encode_col(w)+L],k.f=stringify_formula(C[1],u,{r:v.r,c:w},Z,c);break;case 60:if(!c.cellStyles)break;for(;C.e>=C.s;)oe[C.e--]={width:C.w/256,hidden:!!(C.flags&1),level:C.level},pe||(pe=!0,find_mdw_colw(C.w/256)),process_col(oe[C.e+1]);break;case 161:h["!autofilter"]={ref:encode_range(C)};break;case 476:h["!margins"]=C;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),C.name&&(i.Sheets[n].CodeName=C.name),(C.above||C.left)&&(h["!outline"]={above:C.above,left:C.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),C.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!O.T){if(!p||c.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},c),delete c.supbooks,delete c["!row"],!h["!ref"]&&(u.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(h["!ref"]=encode_range(f||u)),c.sheetRows&&h["!ref"]){var J=safe_decode_range(h["!ref"]);c.sheetRows<=+J.e.r&&(J.e.r=c.sheetRows-1,J.e.r>u.e.r&&(J.e.r=u.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>u.e.c&&(J.e.c=u.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),h["!fullref"]=h["!ref"],h["!ref"]=encode_range(J))}return D.length>0&&(h["!merges"]=D),oe.length>0&&(h["!cols"]=oe),le.length>0&&(h["!rows"]=le),h}function parse_Cache(e){var t=[],n=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=n?+o[2]:o[2])});var i=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,i,a]}function parse_chart(e,t,n,a,i,s){var o=s||{"!type":"chart"};if(!e)return s;var c=0,h=0,f="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=parse_Cache(p);u.s.r=u.s.c=0,u.e.c=c,f=encode_col(c),g[0].forEach(function(v,m){o[f+encode_row(m)]={t:"n",v,z:g[1]},h=m}),u.e.r<h&&(u.e.r=h),++c}),c>0&&(o["!ref"]=encode_range(u)),o}function parse_cs_xml(e,t,n,a,i){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(sheetprregex);return c&&parse_ws_xml_sheetpr(c[0],s,i,n),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function parse_BrtCsProp(e,t){e.l+=10;var n=parse_XLWideString(e);return{name:n}}function parse_cs_bin(e,t,n,a,i){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return recordhopper(e,function(h,f,u){switch(u){case 550:s["!rel"]=h;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),h.name&&(i.Sheets[n].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,t){for(var n=0;n!=e.length;++n)for(var a=e[n],i=0;i!=t.length;++i){var s=t[i];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=parsexmlbool(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function push_defaults(e,t){for(var n=0;n!=t.length;++n){var a=t[n];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=parsexmlbool(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}var badchars="][*?/\\".split("");function check_ws_name(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return badchars.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,i="xmlns",s={},o=0;if(e.replace(tagregex,function(h,f){var u=parsexmltag(h);switch(strip_ns(u[0])){case"<?xml":break;case"<workbook":h.match(wbnsregex)&&(i="xmlns"+h.match(/<(\w+):/)[1]),n.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],n.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(p){if(u[p[0]]!=null)switch(p[2]){case"bool":n.WBProps[p[0]]=parsexmlbool(u[p[0]]);break;case"int":n.WBProps[p[0]]=parseInt(u[p[0]],10);break;default:n.WBProps[p[0]]=u[p[0]]}}),u.codeName&&(n.WBProps.CodeName=utf8read(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],n.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=unescapexml(utf8read(u.name)),delete u[0],n.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=utf8read(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),parsexmlbool(u.hidden||"0")&&(s.Hidden=!0),o=f+h.length;break;case"</definedName>":s.Ref=unescapexml(utf8read(e.slice(o,f))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],n.CalcPr=u;break;case"<calcPr/>":delete u[0],n.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return h}),XMLNS_main.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return parse_wb_defaults(n),n}function parse_BrtBundleSh(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=parse_RelID(e),n.name=parse_XLWideString(e),n}function parse_BrtWbProp(e,t){var n={},a=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?parse_XLWideString(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(a&65536),n.backupFile=!!(a&64),n.checkCompatibility=!!(a&4096),n.date1904=!!(a&1),n.filterPrivacy=!!(a&8),n.hidePivotFieldList=!!(a&1024),n.promptedSolutions=!!(a&16),n.publishItems=!!(a&2048),n.refreshAllConnections=!!(a&262144),n.saveExternalLinkValues=!!(a&128),n.showBorderUnselectedTables=!!(a&4),n.showInkAnnotation=!!(a&32),n.showObjects=["all","placeholders","none"][a>>13&3],n.showPivotChartFilter=!!(a&32768),n.updateLinks=["userSet","never","always"][a>>8&3],n}function parse_BrtFRTArchID$(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function parse_BrtName(e,t,n){var a=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=parse_XLNameWideString(e),o=parse_XLSBNameParsedFormula(e,0,n),c=parse_XLNullableWideString(e);e.l=a;var h={Name:s,Ptg:o};return i<268435455&&(h.Sheet=i),c&&(h.Comment=c),h}function parse_wb_bin(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(h,f,u){switch(u){case 156:o.SheetNames.push(h.name),n.Sheets.push(h);break;case 153:n.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=stringify_formula(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,s.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,h]):o[0]=[u,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;case 16:break;default:if(!f.T){if(!i||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),parse_wb_defaults(n),n.Names=s,n.supbooks=o,n}function parse_wb(e,t,n){return t.slice(-4)===".bin"?parse_wb_bin(e,n):parse_wb_xml(e,n)}function parse_ws(e,t,n,a,i,s,o,c){return t.slice(-4)===".bin"?parse_ws_bin(e,a,n,i,s,o,c):parse_ws_xml(e,a,n,i,s,o,c)}function parse_cs(e,t,n,a,i,s,o,c){return t.slice(-4)===".bin"?parse_cs_bin(e,a,n,i,s):parse_cs_xml(e,a,n,i,s)}function parse_ms(e,t,n,a,i,s,o,c){return t.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,t,n,a,i,s,o,c){return t.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,t,n,a){return t.slice(-4)===".bin"?parse_sty_bin(e,n,a):parse_sty_xml(e,n,a)}function parse_theme(e,t,n){return parse_theme_xml(e,n)}function parse_sst(e,t,n){return t.slice(-4)===".bin"?parse_sst_bin(e,n):parse_sst_xml(e,n)}function parse_cmnt(e,t,n){return t.slice(-4)===".bin"?parse_comments_bin(e,n):parse_comments_xml(e,n)}function parse_cc(e,t,n){return t.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,t,n,a){return n.slice(-4)===".bin"?parse_xlink_bin(e,t,n,a):void 0}function parse_xlmeta(e,t,n){return t.slice(-4)===".bin"?parse_xlmeta_bin(e,t,n):parse_xlmeta_xml(e,t,n)}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,t){var n=e.split(/\s+/),a=[];if(a[0]=n[0],n.length===1)return a;var i=e.match(attregexg2),s,o,c,h;if(i)for(h=0;h!=i.length;++h)s=i[h].match(attregex2),(o=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(o+1),a[c]=s[2].slice(1,s[2].length-1));return a}function xlml_parsexmltagobj(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var a=e.match(attregexg2),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(attregex2),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}var XLMLFormatMap;function xlml_format(e,t){var n=XLMLFormatMap[e]||unescapexml(e);return n==="General"?SSF_general(t):SSF_format(n,t)}function xlml_set_custprop(e,t,n,a){var i=a;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=parsexmlbool(a);break;case"i2":case"int":i=parseInt(a,10);break;case"r4":case"float":i=parseFloat(a);break;case"date":case"dateTime.tz":i=parseDate(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[unescapexml(t)]=i}function safe_format_xlml(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(t||"General",e.v)}catch(s){if(n.WTF)throw s}try{var a=XLMLFormatMap[t]||t||"General";if(n.cellNF&&(e.z=a),n.cellDates&&e.t=="n"&&fmt_is_date(a)){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(n.WTF)throw s}}}function process_style_xlml(e,t,n){if(n.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=XLMLPatternTypeMap[a.Pattern]||a.Pattern)}e[t.ID]=t}function parse_xlml_data(e,t,n,a,i,s,o,c,h,f){var u="General",p=a.StyleID,g={};f=f||{};var v=[],m=0;for(p===void 0&&c&&(p=c.StyleID),p===void 0&&o&&(p=o.StyleID);s[p]!==void 0&&(s[p].nf&&(u=s[p].nf),s[p].Interior&&v.push(s[p].Interior),!!s[p].Parent);)p=s[p].Parent;switch(n.Type){case"Boolean":a.t="b",a.v=parsexmlbool(e);break;case"String":a.t="s",a.r=xlml_fixstr(unescapexml(e)),a.v=e.indexOf("<")>-1?unescapexml(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=unescapexml(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=RBErr[e],f.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=xlml_fixstr(t||e));break}if(safe_format_xlml(a,u,f),f.cellFormula!==!1)if(a.Formula){var S=unescapexml(a.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),a.f=rc_to_a1(S,i),delete a.Formula,a.ArrayRange=="RC"?a.F=rc_to_a1("RC:RC",i):a.ArrayRange&&(a.F=rc_to_a1(a.ArrayRange,i),h.push([safe_decode_range(a.F),a.F]))}else for(m=0;m<h.length;++m)i.r>=h[m][0].s.r&&i.r<=h[m][0].e.r&&i.c>=h[m][0].s.c&&i.c<=h[m][0].e.c&&(a.F=h[m][1]);f.cellStyles&&(v.forEach(function(E){!g.patternType&&E.patternType&&(g.patternType=E.patternType)}),a.s=g),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,t){var n=t||{};make_ssf();var a=debom(xlml_normalize(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(a=utf8read(a));var i=a.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=dup(n);return o.type="string",PRN.to_workbook(a,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Re){i.indexOf("<"+Re)>=0&&(s=!0)}),s)return html_to_workbook(a,n);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,h=[],f,u={},p=[],g=n.dense?[]:{},v="",m={},S={},E=xlml_parsexmltag('<Data ss:Type="String">'),w=0,T=0,A=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},D={},N="",Y=0,z=[],te={},Z={},ne=0,oe=[],le=[],pe={},de=[],J,V=!1,C=[],O=[],I={},M=0,H=0,G={Sheets:[],WBProps:{date1904:!1}},j={};xlmlregex.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";c=xlmlregex.exec(a);)switch(c[3]=(F=c[3]).toLowerCase()){case"data":if(F=="data"){if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break}if(h[h.length-1][1])break;c[1]==="/"?parse_xlml_data(a.slice(w,c.index),N,E,h[h.length-1][0]=="comment"?pe:m,{c:T,r:A},k,de[T],S,C,n):(N="",E=xlml_parsexmltag(c[0]),w=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(le.length>0&&(m.c=le),(!n.sheetRows||n.sheetRows>A)&&m.v!==void 0&&(n.dense?(g[A]||(g[A]=[]),g[A][T]=m):g[encode_col(T)+encode_row(A)]=m),m.HRef&&(m.l={Target:unescapexml(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(M=T+(parseInt(m.MergeAcross,10)|0),H=A+(parseInt(m.MergeDown,10)|0),z.push({s:{c:T,r:A},e:{c:M,r:H}})),!n.sheetStubs)m.MergeAcross?T=M+1:++T;else if(m.MergeAcross||m.MergeDown){for(var q=T;q<=M;++q)for(var X=A;X<=H;++X)(q>T||X>A)&&(n.dense?(g[X]||(g[X]=[]),g[X][q]={t:"z"}):g[encode_col(q)+encode_row(X)]={t:"z"});T=M+1}else++T;else m=xlml_parsexmltagobj(c[0]),m.Index&&(T=+m.Index-1),T<L.s.c&&(L.s.c=T),T>L.e.c&&(L.e.c=T),c[0].slice(-2)==="/>"&&++T,le=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(A<L.s.r&&(L.s.r=A),A>L.e.r&&(L.e.r=A),c[0].slice(-2)==="/>"&&(S=xlml_parsexmltag(c[0]),S.Index&&(A=+S.Index-1)),T=0,++A):(S=xlml_parsexmltag(c[0]),S.Index&&(A=+S.Index-1),I={},(S.AutoFitHeight=="0"||S.Height)&&(I.hpx=parseInt(S.Height,10),I.hpt=px2pt(I.hpx),O[A]=I),S.Hidden=="1"&&(I.hidden=!0,O[A]=I));break;case"worksheet":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));p.push(v),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(g["!ref"]=encode_range(L),n.sheetRows&&n.sheetRows<=L.e.r&&(g["!fullref"]=g["!ref"],L.e.r=n.sheetRows-1,g["!ref"]=encode_range(L))),z.length&&(g["!merges"]=z),de.length>0&&(g["!cols"]=de),O.length>0&&(g["!rows"]=O),u[v]=g}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=T=0,h.push([c[3],!1]),f=xlml_parsexmltag(c[0]),v=unescapexml(f.Name),g=n.dense?[]:{},z=[],C=[],O=[],j={name:v,Hidden:0},G.Sheets.push(j);break;case"table":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;h.push([c[3],!1]),de=[],V=!1}break;case"style":c[1]==="/"?process_style_xlml(k,D,n):D=xlml_parsexmltag(c[0]);break;case"numberformat":D.nf=unescapexml(xlml_parsexmltag(c[0]).Format||"General"),XLMLFormatMap[D.nf]&&(D.nf=XLMLFormatMap[D.nf]);for(var W=0;W!=392&&table_fmt[W]!=D.nf;++W);if(W==392){for(W=57;W!=392;++W)if(table_fmt[W]==null){SSF_load(D.nf,W);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(J=xlml_parsexmltag(c[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!V&&J.wpx>10){V=!0,MDW=DEF_MDW;for(var K=0;K<de.length;++K)de[K]&&process_col(de[K])}V&&process_col(J),de[J.Index-1||de.length]=J;for(var ae=0;ae<+J.Span;++ae)de[de.length]=dup(J);break;case"namedrange":if(c[1]==="/")break;G.Names||(G.Names=[]);var U=parsexmltag(c[0]),ve={Name:U.Name,Ref:rc_to_a1(U.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(ve.Sheet=G.Sheets.length-1),G.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?N+=a.slice(Y,c.index):Y=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;D.Interior=xlml_parsexmltag(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?xlml_set_prop(te,F,a.slice(ne,c.index)):ne=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else h.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));xlml_clean_comment(pe),le.push(pe)}else h.push([c[3],!1]),f=xlml_parsexmltag(c[0]),pe={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var be=xlml_parsexmltag(c[0]);g["!autofilter"]={ref:rc_to_a1(be.Range).replace(/\$/g,"")},h.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"null":break;default:if(h.length==0&&c[3]=="document"||h.length==0&&c[3]=="uof")return parse_fods(a,n);var ye=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ye=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ye=!1}break;case"excelworkbook":switch(c[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ye=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ye=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(ne,c.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else ne=c.index+c[0].length;break;case"header":g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+parsexmltag(c[0]).Margin)||(g["!margins"].header=+parsexmltag(c[0]).Margin);break;case"footer":g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+parsexmltag(c[0]).Margin)||(g["!margins"].footer=+parsexmltag(c[0]).Margin);break;case"pagemargins":var _e=parsexmltag(c[0]);g["!margins"]||default_margins(g["!margins"]={},"xlml"),isNaN(+_e.Top)||(g["!margins"].top=+_e.Top),isNaN(+_e.Left)||(g["!margins"].left=+_e.Left),isNaN(+_e.Right)||(g["!margins"].right=+_e.Right),isNaN(+_e.Bottom)||(g["!margins"].bottom=+_e.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ye=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ye=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ye=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ye=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ye=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ye=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ye=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ye=!1}break;case"smarttags":break;default:ye=!1;break}if(ye||c[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?xlml_set_custprop(Z,F,oe,a.slice(ne,c.index)):(oe=c,ne=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+h.join("|")}var ge={};return!n.bookSheets&&!n.bookProps&&(ge.Sheets=u),ge.SheetNames=p,ge.Workbook=G,ge.SSF=dup(table_fmt),ge.Props=te,ge.Custprops=Z,ge}function parse_xlml(e,t){switch(fix_read_opts(t=t||{}),t.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),t);case"binary":case"buffer":case"file":return parse_xlml_xml(e,t);case"array":return parse_xlml_xml(a2s(e),t)}}function parse_compobj(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(n),n.length-n.l<=4)return t;var a=n.read_shift(4);if(a==0||a>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(a=n.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(n),a=n.read_shift(4),a==0||a>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,t,n,a,i){var s=a,o=[],c=n.slice(n.l,n.l+s);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),n.l+=s;for(var h=__readUInt16LE(n,n.l),f=XLSRecordEnum[h],u=0;f!=null&&CONTINUE_RT.indexOf(h)>-1;)s=__readUInt16LE(n,n.l+2),u=n.l+4,h==2066?u+=4:(h==2165||h==2175)&&(u+=12),c=n.slice(u,n.l+4+s),o.push(c),n.l+=4+s,f=XLSRecordEnum[h=__readUInt16LE(n,n.l)];var p=bconcat(o);prep_blob(p,0);var g=0;p.lens=[];for(var v=0;v<o.length;++v)p.lens.push(g),g+=o[v].length;if(p.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+a;return t.f(p,p.length,i)}function safe_format_xf(e,t,n){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=table_fmt[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(a,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&fmt_is_date(table_fmt[a]||String(a))){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function make_cell(e,t,n){return{v:e,ixfe:t,t:n}}function parse_workbook(e,t){var n={opts:{}},a={},i=t.dense?[]:{},s={},o={},c=null,h=[],f="",u={},p,g="",v,m,S,E,w={},T=[],A,L,k=[],D=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Y={},z=function(tt){return tt<8?XLSIcv[tt]:tt<64&&D[tt-8]||XLSIcv[tt]},te=function(tt,ut,Ht){var St=ut.XF.data;if(!(!St||!St.patternType||!Ht||!Ht.cellStyles)){ut.s={},ut.s.patternType=St.patternType;var Ie;(Ie=rgb2Hex(z(St.icvFore)))&&(ut.s.fgColor={rgb:Ie}),(Ie=rgb2Hex(z(St.icvBack)))&&(ut.s.bgColor={rgb:Ie})}},Z=function(tt,ut,Ht){if(!(I>1)&&!(Ht.sheetRows&&tt.r>=Ht.sheetRows)){if(Ht.cellStyles&&ut.XF&&ut.XF.data&&te(tt,ut,Ht),delete ut.ixfe,delete ut.XF,p=tt,g=encode_cell(tt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<o.s.r&&(o.s.r=tt.r),tt.c<o.s.c&&(o.s.c=tt.c),tt.r+1>o.e.r&&(o.e.r=tt.r+1),tt.c+1>o.e.c&&(o.e.c=tt.c+1),Ht.cellFormula&&ut.f){for(var St=0;St<T.length;++St)if(!(T[St][0].s.c>tt.c||T[St][0].s.r>tt.r)&&!(T[St][0].e.c<tt.c||T[St][0].e.r<tt.r)){ut.F=encode_range(T[St][0]),(T[St][0].s.c!=tt.c||T[St][0].s.r!=tt.r)&&delete ut.f,ut.f&&(ut.f=""+stringify_formula(T[St][1],o,tt,C,ne));break}}Ht.dense?(i[tt.r]||(i[tt.r]=[]),i[tt.r][tt.c]=ut):i[g]=ut}},ne={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ne.password=t.password);var oe,le=[],pe=[],de=[],J=[],V=!1,C=[];C.SheetNames=ne.snames,C.sharedf=ne.sharedf,C.arrayf=ne.arrayf,C.names=[],C.XTI=[];var O=0,I=0,M=0,H=[],G=[],j;ne.codepage=1200,set_cp(1200);for(var F=!1;e.l<e.length-1;){var q=e.l,X=e.read_shift(2);if(X===0&&O===10)break;var W=e.l===e.length?0:e.read_shift(2),K=XLSRecordEnum[X];if(K&&K.f){if(t.bookSheets&&O===133&&X!==133)break;if(O=X,K.r===2||K.r==12){var ae=e.read_shift(2);if(W-=2,!ne.enc&&ae!==X&&((ae&255)<<8|ae>>8)!==X)throw new Error("rt mismatch: "+ae+"!="+X);K.r==12&&(e.l+=10,W-=10)}var U={};if(X===10?U=K.f(e,W,ne):U=slurp(X,K,e,W,ne),I==0&&[9,521,1033,2057].indexOf(O)===-1)continue;switch(X){case 34:n.opts.Date1904=N.WBProps.date1904=U;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(ne.enc||(e.l=0),ne.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:ne.lastuser=U;break;case 66:var ve=Number(U);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}set_cp(ne.codepage=ve),F=!0;break;case 317:ne.rrtabid=U;break;case 25:ne.winlocked=U;break;case 439:n.opts.RefreshAll=U;break;case 12:n.opts.CalcCount=U;break;case 16:n.opts.CalcDelta=U;break;case 17:n.opts.CalcIter=U;break;case 13:n.opts.CalcMode=U;break;case 14:n.opts.CalcPrecision=U;break;case 95:n.opts.CalcSaveRecalc=U;break;case 15:ne.CalcRefMode=U;break;case 2211:n.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(U);break;case 430:C.push([U]),C[C.length-1].XTI=[];break;case 35:case 547:C[C.length-1].push(U);break;case 24:case 536:j={Name:U.Name,Ref:stringify_formula(U.rgce,o,null,C,ne)},U.itab>0&&(j.Sheet=U.itab-1),C.names.push(j),C[0]||(C[0]=[],C[0].XTI=[]),C[C.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(G[U.itab-1]={ref:encode_range(U.rgce[0][0][1][2])});break;case 22:ne.ExternCount=U;break;case 23:C.length==0&&(C[0]=[],C[0].XTI=[]),C[C.length-1].XTI=C[C.length-1].XTI.concat(U),C.XTI=C.XTI.concat(U);break;case 2196:if(ne.biff<8)break;j!=null&&(j.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&ne.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,ne.snames.push(U.name);break;case 10:{if(--I)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=encode_range(o),t.sheetRows&&t.sheetRows<=o.e.r){var be=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=encode_range(o),o.e.r=be}o.e.r++,o.e.c++}le.length>0&&(i["!merges"]=le),pe.length>0&&(i["!objects"]=pe),de.length>0&&(i["!cols"]=de),J.length>0&&(i["!rows"]=J),N.Sheets.push(Y)}f===""?u=i:a[f]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ne.biff===8&&(ne.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),ne.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(ne.biff=5,F=!0,set_cp(ne.codepage=28591)),ne.biff==8&&U.BIFFVer==0&&U.dt==16&&(ne.biff=2),I++)break;if(i=t.dense?[]:{},ne.biff<8&&!F&&(F=!0,set_cp(ne.codepage=t.codepage||1252)),ne.biff<5||U.BIFFVer==0&&U.dt==4096){f===""&&(f="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ye={pos:e.l-W,name:f};s[ye.pos]=ye,ne.snames.push(f)}else f=(s[q]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),le=[],pe=[],ne.arrayf=T=[],de=[],J=[],V=!1,Y={Hidden:(s[q]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[U.r]||[])[U.c]:i[encode_cell({c:U.c,r:U.r})])&&++U.c,A={ixfe:U.ixfe,XF:k[U.ixfe]||{},v:U.val,t:"n"},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t);break;case 5:case 517:A={ixfe:U.ixfe,XF:k[U.ixfe],v:U.val,t:U.t},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t);break;case 638:A={ixfe:U.ixfe,XF:k[U.ixfe],v:U.rknum,t:"n"},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t);break;case 189:for(var _e=U.c;_e<=U.C;++_e){var ge=U.rkrec[_e-U.c][0];A={ixfe:ge,XF:k[ge],v:U.rkrec[_e-U.c][1],t:"n"},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:_e,r:U.r},A,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){c=U;break}if(A=make_cell(U.val,U.cell.ixfe,U.tt),A.XF=k[A.ixfe],t.cellFormula){var Re=U.formula;if(Re&&Re[0]&&Re[0][0]&&Re[0][0][0]=="PtgExp"){var De=Re[0][0][1][0],We=Re[0][0][1][1],ze=encode_cell({r:De,c:We});w[ze]?A.f=""+stringify_formula(U.formula,o,U.cell,C,ne):A.F=((t.dense?(i[De]||[])[We]:i[ze])||{}).F}else A.f=""+stringify_formula(U.formula,o,U.cell,C,ne)}M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z(U.cell,A,t),c=U}break;case 7:case 519:if(c)c.val=U,A=make_cell(U,c.cell.ixfe,"s"),A.XF=k[A.ixfe],t.cellFormula&&(A.f=""+stringify_formula(c.formula,o,c.cell,C,ne)),M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z(c.cell,A,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(U);var Je=encode_cell(U[0].s);if(v=t.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[Je],t.cellFormula&&v){if(!c||!Je||!v)break;v.f=""+stringify_formula(U[1],o,U[0],C,ne),v.F=encode_range(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!c)break;w[encode_cell(c.cell)]=U[0],v=t.dense?(i[c.cell.r]||[])[c.cell.c]:i[encode_cell(c.cell)],(v||{}).f=""+stringify_formula(U[0],o,p,C,ne)}}break;case 253:A=make_cell(h[U.isst].t,U.ixfe,"s"),h[U.isst].h&&(A.h=h[U.isst].h),A.XF=k[A.ixfe],M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:U.ixfe,XF:k[U.ixfe],t:"z"},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t));break;case 190:if(t.sheetStubs)for(var Qe=U.c;Qe<=U.C;++Qe){var et=U.ixfe[Qe-U.c];A={ixfe:et,XF:k[et],t:"z"},M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:Qe,r:U.r},A,t)}break;case 214:case 516:case 4:A=make_cell(U.val,U.ixfe,"s"),A.XF=k[A.ixfe],M>0&&(A.z=H[A.ixfe>>8&63]),safe_format_xf(A,t,n.opts.Date1904),Z({c:U.c,r:U.r},A,t);break;case 0:case 512:I===1&&(o=U);break;case 252:h=U;break;case 1054:if(ne.biff==4){H[M++]=U[1];for(var st=0;st<M+163&&table_fmt[st]!=U[1];++st);st>=163&&SSF_load(U[1],M+163)}else SSF_load(U[1],U[0]);break;case 30:{H[M++]=U;for(var vt=0;vt<M+163&&table_fmt[vt]!=U;++vt);vt>=163&&SSF_load(U,M+163)}break;case 229:le=le.concat(U);break;case 93:pe[U.cmo[0]]=ne.lastobj=U;break;case 438:ne.lastobj.TxO=U;break;case 127:ne.lastobj.ImData=U;break;case 440:for(E=U[0].s.r;E<=U[0].e.r;++E)for(S=U[0].s.c;S<=U[0].e.c;++S)v=t.dense?(i[E]||[])[S]:i[encode_cell({c:S,r:E})],v&&(v.l=U[1]);break;case 2048:for(E=U[0].s.r;E<=U[0].e.r;++E)for(S=U[0].s.c;S<=U[0].e.c;++S)v=t.dense?(i[E]||[])[S]:i[encode_cell({c:S,r:E})],v&&v.l&&(v.l.Tooltip=U[1]);break;case 28:{if(ne.biff<=5&&ne.biff>=2)break;v=t.dense?(i[U[0].r]||[])[U[0].c]:i[encode_cell(U[0])];var xt=pe[U[2]];v||(t.dense?(i[U[0].r]||(i[U[0].r]=[]),v=i[U[0].r][U[0].c]={t:"z"}):v=i[encode_cell(U[0])]={t:"z"},o.e.r=Math.max(o.e.r,U[0].r),o.s.r=Math.min(o.s.r,U[0].r),o.e.c=Math.max(o.e.c,U[0].c),o.s.c=Math.min(o.s.c,U[0].c)),v.c||(v.c=[]),m={a:U[1],t:xt.TxO.t},v.c.push(m)}break;case 2173:update_xfext(k[U.ixfe],U.ext);break;case 125:{if(!ne.cellStyles)break;for(;U.e>=U.s;)de[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},V||(V=!0,find_mdw_colw(U.w/256)),process_col(de[U.e+1])}break;case 520:{var ht={};U.level!=null&&(J[U.r]=ht,ht.level=U.level),U.hidden&&(J[U.r]=ht,ht.hidden=!0),U.hpt&&(J[U.r]=ht,ht.hpt=U.hpt,ht.hpx=pt2px(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=U;break;case 161:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(N.Views[0].RTL=!0);break;case 146:D=U;break;case 2198:oe=U;break;case 140:L=U;break;case 442:f?Y.CodeName=U||Y.name:N.WBProps.CodeName=U||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+X.toString(16)),e.l+=W}return n.SheetNames=keys(s).sort(function(ft,tt){return Number(ft)-Number(tt)}).map(function(ft){return s[ft].name}),t.bookSheets||(n.Sheets=a),!n.SheetNames.length&&u["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=u)):n.Preamble=u,n.Sheets&&G.forEach(function(ft,tt){n.Sheets[n.SheetNames[tt]]["!autofilter"]=ft}),n.Strings=h,n.SSF=dup(table_fmt),ne.enc&&(n.Encryption=ne.enc),oe&&(n.Themes=oe),n.Metadata={},L!==void 0&&(n.Metadata.Country=L),C.names.length>0&&(N.Names=C.names),n.Workbook=N,n}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,t,n){var a=CFB.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var i=parse_PropertySetStream(a,DocSummaryPIDDSI,PSCLSID.DSI);for(var s in i)t[s]=i[s]}catch(f){if(n.WTF)throw f}var o=CFB.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=parse_PropertySetStream(o,SummaryPIDSI,PSCLSID.SI);for(var h in c)t[h]==null&&(t[h]=c[h])}catch(f){if(n.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(load_props_pairs(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function parse_xlscfb(e,t){t||(t={}),fix_read_opts(t),reset_cp(),t.codepage&&set_ansi(t.codepage);var n,a;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");n=CFB.find(e,"!CompObj"),a=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(t.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),a={content:e}}var i,s;if(n&&parse_compobj(n),t.bookProps&&!t.bookSheets)i={};else{var o=has_buf?"buffer":"array";if(a&&a.content)i=parse_workbook(a.content,t);else if((s=CFB.find(e,"PerfectOffice_MAIN"))&&s.content)i=WK_.to_workbook(s.content,(t.type=o,t));else if((s=CFB.find(e,"NativeContent_MAIN"))&&s.content)i=WK_.to_workbook(s.content,(t.type=o,t));else throw(s=CFB.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=make_vba_xls(e))}var c={};return e.FullPaths&&parse_xls_props(e,c,t),i.Props=i.Custprops=c,t.bookFiles&&(i.cfb=e),i}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,t,n,a){var i=t;if(!isNaN(i)){var s=(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&is_buf(n)&&e.push(n)}}function html_to_sheet(e,t){var n=t||{},a=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,c=s&&s.index||e.length,h=split_regex(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,u=0,p=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<h.length;++o){var S=h[o].trim(),E=S.slice(0,3).toLowerCase();if(E=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}u=0;continue}if(!(E!="<td"&&E!="<th")){var w=S.split(/<\/t[dh]>/i);for(c=0;c<w.length;++c){var T=w[c].trim();if(T.match(/<t[dh]/i)){for(var A=T,L=0;A.charAt(0)=="<"&&(L=A.indexOf(">"))>-1;)A=A.slice(L+1);for(var k=0;k<m.length;++k){var D=m[k];D.s.c==u&&D.s.r<f&&f<=D.e.r&&(u=D.e.c+1,k=-1)}var N=parsexmltag(T.slice(0,T.indexOf(">")));g=N.colspan?+N.colspan:1,((p=+N.rowspan)>1||g>1)&&m.push({s:{r:f,c:u},e:{r:f+(p||1)-1,c:u+g-1}});var Y=N.t||N["data-t"]||"";if(!A.length){u+=g;continue}if(A=htmldecode(A),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>u&&(v.s.c=u),v.e.c<u&&(v.e.c=u),!A.length){u+=g;continue}var z={t:"s",v:A};n.raw||!A.trim().length||Y=="s"||(A==="TRUE"?z={t:"b",v:!0}:A==="FALSE"?z={t:"b",v:!1}:isNaN(fuzzynum(A))?isNaN(fuzzydate(A).getDate())||(z={t:"d",v:parseDate(A)},n.cellDates||(z={t:"n",v:datenum(z.v)}),z.z=n.dateNF||table_fmt[14]):z={t:"n",v:fuzzynum(A)}),n.dense?(a[f]||(a[f]=[]),a[f][u]=z):a[encode_cell({r:f,c:u})]=z,u+=g}}}}return a["!ref"]=encode_range(v),m.length&&(a["!merges"]=m),a}function make_html_row(e,t,n,a){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,h=0,f=0;f<i.length;++f)if(!(i[f].s.r>n||i[f].s.c>o)&&!(i[f].e.r<n||i[f].e.c<o)){if(i[f].s.r<n||i[f].s.c<o){c=-1;break}c=i[f].e.r-i[f].s.r+1,h=i[f].e.c-i[f].s.c+1;break}if(!(c<0)){var u=encode_cell({r:n,c:o}),p=a.dense?(e[n]||[])[o]:e[u],g=p&&p.v!=null&&(p.h||escapehtml(p.w||(format_cell(p),p.w)||""))||"",v={};c>1&&(v.rowspan=c),h>1&&(v.colspan=h),a.editable?g='<span contenteditable="true">'+g+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),v.id=(a.id||"sjs")+"-"+u,s.push(writextag("td",g,v))}}var m="<tr>";return m+s.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return sheet_to_workbook(html_to_sheet(n[0],t),t);var a=book_new();return n.forEach(function(i,s){book_append_sheet(a,html_to_sheet(i,t),"Sheet"+(s+1))}),a}function make_html_preamble(e,t,n){var a=[];return a.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function sheet_to_html(e,t){var n=t||{},a=n.header!=null?n.header:HTML_BEGIN,i=n.footer!=null?n.footer:HTML_END,s=[a],o=decode_range(e["!ref"]);n.dense=Array.isArray(e),s.push(make_html_preamble(e,o,n));for(var c=o.s.r;c<=o.e.r;++c)s.push(make_html_row(e,o,c,n));return s.push("</table>"+i),s.join("")}function sheet_add_dom(e,t,n){var a=n||{},i=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var o=typeof a.origin=="string"?decode_cell(a.origin):a.origin;i=o.r,s=o.c}var c=t.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=decode_range(e["!ref"]);f.s.r=Math.min(f.s.r,u.s.r),f.s.c=Math.min(f.s.c,u.s.c),f.e.r=Math.max(f.e.r,u.e.r),f.e.c=Math.max(f.e.c,u.e.c),i==-1&&(f.e.r=i=u.e.r+1)}var p=[],g=0,v=e["!rows"]||(e["!rows"]=[]),m=0,S=0,E=0,w=0,T=0,A=0;for(e["!cols"]||(e["!cols"]=[]);m<c.length&&S<h;++m){var L=c[m];if(is_dom_element_hidden(L)){if(a.display)continue;v[S]={hidden:!0}}var k=L.children;for(E=w=0;E<k.length;++E){var D=k[E];if(!(a.display&&is_dom_element_hidden(D))){var N=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):htmldecode(D.innerHTML),Y=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<p.length;++g){var z=p[g];z.s.c==w+s&&z.s.r<S+i&&S+i<=z.e.r&&(w=z.e.c+1-s,g=-1)}A=+D.getAttribute("colspan")||1,((T=+D.getAttribute("rowspan")||1)>1||A>1)&&p.push({s:{r:S+i,c:w+s},e:{r:S+i+(T||1)-1,c:w+s+(A||1)-1}});var te={t:"s",v:N},Z=D.getAttribute("data-t")||D.getAttribute("t")||"";N!=null&&(N.length==0?te.t=Z||"z":a.raw||N.trim().length==0||Z=="s"||(N==="TRUE"?te={t:"b",v:!0}:N==="FALSE"?te={t:"b",v:!1}:isNaN(fuzzynum(N))?isNaN(fuzzydate(N).getDate())||(te={t:"d",v:parseDate(N)},a.cellDates||(te={t:"n",v:datenum(te.v)}),te.z=a.dateNF||table_fmt[14]):te={t:"n",v:fuzzynum(N)})),te.z===void 0&&Y!=null&&(te.z=Y);var ne="",oe=D.getElementsByTagName("A");if(oe&&oe.length)for(var le=0;le<oe.length&&!(oe[le].hasAttribute("href")&&(ne=oe[le].getAttribute("href"),ne.charAt(0)!="#"));++le);ne&&ne.charAt(0)!="#"&&(te.l={Target:ne}),a.dense?(e[S+i]||(e[S+i]=[]),e[S+i][w+s]=te):e[encode_cell({c:w+s,r:S+i})]=te,f.e.c<w+s&&(f.e.c=w+s),w+=A}}++S}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,S-1+i),e["!ref"]=encode_range(f),S>=h&&(e["!fullref"]=encode_range((f.e.r=c.length-m+S-1+i,f))),e}function parse_dom_table(e,t){var n=t||{},a=n.dense?[]:{};return sheet_add_dom(a,e,t)}function table_to_book(e,t){return sheet_to_workbook(parse_dom_table(e,t),t)}function is_dom_element_hidden(e){var t="",n=get_get_computed_style_function(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=unescapexml(t.replace(/<[^>]*>/g,""));return[n]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,t){var n=t||{},a=xlml_normalize(e),i=[],s,o,c={name:""},h="",f=0,u,p,g={},v=[],m=n.dense?[]:{},S,E,w={value:""},T="",A=0,L=[],k=-1,D=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},Y=0,z={},te=[],Z={},ne=0,oe=0,le=[],pe=1,de=1,J=[],V={Names:[]},C={},O=["",""],I=[],M={},H="",G=0,j=!1,F=!1,q=0;for(xlmlregex.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=xlmlregex.exec(a);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=encode_range(N):m["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=n.sheetRows-1,m["!ref"]=encode_range(N)),te.length&&(m["!merges"]=te),le.length&&(m["!rows"]=le),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),v.push(u.name),g[u.name]=m,F=!1):S[0].charAt(S[0].length-2)!=="/"&&(u=parsexmltag(S[0],!1),k=D=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=n.dense?[]:{},te=[],le=[],F=!0);break;case"table-row-group":S[1]==="/"?--Y:++Y;break;case"table-row":case"":if(S[1]==="/"){k+=pe,pe=1;break}if(p=parsexmltag(S[0],!1),p.?k=p.-1:k==-1&&(k=0),pe=+p["number-rows-repeated"]||1,pe<10)for(q=0;q<pe;++q)Y>0&&(le[k+q]={level:Y});D=-1;break;case"covered-table-cell":S[1]!=="/"&&++D,n.sheetStubs&&(n.dense?(m[k]||(m[k]=[]),m[k][D]={t:"z"}):m[encode_cell({r:k,c:D})]={t:"z"}),T="",L=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++D,w=parsexmltag(S[0],!1),de=parseInt(w["number-columns-repeated"]||"1",10),E={t:"z",v:null},w.formula&&n.cellFormula!=!1&&(E.f=ods_to_csf_formula(unescapexml(w.formula))),(w.||w["value-type"])=="string"&&(E.t="s",E.v=unescapexml(w["string-value"]||""),n.dense?(m[k]||(m[k]=[]),m[k][D]=E):m[encode_cell({r:k,c:D})]=E),D+=de-1;else if(S[1]!=="/"){++D,T="",A=0,L=[],de=1;var X=pe?k+pe-1:k;if(D>N.e.c&&(N.e.c=D),D<N.s.c&&(N.s.c=D),k<N.s.r&&(N.s.r=k),X>N.e.r&&(N.e.r=X),w=parsexmltag(S[0],!1),I=[],M={},E={t:w.||w["value-type"],v:null},n.cellFormula)if(w.formula&&(w.formula=unescapexml(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(ne=parseInt(w["number-matrix-rows-spanned"],10)||0,oe=parseInt(w["number-matrix-columns-spanned"],10)||0,Z={s:{r:k,c:D},e:{r:k+ne-1,c:D+oe-1}},E.F=encode_range(Z),J.push([Z,E.F])),w.formula)E.f=ods_to_csf_formula(w.formula);else for(q=0;q<J.length;++q)k>=J[q][0].s.r&&k<=J[q][0].e.r&&D>=J[q][0].s.c&&D<=J[q][0].e.c&&(E.F=J[q][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(ne=parseInt(w["number-rows-spanned"],10)||0,oe=parseInt(w["number-columns-spanned"],10)||0,Z={s:{r:k,c:D},e:{r:k+ne-1,c:D+oe-1}},te.push(Z)),w["number-columns-repeated"]&&(de=parseInt(w["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=parsexmlbool(w["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(w.value);break;case"percentage":E.t="n",E.v=parseFloat(w.value);break;case"currency":E.t="n",E.v=parseFloat(w.value);break;case"date":E.t="d",E.v=parseDate(w["date-value"]),n.cellDates||(E.t="n",E.v=datenum(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=parse_isodur(w["time-value"])/86400,n.cellDates&&(E.t="d",E.v=numdate(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(w.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",w["string-value"]!=null&&(T=unescapexml(w["string-value"]),L=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(j=!1,E.t==="s"&&(E.v=T||"",L.length&&(E.R=L),j=A==0),C.Target&&(E.l=C),I.length>0&&(E.c=I,I=[]),T&&n.cellText!==!1&&(E.w=T),j&&(E.t="z",delete E.v),(!j||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=k))for(var W=0;W<pe;++W){if(de=parseInt(w["number-columns-repeated"]||"1",10),n.dense)for(m[k+W]||(m[k+W]=[]),m[k+W][D]=W==0?E:dup(E);--de>0;)m[k+W][D+de]=dup(E);else for(m[encode_cell({r:k+W,c:D})]=E;--de>0;)m[encode_cell({r:k+W,c:D+de})]=dup(E);N.e.c<=D&&(N.e.c=D)}de=parseInt(w["number-columns-repeated"]||"1",10),D+=de-1,de=0,E={},T="",L=[]}C={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((s=i.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((s=i.pop())[0]!==S[3])throw"Bad state: "+s;M.t=T,L.length&&(M.R=L),M.a=H,I.push(M)}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);H="",G=0,T="",A=0,L=[];break;case"creator":S[1]==="/"?H=a.slice(G,S.index):G=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((s=i.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);T="",A=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(z[c.name]=h,(s=i.pop())[0]!==S[3])throw"Bad state: "+s}else S[0].charAt(S[0].length-2)!=="/"&&(h="",c=parsexmltag(S[0],!1),i.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=parsexmltag(S[0],!1),h+=number_formats_ods[S[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=parsexmltag(S[0],!1),h+=number_formats_ods[S[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":o=parsexmltag(S[0],!1),O=ods_to_csf_3D(o["cell-range-address"]);var K={Name:o.name,Ref:O[0]+"!"+O[1]};F&&(K.Sheet=v.length),V.Names.push(K);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(S[1]==="/"&&(!w||!w["string-value"])){var ae=parse_text_p(a.slice(A,S.index));T=(T.length>0?T+`
`:"")+ae[0]}else parsexmltag(S[0],!1),A=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{O=ods_to_csf_3D(parsexmltag(S[0])["target-range-address"]),g[O[0]]["!autofilter"]={ref:O[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(C=parsexmltag(S[0],!1),!C.href)break;C.Target=unescapexml(C.href),delete C.href,C.Target.charAt(0)=="#"&&C.Target.indexOf(".")>-1?(O=ods_to_csf_3D(C.Target.slice(1)),C.Target="#"+O[0]+"!"+O[1]):C.Target.match(/^\.\.[\\\/]/)&&(C.Target=C.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(S)}}var U={Sheets:g,SheetNames:v,Workbook:V};return n.bookSheets&&delete U.Sheets,U}function parse_ods(e,t){t=t||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),t);var n=getzipstr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var a=parse_content_xml(utf8read(n),t);return safegetzipfile(e,"meta.xml")&&(a.Props=parse_core_props(getzipdata(e,"meta.xml"))),a}function parse_fods(e,t){return parse_content_xml(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function u8concat(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),a=0;return e.forEach(function(i){n.set(i,a),a+=i.length}),n}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,i=t+13;i>=t;--i)a=a*256+e[i];return(e[t+15]&128?-a:a)*Math.pow(10,n-6176)}function parse_varint49(e,t){var n=t?t[0]:0,a=e[n]&127;e:if(e[n++]>=128&&(a|=(e[n]&127)<<7,e[n++]<128||(a|=(e[n]&127)<<14,e[n++]<128)||(a|=(e[n]&127)<<21,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(a+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),a}function varint_to_i32(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function parse_shallow(e){for(var t=[],n=[0];n[0]<e.length;){var a=n[0],i=parse_varint49(e,n),s=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(s){case 0:{for(var h=n[0];e[n[0]++]>=128;);c=e.slice(h,n[0])}break;case 5:o=4,c=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,c=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=parse_varint49(e,n),c=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var f={data:c,type:s};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function mappa(e,t){return e?.map(function(n){return t(n.data)})||[]}function parse_iwa_file(e){for(var t,n=[],a=[0];a[0]<e.length;){var i=parse_varint49(e,a),s=parse_shallow(e.slice(a[0],a[0]+i));a[0]+=i;var o={id:varint_to_i32(s[1][0].data),messages:[]};s[2].forEach(function(c){var h=parse_shallow(c.data),f=varint_to_i32(h[3][0].data);o.messages.push({meta:h,data:e.slice(a[0],a[0]+f)}),a[0]+=f}),(t=s[3])!=null&&t[0]&&(o.merge=varint_to_i32(s[3][0].data)>>>0>0),n.push(o)}return n}function parse_snappy_chunk(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],a=parse_varint49(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[n[0]],c>1&&(o|=t[n[0]+1]<<8),c>2&&(o|=t[n[0]+2]<<16),c>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=c}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var h=0,f=0;if(s==1?(f=(t[n[0]]>>2&7)+4,h=(t[n[0]++]&224)<<3,h|=t[n[0]++]):(f=(t[n[0]++]>>2)+1,s==2?(h=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(h=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[u8concat(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(i.push(i[0].slice(-h)),f-=h;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-h,-h+f))}}var u=u8concat(i);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function decompress_iwa_file(e){for(var t=[],n=0;n<e.length;){var a=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(parse_snappy_chunk(a,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(t)}function parse_old_storage(e,t,n,a){var i=u8_to_dataview(e),s=i.getUint32(4,!0),o=(a>1?12:8)+popcnt(s&(a>1?3470:398))*4,c=-1,h=-1,f=NaN,u=new Date(2001,0,1);s&512&&(c=i.getUint32(o,!0),o+=4),o+=popcnt(s&(a>1?12288:4096))*4,s&16&&(h=i.getUint32(o,!0),o+=4),s&32&&(f=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[h]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:n[c]};else if(h>-1)p={t:"s",v:t[h]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function parse_new_storage(e,t,n){var a=u8_to_dataview(e),i=a.getUint32(8,!0),s=12,o=-1,c=-1,h=NaN,f=NaN,u=new Date(2001,0,1);i&1&&(h=readDecimal128LE(e,s),s+=16),i&2&&(f=a.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8),i&8&&(c=a.getUint32(s,!0),s+=4),i&16&&(o=a.getUint32(s,!0),s+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:h};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:n[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function parse_cell_storage(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,t,n,e[0]);case 5:return parse_new_storage(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var t=parse_shallow(e);return parse_varint49(t[1][0].data)}function parse_TST_TableDataList(e,t){var n=parse_shallow(t.data),a=varint_to_i32(n[1][0].data),i=n[3],s=[];return(i||[]).forEach(function(o){var c=parse_shallow(o.data),h=varint_to_i32(c[1][0].data)>>>0;switch(a){case 1:s[h]=u8str(c[3][0].data);break;case 8:{var f=e[parse_TSP_Reference(c[9][0].data)][0],u=parse_shallow(f.data),p=e[parse_TSP_Reference(u[1][0].data)][0],g=varint_to_i32(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=parse_shallow(p.data);s[h]=v[3].map(function(m){return u8str(m.data)}).join("")}break}}),s}function parse_TST_TileRowInfo(e,t){var n,a,i,s,o,c,h,f,u,p,g,v,m,S,E=parse_shallow(e),w=varint_to_i32(E[1][0].data)>>>0,T=varint_to_i32(E[2][0].data)>>>0,A=((a=(n=E[8])==null?void 0:n[0])==null?void 0:a.data)&&varint_to_i32(E[8][0].data)>0||!1,L,k;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&t!=0)L=(c=(o=E[7])==null?void 0:o[0])==null?void 0:c.data,k=(f=(h=E[6])==null?void 0:h[0])==null?void 0:f.data;else if((p=(u=E[4])==null?void 0:u[0])!=null&&p.data&&t!=1)L=(v=(g=E[4])==null?void 0:g[0])==null?void 0:v.data,k=(S=(m=E[3])==null?void 0:m[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=A?4:1,N=u8_to_dataview(L),Y=[],z=0;z<L.length/2;++z){var te=N.getUint16(z*2,!0);te<65535&&Y.push([z,te])}if(Y.length!=T)throw"Expected ".concat(T," cells, found ").concat(Y.length);var Z=[];for(z=0;z<Y.length-1;++z)Z[Y[z][0]]=k.subarray(Y[z][1]*D,Y[z+1][1]*D);return Y.length>=1&&(Z[Y[Y.length-1][0]]=k.subarray(Y[Y.length-1][1]*D)),{R:w,cells:Z}}function parse_TST_Tile(e,t){var n,a=parse_shallow(t.data),i=(n=a?.[7])!=null&&n[0]?varint_to_i32(a[7][0].data)>>>0>0?1:0:-1,s=mappa(a[5],function(o){return parse_TST_TileRowInfo(o,i)});return{nrows:varint_to_i32(a[4][0].data)>>>0,data:s.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(h,f){if(o[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));o[c.R][f]=h}),o},[])}}function parse_TST_TableModelArchive(e,t,n){var a,i=parse_shallow(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(varint_to_i32(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(varint_to_i32(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=encode_range(s);var o=parse_shallow(i[4][0].data),c=parse_TST_TableDataList(e,e[parse_TSP_Reference(o[4][0].data)][0]),h=(a=o[17])!=null&&a[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(o[17][0].data)][0]):[],f=parse_shallow(o[3][0].data),u=0;f[1].forEach(function(p){var g=parse_shallow(p.data),v=e[parse_TSP_Reference(g[2][0].data)][0],m=varint_to_i32(v.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var S=parse_TST_Tile(e,v);S.data.forEach(function(E,w){E.forEach(function(T,A){var L=encode_cell({r:u+w,c:A}),k=parse_cell_storage(T,c,h);k&&(n[L]=k)})}),u+=S.nrows})}function parse_TST_TableInfoArchive(e,t){var n=parse_shallow(t.data),a={"!ref":"A1"},i=e[parse_TSP_Reference(n[2][0].data)],s=varint_to_i32(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return parse_TST_TableModelArchive(e,i[0],a),a}function parse_TN_SheetArchive(e,t){var n,a=parse_shallow(t.data),i={name:(n=a[1])!=null&&n[0]?u8str(a[1][0].data):"",sheets:[]},s=mappa(a[2],parse_TSP_Reference);return s.forEach(function(o){e[o].forEach(function(c){var h=varint_to_i32(c.meta[1][0].data);h==6e3&&i.sheets.push(parse_TST_TableInfoArchive(e,c))})}),i}function parse_TN_DocumentArchive(e,t){var n=book_new(),a=parse_shallow(t.data),i=mappa(a[1],parse_TSP_Reference);if(i.forEach(function(s){e[s].forEach(function(o){var c=varint_to_i32(o.meta[1][0].data);if(c==2){var h=parse_TN_SheetArchive(e,o);h.sheets.forEach(function(f,u){book_append_sheet(n,f,u==0?h.name:h.name+"_"+u,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function parse_numbers_iwa(e){var t,n,a,i,s={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var f;try{f=decompress_iwa_file(h.content)}catch(p){return console.log("?? "+h.content.length+" "+(p.message||p))}var u;try{u=parse_iwa_file(f)}catch(p){return console.log("## "+(p.message||p))}u.forEach(function(p){s[p.id]=p.messages,o.push(p.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(a=(n=(t=s?.[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:a[1])==null?void 0:i[0].data)&&varint_to_i32(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||o.forEach(function(h){s[h].forEach(function(f){var u=varint_to_i32(f.meta[1][0].data)>>>0;if(u==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(s,c)}function fix_opts_func(e){return function(n){for(var a=0;a!=e.length;++a){var i=e[a];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,get_sheet_type(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,t,n,a,i,s,o,c,h,f,u,p){try{s[a]=parse_rels(getzipstr(e,n,!0),t);var g=getzipdata(e,t),v;switch(c){case"sheet":v=parse_ws(g,t,i,h,s[a],f,u,p);break;case"chart":if(v=parse_cs(g,t,i,h,s[a],f,u,p),!v||!v["!drawel"])break;var m=resolve_path(v["!drawel"].Target,t),S=get_rels_path(m),E=parse_drawing(getzipstr(e,m,!0),parse_rels(getzipstr(e,S,!0),m)),w=resolve_path(E,m),T=get_rels_path(w);v=parse_chart(getzipstr(e,w,!0),w,h,parse_rels(getzipstr(e,T,!0),w),f,v);break;case"macro":v=parse_ms(g,t,i,h,s[a],f,u,p);break;case"dialog":v=parse_ds(g,t,i,h,s[a],f,u,p);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=v;var A=[];s&&s[a]&&keys(s[a]).forEach(function(L){var k="";if(s[a][L].Type==RELS.CMNT){k=resolve_path(s[a][L].Target,t);var D=parse_cmnt(getzipdata(e,k,!0),k,h);if(!D||!D.length)return;sheet_insert_comments(v,D,!1)}s[a][L].Type==RELS.TCMNT&&(k=resolve_path(s[a][L].Target,t),A=A.concat(parse_tcmnt_xml(getzipdata(e,k,!0),h)))}),A&&A.length&&sheet_insert_comments(v,A,!0,h.people||[])}catch(L){if(h.WTF)throw L}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,t){if(make_ssf(),t=t||{},fix_read_opts(t),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,t);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var n=CFB.utils.cfb_new();return zipentries(e).forEach(function(le){zip_add_file(n,le,getzipbin(e,le))}),parse_numbers_iwa(n)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=zipentries(e),i=parse_ct(getzipstr(e,"[Content_Types].xml")),s=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",getzipdata(e,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!getzipdata(e,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var h={},f={};if(!t.bookSheets&&!t.bookProps){if(strs=[],i.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(i.sst)),i.sst,t)}catch(le){if(t.WTF)throw le}t.cellStyles&&i.themes.length&&(h=parse_theme(getzipstr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(f=parse_sty(getzipdata(e,strip_front_slash(i.style)),i.style,h,t))}i.links.map(function(le){try{var pe=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(le))),le);return parse_xlink(getzipdata(e,strip_front_slash(le)),pe,le,t)}catch{}});var u=parse_wb(getzipdata(e,strip_front_slash(i.workbooks[0])),i.workbooks[0],t),p={},g="";i.coreprops.length&&(g=getzipdata(e,strip_front_slash(i.coreprops[0]),!0),g&&(p=parse_core_props(g)),i.extprops.length!==0&&(g=getzipdata(e,strip_front_slash(i.extprops[0]),!0),g&&parse_ext_props(g,p,t)));var v={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(g=getzipstr(e,strip_front_slash(i.custprops[0]),!0),g&&(v=parse_cust_props(g,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(pe){return pe.name}):p.Worksheets&&p.SheetNames.length>0&&(o=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=v),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var S={};t.bookDeps&&i.calcchain&&(S=parse_cc(getzipdata(e,strip_front_slash(i.calcchain)),i.calcchain));var E=0,w={},T,A;{var L=u.Sheets;p.Worksheets=L.length,p.SheetNames=[];for(var k=0;k!=L.length;++k)p.SheetNames[k]=L[k].name}var D=s?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),Y=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");safegetzipfile(e,Y)||(Y="xl/_rels/workbook."+D+".rels");var z=parse_rels(getzipstr(e,Y,!0),Y.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=parse_people_xml(getzipdata(e,strip_front_slash(i.people[0])),t)),z&&(z=safe_parse_wbrels(z,u.Sheets));var te=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=p.Worksheets;++E){var Z="sheet";if(z&&z[E]?(T="xl/"+z[E][1].replace(/[\/]?xl\//,""),safegetzipfile(e,T)||(T=z[E][1]),safegetzipfile(e,T)||(T=Y.replace(/_rels\/.*$/,"")+z[E][1]),Z=z[E][2]):(T="xl/worksheets/sheet"+(E+1-te)+"."+D,T=T.replace(/sheet0\./,"sheet.")),A=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(p.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ne=!1,oe=0;oe!=t.sheets.length;++oe)typeof t.sheets[oe]=="number"&&t.sheets[oe]==E&&(ne=1),typeof t.sheets[oe]=="string"&&t.sheets[oe].toLowerCase()==p.SheetNames[E].toLowerCase()&&(ne=1);if(!ne)continue e}}safe_parse_sheet(e,T,A,p.SheetNames[E],E,w,o,Z,t,u,h,f)}return m={Directory:i,Workbook:u,Props:p,Custprops:v,Deps:S,Sheets:o,SheetNames:p.SheetNames,Strings:strs,Styles:f,Themes:h,SSF:dup(table_fmt)},t&&t.bookFiles&&(e.files?(m.keys=a,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(le,pe){le=le.replace(/^Root Entry[\/]/,""),m.keys.push(le),m.files[le]=e.FileIndex[pe]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=getzipdata(e,strip_front_slash(i.vba[0]),!0):i.defaults&&i.defaults.bin===CT_VBA&&(m.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),m}function parse_xlsxcfb(e,t){var n=t||{},a="Workbook",i=CFB.find(e,a);try{if(a="/!DataSpaces/Version",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(parse_DataSpaceVersionInfo(i.content),a="/!DataSpaces/DataSpaceMap",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=parse_DataSpaceMap(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=parse_DataSpaceDefinition(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);parse_Primary(i.content)}catch{}if(a="/EncryptionInfo",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=parse_EncryptionInfo(i.content);if(a="/EncryptedPackage",i=CFB.find(e,a),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function firstbyte(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Base64_decode(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function read_cfb(e,t){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,t):parse_xlscfb(e,t)}function read_zip(e,t){var n,a=e,i=t||{};return i.type||(i.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),n=zip_read(a,i),parse_zip(n,i)}function read_plaintext(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return parse_xlml(e.slice(n),t);default:break e}return PRN.to_workbook(e,t)}function read_plaintext_raw(e,t){var n="",a=firstbyte(e,t);switch(t.type){case"base64":n=Base64_decode(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=cc2str(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(n=utf8read(n)),t.type="binary",read_plaintext(n,t)}function read_utf16(e,t){var n=e;return t.type=="base64"&&(n=Base64_decode(n)),n=$cptable.utils.decode(1200,n.slice(2),"str"),t.type="binary",read_plaintext(n,t)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,t,n,a){return a?(n.type="string",PRN.to_workbook(e,n)):PRN.to_workbook(t,n)}function readSync(e,t){reset_cp();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(n=dup(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var a=e,i=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),_ssfopts={},n.dateNF&&(_ssfopts.dateNF=n.dateNF),n.type||(n.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=has_buf?"buffer":"binary",a=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,a=bstrify(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return n=dup(n),n.type="array",readSync(ab2a(a),n)}switch((i=firstbyte(a,n))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return read_cfb(CFB.read(a,n),n);break;case 9:if(i[1]<=8)return parse_xlscfb(a,n);break;case 60:return parse_xlml(a,n);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return read_wb_ID(a,n);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DIF.to_workbook(a,n);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?read_zip(a,n):read_prn(e,a,n,s);case 239:return i[3]===60?parse_xlml(a,n):read_prn(e,a,n,s);case 255:if(i[1]===254)return read_utf16(a,n);if(i[1]===0&&i[2]===2&&i[3]===0)return WK_.to_workbook(a,n);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return WK_.to_workbook(a,n);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(a,n);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return RTF.to_workbook(a,n);break;case 10:case 13:case 32:return read_plaintext_raw(a,n);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?DBF.to_workbook(a,n):read_prn(e,a,n,s)}function make_json_row(e,t,n,a,i,s,o,c){var h=encode_row(n),f=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:n,enumerable:!1})}catch{g.__rowNum__=n}else g.__rowNum__=n;if(!o||e[n])for(var v=t.s.c;v<=t.e.c;++v){var m=o?e[n][v]:e[a[v]+h];if(m===void 0||m.t===void 0){if(f===void 0)continue;s[v]!=null&&(g[s[v]]=f);continue}var S=m.v;switch(m.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[v]!=null){if(S==null)if(m.t=="e"&&S===null)g[s[v]]=null;else if(f!==void 0)g[s[v]]=f;else if(u&&S===null)g[s[v]]=null;else continue;else g[s[v]]=u&&(m.t!=="n"||m.t==="n"&&c.rawNumbers!==!1)?S:format_cell(m,S,c);S!=null&&(p=!1)}}return{row:g,isempty:p}}function sheet_to_json(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},a=0,i=1,s=[],o=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},u=f.range!=null?f.range:e["!ref"];switch(f.header===1?a=1:f.header==="A"?a=2:Array.isArray(f.header)?a=3:f.header==null&&(a=0),typeof u){case"string":h=safe_decode_range(u);break;case"number":h=safe_decode_range(e["!ref"]),h.s.r=u;break;default:h=u}a>0&&(i=0);var p=encode_row(h.s.r),g=[],v=[],m=0,S=0,E=Array.isArray(e),w=h.s.r,T=0,A={};E&&!e[w]&&(e[w]=[]);var L=f.skipHidden&&e["!cols"]||[],k=f.skipHidden&&e["!rows"]||[];for(T=h.s.c;T<=h.e.c;++T)if(!(L[T]||{}).hidden)switch(g[T]=encode_col(T),n=E?e[w][T]:e[g[T]+p],a){case 1:s[T]=T-h.s.c;break;case 2:s[T]=g[T];break;case 3:s[T]=f.header[T-h.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=format_cell(n,null,f),S=A[o]||0,!S)A[o]=1;else{do c=o+"_"+S++;while(A[c]);A[o]=S,A[c]=1}s[T]=c}for(w=h.s.r+i;w<=h.e.r;++w)if(!(k[w]||{}).hidden){var D=make_json_row(e,h,w,g,a,s,E,f);(D.isempty===!1||(a===1?f.blankrows!==!1:f.blankrows))&&(v[m++]=D.row)}return v.length=m,v}var qreg=/"/g;function make_csv_row(e,t,n,a,i,s,o,c){for(var h=!0,f=[],u="",p=encode_row(n),g=t.s.c;g<=t.e.c;++g)if(a[g]){var v=c.dense?(e[n]||[])[g]:e[a[g]+p];if(v==null)u="";else if(v.v!=null){h=!1,u=""+(c.rawNumbers&&v.t=="n"?v.v:format_cell(v,null,c));for(var m=0,S=0;m!==u.length;++m)if((S=u.charCodeAt(m))===i||S===s||S===34||c.forceQuotes){u='"'+u.replace(qreg,'""')+'"';break}u=="ID"&&(u='"ID"')}else v.f!=null&&!v.F?(h=!1,u="="+v.f,u.indexOf(",")>=0&&(u='"'+u.replace(qreg,'""')+'"')):u="";f.push(u)}return c.blankrows===!1&&h?null:f.join(o)}function sheet_to_csv(e,t){var n=[],a=t??{};if(e==null||e["!ref"]==null)return"";var i=safe_decode_range(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,h=c.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),u="",p=[];a.dense=Array.isArray(e);for(var g=a.skipHidden&&e["!cols"]||[],v=a.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(g[m]||{}).hidden||(p[m]=encode_col(m));for(var S=0,E=i.s.r;E<=i.e.r;++E)(v[E]||{}).hidden||(u=make_csv_row(e,i,E,p,o,h,s,a),u!=null&&(a.strip&&(u=u.replace(f,"")),(u||a.blankrows!==!1)&&n.push((S++?c:"")+u)));return delete a.dense,n.join("")}function sheet_to_txt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=sheet_to_csv(e,t);return n}function sheet_to_formulae(e){var t="",n,a="";if(e==null||e["!ref"]==null)return[];var i=safe_decode_range(e["!ref"]),s="",o=[],c,h=[],f=Array.isArray(e);for(c=i.s.c;c<=i.e.c;++c)o[c]=encode_col(c);for(var u=i.s.r;u<=i.e.r;++u)for(s=encode_row(u),c=i.s.c;c<=i.e.c;++c)if(t=o[c]+s,n=f?(e[u]||[])[c]:e[t],a="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;a=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)a=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}h[h.length]=t+"="+a}return h}function sheet_add_json(e,t,n){var a=n||{},i=+!a.skipHeader,s=e||{},o=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?decode_cell(a.origin):a.origin;o=h.r,c=h.c}var f,u={s:{c:0,r:0},e:{c,r:o+t.length-1+i}};if(s["!ref"]){var p=safe_decode_range(s["!ref"]);u.e.c=Math.max(u.e.c,p.e.c),u.e.r=Math.max(u.e.r,p.e.r),o==-1&&(o=p.e.r+1,u.e.r=o+t.length-1+i)}else o==-1&&(o=0,u.e.r=t.length-1+i);var g=a.header||[],v=0;t.forEach(function(S,E){keys(S).forEach(function(w){(v=g.indexOf(w))==-1&&(g[v=g.length]=w);var T=S[w],A="z",L="",k=encode_cell({c:c+v,r:o+E+i});f=ws_get_cell_stub(s,k),T&&typeof T=="object"&&!(T instanceof Date)?s[k]=T:(typeof T=="number"?A="n":typeof T=="boolean"?A="b":typeof T=="string"?A="s":T instanceof Date?(A="d",a.cellDates||(A="n",T=datenum(T)),L=a.dateNF||table_fmt[14]):T===null&&a.nullError&&(A="e",T=0),f?(f.t=A,f.v=T,delete f.w,delete f.R,L&&(f.z=L)):s[k]=f={t:A,v:T},L&&(f.z=L))})}),u.e.c=Math.max(u.e.c,c+g.length-1);var m=encode_row(o);if(i)for(v=0;v<g.length;++v)s[encode_col(v+c)+m]={t:"s",v:g[v]};return s["!ref"]=encode_range(u),s}function json_to_sheet(e,t){return sheet_add_json(null,e,t)}function ws_get_cell_stub(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var a=decode_cell(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ws_get_cell_stub(e,encode_cell(t)):ws_get_cell_stub(e,encode_cell({r:t,c:n||0}))}function wb_sheet_idx(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,t,n,a){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(check_ws_name(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function book_set_sheet_visibility(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=wb_sheet_idx(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[a].Hidden=n}function cell_set_number_format(e,t){return e.z=t,e}function cell_set_hyperlink(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function cell_set_internal_link(e,t,n){return cell_set_hyperlink(e,"#"+t,n)}function cell_add_comment(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function sheet_set_array_formula(e,t,n,a){for(var i=typeof t!="string"?t:safe_decode_range(t),s=typeof t=="string"?t:encode_range(t),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var h=ws_get_cell_stub(e,o,c);h.t="n",h.F=s,delete h.v,o==i.s.r&&c==i.s.c&&(h.f=n,a&&(h.D=!0))}return e}var utils$2={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function checkFusionSolarPeriod(e){try{const t=e.name.split(".").pop().toLowerCase(),n=await e.arrayBuffer(),a=console.error;console.error=(...le)=>{typeof le[0]=="string"&&le[0].includes("Bad uncompressed size")||a(...le)};let i;try{i=t==="csv"?readSync(await new Response(n).text(),{type:"string"}):readSync(n,{type:"array"})}finally{console.error=a}const s=i.Sheets[i.SheetNames[0]],o=utils$2.sheet_to_json(s,{header:1,defval:""});if(!o?.length)throw new Error("Empty or invalid file.");const c=le=>String(le||"").replace(/\s+/g,"").replace(/[^\w()/%\-]/g,"").toLowerCase(),h=["time","timestamp","","thigian","starttime"],f=["totalyield","totalenergy","","annualenergy(kwh)"],u=["manageobject","inverter",""];let p=-1;for(let le=0;le<Math.min(o.length,30);le++){const pe=o[le].map(c);if(pe.some(de=>h.some(J=>de.includes(J)))&&pe.some(de=>u.some(J=>de.includes(J)))){p=le;break}}if(p===-1)throw new Error("Header not found.");const g=o[p],v=g.map(c),m=o.slice(p+1),S=v.findIndex(le=>h.some(pe=>le.includes(pe))),E=v.findIndex(le=>u.some(pe=>le.includes(pe))),w=v.findIndex(le=>f.some(pe=>le.includes(pe)));if(S===-1||E===-1)throw new Error("Missing Time or Inverter column.");const T=le=>{if(le==null||le==="")return null;if(typeof le=="number"){const J=Math.round((le-25569)*86400*1e3),V=new Date(J);return isNaN(V)?null:V}const pe=String(le).trim(),de=new Date(pe);return isNaN(de)?null:de},A=le=>`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}-${String(le.getDate()).padStart(2,"0")}`,L=le=>{if(le==null||le==="")return NaN;let pe=String(le).replace(/[^\d.,\-]/g,"").trim();if(!pe)return NaN;const de=(pe.match(/,/g)||[]).length,J=(pe.match(/\./g)||[]).length;de>0&&J>0?pe=pe.replace(/\./g,"").replace(",","."):de>0&&J===0&&(pe=pe.replace(",","."));const V=parseFloat(pe);return isNaN(V)?NaN:V},k=[],D=new Map;for(const le of m){const pe=T(le[S]);if(!pe)continue;const de=String(le[E]||"Unknown").trim(),J=A(pe),V={time:pe.toISOString(),day:J,inverter:de};g.forEach((O,I)=>{if(I===S||I===E)return;const M=le[I],H=L(M);isNaN(H)?typeof M=="string"&&M.trim()!==""&&(V[g[I].trim()]=M.trim()):V[g[I].trim()]=H}),k.push(V);const C=L(le[w]);if(!isNaN(C)){D.has(de)||D.set(de,new Map);const O=D.get(de);O.has(J)||O.set(J,[]),O.get(J).push(C)}}const N=new Map;for(const[,le]of D.entries())for(const[pe,de]of le.entries()){const J=Math.max(0,Math.max(...de)-Math.min(...de));N.set(pe,(N.get(pe)||0)+J)}const Y=Array.from(N.keys()).sort();if(!Y.length)return{valid:!1,message:"No valid data rows.",totalProduction:0,dailyProduction:[],records:[]};const z=Y[0],te=Y[Y.length-1],Z=Math.round((new Date(te)-new Date(z))/864e5)+1,ne=Math.round([...N.values()].reduce((le,pe)=>le+pe,0)),oe=new Set;return k.forEach(le=>{Object.keys(le).forEach(pe=>{["time","day","inverter"].includes(pe)||oe.add(pe)})}),console.log(" Sample parsed record:",k[0]),{valid:Z<=31,startDate:z,endDate:te,days:Z,totalProduction:ne,dailyProduction:Y.map(le=>({date:le,production:Math.round(N.get(le))})),records:k,availableMetrics:Array.from(oe),message:` OK  ${Z} days (${z}  ${te}), metrics: ${oe.size}`}}catch(t){return console.error(" FusionSolar parse error:",t),{valid:!1,message:"Error parsing file",totalProduction:0,dailyProduction:[],records:[]}}}pdfExports.GlobalWorkerOptions.workerSrc=pdfjsWorker;async function readPDFText(e){const t=await pdfExports.getDocument({data:await e.arrayBuffer()}).promise;let n="";for(let a=1;a<=Math.min(t.numPages,3);a++){const s=await(await t.getPage(a)).getTextContent();n+=s.items.map(o=>o.str).join(" ")+`
`}return n.replace(/\s+/g," ").trim()}function FileCheckModal({open:e,logFile:t,pvsystFile:n,onClose:a,onNext:i}){const[s,o]=reactExports.useState(!1),[c,h]=reactExports.useState(null),[f,u]=reactExports.useState(null);if(reactExports.useEffect(()=>{e&&(async()=>{o(!0);let g=null,v=null;try{t&&(g=await checkFusionSolarPeriod(t))}catch{g={valid:!1,message:"Error reading log file"}}if(n)try{const m=await readPDFText(n),S=/Simulation|PVSystem|Report|Project/i.test(m);v={valid:S,message:S?"PVSyst PDF detected":"Invalid or unreadable PDF"}}catch{v={valid:!1,message:"Error parsing PDF"}}h(g),u(v),o(!1)})()},[e,t,n]),!e)return null;const p=c?.valid;return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg p-6 text-gray-800",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-700",children:"Checking Uploaded File(s)"}),jsxRuntimeExports.jsxs("div",{className:"space-y-3 mb-4",children:[jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 rounded-xl p-3 bg-gray-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-700 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"truncate",children:[" Log File: ",t?.name||""]}),jsxRuntimeExports.jsx("span",{children:s?"":c?.valid?"":""})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`${s?"bg-blue-500 animate-pulse":c?.valid?"bg-green-500":"bg-red-500"} h-full`,style:{width:s?"70%":"100%"}})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s?"Parsing log...":c?.startDate&&c?.endDate?`OK  ${c.days} days (${c.startDate}  ${c.endDate})`:c?.message||"Waiting..."})]}),n&&jsxRuntimeExports.jsxs("div",{className:"border border-gray-200 rounded-xl p-3 bg-gray-50",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-700 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"truncate",children:[" PVSyst File: ",n?.name]}),jsxRuntimeExports.jsx("span",{children:s?"":f?.valid?"":""})]}),jsxRuntimeExports.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:`${s?"bg-amber-500 animate-pulse":f?.valid?"bg-green-500":"bg-red-500"} h-full`,style:{width:s?"70%":"100%"}})}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s?"Checking PDF...":f?.message||"Waiting..."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-end gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:a,disabled:s,className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-600 hover:bg-gray-100",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:()=>i({...c,pvsystOK:!!f?.valid}),disabled:!p||s,className:`px-5 py-2 rounded-lg font-medium text-white shadow-md transition-all ${p&&!s?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:s?"Checking...":"Next  Confirm Info"})]})]})})}function bind(e,t){return function(){return e.apply(t,arguments)}}const{toString:toString$2}=Object.prototype,{getPrototypeOf:getPrototypeOf$1}=Object,{iterator,toStringTag}=Symbol,kindOf=(e=>t=>{const n=toString$2.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=e=>(e=e.toLowerCase(),t=>kindOf(t)===e),typeOfTest=e=>t=>typeof t===e,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&isFunction$1(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&isArrayBuffer(e.buffer),t}const isString=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$1=e=>e!==null&&typeof e=="object",isBoolean$1=e=>e===!0||e===!1,isPlainObject$2=e=>{if(kindOf(e)!=="object")return!1;const t=getPrototypeOf$1(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(toStringTag in e)&&!(iterator in e)},isEmptyObject=e=>{if(!isObject$1(e)||isBuffer(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject$1(e)&&isFunction$1(e.pipe),isFormData=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||isFunction$1(e.append)&&((t=kindOf(e))==="formdata"||t==="object"&&isFunction$1(e.toString)&&e.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let a,i;if(typeof e!="object"&&(e=[e]),isArray(e))for(a=0,i=e.length;a<i;a++)t.call(null,e[a],a,e);else{if(isBuffer(e))return;const s=n?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let c;for(a=0;a<o;a++)c=s[a],t.call(null,e[c],c,e)}}function findKey(e,t){if(isBuffer(e))return null;t=t.toLowerCase();const n=Object.keys(e);let a=n.length,i;for(;a-- >0;)if(i=n[a],t===i.toLowerCase())return i;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=e=>!isUndefined(e)&&e!==_global;function merge(){const{caseless:e,skipUndefined:t}=isContextDefined(this)&&this||{},n={},a=(i,s)=>{const o=e&&findKey(n,s)||s;isPlainObject$2(n[o])&&isPlainObject$2(i)?n[o]=merge(n[o],i):isPlainObject$2(i)?n[o]=merge({},i):isArray(i)?n[o]=i.slice():(!t||!isUndefined(i))&&(n[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&forEach(arguments[i],a);return n}const extend$1=(e,t,n,{allOwnKeys:a}={})=>(forEach(t,(i,s)=>{n&&isFunction$1(i)?e[s]=bind(i,n):e[s]=i},{allOwnKeys:a}),e),stripBOM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits=(e,t,n,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject=(e,t,n,a)=>{let i,s,o;const c={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!a||a(o,e,t))&&!c[o]&&(t[o]=e[o],c[o]=!0);e=n!==!1&&getPrototypeOf$1(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},endsWith=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const a=e.indexOf(t,n);return a!==-1&&a===n},toArray$1=e=>{if(!e)return null;if(isArray(e))return e;let t=e.length;if(!isNumber$1(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},isTypedArray$1=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&getPrototypeOf$1(Uint8Array)),forEachEntry=(e,t)=>{const a=(e&&e[iterator]).call(e);let i;for(;(i=a.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},matchAll=(e,t)=>{let n;const a=[];for(;(n=e.exec(t))!==null;)a.push(n);return a},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,a,i){return a.toUpperCase()+i}),hasOwnProperty=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),a={};forEach(n,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(a[s]=o||i)}),Object.defineProperties(e,a)},freezeMethods=e=>{reduceDescriptors(e,(t,n)=>{if(isFunction$1(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const a=e[n];if(isFunction$1(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},toObjectSet=(e,t)=>{const n={},a=i=>{i.forEach(s=>{n[s]=!0})};return isArray(e)?a(e):a(String(e).split(t)),n},noop$6=()=>{},toFiniteNumber=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function isSpecCompliantForm(e){return!!(e&&isFunction$1(e.append)&&e[toStringTag]==="FormData"&&e[iterator])}const toJSONObject=e=>{const t=new Array(10),n=(a,i)=>{if(isObject$1(a)){if(t.indexOf(a)>=0)return;if(isBuffer(a))return a;if(!("toJSON"in a)){t[i]=a;const s=isArray(a)?[]:{};return forEach(a,(o,c)=>{const h=n(o,i+1);!isUndefined(h)&&(s[c]=h)}),t[i]=void 0,s}}return a};return n(e,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=e=>e&&(isObject$1(e)||isFunction$1(e))&&isFunction$1(e.then)&&isFunction$1(e.catch),_setImmediate=((e,t)=>e?setImmediate:t?((n,a)=>(_global.addEventListener("message",({source:i,data:s})=>{i===_global&&s===n&&a.length&&a.shift()()},!1),i=>{a.push(i),_global.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",isFunction$1(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,isIterable=e=>e!=null&&isFunction$1(e[iterator]),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber:isNumber$1,isBoolean:isBoolean$1,isObject:isObject$1,isPlainObject:isPlainObject$2,isEmptyObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray:isTypedArray$1,isFileList,forEach,merge,extend:extend$1,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$6,toFiniteNumber,findKey,global:_global,isContextDefined,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap,isIterable};function AxiosError$1(e,t,n,a,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),a&&(this.request=a),i&&(this.response=i,this.status=i.status?i.status:null)}utils$1.inherits(AxiosError$1,Error,{toJSON:function e(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}});Object.defineProperties(AxiosError$1,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError$1.from=(e,t,n,a,i,s)=>{const o=Object.create(prototype$1);utils$1.toFlatObject(e,o,function(u){return u!==Error.prototype},f=>f!=="isAxiosError");const c=e&&e.message?e.message:"Error",h=t==null&&e?e.code:t;return AxiosError$1.call(o,c,h,n,a,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const httpAdapter=null;function isVisitable(e){return utils$1.isPlainObject(e)||utils$1.isArray(e)}function removeBrackets(e){return utils$1.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,t,n){return e?e.concat(t).map(function(i,s){return i=removeBrackets(i),!n&&s?"["+i+"]":i}).join(n?".":""):t}function isFlatArray(e){return utils$1.isArray(e)&&!e.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function e(t){return/^is[A-Z]/.test(t)});function toFormData$1(e,t,n){if(!utils$1.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=utils$1.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,E){return!utils$1.isUndefined(E[S])});const a=n.metaTokens,i=n.visitor||u,s=n.dots,o=n.indexes,h=(n.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(t);if(!utils$1.isFunction(i))throw new TypeError("visitor must be a function");function f(m){if(m===null)return"";if(utils$1.isDate(m))return m.toISOString();if(utils$1.isBoolean(m))return m.toString();if(!h&&utils$1.isBlob(m))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(m)||utils$1.isTypedArray(m)?h&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,S,E){let w=m;if(m&&!E&&typeof m=="object"){if(utils$1.endsWith(S,"{}"))S=a?S:S.slice(0,-2),m=JSON.stringify(m);else if(utils$1.isArray(m)&&isFlatArray(m)||(utils$1.isFileList(m)||utils$1.endsWith(S,"[]"))&&(w=utils$1.toArray(m)))return S=removeBrackets(S),w.forEach(function(A,L){!(utils$1.isUndefined(A)||A===null)&&t.append(o===!0?renderKey([S],L,s):o===null?S:S+"[]",f(A))}),!1}return isVisitable(m)?!0:(t.append(renderKey(E,S,s),f(m)),!1)}const p=[],g=Object.assign(predicates,{defaultVisitor:u,convertValue:f,isVisitable});function v(m,S){if(!utils$1.isUndefined(m)){if(p.indexOf(m)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(m),utils$1.forEach(m,function(w,T){(!(utils$1.isUndefined(w)||w===null)&&i.call(t,w,utils$1.isString(T)?T.trim():T,S,g))===!0&&v(w,S?S.concat(T):[T])}),p.pop()}}if(!utils$1.isObject(e))throw new TypeError("data must be an object");return v(e),t}function encode$1(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function AxiosURLSearchParams(e,t){this._pairs=[],e&&toFormData$1(e,this,t)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function e(t,n){this._pairs.push([t,n])};prototype.toString=function e(t){const n=t?function(a){return t.call(this,a,encode$1)}:encode$1;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function buildURL(e,t,n){if(!t)return e;const a=n&&n.encode||encode;utils$1.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(i?s=i(t,n):s=utils$1.isURLSearchParams(t)?t.toString():new AxiosURLSearchParams(t,n).toString(a),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class InterceptorManager{constructor(){this.handlers=[]}use(t,n,a){return this.handlers.push({fulfilled:t,rejected:n,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){utils$1.forEach(this.handlers,function(a){a!==null&&t(a)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(e,t){return toFormData$1(e,new platform.classes.URLSearchParams,{visitor:function(n,a,i,s){return platform.isNode&&utils$1.isBuffer(n)?(this.append(a,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function parsePropPath(e){return utils$1.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function arrayToObject(e){const t={},n=Object.keys(e);let a;const i=n.length;let s;for(a=0;a<i;a++)s=n[a],t[s]=e[s];return t}function formDataToJSON(e){function t(n,a,i,s){let o=n[s++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),h=s>=n.length;return o=!o&&utils$1.isArray(i)?i.length:o,h?(utils$1.hasOwnProp(i,o)?i[o]=[i[o],a]:i[o]=a,!c):((!i[o]||!utils$1.isObject(i[o]))&&(i[o]=[]),t(n,a,i[o],s)&&utils$1.isArray(i[o])&&(i[o]=arrayToObject(i[o])),!c)}if(utils$1.isFormData(e)&&utils$1.isFunction(e.entries)){const n={};return utils$1.forEachEntry(e,(a,i)=>{t(parsePropPath(a),i,n,0)}),n}return null}function stringifySafely(e,t,n){if(utils$1.isString(e))try{return(t||JSON.parse)(e),utils$1.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(n||JSON.stringify)(e)}const defaults$1={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function e(t,n){const a=n.getContentType()||"",i=a.indexOf("application/json")>-1,s=utils$1.isObject(t);if(s&&utils$1.isHTMLForm(t)&&(t=new FormData(t)),utils$1.isFormData(t))return i?JSON.stringify(formDataToJSON(t)):t;if(utils$1.isArrayBuffer(t)||utils$1.isBuffer(t)||utils$1.isStream(t)||utils$1.isFile(t)||utils$1.isBlob(t)||utils$1.isReadableStream(t))return t;if(utils$1.isArrayBufferView(t))return t.buffer;if(utils$1.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(s){if(a.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(t,this.formSerializer).toString();if((c=utils$1.isFileList(t))||a.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return toFormData$1(c?{"files[]":t}:t,h&&new h,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),stringifySafely(t)):t}],transformResponse:[function e(t){const n=this.transitional||defaults$1.transitional,a=n&&n.forcedJSONParsing,i=this.responseType==="json";if(utils$1.isResponse(t)||utils$1.isReadableStream(t))return t;if(t&&utils$1.isString(t)&&(a&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(c){if(o)throw c.name==="SyntaxError"?AxiosError$1.from(c,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function e(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],e=>{defaults$1.headers[e]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=e=>{const t={};let n,a,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),a=o.substring(i+1).trim(),!(!n||t[n]&&ignoreDuplicateOf[n])&&(n==="set-cookie"?t[n]?t[n].push(a):t[n]=[a]:t[n]=t[n]?t[n]+", "+a:a)}),t},$internals=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return e===!1||e==null?e:utils$1.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=n.exec(e);)t[a[1]]=a[2];return t}const isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,t,n,a,i){if(utils$1.isFunction(a))return a.call(this,t,n);if(i&&(t=n),!!utils$1.isString(t)){if(utils$1.isString(a))return t.indexOf(a)!==-1;if(utils$1.isRegExp(a))return a.test(t)}}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,a)=>n.toUpperCase()+a)}function buildAccessors(e,t){const n=utils$1.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+n,{value:function(i,s,o){return this[a].call(this,t,i,s,o)},configurable:!0})})}let AxiosHeaders$1=class{constructor(t){t&&this.set(t)}set(t,n,a){const i=this;function s(c,h,f){const u=normalizeHeader(h);if(!u)throw new Error("header name must be a non-empty string");const p=utils$1.findKey(i,u);(!p||i[p]===void 0||f===!0||f===void 0&&i[p]!==!1)&&(i[p||h]=normalizeValue(c))}const o=(c,h)=>utils$1.forEach(c,(f,u)=>s(f,u,h));if(utils$1.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(utils$1.isString(t)&&(t=t.trim())&&!isValidHeaderName(t))o(parseHeaders(t),n);else if(utils$1.isObject(t)&&utils$1.isIterable(t)){let c={},h,f;for(const u of t){if(!utils$1.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[f=u[0]]=(h=c[f])?utils$1.isArray(h)?[...h,u[1]]:[h,u[1]]:u[1]}o(c,n)}else t!=null&&s(n,t,a);return this}get(t,n){if(t=normalizeHeader(t),t){const a=utils$1.findKey(this,t);if(a){const i=this[a];if(!n)return i;if(n===!0)return parseTokens(i);if(utils$1.isFunction(n))return n.call(this,i,a);if(utils$1.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=normalizeHeader(t),t){const a=utils$1.findKey(this,t);return!!(a&&this[a]!==void 0&&(!n||matchHeaderValue(this,this[a],a,n)))}return!1}delete(t,n){const a=this;let i=!1;function s(o){if(o=normalizeHeader(o),o){const c=utils$1.findKey(a,o);c&&(!n||matchHeaderValue(a,a[c],c,n))&&(delete a[c],i=!0)}}return utils$1.isArray(t)?t.forEach(s):s(t),i}clear(t){const n=Object.keys(this);let a=n.length,i=!1;for(;a--;){const s=n[a];(!t||matchHeaderValue(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const n=this,a={};return utils$1.forEach(this,(i,s)=>{const o=utils$1.findKey(a,s);if(o){n[o]=normalizeValue(i),delete n[s];return}const c=t?formatHeader(s):String(s).trim();c!==s&&delete n[s],n[c]=normalizeValue(i),a[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return utils$1.forEach(this,(a,i)=>{a!=null&&a!==!1&&(n[i]=t&&utils$1.isArray(a)?a.join(", "):a)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const a=new this(t);return n.forEach(i=>a.set(i)),a}static accessor(t){const a=(this[$internals]=this[$internals]={accessors:{}}).accessors,i=this.prototype;function s(o){const c=normalizeHeader(o);a[c]||(buildAccessors(i,o),a[c]=!0)}return utils$1.isArray(t)?t.forEach(s):s(t),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders$1.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[n]=a}}});utils$1.freezeMethods(AxiosHeaders$1);function transformData(e,t){const n=this||defaults$1,a=t||n,i=AxiosHeaders$1.from(a.headers);let s=a.data;return utils$1.forEach(e,function(c){s=c.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function isCancel$1(e){return!!(e&&e.__CANCEL__)}function CanceledError$1(e,t,n){AxiosError$1.call(this,e??"canceled",AxiosError$1.ERR_CANCELED,t,n),this.name="CanceledError"}utils$1.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(e,t,n){const a=n.config.validateStatus;!n.status||!a||a(n.status)?e(n):t(new AxiosError$1("Request failed with status code "+n.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function parseProtocol(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function speedometer(e,t){e=e||10;const n=new Array(e),a=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(h){const f=Date.now(),u=a[s];o||(o=f),n[i]=h,a[i]=f;let p=s,g=0;for(;p!==i;)g+=n[p++],p=p%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),f-o<t)return;const v=u&&f-u;return v?Math.round(g*1e3/v):void 0}}function throttle$3(e,t){let n=0,a=1e3/t,i,s;const o=(f,u=Date.now())=>{n=u,i=null,s&&(clearTimeout(s),s=null),e(...f)};return[(...f)=>{const u=Date.now(),p=u-n;p>=a?o(f,u):(i=f,s||(s=setTimeout(()=>{s=null,o(i)},a-p)))},()=>i&&o(i)]}const progressEventReducer=(e,t,n=3)=>{let a=0;const i=speedometer(50,250);return throttle$3(s=>{const o=s.loaded,c=s.lengthComputable?s.total:void 0,h=o-a,f=i(h),u=o<=c;a=o;const p={loaded:o,total:c,progress:c?o/c:void 0,bytes:h,rate:f||void 0,estimated:f&&c&&u?(c-o)/f:void 0,event:s,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(p)},n)},progressEventDecorator=(e,t)=>{const n=e!=null;return[a=>t[0]({lengthComputable:n,total:e,loaded:a}),t[1]]},asyncDecorator=e=>(...t)=>utils$1.asap(()=>e(...t)),isURLSameOrigin=platform.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,platform.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(platform.origin),platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent)):()=>!0,cookies=platform.hasStandardBrowserEnv?{write(e,t,n,a,i,s,o){if(typeof document>"u")return;const c=[`${e}=${encodeURIComponent(t)}`];utils$1.isNumber(n)&&c.push(`expires=${new Date(n).toUTCString()}`),utils$1.isString(a)&&c.push(`path=${a}`),utils$1.isString(i)&&c.push(`domain=${i}`),s===!0&&c.push("secure"),utils$1.isString(o)&&c.push(`SameSite=${o}`),document.cookie=c.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function buildFullPath(e,t,n){let a=!isAbsoluteURL(t);return e&&(a||n==!1)?combineURLs(e,t):t}const headersToObject=e=>e instanceof AxiosHeaders$1?{...e}:e;function mergeConfig$1(e,t){t=t||{};const n={};function a(f,u,p,g){return utils$1.isPlainObject(f)&&utils$1.isPlainObject(u)?utils$1.merge.call({caseless:g},f,u):utils$1.isPlainObject(u)?utils$1.merge({},u):utils$1.isArray(u)?u.slice():u}function i(f,u,p,g){if(utils$1.isUndefined(u)){if(!utils$1.isUndefined(f))return a(void 0,f,p,g)}else return a(f,u,p,g)}function s(f,u){if(!utils$1.isUndefined(u))return a(void 0,u)}function o(f,u){if(utils$1.isUndefined(u)){if(!utils$1.isUndefined(f))return a(void 0,f)}else return a(void 0,u)}function c(f,u,p){if(p in t)return a(f,u);if(p in e)return a(void 0,f)}const h={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(f,u,p)=>i(headersToObject(f),headersToObject(u),p,!0)};return utils$1.forEach(Object.keys({...e,...t}),function(u){const p=h[u]||i,g=p(e[u],t[u],u);utils$1.isUndefined(g)&&p!==c||(n[u]=g)}),n}const resolveConfig=e=>{const t=mergeConfig$1({},e);let{data:n,withXSRFToken:a,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:c}=t;if(t.headers=o=AxiosHeaders$1.from(o),t.url=buildURL(buildFullPath(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),utils$1.isFormData(n)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(utils$1.isFunction(n.getHeaders)){const h=n.getHeaders(),f=["content-type","content-length"];Object.entries(h).forEach(([u,p])=>{f.includes(u.toLowerCase())&&o.set(u,p)})}}if(platform.hasStandardBrowserEnv&&(a&&utils$1.isFunction(a)&&(a=a(t)),a||a!==!1&&isURLSameOrigin(t.url))){const h=i&&s&&cookies.read(s);h&&o.set(i,h)}return t},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(e){return new Promise(function(n,a){const i=resolveConfig(e);let s=i.data;const o=AxiosHeaders$1.from(i.headers).normalize();let{responseType:c,onUploadProgress:h,onDownloadProgress:f}=i,u,p,g,v,m;function S(){v&&v(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let E=new XMLHttpRequest;E.open(i.method.toUpperCase(),i.url,!0),E.timeout=i.timeout;function w(){if(!E)return;const A=AxiosHeaders$1.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),k={data:!c||c==="text"||c==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:A,config:e,request:E};settle(function(N){n(N),S()},function(N){a(N),S()},k),E=null}"onloadend"in E?E.onloadend=w:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(w)},E.onabort=function(){E&&(a(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,e,E)),E=null)},E.onerror=function(L){const k=L&&L.message?L.message:"Network Error",D=new AxiosError$1(k,AxiosError$1.ERR_NETWORK,e,E);D.event=L||null,a(D),E=null},E.ontimeout=function(){let L=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const k=i.transitional||transitionalDefaults;i.timeoutErrorMessage&&(L=i.timeoutErrorMessage),a(new AxiosError$1(L,k.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,e,E)),E=null},s===void 0&&o.setContentType(null),"setRequestHeader"in E&&utils$1.forEach(o.toJSON(),function(L,k){E.setRequestHeader(k,L)}),utils$1.isUndefined(i.withCredentials)||(E.withCredentials=!!i.withCredentials),c&&c!=="json"&&(E.responseType=i.responseType),f&&([g,m]=progressEventReducer(f,!0),E.addEventListener("progress",g)),h&&E.upload&&([p,v]=progressEventReducer(h),E.upload.addEventListener("progress",p),E.upload.addEventListener("loadend",v)),(i.cancelToken||i.signal)&&(u=A=>{E&&(a(!A||A.type?new CanceledError$1(null,e,E):A),E.abort(),E=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const T=parseProtocol(i.url);if(T&&platform.protocols.indexOf(T)===-1){a(new AxiosError$1("Unsupported protocol "+T+":",AxiosError$1.ERR_BAD_REQUEST,e));return}E.send(s||null)})},composeSignals=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let a=new AbortController,i;const s=function(f){if(!i){i=!0,c();const u=f instanceof Error?f:this.reason;a.abort(u instanceof AxiosError$1?u:new CanceledError$1(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,s(new AxiosError$1(`timeout ${t} of ms exceeded`,AxiosError$1.ETIMEDOUT))},t);const c=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(s):f.removeEventListener("abort",s)}),e=null)};e.forEach(f=>f.addEventListener("abort",s));const{signal:h}=a;return h.unsubscribe=()=>utils$1.asap(c),h}},streamChunk=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let a=0,i;for(;a<n;)i=a+t,yield e.slice(a,i),a=i},readBytes=async function*(e,t){for await(const n of readStream(e))yield*streamChunk(n,t)},readStream=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:a}=await t.read();if(n)break;yield a}}finally{await t.cancel()}},trackStream=(e,t,n,a)=>{const i=readBytes(e,t);let s=0,o,c=h=>{o||(o=!0,a&&a(h))};return new ReadableStream({async pull(h){try{const{done:f,value:u}=await i.next();if(f){c(),h.close();return}let p=u.byteLength;if(n){let g=s+=p;n(g)}h.enqueue(new Uint8Array(u))}catch(f){throw c(f),f}},cancel(h){return c(h),i.return()}},{highWaterMark:2})},DEFAULT_CHUNK_SIZE=64*1024,{isFunction}=utils$1,globalFetchAPI=(({Request:e,Response:t})=>({Request:e,Response:t}))(utils$1.global),{ReadableStream:ReadableStream$1,TextEncoder}=utils$1.global,test=(e,...t)=>{try{return!!e(...t)}catch{return!1}},factory=e=>{e=utils$1.merge.call({skipUndefined:!0},globalFetchAPI,e);const{fetch:t,Request:n,Response:a}=e,i=t?isFunction(t):typeof fetch=="function",s=isFunction(n),o=isFunction(a);if(!i)return!1;const c=i&&isFunction(ReadableStream$1),h=i&&(typeof TextEncoder=="function"?(m=>S=>m.encode(S))(new TextEncoder):async m=>new Uint8Array(await new n(m).arrayBuffer())),f=s&&c&&test(()=>{let m=!1;const S=new n(platform.origin,{body:new ReadableStream$1,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!S}),u=o&&c&&test(()=>utils$1.isReadableStream(new a("").body)),p={stream:u&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!p[m]&&(p[m]=(S,E)=>{let w=S&&S[m];if(w)return w.call(S);throw new AxiosError$1(`Response type '${m}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,E)})});const g=async m=>{if(m==null)return 0;if(utils$1.isBlob(m))return m.size;if(utils$1.isSpecCompliantForm(m))return(await new n(platform.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(m)||utils$1.isArrayBuffer(m))return m.byteLength;if(utils$1.isURLSearchParams(m)&&(m=m+""),utils$1.isString(m))return(await h(m)).byteLength},v=async(m,S)=>{const E=utils$1.toFiniteNumber(m.getContentLength());return E??g(S)};return async m=>{let{url:S,method:E,data:w,signal:T,cancelToken:A,timeout:L,onDownloadProgress:k,onUploadProgress:D,responseType:N,headers:Y,withCredentials:z="same-origin",fetchOptions:te}=resolveConfig(m),Z=t||fetch;N=N?(N+"").toLowerCase():"text";let ne=composeSignals([T,A&&A.toAbortSignal()],L),oe=null;const le=ne&&ne.unsubscribe&&(()=>{ne.unsubscribe()});let pe;try{if(D&&f&&E!=="get"&&E!=="head"&&(pe=await v(Y,w))!==0){let I=new n(S,{method:"POST",body:w,duplex:"half"}),M;if(utils$1.isFormData(w)&&(M=I.headers.get("content-type"))&&Y.setContentType(M),I.body){const[H,G]=progressEventDecorator(pe,progressEventReducer(asyncDecorator(D)));w=trackStream(I.body,DEFAULT_CHUNK_SIZE,H,G)}}utils$1.isString(z)||(z=z?"include":"omit");const de=s&&"credentials"in n.prototype,J={...te,signal:ne,method:E.toUpperCase(),headers:Y.normalize().toJSON(),body:w,duplex:"half",credentials:de?z:void 0};oe=s&&new n(S,J);let V=await(s?Z(oe,te):Z(S,J));const C=u&&(N==="stream"||N==="response");if(u&&(k||C&&le)){const I={};["status","statusText","headers"].forEach(j=>{I[j]=V[j]});const M=utils$1.toFiniteNumber(V.headers.get("content-length")),[H,G]=k&&progressEventDecorator(M,progressEventReducer(asyncDecorator(k),!0))||[];V=new a(trackStream(V.body,DEFAULT_CHUNK_SIZE,H,()=>{G&&G(),le&&le()}),I)}N=N||"text";let O=await p[utils$1.findKey(p,N)||"text"](V,m);return!C&&le&&le(),await new Promise((I,M)=>{settle(I,M,{data:O,headers:AxiosHeaders$1.from(V.headers),status:V.status,statusText:V.statusText,config:m,request:oe})})}catch(de){throw le&&le(),de&&de.name==="TypeError"&&/Load failed|fetch/i.test(de.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,m,oe),{cause:de.cause||de}):AxiosError$1.from(de,de&&de.code,m,oe)}}},seedCache=new Map,getFetch=e=>{let t=e&&e.env||{};const{fetch:n,Request:a,Response:i}=t,s=[a,i,n];let o=s.length,c=o,h,f,u=seedCache;for(;c--;)h=s[c],f=u.get(h),f===void 0&&u.set(h,f=c?new Map:factory(t)),u=f;return f};getFetch();const knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:{get:getFetch}};utils$1.forEach(knownAdapters,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const renderReason=e=>`- ${e}`,isResolvedHandle=e=>utils$1.isFunction(e)||e===null||e===!1;function getAdapter$1(e,t){e=utils$1.isArray(e)?e:[e];const{length:n}=e;let a,i;const s={};for(let o=0;o<n;o++){a=e[o];let c;if(i=a,!isResolvedHandle(a)&&(i=knownAdapters[(c=String(a)).toLowerCase()],i===void 0))throw new AxiosError$1(`Unknown adapter '${c}'`);if(i&&(utils$1.isFunction(i)||(i=i.get(t))))break;s[c||"#"+o]=i}if(!i){const o=Object.entries(s).map(([h,f])=>`adapter ${h} `+(f===!1?"is not supported by the environment":"is not available in the build"));let c=n?o.length>1?`since :
`+o.map(renderReason).join(`
`):" "+renderReason(o[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return i}const adapters={getAdapter:getAdapter$1,adapters:knownAdapters};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError$1(null,e)}function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=AxiosHeaders$1.from(e.headers),e.data=transformData.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(e.adapter||defaults$1.adapter,e)(e).then(function(a){return throwIfCancellationRequested(e),a.data=transformData.call(e,e.transformResponse,a),a.headers=AxiosHeaders$1.from(a.headers),a},function(a){return isCancel$1(a)||(throwIfCancellationRequested(e),a&&a.response&&(a.response.data=transformData.call(e,e.transformResponse,a.response),a.response.headers=AxiosHeaders$1.from(a.response.headers))),Promise.reject(a)})}const VERSION$1="1.13.1",validators$1={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{validators$1[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const deprecatedWarnings={};validators$1.transitional=function e(t,n,a){function i(s,o){return"[Axios v"+VERSION$1+"] Transitional option '"+s+"'"+o+(a?". "+a:"")}return(s,o,c)=>{if(t===!1)throw new AxiosError$1(i(o," has been removed"+(n?" in "+n:"")),AxiosError$1.ERR_DEPRECATED);return n&&!deprecatedWarnings[o]&&(deprecatedWarnings[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(s,o,c):!0}};validators$1.spelling=function e(t){return(n,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function assertOptions(e,t,n){if(typeof e!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let i=a.length;for(;i-- >0;){const s=a[i],o=t[s];if(o){const c=e[s],h=c===void 0||o(c,s,e);if(h!==!0)throw new AxiosError$1("option "+s+" must be "+h,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new AxiosError$1("Unknown option "+s,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(t){this.defaults=t||{},this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(t,n){try{return await this._request(t,n)}catch(a){if(a instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{a.stack?s&&!String(a.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+s):a.stack=s}catch{}}throw a}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=mergeConfig$1(this.defaults,n);const{transitional:a,paramsSerializer:i,headers:s}=n;a!==void 0&&validator.assertOptions(a,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),i!=null&&(utils$1.isFunction(i)?n.paramsSerializer={serialize:i}:validator.assertOptions(i,{encode:validators.function,serialize:validators.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),validator.assertOptions(n,{baseUrl:validators.spelling("baseURL"),withXsrfToken:validators.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&utils$1.merge(s.common,s[n.method]);s&&utils$1.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),n.headers=AxiosHeaders$1.concat(o,s);const c=[];let h=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(n)===!1||(h=h&&S.synchronous,c.unshift(S.fulfilled,S.rejected))});const f=[];this.interceptors.response.forEach(function(S){f.push(S.fulfilled,S.rejected)});let u,p=0,g;if(!h){const m=[dispatchRequest.bind(this),void 0];for(m.unshift(...c),m.push(...f),g=m.length,u=Promise.resolve(n);p<g;)u=u.then(m[p++],m[p++]);return u}g=c.length;let v=n;for(;p<g;){const m=c[p++],S=c[p++];try{v=m(v)}catch(E){S.call(this,E);break}}try{u=dispatchRequest.call(this,v)}catch(m){return Promise.reject(m)}for(p=0,g=f.length;p<g;)u=u.then(f[p++],f[p++]);return u}getUri(t){t=mergeConfig$1(this.defaults,t);const n=buildFullPath(t.baseURL,t.url,t.allowAbsoluteUrls);return buildURL(n,t.params,t.paramsSerializer)}};utils$1.forEach(["delete","get","head","options"],function e(t){Axios$1.prototype[t]=function(n,a){return this.request(mergeConfig$1(a||{},{method:t,url:n,data:(a||{}).data}))}});utils$1.forEach(["post","put","patch"],function e(t){function n(a){return function(s,o,c){return this.request(mergeConfig$1(c||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Axios$1.prototype[t]=n(),Axios$1.prototype[t+"Form"]=n(!0)});let CancelToken$1=class Mc{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const a=this;this.promise.then(i=>{if(!a._listeners)return;let s=a._listeners.length;for(;s-- >0;)a._listeners[s](i);a._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(c=>{a.subscribe(c),s=c}).then(i);return o.cancel=function(){a.unsubscribe(s)},o},t(function(s,o,c){a.reason||(a.reason=new CanceledError$1(s,o,c),n(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=a=>{t.abort(a)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Mc(function(i){t=i}),cancel:t}}};function spread$1(e){return function(n){return e.apply(null,n)}}function isAxiosError$1(e){return utils$1.isObject(e)&&e.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(HttpStatusCode$1).forEach(([e,t])=>{HttpStatusCode$1[t]=e});function createInstance(e){const t=new Axios$1(e),n=bind(Axios$1.prototype.request,t);return utils$1.extend(n,Axios$1.prototype,t,{allOwnKeys:!0}),utils$1.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return createInstance(mergeConfig$1(e,i))},n}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError$1;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel$1;axios.VERSION=VERSION$1;axios.toFormData=toFormData$1;axios.AxiosError=AxiosError$1;axios.Cancel=axios.CanceledError;axios.all=function e(t){return Promise.all(t)};axios.spread=spread$1;axios.isAxiosError=isAxiosError$1;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=e=>formDataToJSON(utils$1.isHTMLForm(e)?new FormData(e):e);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios,api=axios.create({baseURL:void 0,timeout:12e4});console.log(" [cloudApi] Backend URL:",void 0);async function analyzeOnCloud({logFile:e,irrFile:t,pvsystFile:n,extras:a={}}){if(!e)throw new Error("Missing required logFile");const i=new FormData;i.append("file",e),t&&i.append("irrFile",t),n&&i.append("pvsystFile",n),Object.entries(a).forEach(([o,c])=>i.append(o,String(c)));const s=await api.post("/api/parse-fusion",i,{headers:{"Content-Type":"multipart/form-data"},maxBodyLength:1/0,maxContentLength:1/0});return console.log(" [cloudApi] Cloud compute OK:",s.data),s.data}pdfExports.GlobalWorkerOptions.workerSrc=pdfjsWorker;async function extractFullPDF(e){const t=await pdfExports.getDocument({data:await e.arrayBuffer()}).promise;let n="";for(let a=1;a<=t.numPages;a++){const s=await(await t.getPage(a)).getTextContent();n+=s.items.map(o=>o.str).join(" ")+`
`}return n.trim()||(n=(await Tesseract.recognize(await e.arrayBuffer(),"eng")).data.text),{fullText:n}}function roughExtractBasicInfo(e){const t=e.replace(/\s+/g," "),n=t.match(/(-?\d{1,3}\.\d{2,})[,]?\s*(\d{1,3}\.\d{2,})/),a=t.match(/\b(JAM|LR|TSM|JKM|CS)[0-9A-Za-z\-\/]+\b/)?.[0]||"",i=t.match(/\b(SUN2000|SG|STP|PVS)\-[A-Za-z0-9\-]+/)?.[0]||"",s=t.match(/(\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2,4})/)?.[0]||"";return{gps:n?`${n[1]}, ${n[2]}`:"",module:a,inverter:i,cod:s}}function inferCountryFromLocation(e=""){const t=(e||"").toLowerCase();return t.includes("viet")?"Vietnam":t.includes("thai")?"Thailand":t.includes("phil")?"Philippines":t.includes("indo")?"Indonesia":t.includes("malay")?"Malaysia":"Vietnam"}function TestBackendButton(){const[e,t]=reactExports.useState(""),[n,a]=reactExports.useState(!1),i=async()=>{a(!0);try{const o=await(await fetch("undefined/")).text();t(" "+o)}catch(s){t(" "+s.message)}finally{a(!1)}};return jsxRuntimeExports.jsxs("div",{className:"mt-4 text-center",children:[jsxRuntimeExports.jsx("button",{onClick:i,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 transition",children:n?"Testing...":"Test backend"}),e&&jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-600 mt-2",children:e})]})}function HomePage(){const e=useNavigate(),[t,n]=reactExports.useState(null),[a,i]=reactExports.useState(null),[s,o]=reactExports.useState(null),[c,h]=reactExports.useState(!1),[f,u]=reactExports.useState({}),[p,g]=reactExports.useState(!1),[v,m]=reactExports.useState(!1),S=()=>{if(!t){alert("Please upload your Actual Log File before starting analysis.");return}g(!0)},E=async T=>{g(!1),m(!0);try{let A={};if(a){const D=await extractFullPDF(a);localStorage.setItem("pvsyst_full_text",D.fullText),A=roughExtractBasicInfo(D.fullText)}let L=null;try{L=await analyzeOnCloud({logFile:t,irrFile:s,pvsystFile:a,extras:{gpsCountry:A?.location||"Vietnam"}})}catch(D){console.warn(" Cloud compute failed:",D.message)}const k={...A,...T,actualProduction:L?.summary?.totalEac??T?.totalProduction??0,dailyProduction:L?.charts?.dailyProd??T?.dailyProduction??[],rpr:L?.summary?.RPR??null,cloudMeta:L?.meta??null,cloudDebug:L?.debug??null};u(k),h(!0)}catch{u(T||{}),h(!0)}finally{m(!1)}},w=T=>{const A=T?.country||T?.nation||inferCountryFromLocation(T?.location||f?.location),L={...f,...T,logFileName:t?.name,gpsCountry:A||"Vietnam"};e("/report",{state:{projectData:L,files:{logFile:t,irrFile:s||null,pvsystFile:a||null}}})};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col items-center bg-gradient-to-b from-blue-50 to-white text-gray-800",children:[jsxRuntimeExports.jsxs("main",{className:"w-full flex flex-col items-center justify-center mb-10 px-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/90 backdrop-blur-md p-8 md:p-10 rounded-3xl shadow-lg max-w-2xl w-full text-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl md:text-[30px] font-bold text-blue-800 mb-3",children:"Your Solar Performance Insight Engine"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 mb-8 text-[15px]",children:"Automatically analyze your FusionSolar or iSolarCloud log files to evaluate system performance, identify losses, and generate clear visual reports."}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-green-50 border border-green-200 px-4 py-4 rounded-2xl",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-green-700 text-[16px]",children:"Free Trial"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm",children:"1 free report for new users"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-50 border border-blue-200 px-4 py-4 rounded-2xl",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-blue-700 text-[16px]",children:"Pay-per-Report"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm",children:"Only 1 USD per analysis"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-amber-50 border border-amber-200 px-4 py-4 rounded-2xl",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold text-amber-700 text-[16px]",children:"Member Plan"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm",children:"5 USD / month  up to 10 reports"})]})]}),jsxRuntimeExports.jsx("h3",{className:"text-[18px] font-semibold text-gray-700 mb-5",children:"Upload Your Data"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 text-left",children:[jsxRuntimeExports.jsxs("div",{className:"md:col-span-2 rounded-2xl border border-blue-100 bg-white p-4 shadow-sm hover:shadow transition",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-blue-500 text-xl",children:""}),jsxRuntimeExports.jsxs("p",{className:"font-semibold text-blue-700 text-[15px]",children:["Actual Log File ",jsxRuntimeExports.jsx("span",{className:"text-red-500",children:"*"})]})]}),jsxRuntimeExports.jsx("input",{type:"file",onChange:T=>n(T.target.files[0]),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 file:mr-3 file:py-2 file:px-4 file:rounded-md file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Required  FusionSolar / iSolarCloud export file"})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-2xl border border-amber-100 bg-white p-4 shadow-sm hover:shadow transition",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-amber-500 text-xl",children:""}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-amber-700 text-[15px]",children:"PVSyst Simulation (optional)"})]}),jsxRuntimeExports.jsx("input",{type:"file",onChange:T=>i(T.target.files[0]),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 file:mr-3 file:py-2 file:px-4 file:rounded-md file:border-0 file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 transition"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional  expected energy model for comparison"})]}),jsxRuntimeExports.jsxs("div",{className:"rounded-2xl border border-yellow-100 bg-white p-4 shadow-sm hover:shadow transition",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[jsxRuntimeExports.jsx("span",{className:"text-yellow-500 text-xl",children:""}),jsxRuntimeExports.jsx("p",{className:"font-semibold text-yellow-700 text-[15px]",children:"Irradiation Data (optional)"})]}),jsxRuntimeExports.jsx("input",{type:"file",onChange:T=>o(T.target.files[0]),className:"w-full text-sm border border-gray-300 rounded-lg px-3 py-2 file:mr-3 file:py-2 file:px-4 file:rounded-md file:border-0 file:bg-yellow-50 file:text-yellow-700 hover:file:bg-yellow-100 transition"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional  upload Excel/CSV daily irradiation (kWh/m). If empty, system uses national baseline."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-3 mt-4",children:[jsxRuntimeExports.jsx("button",{onClick:S,className:"bg-gradient-to-r from-blue-600 to-blue-500 text-white font-medium px-8 py-3 rounded-xl hover:from-blue-700 hover:to-blue-600 transition-all shadow-md hover:shadow-lg",disabled:v,children:v?"Checking...":"Start Analysis"}),jsxRuntimeExports.jsx("button",{onClick:async()=>{if(!t)return alert("Please upload an Actual Log file first!");try{const T=new FormData;T.append("file",t);const L=await(await fetch("undefined/api/parse-fusion",{method:"POST",body:T})).json();console.log(" Cloud Parse Result:",L),alert(` Cloud Parse OK!
`+JSON.stringify(L.message||L,null,2))}catch(T){console.error(" Cloud parse error:",T),alert(" Cloud Parse failed: "+T.message)}},className:"border border-gray-300 text-gray-700 font-medium px-8 py-3 rounded-xl hover:bg-gray-50 transition-all shadow-sm hover:shadow",children:"Run Cloud Parse (backend)"})]}),jsxRuntimeExports.jsx(TestBackendButton,{}),jsxRuntimeExports.jsx("p",{className:"mt-3 text-sm text-blue-700 hover:underline cursor-pointer",children:"How to export log files"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400 mt-4",children:"Your files are used for analysis only  not stored or shared."})]}),jsxRuntimeExports.jsx("footer",{className:"mt-8 text-sm text-gray-400",children:" 2025 iSolarChecking  Your Solar Insight Simplified"})]}),jsxRuntimeExports.jsx(FileCheckModal,{open:p,logFile:t,pvsystFile:a,irrFile:s,onClose:()=>g(!1),onNext:E}),jsxRuntimeExports.jsx(ProjectConfirmModal,{open:c,initialData:f,onConfirm:w,onClose:()=>h(!1)})]})}function r(e){var t,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function clsx(){for(var e,t,n=0,a="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}var EventKeys=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function isEventKey(e){if(typeof e!="string")return!1;var t=EventKeys;return t.includes(e)}var SVGElementPropKeys=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function isSvgElementPropKey(e){if(typeof e!="string")return!1;var t=SVGElementPropKeys;return t.includes(e)}function isDataAttribute(e){return typeof e=="string"&&e.startsWith("data-")}function svgPropertiesNoEvents(e){var t=Object.entries(e).filter(n=>{var[a]=n;return isSvgElementPropKey(a)||isDataAttribute(a)});return Object.fromEntries(t)}function svgPropertiesNoEventsFromUnknown(e){if(e==null)return null;if(reactExports.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return svgPropertiesNoEvents(t)}return typeof e=="object"&&!Array.isArray(e)?svgPropertiesNoEvents(e):null}function svgPropertiesAndEvents(e){var t=Object.entries(e).filter(n=>{var[a]=n;return isSvgElementPropKey(a)||isDataAttribute(a)||isEventKey(a)});return Object.fromEntries(t)}function svgPropertiesAndEventsFromUnknown(e){return e==null?null:reactExports.isValidElement(e)?svgPropertiesAndEvents(e.props):typeof e=="object"&&!Array.isArray(e)?svgPropertiesAndEvents(e):null}var _excluded$f=["children","width","height","viewBox","className","style","title","desc"];function _extends$k(){return _extends$k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$k.apply(null,arguments)}function _objectWithoutProperties$f(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$f(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$f(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var Surface=reactExports.forwardRef((e,t)=>{var{children:n,width:a,height:i,viewBox:s,className:o,style:c,title:h,desc:f}=e,u=_objectWithoutProperties$f(e,_excluded$f),p=s||{width:a,height:i,x:0,y:0},g=clsx("recharts-surface",o);return reactExports.createElement("svg",_extends$k({},svgPropertiesAndEvents(u),{className:g,width:a,height:i,style:c,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),reactExports.createElement("title",null,h),reactExports.createElement("desc",null,f),n)}),_excluded$e=["children","className"];function _extends$j(){return _extends$j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$j.apply(null,arguments)}function _objectWithoutProperties$e(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$e(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var Layer=reactExports.forwardRef((e,t)=>{var{children:n,className:a}=e,i=_objectWithoutProperties$e(e,_excluded$e),s=clsx("recharts-layer",a);return reactExports.createElement("g",_extends$j({className:s},svgPropertiesAndEvents(i),{ref:t}),n)}),LegendPortalContext=reactExports.createContext(null);function constant$1(e){return function(){return e}}const pi=Math.PI,tau=2*pi,epsilon=1e-6,tauEpsilon=tau-epsilon;function append(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function appendRound(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return append;const n=10**t;return function(a){this._+=a[0];for(let i=1,s=a.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+a[i]}}class Path{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?append:appendRound(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,a,i){this._append`Q${+t},${+n},${this._x1=+a},${this._y1=+i}`}bezierCurveTo(t,n,a,i,s,o){this._append`C${+t},${+n},${+a},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,a,i,s){if(t=+t,n=+n,a=+a,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,c=this._y1,h=a-t,f=i-n,u=o-t,p=c-n,g=u*u+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(g>epsilon)if(!(Math.abs(p*h-f*u)>epsilon)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let v=a-o,m=i-c,S=h*h+f*f,E=v*v+m*m,w=Math.sqrt(S),T=Math.sqrt(g),A=s*Math.tan((pi-Math.acos((S+g-E)/(2*w*T)))/2),L=A/T,k=A/w;Math.abs(L-1)>epsilon&&this._append`L${t+L*u},${n+L*p}`,this._append`A${s},${s},0,0,${+(p*v>u*m)},${this._x1=t+k*h},${this._y1=n+k*f}`}}arc(t,n,a,i,s,o){if(t=+t,n=+n,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let c=a*Math.cos(i),h=a*Math.sin(i),f=t+c,u=n+h,p=1^o,g=o?i-s:s-i;this._x1===null?this._append`M${f},${u}`:(Math.abs(this._x1-f)>epsilon||Math.abs(this._y1-u)>epsilon)&&this._append`L${f},${u}`,a&&(g<0&&(g=g%tau+tau),g>tauEpsilon?this._append`A${a},${a},0,1,${p},${t-c},${n-h}A${a},${a},0,1,${p},${this._x1=f},${this._y1=u}`:g>epsilon&&this._append`A${a},${a},0,${+(g>=pi)},${p},${this._x1=t+a*Math.cos(s)},${this._y1=n+a*Math.sin(s)}`)}rect(t,n,a,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${a=+a}v${+i}h${-a}Z`}toString(){return this._}}function withPath(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);t=a}return e},()=>new Path(t)}function array(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Linear(e){this._context=e}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function curveLinear(e){return new Linear(e)}function x(e){return e[0]}function y(e){return e[1]}function shapeLine(e,t){var n=constant$1(!0),a=null,i=curveLinear,s=null,o=withPath(c);e=typeof e=="function"?e:e===void 0?x:constant$1(e),t=typeof t=="function"?t:t===void 0?y:constant$1(t);function c(h){var f,u=(h=array(h)).length,p,g=!1,v;for(a==null&&(s=i(v=o())),f=0;f<=u;++f)!(f<u&&n(p=h[f],f,h))===g&&((g=!g)?s.lineStart():s.lineEnd()),g&&s.point(+e(p,f,h),+t(p,f,h));if(v)return s=null,v+""||null}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:constant$1(+h),c):e},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:constant$1(+h),c):t},c.defined=function(h){return arguments.length?(n=typeof h=="function"?h:constant$1(!!h),c):n},c.curve=function(h){return arguments.length?(i=h,a!=null&&(s=i(a)),c):i},c.context=function(h){return arguments.length?(h==null?a=s=null:s=i(a=h),c):a},c}function shapeArea(e,t,n){var a=null,i=constant$1(!0),s=null,o=curveLinear,c=null,h=withPath(f);e=typeof e=="function"?e:e===void 0?x:constant$1(+e),t=typeof t=="function"?t:constant$1(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?y:constant$1(+n);function f(p){var g,v,m,S=(p=array(p)).length,E,w=!1,T,A=new Array(S),L=new Array(S);for(s==null&&(c=o(T=h())),g=0;g<=S;++g){if(!(g<S&&i(E=p[g],g,p))===w)if(w=!w)v=g,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),m=g-1;m>=v;--m)c.point(A[m],L[m]);c.lineEnd(),c.areaEnd()}w&&(A[g]=+e(E,g,p),L[g]=+t(E,g,p),c.point(a?+a(E,g,p):A[g],n?+n(E,g,p):L[g]))}if(T)return c=null,T+""||null}function u(){return shapeLine().defined(i).curve(o).context(s)}return f.x=function(p){return arguments.length?(e=typeof p=="function"?p:constant$1(+p),a=null,f):e},f.x0=function(p){return arguments.length?(e=typeof p=="function"?p:constant$1(+p),f):e},f.x1=function(p){return arguments.length?(a=p==null?null:typeof p=="function"?p:constant$1(+p),f):a},f.y=function(p){return arguments.length?(t=typeof p=="function"?p:constant$1(+p),n=null,f):t},f.y0=function(p){return arguments.length?(t=typeof p=="function"?p:constant$1(+p),f):t},f.y1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:constant$1(+p),f):n},f.lineX0=f.lineY0=function(){return u().x(e).y(t)},f.lineY1=function(){return u().x(e).y(n)},f.lineX1=function(){return u().x(a).y(t)},f.defined=function(p){return arguments.length?(i=typeof p=="function"?p:constant$1(!!p),f):i},f.curve=function(p){return arguments.length?(o=p,s!=null&&(c=o(s)),f):o},f.context=function(p){return arguments.length?(p==null?s=c=null:c=o(s=p),f):s},f}class Bump{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function bumpX(e){return new Bump(e,!0)}function bumpY(e){return new Bump(e,!1)}function noop$5(){}function point$2(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Basis(e){this._context=e}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point$2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point$2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curveBasis(e){return new Basis(e)}function BasisClosed(e){this._context=e}BasisClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:point$2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curveBasisClosed(e){return new BasisClosed(e)}function BasisOpen(e){this._context=e}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:point$2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curveBasisOpen(e){return new BasisOpen(e)}function LinearClosed(e){this._context=e}LinearClosed.prototype={areaStart:noop$5,areaEnd:noop$5,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function curveLinearClosed(e){return new LinearClosed(e)}function sign(e){return e<0?-1:1}function slope3(e,t,n){var a=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(a||i<0&&-0),o=(n-e._y1)/(i||a<0&&-0),c=(s*i+o*a)/(a+i);return(sign(s)+sign(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(c))||0}function slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function point$1(e,t,n){var a=e._x0,i=e._y0,s=e._x1,o=e._y1,c=(s-a)/3;e._context.bezierCurveTo(a+c,i+c*t,s-c,o-c*n,s,o)}function MonotoneX(e){this._context=e}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$1(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,point$1(this,slope2(this,n=slope3(this,e,t)),n);break;default:point$1(this,this._t0,n=slope3(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function MonotoneY(e){this._context=new ReflectContext(e)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,t){MonotoneX.prototype.point.call(this,t,e)};function ReflectContext(e){this._context=e}ReflectContext.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,i,s){this._context.bezierCurveTo(t,e,a,n,s,i)}};function monotoneX(e){return new MonotoneX(e)}function monotoneY(e){return new MonotoneY(e)}function Natural(e){this._context=e}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var a=controlPoints(e),i=controlPoints(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(a[0][s],i[0][s],a[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function controlPoints(e){var t,n=e.length-1,a,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=i[t]/s[t-1],s[t]-=a,o[t]-=a*o[t-1];for(i[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function curveNatural(e){return new Natural(e)}function Step(e,t){this._context=e,this._t=t}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function curveStep(e){return new Step(e,.5)}function stepBefore(e){return new Step(e,0)}function stepAfter(e){return new Step(e,1)}function stackOffsetNone(e,t){if((o=e.length)>1)for(var n=1,a,i,s=e[t[0]],o,c=s.length;n<o;++n)for(i=s,s=e[t[n]],a=0;a<c;++a)s[a][1]+=s[a][0]=isNaN(i[a][1])?i[a][0]:i[a][1]}function stackOrderNone(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function stackValue(e,t){return e[t]}function stackSeries(e){const t=[];return t.key=e,t}function shapeStack(){var e=constant$1([]),t=stackOrderNone,n=stackOffsetNone,a=stackValue;function i(s){var o=Array.from(e.apply(this,arguments),stackSeries),c,h=o.length,f=-1,u;for(const p of s)for(c=0,++f;c<h;++c)(o[c][f]=[0,+a(p,o[c].key,f,s)]).data=p;for(c=0,u=array(t(o));c<h;++c)o[u[c]].index=c;return n(o,u),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:constant$1(Array.from(s)),i):e},i.value=function(s){return arguments.length?(a=typeof s=="function"?s:constant$1(+s),i):a},i.order=function(s){return arguments.length?(t=s==null?stackOrderNone:typeof s=="function"?s:constant$1(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(n=s??stackOffsetNone,i):n},i}function stackOffsetExpand(e,t){if((a=e.length)>0){for(var n,a,i=0,s=e[0].length,o;i<s;++i){for(o=n=0;n<a;++n)o+=e[n][i][1]||0;if(o)for(n=0;n<a;++n)e[n][i][1]/=o}stackOffsetNone(e,t)}}function stackOffsetSilhouette(e,t){if((i=e.length)>0){for(var n=0,a=e[t[0]],i,s=a.length;n<s;++n){for(var o=0,c=0;o<i;++o)c+=e[o][n][1]||0;a[n][1]+=a[n][0]=-c/2}stackOffsetNone(e,t)}}function stackOffsetWiggle(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var n=0,a=1,i,s,o;a<s;++a){for(var c=0,h=0,f=0;c<o;++c){for(var u=e[t[c]],p=u[a][1]||0,g=u[a-1][1]||0,v=(p-g)/2,m=0;m<c;++m){var S=e[t[m]],E=S[a][1]||0,w=S[a-1][1]||0;v+=E-w}h+=p,f+=v*p}i[a-1][1]+=i[a-1][0]=n,h&&(n-=f/h)}i[a-1][1]+=i[a-1][0]=n,stackOffsetNone(e,t)}}var get$2={},isUnsafeProperty={},hasRequiredIsUnsafeProperty;function requireIsUnsafeProperty(){return hasRequiredIsUnsafeProperty||(hasRequiredIsUnsafeProperty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(isUnsafeProperty)),isUnsafeProperty}var isDeepKey={},hasRequiredIsDeepKey;function requireIsDeepKey(){return hasRequiredIsDeepKey||(hasRequiredIsDeepKey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(isDeepKey)),isDeepKey}var toKey={},hasRequiredToKey;function requireToKey(){return hasRequiredToKey||(hasRequiredToKey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=t})(toKey)),toKey}var toPath={},toString$1={},hasRequiredToString;function requireToString(){return hasRequiredToString||(hasRequiredToString=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}e.toString=t})(toString$1)),toString$1}var hasRequiredToPath;function requireToPath(){return hasRequiredToPath||(hasRequiredToPath=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireToString(),n=requireToKey();function a(i){if(Array.isArray(i))return i.map(n.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let c=0,h="",f="",u=!1;for(i.charCodeAt(0)===46&&(s.push(""),c++);c<o;){const p=i[c];f?p==="\\"&&c+1<o?(c++,h+=i[c]):p===f?f="":h+=p:u?p==='"'||p==="'"?f=p:p==="]"?(u=!1,s.push(h),h=""):h+=p:p==="["?(u=!0,h&&(s.push(h),h="")):p==="."?h&&(s.push(h),h=""):h+=p,c++}return h&&s.push(h),s}e.toPath=a})(toPath)),toPath}var hasRequiredGet$1;function requireGet$1(){return hasRequiredGet$1||(hasRequiredGet$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsUnsafeProperty(),n=requireIsDeepKey(),a=requireToKey(),i=requireToPath();function s(c,h,f){if(c==null)return f;switch(typeof h){case"string":{if(t.isUnsafeProperty(h))return f;const u=c[h];return u===void 0?n.isDeepKey(h)?s(c,i.toPath(h),f):f:u}case"number":case"symbol":{typeof h=="number"&&(h=a.toKey(h));const u=c[h];return u===void 0?f:u}default:{if(Array.isArray(h))return o(c,h,f);if(Object.is(h?.valueOf(),-0)?h="-0":h=String(h),t.isUnsafeProperty(h))return f;const u=c[h];return u===void 0?f:u}}}function o(c,h,f){if(h.length===0)return f;let u=c;for(let p=0;p<h.length;p++){if(u==null||t.isUnsafeProperty(h[p]))return f;u=u[h[p]]}return u===void 0?f:u}e.get=s})(get$2)),get$2}var get$1,hasRequiredGet;function requireGet(){return hasRequiredGet||(hasRequiredGet=1,get$1=requireGet$1().get),get$1}var getExports=requireGet();const get=getDefaultExportFromCjs(getExports);var mathSign=e=>e===0?0:e>0?1:-1,isNan=e=>typeof e=="number"&&e!=+e,isPercent=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,isNumber=e=>(typeof e=="number"||e instanceof Number)&&!isNan(e),isNumOrStr=e=>isNumber(e)||typeof e=="string",idCounter=0,uniqueId=e=>{var t=++idCounter;return"".concat(e||"").concat(t)},getPercentValue=function e(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!isNumber(t)&&typeof t!="string")return a;var s;if(isPercent(t)){if(n==null)return a;var o=t.indexOf("%");s=n*parseFloat(t.slice(0,o))/100}else s=+t;return isNan(s)&&(s=a),i&&n!=null&&s>n&&(s=n),s},hasDuplicate=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},a=0;a<t;a++)if(!n[e[a]])n[e[a]]=!0;else return!0;return!1};function interpolate$1(e,t,n){return isNumber(e)&&isNumber(t)?e+n*(t-e):t}function findEntryInArray(e,t,n){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):get(a,t))===n)}var isNullish=e=>e===null||typeof e>"u",upperFirst=e=>isNullish(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),adaptEventHandlers=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(reactExports.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{isEventKey(i)&&(a[i]=(s=>n[i](n,s)))}),a},getEventHandlerOfChild=(e,t,n)=>a=>(e(t,n,a),null),adaptEventsOfChild=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(i=>{var s=e[i];isEventKey(i)&&typeof s=="function"&&(a||(a={}),a[i]=getEventHandlerOfChild(s,t,n))}),a},uniqBy$3={},uniqBy$2={},hasRequiredUniqBy$2;function requireUniqBy$2(){return hasRequiredUniqBy$2||(hasRequiredUniqBy$2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){const i=new Map;for(let s=0;s<n.length;s++){const o=n[s],c=a(o);i.has(c)||i.set(c,o)}return Array.from(i.values())}e.uniqBy=t})(uniqBy$2)),uniqBy$2}var identity$4={},hasRequiredIdentity;function requireIdentity(){return hasRequiredIdentity||(hasRequiredIdentity=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(identity$4)),identity$4}var isArrayLikeObject={},isArrayLike={},isLength={},hasRequiredIsLength;function requireIsLength(){return hasRequiredIsLength||(hasRequiredIsLength=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(isLength)),isLength}var hasRequiredIsArrayLike;function requireIsArrayLike(){return hasRequiredIsArrayLike||(hasRequiredIsArrayLike=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsLength();function n(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=n})(isArrayLike)),isArrayLike}var isObjectLike={},hasRequiredIsObjectLike;function requireIsObjectLike(){return hasRequiredIsObjectLike||(hasRequiredIsObjectLike=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(isObjectLike)),isObjectLike}var hasRequiredIsArrayLikeObject;function requireIsArrayLikeObject(){return hasRequiredIsArrayLikeObject||(hasRequiredIsArrayLikeObject=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsArrayLike(),n=requireIsObjectLike();function a(i){return n.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=a})(isArrayLikeObject)),isArrayLikeObject}var iteratee={},property={},hasRequiredProperty;function requireProperty(){return hasRequiredProperty||(hasRequiredProperty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireGet$1();function n(a){return function(i){return t.get(i,a)}}e.property=n})(property)),property}var matches={},isMatch={},isMatchWith={},isObject={},hasRequiredIsObject;function requireIsObject(){return hasRequiredIsObject||(hasRequiredIsObject=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(isObject)),isObject}var isPrimitive={},hasRequiredIsPrimitive;function requireIsPrimitive(){return hasRequiredIsPrimitive||(hasRequiredIsPrimitive=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(isPrimitive)),isPrimitive}var eq={},hasRequiredEq;function requireEq(){return hasRequiredEq||(hasRequiredEq=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}e.eq=t})(eq)),eq}var hasRequiredIsMatchWith;function requireIsMatchWith(){return hasRequiredIsMatchWith||(hasRequiredIsMatchWith=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsObject(),n=requireIsPrimitive(),a=requireEq();function i(u,p,g){return typeof g!="function"?i(u,p,()=>{}):s(u,p,function v(m,S,E,w,T,A){const L=g(m,S,E,w,T,A);return L!==void 0?!!L:s(m,S,v,A)},new Map)}function s(u,p,g,v){if(p===u)return!0;switch(typeof p){case"object":return o(u,p,g,v);case"function":return Object.keys(p).length>0?s(u,{...p},g,v):a.eq(u,p);default:return t.isObject(u)?typeof p=="string"?p==="":!0:a.eq(u,p)}}function o(u,p,g,v){if(p==null)return!0;if(Array.isArray(p))return h(u,p,g,v);if(p instanceof Map)return c(u,p,g,v);if(p instanceof Set)return f(u,p,g,v);const m=Object.keys(p);if(u==null)return m.length===0;if(m.length===0)return!0;if(v?.has(p))return v.get(p)===u;v?.set(p,u);try{for(let S=0;S<m.length;S++){const E=m[S];if(!n.isPrimitive(u)&&!(E in u)||p[E]===void 0&&u[E]!==void 0||p[E]===null&&u[E]!==null||!g(u[E],p[E],E,u,p,v))return!1}return!0}finally{v?.delete(p)}}function c(u,p,g,v){if(p.size===0)return!0;if(!(u instanceof Map))return!1;for(const[m,S]of p.entries()){const E=u.get(m);if(g(E,S,m,u,p,v)===!1)return!1}return!0}function h(u,p,g,v){if(p.length===0)return!0;if(!Array.isArray(u))return!1;const m=new Set;for(let S=0;S<p.length;S++){const E=p[S];let w=!1;for(let T=0;T<u.length;T++){if(m.has(T))continue;const A=u[T];let L=!1;if(g(A,E,S,u,p,v)&&(L=!0),L){m.add(T),w=!0;break}}if(!w)return!1}return!0}function f(u,p,g,v){return p.size===0?!0:u instanceof Set?h([...u],[...p],g,v):!1}e.isMatchWith=i,e.isSetMatch=f})(isMatchWith)),isMatchWith}var hasRequiredIsMatch;function requireIsMatch(){return hasRequiredIsMatch||(hasRequiredIsMatch=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsMatchWith();function n(a,i){return t.isMatchWith(a,i,()=>{})}e.isMatch=n})(isMatch)),isMatch}var cloneDeep$1={},cloneDeepWith$1={},getSymbols={},hasRequiredGetSymbols;function requireGetSymbols(){return hasRequiredGetSymbols||(hasRequiredGetSymbols=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}e.getSymbols=t})(getSymbols)),getSymbols}var getTag={},hasRequiredGetTag;function requireGetTag(){return hasRequiredGetTag||(hasRequiredGetTag=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(getTag)),getTag}var tags={},hasRequiredTags;function requireTags(){return hasRequiredTags||(hasRequiredTags=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",a="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",c="[object Date]",h="[object Map]",f="[object Set]",u="[object Array]",p="[object Function]",g="[object ArrayBuffer]",v="[object Object]",m="[object Error]",S="[object DataView]",E="[object Uint8Array]",w="[object Uint8ClampedArray]",T="[object Uint16Array]",A="[object Uint32Array]",L="[object BigUint64Array]",k="[object Int8Array]",D="[object Int16Array]",N="[object Int32Array]",Y="[object BigInt64Array]",z="[object Float32Array]",te="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=g,e.arrayTag=u,e.bigInt64ArrayTag=Y,e.bigUint64ArrayTag=L,e.booleanTag=i,e.dataViewTag=S,e.dateTag=c,e.errorTag=m,e.float32ArrayTag=z,e.float64ArrayTag=te,e.functionTag=p,e.int16ArrayTag=D,e.int32ArrayTag=N,e.int8ArrayTag=k,e.mapTag=h,e.numberTag=a,e.objectTag=v,e.regexpTag=t,e.setTag=f,e.stringTag=n,e.symbolTag=o,e.uint16ArrayTag=T,e.uint32ArrayTag=A,e.uint8ArrayTag=E,e.uint8ClampedArrayTag=w})(tags)),tags}var isTypedArray={},hasRequiredIsTypedArray;function requireIsTypedArray(){return hasRequiredIsTypedArray||(hasRequiredIsTypedArray=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(isTypedArray)),isTypedArray}var hasRequiredCloneDeepWith$1;function requireCloneDeepWith$1(){return hasRequiredCloneDeepWith$1||(hasRequiredCloneDeepWith$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireGetSymbols(),n=requireGetTag(),a=requireTags(),i=requireIsPrimitive(),s=requireIsTypedArray();function o(u,p){return c(u,void 0,u,new Map,p)}function c(u,p,g,v=new Map,m=void 0){const S=m?.(u,p,g,v);if(S!==void 0)return S;if(i.isPrimitive(u))return u;if(v.has(u))return v.get(u);if(Array.isArray(u)){const E=new Array(u.length);v.set(u,E);for(let w=0;w<u.length;w++)E[w]=c(u[w],w,g,v,m);return Object.hasOwn(u,"index")&&(E.index=u.index),Object.hasOwn(u,"input")&&(E.input=u.input),E}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const E=new RegExp(u.source,u.flags);return E.lastIndex=u.lastIndex,E}if(u instanceof Map){const E=new Map;v.set(u,E);for(const[w,T]of u)E.set(w,c(T,w,g,v,m));return E}if(u instanceof Set){const E=new Set;v.set(u,E);for(const w of u)E.add(c(w,void 0,g,v,m));return E}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const E=new(Object.getPrototypeOf(u)).constructor(u.length);v.set(u,E);for(let w=0;w<u.length;w++)E[w]=c(u[w],w,g,v,m);return E}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const E=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return v.set(u,E),h(E,u,g,v,m),E}if(typeof File<"u"&&u instanceof File){const E=new File([u],u.name,{type:u.type});return v.set(u,E),h(E,u,g,v,m),E}if(typeof Blob<"u"&&u instanceof Blob){const E=new Blob([u],{type:u.type});return v.set(u,E),h(E,u,g,v,m),E}if(u instanceof Error){const E=new u.constructor;return v.set(u,E),E.message=u.message,E.name=u.name,E.stack=u.stack,E.cause=u.cause,h(E,u,g,v,m),E}if(u instanceof Boolean){const E=new Boolean(u.valueOf());return v.set(u,E),h(E,u,g,v,m),E}if(u instanceof Number){const E=new Number(u.valueOf());return v.set(u,E),h(E,u,g,v,m),E}if(u instanceof String){const E=new String(u.valueOf());return v.set(u,E),h(E,u,g,v,m),E}if(typeof u=="object"&&f(u)){const E=Object.create(Object.getPrototypeOf(u));return v.set(u,E),h(E,u,g,v,m),E}return u}function h(u,p,g=u,v,m){const S=[...Object.keys(p),...t.getSymbols(p)];for(let E=0;E<S.length;E++){const w=S[E],T=Object.getOwnPropertyDescriptor(u,w);(T==null||T.writable)&&(u[w]=c(p[w],w,g,v,m))}}function f(u){switch(n.getTag(u)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=c,e.copyProperties=h})(cloneDeepWith$1)),cloneDeepWith$1}var hasRequiredCloneDeep$1;function requireCloneDeep$1(){return hasRequiredCloneDeep$1||(hasRequiredCloneDeep$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireCloneDeepWith$1();function n(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=n})(cloneDeep$1)),cloneDeep$1}var hasRequiredMatches;function requireMatches(){return hasRequiredMatches||(hasRequiredMatches=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsMatch(),n=requireCloneDeep$1();function a(i){return i=n.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=a})(matches)),matches}var matchesProperty={},cloneDeep={},cloneDeepWith={},hasRequiredCloneDeepWith;function requireCloneDeepWith(){return hasRequiredCloneDeepWith||(hasRequiredCloneDeepWith=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireCloneDeepWith$1(),n=requireTags();function a(i,s){return t.cloneDeepWith(i,(o,c,h,f)=>{const u=s?.(o,c,h,f);if(u!==void 0)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const p=new i.constructor(i?.valueOf());return t.copyProperties(p,i),p}case n.argumentsTag:{const p={};return t.copyProperties(p,i),p.length=i.length,p[Symbol.iterator]=i[Symbol.iterator],p}default:return}})}e.cloneDeepWith=a})(cloneDeepWith)),cloneDeepWith}var hasRequiredCloneDeep;function requireCloneDeep(){return hasRequiredCloneDeep||(hasRequiredCloneDeep=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireCloneDeepWith();function n(a){return t.cloneDeepWith(a)}e.cloneDeep=n})(cloneDeep)),cloneDeep}var has$1={},isIndex={},hasRequiredIsIndex;function requireIsIndex(){return hasRequiredIsIndex||(hasRequiredIsIndex=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(a,i=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<i;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=n})(isIndex)),isIndex}var isArguments={},hasRequiredIsArguments;function requireIsArguments(){return hasRequiredIsArguments||(hasRequiredIsArguments=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireGetTag();function n(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=n})(isArguments)),isArguments}var hasRequiredHas;function requireHas(){return hasRequiredHas||(hasRequiredHas=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsDeepKey(),n=requireIsIndex(),a=requireIsArguments(),i=requireToPath();function s(o,c){let h;if(Array.isArray(c)?h=c:typeof c=="string"&&t.isDeepKey(c)&&o?.[c]==null?h=i.toPath(c):h=[c],h.length===0)return!1;let f=o;for(let u=0;u<h.length;u++){const p=h[u];if((f==null||!Object.hasOwn(f,p))&&!((Array.isArray(f)||a.isArguments(f))&&n.isIndex(p)&&p<f.length))return!1;f=f[p]}return!0}e.has=s})(has$1)),has$1}var hasRequiredMatchesProperty;function requireMatchesProperty(){return hasRequiredMatchesProperty||(hasRequiredMatchesProperty=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsMatch(),n=requireToKey(),a=requireCloneDeep(),i=requireGet$1(),s=requireHas();function o(c,h){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=n.toKey(c);break}}return h=a.cloneDeep(h),function(f){const u=i.get(f,c);return u===void 0?s.has(f,c):h===void 0?u===void 0:t.isMatch(u,h)}}e.matchesProperty=o})(matchesProperty)),matchesProperty}var hasRequiredIteratee;function requireIteratee(){return hasRequiredIteratee||(hasRequiredIteratee=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIdentity(),n=requireProperty(),a=requireMatches(),i=requireMatchesProperty();function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return n.property(o)}}e.iteratee=s})(iteratee)),iteratee}var hasRequiredUniqBy$1;function requireUniqBy$1(){return hasRequiredUniqBy$1||(hasRequiredUniqBy$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireUniqBy$2(),n=requireIdentity(),a=requireIsArrayLikeObject(),i=requireIteratee();function s(o,c=n.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),i.iteratee(c)):[]}e.uniqBy=s})(uniqBy$3)),uniqBy$3}var uniqBy$1,hasRequiredUniqBy;function requireUniqBy(){return hasRequiredUniqBy||(hasRequiredUniqBy=1,uniqBy$1=requireUniqBy$1().uniqBy),uniqBy$1}var uniqByExports=requireUniqBy();const uniqBy=getDefaultExportFromCjs(uniqByExports);function getUniqPayload(e,t,n){return t===!0?uniqBy(e,n):typeof t=="function"?uniqBy(e,t):e}var withSelector$1={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var e=requireReact();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var n=typeof Object.is=="function"?Object.is:t,a=e.useState,i=e.useEffect,s=e.useLayoutEffect,o=e.useDebugValue;function c(p,g){var v=g(),m=a({inst:{value:v,getSnapshot:g}}),S=m[0].inst,E=m[1];return s(function(){S.value=v,S.getSnapshot=g,h(S)&&E({inst:S})},[p,v,g]),i(function(){return h(S)&&E({inst:S}),p(function(){h(S)&&E({inst:S})})},[p]),o(v),v}function h(p){var g=p.getSnapshot;p=p.value;try{var v=g();return!n(p,v)}catch{return!0}}function f(p,g){return g()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:c;return useSyncExternalStoreShim_production.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var e=requireReact(),t=requireShim();function n(f,u){return f===u&&(f!==0||1/f===1/u)||f!==f&&u!==u}var a=typeof Object.is=="function"?Object.is:n,i=t.useSyncExternalStore,s=e.useRef,o=e.useEffect,c=e.useMemo,h=e.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(f,u,p,g,v){var m=s(null);if(m.current===null){var S={hasValue:!1,value:null};m.current=S}else S=m.current;m=c(function(){function w(D){if(!T){if(T=!0,A=D,D=g(D),v!==void 0&&S.hasValue){var N=S.value;if(v(N,D))return L=N}return L=D}if(N=L,a(A,D))return N;var Y=g(D);return v!==void 0&&v(N,Y)?(A=D,N):(A=D,L=Y)}var T=!1,A,L,k=p===void 0?null:p;return[function(){return w(u())},k===null?void 0:function(){return w(k())}]},[u,p,g,v]);var E=i(f,m[0],m[1]);return o(function(){S.hasValue=!0,S.value=E},[E]),h(E),E},withSelector_production}var hasRequiredWithSelector$1;function requireWithSelector$1(){return hasRequiredWithSelector$1||(hasRequiredWithSelector$1=1,withSelector$1.exports=requireWithSelector_production()),withSelector$1.exports}var withSelectorExports=requireWithSelector$1(),RechartsReduxContext=reactExports.createContext(null),noopDispatch=e=>e,useAppDispatch=()=>{var e=reactExports.useContext(RechartsReduxContext);return e?e.store.dispatch:noopDispatch},noop$4=()=>{},addNestedSubNoop=()=>noop$4,refEquality=(e,t)=>e===t;function useAppSelector(e){var t=reactExports.useContext(RechartsReduxContext);return withSelectorExports.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:addNestedSubNoop,t?t.store.getState:noop$4,t?t.store.getState:noop$4,t?e:noop$4,refEquality)}function assertIsFunction(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function assertIsObject(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function assertIsArrayOfFunctions(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${n}]`)}}var ensureIsArray=e=>Array.isArray(e)?e:[e];function getDependencies(e){const t=Array.isArray(e[0])?e[0]:e;return assertIsArrayOfFunctions(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function collectInputSelectorResults(e,t){const n=[],{length:a}=e;for(let i=0;i<a;i++)n.push(e[i].apply(null,t));return n}var StrongRef=class{constructor(e){this.value=e}deref(){return this.value}},Ref=typeof WeakRef<"u"?WeakRef:StrongRef,UNTERMINATED=0,TERMINATED=1;function createCacheNode(){return{s:UNTERMINATED,v:void 0,o:null,p:null}}function weakMapMemoize(e,t={}){let n=createCacheNode();const{resultEqualityCheck:a}=t;let i,s=0;function o(){let c=n;const{length:h}=arguments;for(let p=0,g=h;p<g;p++){const v=arguments[p];if(typeof v=="function"||typeof v=="object"&&v!==null){let m=c.o;m===null&&(c.o=m=new WeakMap);const S=m.get(v);S===void 0?(c=createCacheNode(),m.set(v,c)):c=S}else{let m=c.p;m===null&&(c.p=m=new Map);const S=m.get(v);S===void 0?(c=createCacheNode(),m.set(v,c)):c=S}}const f=c;let u;if(c.s===TERMINATED)u=c.v;else if(u=e.apply(null,arguments),s++,a){const p=i?.deref?.()??i;p!=null&&a(p,u)&&(u=p,s!==0&&s--),i=typeof u=="object"&&u!==null||typeof u=="function"?new Ref(u):u}return f.s=TERMINATED,f.v=u,u}return o.clearCache=()=>{n=createCacheNode(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function createSelectorCreator(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...i)=>{let s=0,o=0,c,h={},f=i.pop();typeof f=="object"&&(h=f,f=i.pop()),assertIsFunction(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const u={...n,...h},{memoize:p,memoizeOptions:g=[],argsMemoize:v=weakMapMemoize,argsMemoizeOptions:m=[]}=u,S=ensureIsArray(g),E=ensureIsArray(m),w=getDependencies(i),T=p(function(){return s++,f.apply(null,arguments)},...S),A=v(function(){o++;const k=collectInputSelectorResults(w,arguments);return c=T.apply(null,k),c},...E);return Object.assign(A,{resultFunc:f,memoizedResultFunc:T,dependencies:w,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>c,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:p,argsMemoize:v})};return Object.assign(a,{withTypes:()=>a}),a}var createSelector=createSelectorCreator(weakMapMemoize),createStructuredSelector=Object.assign((e,t=createSelector)=>{assertIsObject(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),a=n.map(s=>e[s]);return t(a,(...s)=>s.reduce((o,c,h)=>(o[n[h]]=c,o),{}))},{withTypes:()=>createStructuredSelector}),sortBy$2={},orderBy={},compareValues={},hasRequiredCompareValues;function requireCompareValues(){return hasRequiredCompareValues||(hasRequiredCompareValues=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,i,s)=>{if(a!==i){const o=t(a),c=t(i);if(o===c&&o===0){if(a<i)return s==="desc"?1:-1;if(a>i)return s==="desc"?-1:1}return s==="desc"?c-o:o-c}return 0};e.compareValues=n})(compareValues)),compareValues}var isKey={},isSymbol={},hasRequiredIsSymbol;function requireIsSymbol(){return hasRequiredIsSymbol||(hasRequiredIsSymbol=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(isSymbol)),isSymbol}var hasRequiredIsKey;function requireIsKey(){return hasRequiredIsKey||(hasRequiredIsKey=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsSymbol(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(a.test(s)||!n.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(isKey)),isKey}var hasRequiredOrderBy;function requireOrderBy(){return hasRequiredOrderBy||(hasRequiredOrderBy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireCompareValues(),n=requireIsKey(),a=requireToPath();function i(s,o,c,h){if(s==null)return[];c=h?void 0:c,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(v=>String(v));const f=(v,m)=>{let S=v;for(let E=0;E<m.length&&S!=null;++E)S=S[m[E]];return S},u=(v,m)=>m==null||v==null?m:typeof v=="object"&&"key"in v?Object.hasOwn(m,v.key)?m[v.key]:f(m,v.path):typeof v=="function"?v(m):Array.isArray(v)?f(m,v):typeof m=="object"?m[v]:m,p=o.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||n.isKey(v)?v:{key:v,path:a.toPath(v)}));return s.map(v=>({original:v,criteria:p.map(m=>u(m,v))})).slice().sort((v,m)=>{for(let S=0;S<p.length;S++){const E=t.compareValues(v.criteria[S],m.criteria[S],c[S]);if(E!==0)return E}return 0}).map(v=>v.original)}e.orderBy=i})(orderBy)),orderBy}var flatten={},hasRequiredFlatten;function requireFlatten(){return hasRequiredFlatten||(hasRequiredFlatten=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a=1){const i=[],s=Math.floor(a),o=(c,h)=>{for(let f=0;f<c.length;f++){const u=c[f];Array.isArray(u)&&h<s?o(u,h+1):i.push(u)}};return o(n,0),i}e.flatten=t})(flatten)),flatten}var isIterateeCall={},hasRequiredIsIterateeCall;function requireIsIterateeCall(){return hasRequiredIsIterateeCall||(hasRequiredIsIterateeCall=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsIndex(),n=requireIsArrayLike(),a=requireIsObject(),i=requireEq();function s(o,c,h){return a.isObject(h)&&(typeof c=="number"&&n.isArrayLike(h)&&t.isIndex(c)&&c<h.length||typeof c=="string"&&c in h)?i.eq(h[c],o):!1}e.isIterateeCall=s})(isIterateeCall)),isIterateeCall}var hasRequiredSortBy$1;function requireSortBy$1(){return hasRequiredSortBy$1||(hasRequiredSortBy$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireOrderBy(),n=requireFlatten(),a=requireIsIterateeCall();function i(s,...o){const c=o.length;return c>1&&a.isIterateeCall(s,o[0],o[1])?o=[]:c>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,n.flatten(o),["asc"])}e.sortBy=i})(sortBy$2)),sortBy$2}var sortBy$1,hasRequiredSortBy;function requireSortBy(){return hasRequiredSortBy||(hasRequiredSortBy=1,sortBy$1=requireSortBy$1().sortBy),sortBy$1}var sortByExports=requireSortBy();const sortBy=getDefaultExportFromCjs(sortByExports);var selectLegendSettings=e=>e.legend.settings,selectLegendSize=e=>e.legend.size,selectAllLegendPayload2DArray=e=>e.legend.payload;createSelector([selectAllLegendPayload2DArray,selectLegendSettings],(e,t)=>{var{itemSorter:n}=t,a=e.flat(1);return n?sortBy(a,n):a});var EPS$1=1;function useElementOffset(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=reactExports.useState({height:0,left:0,top:0,width:0}),a=reactExports.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>EPS$1||Math.abs(o.left-t.left)>EPS$1||Math.abs(o.top-t.top)>EPS$1||Math.abs(o.width-t.width)>EPS$1)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function formatProdErrorMessage$1(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var $$observable=typeof Symbol=="function"&&Symbol.observable||"@@observable",symbol_observable_default=$$observable,randomString=()=>Math.random().toString(36).substring(7).split("").join("."),ActionTypes={INIT:`@@redux/INIT${randomString()}`,REPLACE:`@@redux/REPLACE${randomString()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${randomString()}`},actionTypes_default=ActionTypes;function isPlainObject$1(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function createStore(e,t,n){if(typeof e!="function")throw new Error(formatProdErrorMessage$1(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage$1(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(formatProdErrorMessage$1(1));return n(createStore)(e,t)}let a=e,i=t,s=new Map,o=s,c=0,h=!1;function f(){o===s&&(o=new Map,s.forEach((E,w)=>{o.set(w,E)}))}function u(){if(h)throw new Error(formatProdErrorMessage$1(3));return i}function p(E){if(typeof E!="function")throw new Error(formatProdErrorMessage$1(4));if(h)throw new Error(formatProdErrorMessage$1(5));let w=!0;f();const T=c++;return o.set(T,E),function(){if(w){if(h)throw new Error(formatProdErrorMessage$1(6));w=!1,f(),o.delete(T),s=null}}}function g(E){if(!isPlainObject$1(E))throw new Error(formatProdErrorMessage$1(7));if(typeof E.type>"u")throw new Error(formatProdErrorMessage$1(8));if(typeof E.type!="string")throw new Error(formatProdErrorMessage$1(17));if(h)throw new Error(formatProdErrorMessage$1(9));try{h=!0,i=a(i,E)}finally{h=!1}return(s=o).forEach(T=>{T()}),E}function v(E){if(typeof E!="function")throw new Error(formatProdErrorMessage$1(10));a=E,g({type:actionTypes_default.REPLACE})}function m(){const E=p;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(formatProdErrorMessage$1(11));function T(){const L=w;L.next&&L.next(u())}return T(),{unsubscribe:E(T)}},[symbol_observable_default](){return this}}}return g({type:actionTypes_default.INIT}),{dispatch:g,subscribe:p,getState:u,replaceReducer:v,[symbol_observable_default]:m}}function assertReducerShape(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:actionTypes_default.INIT})>"u")throw new Error(formatProdErrorMessage$1(12));if(typeof n(void 0,{type:actionTypes_default.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(formatProdErrorMessage$1(13))})}function combineReducers(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(n[o]=e[o])}const a=Object.keys(n);let i;try{assertReducerShape(n)}catch(s){i=s}return function(o={},c){if(i)throw i;let h=!1;const f={};for(let u=0;u<a.length;u++){const p=a[u],g=n[p],v=o[p],m=g(v,c);if(typeof m>"u")throw c&&c.type,new Error(formatProdErrorMessage$1(14));f[p]=m,h=h||m!==v}return h=h||a.length!==Object.keys(o).length,h?f:o}}function compose$1(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...a)=>t(n(...a)))}function applyMiddleware(...e){return t=>(n,a)=>{const i=t(n,a);let s=()=>{throw new Error(formatProdErrorMessage$1(15))};const o={getState:i.getState,dispatch:(h,...f)=>s(h,...f)},c=e.map(h=>h(o));return s=compose$1(...c)(i.dispatch),{...i,dispatch:s}}}function isAction(e){return isPlainObject$1(e)&&"type"in e&&typeof e.type=="string"}var NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(e){return!!e&&!!e[DRAFT_STATE]}function isDraftable(e){return e?isPlainObject(e)||Array.isArray(e)||!!e[DRAFTABLE]||!!e.constructor?.[DRAFTABLE]||isMap(e)||isSet(e):!1}var objectCtorString=Object.prototype.constructor.toString(),cachedCtorStrings=new WeakMap;function isPlainObject(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=cachedCtorStrings.get(n);return a===void 0&&(a=Function.toString.call(n),cachedCtorStrings.set(n,a)),a===objectCtorString}function each(e,t,n=!0){getArchtype(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((a,i)=>t(i,a,e))}function getArchtype(e){const t=e[DRAFT_STATE];return t?t.type_:Array.isArray(e)?1:isMap(e)?2:isSet(e)?3:0}function has(e,t){return getArchtype(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function set(e,t,n){const a=getArchtype(e);a===2?e.set(t,n):a===3?e.add(n):e[t]=n}function is(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function isMap(e){return e instanceof Map}function isSet(e){return e instanceof Set}function latest(e){return e.copy_||e.base_}function shallowCopy(e,t){if(isMap(e))return new Map(e);if(isSet(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=isPlainObject(e);if(t===!0||t==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(e);delete a[DRAFT_STATE];let i=Reflect.ownKeys(a);for(let s=0;s<i.length;s++){const o=i[s],c=a[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(a[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[o]})}return Object.create(getPrototypeOf(e),a)}else{const a=getPrototypeOf(e);if(a!==null&&n)return{...e};const i=Object.create(a);return Object.assign(i,e)}}function freeze(e,t=!1){return isFrozen(e)||isDraft(e)||!isDraftable(e)||(getArchtype(e)>1&&Object.defineProperties(e,{set:dontMutateMethodOverride,add:dontMutateMethodOverride,clear:dontMutateMethodOverride,delete:dontMutateMethodOverride}),Object.freeze(e),t&&Object.values(e).forEach(n=>freeze(n,!0))),e}function dontMutateFrozenCollections(){die(2)}var dontMutateMethodOverride={value:dontMutateFrozenCollections};function isFrozen(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var plugins={};function getPlugin(e){const t=plugins[e];return t||die(0,e),t}var currentScope;function getCurrentScope(){return currentScope}function createScope(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(e,t){t&&(getPlugin("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function revokeScope(e){leaveScope(e),e.drafts_.forEach(revokeDraft),e.drafts_=null}function leaveScope(e){e===currentScope&&(currentScope=e.parent_)}function enterScope(e){return currentScope=createScope(currentScope,e)}function revokeDraft(e){const t=e[DRAFT_STATE];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function processResult(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[DRAFT_STATE].modified_&&(revokeScope(t),die(4)),isDraftable(e)&&(e=finalize(t,e),t.parent_||maybeFreeze(t,e)),t.patches_&&getPlugin("Patches").generateReplacementPatches_(n[DRAFT_STATE].base_,e,t.patches_,t.inversePatches_)):e=finalize(t,n,[]),revokeScope(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==NOTHING?e:void 0}function finalize(e,t,n){if(isFrozen(t))return t;const a=e.immer_.shouldUseStrictIteration(),i=t[DRAFT_STATE];if(!i)return each(t,(s,o)=>finalizeProperty(e,i,t,s,o,n),a),t;if(i.scope_!==e)return t;if(!i.modified_)return maybeFreeze(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,c=!1;i.type_===3&&(o=new Set(s),s.clear(),c=!0),each(o,(h,f)=>finalizeProperty(e,i,s,h,f,n,c),a),maybeFreeze(e,s,!1),n&&e.patches_&&getPlugin("Patches").generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function finalizeProperty(e,t,n,a,i,s,o){if(i==null||typeof i!="object"&&!o)return;const c=isFrozen(i);if(!(c&&!o)){if(isDraft(i)){const h=s&&t&&t.type_!==3&&!has(t.assigned_,a)?s.concat(a):void 0,f=finalize(e,i,h);if(set(n,a,f),isDraft(f))e.canAutoFreeze_=!1;else return}else o&&n.add(i);if(isDraftable(i)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===i&&c)return;finalize(e,i),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(isMap(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&maybeFreeze(e,i)}}}function maybeFreeze(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&freeze(t,n)}function createProxyProxy(e,t){const n=Array.isArray(e),a={type_:n?1:0,scope_:t?t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,s=objectTraps;n&&(i=[a],s=arrayTraps);const{revoke:o,proxy:c}=Proxy.revocable(i,s);return a.draft_=c,a.revoke_=o,c}var objectTraps={get(e,t){if(t===DRAFT_STATE)return e;const n=latest(e);if(!has(n,t))return readPropFromProto(e,n,t);const a=n[t];return e.finalized_||!isDraftable(a)?a:a===peek(e.base_,t)?(prepareCopy(e),e.copy_[t]=createProxy(a,e)):a},has(e,t){return t in latest(e)},ownKeys(e){return Reflect.ownKeys(latest(e))},set(e,t,n){const a=getDescriptorFromProto(latest(e),t);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const i=peek(latest(e),t),s=i?.[DRAFT_STATE];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(is(n,i)&&(n!==void 0||has(e.base_,t)))return!0;prepareCopy(e),markChanged(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return peek(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,prepareCopy(e),markChanged(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=latest(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:n[t]}},defineProperty(){die(11)},getPrototypeOf(e){return getPrototypeOf(e.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each(objectTraps,(e,t)=>{arrayTraps[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});arrayTraps.deleteProperty=function(e,t){return arrayTraps.set.call(this,e,t,void 0)};arrayTraps.set=function(e,t,n){return objectTraps.set.call(this,e[0],t,n,e[0])};function peek(e,t){const n=e[DRAFT_STATE];return(n?latest(n):e)[t]}function readPropFromProto(e,t,n){const a=getDescriptorFromProto(t,n);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function getDescriptorFromProto(e,t){if(!(t in e))return;let n=getPrototypeOf(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=getPrototypeOf(n)}}function markChanged(e){e.modified_||(e.modified_=!0,e.parent_&&markChanged(e.parent_))}function prepareCopy(e){e.copy_||(e.copy_=shallowCopy(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,a)=>{if(typeof t=="function"&&typeof n!="function"){const s=n;n=t;const o=this;return function(h=s,...f){return o.produce(h,u=>n.call(this,u,...f))}}typeof n!="function"&&die(6),a!==void 0&&typeof a!="function"&&die(7);let i;if(isDraftable(t)){const s=enterScope(this),o=createProxy(t,void 0);let c=!0;try{i=n(o),c=!1}finally{c?revokeScope(s):leaveScope(s)}return usePatchesInScope(s,a),processResult(i,s)}else if(!t||typeof t!="object"){if(i=n(t),i===void 0&&(i=t),i===NOTHING&&(i=void 0),this.autoFreeze_&&freeze(i,!0),a){const s=[],o=[];getPlugin("Patches").generateReplacementPatches_(t,i,s,o),a(s,o)}return i}else die(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...c)=>this.produceWithPatches(o,h=>t(h,...c));let a,i;return[this.produce(t,n,(o,c)=>{a=o,i=c}),a,i]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){isDraftable(e)||die(8),isDraft(e)&&(e=current(e));const t=enterScope(this),n=createProxy(e,void 0);return n[DRAFT_STATE].isManual_=!0,leaveScope(t),n}finishDraft(e,t){const n=e&&e[DRAFT_STATE];(!n||!n.isManual_)&&die(9);const{scope_:a}=n;return usePatchesInScope(a,t),processResult(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}n>-1&&(t=t.slice(n+1));const a=getPlugin("Patches").applyPatches_;return isDraft(e)?a(e,t):this.produce(e,i=>a(i,t))}};function createProxy(e,t){const n=isMap(e)?getPlugin("MapSet").proxyMap_(e,t):isSet(e)?getPlugin("MapSet").proxySet_(e,t):createProxyProxy(e,t);return(t?t.scope_:getCurrentScope()).drafts_.push(n),n}function current(e){return isDraft(e)||die(10,e),currentImpl(e)}function currentImpl(e){if(!isDraftable(e)||isFrozen(e))return e;const t=e[DRAFT_STATE];let n,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=shallowCopy(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else n=shallowCopy(e,!0);return each(n,(i,s)=>{set(n,i,currentImpl(s))},a),t&&(t.finalized_=!1),n}var immer=new Immer2,produce=immer.produce;function castDraft(e){return e}function createThunkMiddleware(e){return({dispatch:n,getState:a})=>i=>s=>typeof s=="function"?s(n,a,e):i(s)}var thunk=createThunkMiddleware(),withExtraArgument=createThunkMiddleware,composeWithDevTools=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?compose$1:compose$1.apply(null,arguments)};function createAction(e,t){function n(...a){if(t){let i=t(...a);if(!i)throw new Error(formatProdErrorMessage(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:a[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=a=>isAction(a)&&a.type===e,n}var Tuple=class Aa extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Aa.prototype)}static get[Symbol.species](){return Aa}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Aa(...t[0].concat(this)):new Aa(...t.concat(this))}};function freezeDraftable(e){return isDraftable(e)?produce(e,()=>{}):e}function getOrInsertComputed(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function isBoolean(e){return typeof e=="boolean"}var buildGetDefaultMiddleware=()=>function(t){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new Tuple;return n&&(isBoolean(n)?o.push(thunk):o.push(withExtraArgument(n.extraArgument))),o},SHOULD_AUTOBATCH="RTK_autoBatch",prepareAutoBatched=()=>e=>({payload:e,meta:{[SHOULD_AUTOBATCH]:!0}}),createQueueWithTimer=e=>t=>{setTimeout(t,e)},autoBatchEnhancer=(e={type:"raf"})=>t=>(...n)=>{const a=t(...n);let i=!0,s=!1,o=!1;const c=new Set,h=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:createQueueWithTimer(10):e.type==="callback"?e.queueNotification:createQueueWithTimer(e.timeout),f=()=>{o=!1,s&&(s=!1,c.forEach(u=>u()))};return Object.assign({},a,{subscribe(u){const p=()=>i&&u(),g=a.subscribe(p);return c.add(u),()=>{g(),c.delete(u)}},dispatch(u){try{return i=!u?.meta?.[SHOULD_AUTOBATCH],s=!i,s&&(o||(o=!0,h(f))),a.dispatch(u)}finally{i=!0}}})},buildGetDefaultEnhancers=e=>function(n){const{autoBatch:a=!0}=n??{};let i=new Tuple(e);return a&&i.push(autoBatchEnhancer(typeof a=="object"?a:void 0)),i};function configureStore(e){const t=buildGetDefaultMiddleware(),{reducer:n=void 0,middleware:a,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let c;if(typeof n=="function")c=n;else if(isPlainObject$1(n))c=combineReducers(n);else throw new Error(formatProdErrorMessage(1));let h;typeof a=="function"?h=a(t):h=t();let f=compose$1;i&&(f=composeWithDevTools({trace:!1,...typeof i=="object"&&i}));const u=applyMiddleware(...h),p=buildGetDefaultEnhancers(u);let g=typeof o=="function"?o(p):p();const v=f(...g);return createStore(c,s,v)}function executeReducerBuilderCallback(e){const t={},n=[];let a;const i={addCase(s,o){const c=typeof s=="string"?s:s.type;if(!c)throw new Error(formatProdErrorMessage(28));if(c in t)throw new Error(formatProdErrorMessage(29));return t[c]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return n.push({matcher:s,reducer:o}),i},addDefaultCase(s){return a=s,i}};return e(i),[t,n,a]}function isStateFunction(e){return typeof e=="function"}function createReducer(e,t){let[n,a,i]=executeReducerBuilderCallback(t),s;if(isStateFunction(e))s=()=>freezeDraftable(e());else{const c=freezeDraftable(e);s=()=>c}function o(c=s(),h){let f=[n[h.type],...a.filter(({matcher:u})=>u(h)).map(({reducer:u})=>u)];return f.filter(u=>!!u).length===0&&(f=[i]),f.reduce((u,p)=>{if(p)if(isDraft(u)){const v=p(u,h);return v===void 0?u:v}else{if(isDraftable(u))return produce(u,g=>p(g,h));{const g=p(u,h);if(g===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return u},c)}return o.getInitialState=s,o}var urlAlphabet="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",nanoid=(e=21)=>{let t="",n=e;for(;n--;)t+=urlAlphabet[Math.random()*64|0];return t},asyncThunkSymbol=Symbol.for("rtk-slice-createasyncthunk");function getType(e,t){return`${e}/${t}`}function buildCreateSlice({creators:e}={}){const t=e?.asyncThunk?.[asyncThunkSymbol];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(formatProdErrorMessage(11));const o=(typeof a.reducers=="function"?a.reducers(buildReducerCreators()):a.reducers)||{},c=Object.keys(o),h={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(A,L){const k=typeof A=="string"?A:A.type;if(!k)throw new Error(formatProdErrorMessage(12));if(k in h.sliceCaseReducersByType)throw new Error(formatProdErrorMessage(13));return h.sliceCaseReducersByType[k]=L,f},addMatcher(A,L){return h.sliceMatchers.push({matcher:A,reducer:L}),f},exposeAction(A,L){return h.actionCreators[A]=L,f},exposeCaseReducer(A,L){return h.sliceCaseReducersByName[A]=L,f}};c.forEach(A=>{const L=o[A],k={reducerName:A,type:getType(i,A),createNotation:typeof a.reducers=="function"};isAsyncThunkSliceReducerDefinition(L)?handleThunkCaseReducerDefinition(k,L,f,t):handleNormalReducerDefinition(k,L,f)});function u(){const[A={},L=[],k=void 0]=typeof a.extraReducers=="function"?executeReducerBuilderCallback(a.extraReducers):[a.extraReducers],D={...A,...h.sliceCaseReducersByType};return createReducer(a.initialState,N=>{for(let Y in D)N.addCase(Y,D[Y]);for(let Y of h.sliceMatchers)N.addMatcher(Y.matcher,Y.reducer);for(let Y of L)N.addMatcher(Y.matcher,Y.reducer);k&&N.addDefaultCase(k)})}const p=A=>A,g=new Map,v=new WeakMap;let m;function S(A,L){return m||(m=u()),m(A,L)}function E(){return m||(m=u()),m.getInitialState()}function w(A,L=!1){function k(N){let Y=N[A];return typeof Y>"u"&&L&&(Y=getOrInsertComputed(v,k,E)),Y}function D(N=p){const Y=getOrInsertComputed(g,L,()=>new WeakMap);return getOrInsertComputed(Y,N,()=>{const z={};for(const[te,Z]of Object.entries(a.selectors??{}))z[te]=wrapSelector(Z,N,()=>getOrInsertComputed(v,N,E),L);return z})}return{reducerPath:A,getSelectors:D,get selectors(){return D(k)},selectSlice:k}}const T={name:i,reducer:S,actions:h.actionCreators,caseReducers:h.sliceCaseReducersByName,getInitialState:E,...w(s),injectInto(A,{reducerPath:L,...k}={}){const D=L??s;return A.inject({reducerPath:D,reducer:S},k),{...T,...w(D,!0)}}};return T}}function wrapSelector(e,t,n,a){function i(s,...o){let c=t(s);return typeof c>"u"&&a&&(c=n()),e(c,...o)}return i.unwrapped=e,i}var createSlice=buildCreateSlice();function buildReducerCreators(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function handleNormalReducerDefinition({type:e,reducerName:t,createNotation:n},a,i){let s,o;if("reducer"in a){if(n&&!isCaseReducerWithPrepareDefinition(a))throw new Error(formatProdErrorMessage(17));s=a.reducer,o=a.prepare}else s=a;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?createAction(e,o):createAction(e))}function isAsyncThunkSliceReducerDefinition(e){return e._reducerDefinitionType==="asyncThunk"}function isCaseReducerWithPrepareDefinition(e){return e._reducerDefinitionType==="reducerWithPrepare"}function handleThunkCaseReducerDefinition({type:e,reducerName:t},n,a,i){if(!i)throw new Error(formatProdErrorMessage(18));const{payloadCreator:s,fulfilled:o,pending:c,rejected:h,settled:f,options:u}=n,p=i(e,s,u);a.exposeAction(t,p),o&&a.addCase(p.fulfilled,o),c&&a.addCase(p.pending,c),h&&a.addCase(p.rejected,h),f&&a.addMatcher(p.settled,f),a.exposeCaseReducer(t,{fulfilled:o||noop$3,pending:c||noop$3,rejected:h||noop$3,settled:f||noop$3})}function noop$3(){}var task="task",listener="listener",completed="completed",cancelled="cancelled",taskCancelled=`task-${cancelled}`,taskCompleted=`task-${completed}`,listenerCancelled=`${listener}-${cancelled}`,listenerCompleted=`${listener}-${completed}`,TaskAbortError=class{constructor(e){this.code=e,this.message=`${task} ${cancelled} (reason: ${e})`}name="TaskAbortError";message},assertFunction=(e,t)=>{if(typeof e!="function")throw new TypeError(formatProdErrorMessage(32))},noop2=()=>{},catchRejection=(e,t=noop2)=>(e.catch(t),e),addAbortSignalListener=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),abortControllerWithReason=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},validateActive=e=>{if(e.aborted){const{reason:t}=e;throw new TaskAbortError(t)}};function raceWithSignal(e,t){let n=noop2;return new Promise((a,i)=>{const s=()=>i(new TaskAbortError(e.reason));if(e.aborted){s();return}n=addAbortSignalListener(e,s),t.finally(()=>n()).then(a,i)}).finally(()=>{n=noop2})}var runTask=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof TaskAbortError?"cancelled":"rejected",error:n}}finally{t?.()}},createPause=e=>t=>catchRejection(raceWithSignal(e,t).then(n=>(validateActive(e),n))),createDelay=e=>{const t=createPause(e);return n=>t(new Promise(a=>setTimeout(a,n)))},{assign}=Object,INTERNAL_NIL_TOKEN={},alm="listenerMiddleware",createFork=(e,t)=>{const n=a=>addAbortSignalListener(e,()=>abortControllerWithReason(a,e.reason));return(a,i)=>{assertFunction(a);const s=new AbortController;n(s);const o=runTask(async()=>{validateActive(e),validateActive(s.signal);const c=await a({pause:createPause(s.signal),delay:createDelay(s.signal),signal:s.signal});return validateActive(s.signal),c},()=>abortControllerWithReason(s,taskCompleted));return i?.autoJoin&&t.push(o.catch(noop2)),{result:createPause(e)(o),cancel(){abortControllerWithReason(s,taskCancelled)}}}},createTakePattern=(e,t)=>{const n=async(a,i)=>{validateActive(t);let s=()=>{};const c=[new Promise((h,f)=>{let u=e({predicate:a,effect:(p,g)=>{g.unsubscribe(),h([p,g.getState(),g.getOriginalState()])}});s=()=>{u(),f()}})];i!=null&&c.push(new Promise(h=>setTimeout(h,i,null)));try{const h=await raceWithSignal(t,Promise.race(c));return validateActive(t),h}finally{s()}};return(a,i)=>catchRejection(n(a,i))},getListenerEntryPropsFrom=e=>{let{type:t,actionCreator:n,matcher:a,predicate:i,effect:s}=e;if(t)i=createAction(t).match;else if(n)t=n.type,i=n.match;else if(a)i=a;else if(!i)throw new Error(formatProdErrorMessage(21));return assertFunction(s),{predicate:i,type:t,effect:s}},createListenerEntry=assign(e=>{const{type:t,predicate:n,effect:a}=getListenerEntryPropsFrom(e);return{id:nanoid(),effect:a,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(formatProdErrorMessage(22))}}},{withTypes:()=>createListenerEntry}),findListenerEntry=(e,t)=>{const{type:n,effect:a,predicate:i}=getListenerEntryPropsFrom(t);return Array.from(e.values()).find(s=>(typeof n=="string"?s.type===n:s.predicate===i)&&s.effect===a)},cancelActiveListeners=e=>{e.pending.forEach(t=>{abortControllerWithReason(t,listenerCancelled)})},createClearListenerMiddleware=(e,t)=>()=>{for(const n of t.keys())cancelActiveListeners(n);e.clear()},safelyNotifyError=(e,t,n)=>{try{e(t,n)}catch(a){setTimeout(()=>{throw a},0)}},addListener=assign(createAction(`${alm}/add`),{withTypes:()=>addListener}),clearAllListeners=createAction(`${alm}/removeAll`),removeListener=assign(createAction(`${alm}/remove`),{withTypes:()=>removeListener}),defaultErrorHandler=(...e)=>{console.error(`${alm}/error`,...e)},createListenerMiddleware=(e={})=>{const t=new Map,n=new Map,a=v=>{const m=n.get(v)??0;n.set(v,m+1)},i=v=>{const m=n.get(v)??1;m===1?n.delete(v):n.set(v,m-1)},{extra:s,onError:o=defaultErrorHandler}=e;assertFunction(o);const c=v=>(v.unsubscribe=()=>t.delete(v.id),t.set(v.id,v),m=>{v.unsubscribe(),m?.cancelActive&&cancelActiveListeners(v)}),h=v=>{const m=findListenerEntry(t,v)??createListenerEntry(v);return c(m)};assign(h,{withTypes:()=>h});const f=v=>{const m=findListenerEntry(t,v);return m&&(m.unsubscribe(),v.cancelActive&&cancelActiveListeners(m)),!!m};assign(f,{withTypes:()=>f});const u=async(v,m,S,E)=>{const w=new AbortController,T=createTakePattern(h,w.signal),A=[];try{v.pending.add(w),a(v),await Promise.resolve(v.effect(m,assign({},S,{getOriginalState:E,condition:(L,k)=>T(L,k).then(Boolean),take:T,delay:createDelay(w.signal),pause:createPause(w.signal),extra:s,signal:w.signal,fork:createFork(w.signal,A),unsubscribe:v.unsubscribe,subscribe:()=>{t.set(v.id,v)},cancelActiveListeners:()=>{v.pending.forEach((L,k,D)=>{L!==w&&(abortControllerWithReason(L,listenerCancelled),D.delete(L))})},cancel:()=>{abortControllerWithReason(w,listenerCancelled),v.pending.delete(w)},throwIfCancelled:()=>{validateActive(w.signal)}})))}catch(L){L instanceof TaskAbortError||safelyNotifyError(o,L,{raisedBy:"effect"})}finally{await Promise.all(A),abortControllerWithReason(w,listenerCompleted),i(v),v.pending.delete(w)}},p=createClearListenerMiddleware(t,n);return{middleware:v=>m=>S=>{if(!isAction(S))return m(S);if(addListener.match(S))return h(S.payload);if(clearAllListeners.match(S)){p();return}if(removeListener.match(S))return f(S.payload);let E=v.getState();const w=()=>{if(E===INTERNAL_NIL_TOKEN)throw new Error(formatProdErrorMessage(23));return E};let T;try{if(T=m(S),t.size>0){const A=v.getState(),L=Array.from(t.values());for(const k of L){let D=!1;try{D=k.predicate(S,A,E)}catch(N){D=!1,safelyNotifyError(o,N,{raisedBy:"predicate"})}D&&u(k,S,v,w)}}}finally{E=INTERNAL_NIL_TOKEN}return T},startListening:h,stopListening:f,clearListeners:p}};function formatProdErrorMessage(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var initialState$a={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},chartLayoutSlice=createSlice({name:"chartLayout",initialState:initialState$a,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,a,i,s;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin,setLayout,setChartSize,setScale}=chartLayoutSlice.actions,chartLayoutReducer=chartLayoutSlice.reducer;function ownKeys$r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$r(Object(n),!0).forEach(function(a){_defineProperty$t(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$r(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$t(e,t,n){return(t=_toPropertyKey$t(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$t(e){var t=_toPrimitive$t(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$t(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RADIAN=Math.PI/180,radianToDegree=e=>e*180/Math.PI,polarToCartesian=(e,t,n,a)=>({x:e+Math.cos(-RADIAN*a)*n,y:t+Math.sin(-RADIAN*a)*n}),getMaxRadius=function e(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},distanceBetweenPoints=(e,t)=>{var{x:n,y:a}=e,{x:i,y:s}=t;return Math.sqrt((n-i)**2+(a-s)**2)},getAngleOfPoint=(e,t)=>{var{x:n,y:a}=e,{cx:i,cy:s}=t,o=distanceBetweenPoints({x:n,y:a},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var c=(n-i)/o,h=Math.acos(c);return a>s&&(h=2*Math.PI-h),{radius:o,angle:radianToDegree(h),angleInRadian:h}},formatAngleOfSector=e=>{var{startAngle:t,endAngle:n}=e,a=Math.floor(t/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:t-s*360,endAngle:n-s*360}},reverseFormatAngleOfSector=(e,t)=>{var{startAngle:n,endAngle:a}=t,i=Math.floor(n/360),s=Math.floor(a/360),o=Math.min(i,s);return e+o*360},inRangeOfSector=(e,t)=>{var{x:n,y:a}=e,{radius:i,angle:s}=getAngleOfPoint({x:n,y:a},t),{innerRadius:o,outerRadius:c}=t;if(i<o||i>c||i===0)return null;var{startAngle:h,endAngle:f}=formatAngleOfSector(t),u=s,p;if(h<=f){for(;u>f;)u-=360;for(;u<h;)u+=360;p=u>=h&&u<=f}else{for(;u>h;)u-=360;for(;u<f;)u+=360;p=u>=f&&u<=h}return p?_objectSpread$r(_objectSpread$r({},t),{},{radius:i,angle:reverseFormatAngleOfSector(u,t)}):null};function getSliced(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function ownKeys$q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$q(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$q(Object(n),!0).forEach(function(a){_defineProperty$s(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$q(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$s(e,t,n){return(t=_toPropertyKey$s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$s(e){var t=_toPrimitive$s(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$s(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function getValueByDataKey(e,t,n){return isNullish(e)||isNullish(t)?n:isNumOrStr(t)?get(e,t,n):typeof t=="function"?t(e):n}var calculateActiveTickIndex=(e,t,n,a,i)=>{var s,o=-1,c=(s=t?.length)!==null&&s!==void 0?s:0;if(c<=1||e==null)return 0;if(a==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var h=0;h<c;h++){var f=h>0?n[h-1].coordinate:n[c-1].coordinate,u=n[h].coordinate,p=h>=c-1?n[0].coordinate:n[h+1].coordinate,g=void 0;if(mathSign(u-f)!==mathSign(p-u)){var v=[];if(mathSign(p-u)===mathSign(i[1]-i[0])){g=p;var m=u+i[1]-i[0];v[0]=Math.min(m,(m+f)/2),v[1]=Math.max(m,(m+f)/2)}else{g=f;var S=p+i[1]-i[0];v[0]=Math.min(u,(S+u)/2),v[1]=Math.max(u,(S+u)/2)}var E=[Math.min(u,(g+u)/2),Math.max(u,(g+u)/2)];if(e>E[0]&&e<=E[1]||e>=v[0]&&e<=v[1]){({index:o}=n[h]);break}}else{var w=Math.min(f,p),T=Math.max(f,p);if(e>(w+u)/2&&e<=(T+u)/2){({index:o}=n[h]);break}}}else if(t){for(var A=0;A<c;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<c-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===c-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:o}=t[A]);break}}return o},appendOffsetOfLegend=(e,t,n)=>{if(t&&n){var{width:a,height:i}=n,{align:s,verticalAlign:o,layout:c}=t;if((c==="vertical"||c==="horizontal"&&o==="middle")&&s!=="center"&&isNumber(e[s]))return _objectSpread$q(_objectSpread$q({},e),{},{[s]:e[s]+(a||0)});if((c==="horizontal"||c==="vertical"&&s==="center")&&o!=="middle"&&isNumber(e[o]))return _objectSpread$q(_objectSpread$q({},e),{},{[o]:e[o]+(i||0)})}return e},isCategoricalAxis=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",getCoordinatesOfGrid=(e,t,n,a)=>{if(a)return e.map(c=>c.coordinate);var i,s,o=e.map(c=>(c.coordinate===t&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate));return i||o.push(t),s||o.push(n),o},getTicksOfAxis=(e,t,n)=>{if(!e)return null;var{duplicateDomain:a,type:i,range:s,scale:o,realScaleType:c,isCategorical:h,categoricalDomain:f,tickCount:u,ticks:p,niceTicks:g,axisType:v}=e;if(!o)return null;var m=c==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,S=i==="category"&&o.bandwidth?o.bandwidth()/m:0;if(S=v==="angleAxis"&&s&&s.length>=2?mathSign(s[0]-s[1])*2*S:S,p||g){var E=(p||g||[]).map((w,T)=>{var A=a?a.indexOf(w):w;return{coordinate:o(A)+S,value:w,offset:S,index:T}});return E.filter(w=>!isNan(w.coordinate))}return h&&f?f.map((w,T)=>({coordinate:o(w)+S,value:w,index:T,offset:S})):o.ticks&&u!=null?o.ticks(u).map((w,T)=>({coordinate:o(w)+S,value:w,offset:S,index:T})):o.domain().map((w,T)=>({coordinate:o(w)+S,value:a?a[w]:w,index:T,offset:S}))},EPS=1e-4,checkDomainOfScale=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,a=e.range(),i=Math.min(a[0],a[1])-EPS,s=Math.max(a[0],a[1])+EPS,o=e(t[0]),c=e(t[n-1]);(o<i||o>s||c<i||c>s)&&e.domain([t[0],t[n-1]])}},offsetSign=e=>{var t=e.length;if(!(t<=0))for(var n=0,a=e[0].length;n<a;++n)for(var i=0,s=0,o=0;o<t;++o){var c=isNan(e[o][n][1])?e[o][n][0]:e[o][n][1];c>=0?(e[o][n][0]=i,e[o][n][1]=i+c,i=e[o][n][1]):(e[o][n][0]=s,e[o][n][1]=s+c,s=e[o][n][1])}},offsetPositive=e=>{var t=e.length;if(!(t<=0))for(var n=0,a=e[0].length;n<a;++n)for(var i=0,s=0;s<t;++s){var o=isNan(e[s][n][1])?e[s][n][0]:e[s][n][1];o>=0?(e[s][n][0]=i,e[s][n][1]=i+o,i=e[s][n][1]):(e[s][n][0]=0,e[s][n][1]=0)}},STACK_OFFSET_MAP={sign:offsetSign,expand:stackOffsetExpand,none:stackOffsetNone,silhouette:stackOffsetSilhouette,wiggle:stackOffsetWiggle,positive:offsetPositive},getStackedData=(e,t,n)=>{var a=STACK_OFFSET_MAP[n],i=shapeStack().keys(t).value((s,o)=>+getValueByDataKey(s,o,0)).order(stackOrderNone).offset(a);return i(e)};function getCateCoordinateOfLine(e){var{axis:t,ticks:n,bandSize:a,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!isNullish(i[t.dataKey])){var c=findEntryInArray(n,"value",i[t.dataKey]);if(c)return c.coordinate+a/2}return n[s]?n[s].coordinate+a/2:null}var h=getValueByDataKey(i,isNullish(o)?t.dataKey:o);return isNullish(h)?null:t.scale(h)}var getDomainOfSingle=e=>{var t=e.flat(2).filter(isNumber);return[Math.min(...t),Math.max(...t)]},makeDomainFinite=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],getDomainOfStackGroups=(e,t,n)=>{if(e!=null)return makeDomainFinite(Object.keys(e).reduce((a,i)=>{var s=e[i],{stackedData:o}=s,c=o.reduce((h,f)=>{var u=getSliced(f,t,n),p=getDomainOfSingle(u);return[Math.min(h[0],p[0]),Math.max(h[1],p[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]))},MIN_VALUE_REG=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MAX_VALUE_REG=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,getBandSizeOfAxis=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&t&&t.length>=2){for(var i=sortBy(t,u=>u.coordinate),s=1/0,o=1,c=i.length;o<c;o++){var h=i[o],f=i[o-1];s=Math.min((h.coordinate||0)-(f.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0};function getTooltipEntry(e){var{tooltipEntrySettings:t,dataKey:n,payload:a,value:i,name:s}=e;return _objectSpread$q(_objectSpread$q({},t),{},{dataKey:n,payload:a,value:i,name:s})}function getTooltipNameProp(e,t){if(e)return String(e);if(typeof t=="string")return t}function inRange(e,t,n,a,i){if(n==="horizontal"||n==="vertical"){var s=e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height;return s?{x:e,y:t}:null}return a?inRangeOfSector({x:e,y:t},a):null}var getActiveCoordinate=(e,t,n,a)=>{var i=t.find(f=>f&&f.index===n);if(i){if(e==="horizontal")return{x:i.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:i.coordinate};if(e==="centric"){var s=i.coordinate,{radius:o}=a;return _objectSpread$q(_objectSpread$q(_objectSpread$q({},a),polarToCartesian(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var c=i.coordinate,{angle:h}=a;return _objectSpread$q(_objectSpread$q(_objectSpread$q({},a),polarToCartesian(a.cx,a.cy,c,h)),{},{angle:h,radius:c})}return{x:0,y:0}},calculateTooltipPos=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,selectChartWidth=e=>e.layout.width,selectChartHeight=e=>e.layout.height,selectContainerScale=e=>e.layout.scale,selectMargin=e=>e.layout.margin,selectAllXAxes=createSelector(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),selectAllYAxes=createSelector(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),DATA_ITEM_INDEX_ATTRIBUTE_NAME="data-recharts-item-index",DATA_ITEM_DATAKEY_ATTRIBUTE_NAME="data-recharts-item-data-key",DEFAULT_Y_AXIS_WIDTH=60;function ownKeys$p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$p(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$p(Object(n),!0).forEach(function(a){_defineProperty$r(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$p(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$r(e,t,n){return(t=_toPropertyKey$r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$r(e){var t=_toPrimitive$r(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$r(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var selectBrushHeight=e=>e.brush.height;function selectLeftAxesOffset(e){var t=selectAllYAxes(e);return t.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:DEFAULT_Y_AXIS_WIDTH;return n+i}return n},0)}function selectRightAxesOffset(e){var t=selectAllYAxes(e);return t.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:DEFAULT_Y_AXIS_WIDTH;return n+i}return n},0)}function selectTopAxesOffset(e){var t=selectAllXAxes(e);return t.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function selectBottomAxesOffset(e){var t=selectAllXAxes(e);return t.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var selectChartOffsetInternal=createSelector([selectChartWidth,selectChartHeight,selectMargin,selectBrushHeight,selectLeftAxesOffset,selectRightAxesOffset,selectTopAxesOffset,selectBottomAxesOffset,selectLegendSettings,selectLegendSize],(e,t,n,a,i,s,o,c,h,f)=>{var u={left:(n.left||0)+i,right:(n.right||0)+s},p={top:(n.top||0)+o,bottom:(n.bottom||0)+c},g=_objectSpread$p(_objectSpread$p({},p),u),v=g.bottom;g.bottom+=a,g=appendOffsetOfLegend(g,h,f);var m=e-g.left-g.right,S=t-g.top-g.bottom;return _objectSpread$p(_objectSpread$p({brushBottom:v},g),{},{width:Math.max(m,0),height:Math.max(S,0)})}),selectChartViewBox=createSelector(selectChartOffsetInternal,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),selectAxisViewBox=createSelector(selectChartWidth,selectChartHeight,(e,t)=>({x:0,y:0,width:e,height:t})),PanoramaContext=reactExports.createContext(null),useIsPanorama=()=>reactExports.useContext(PanoramaContext)!=null,selectBrushSettings=e=>e.brush,selectBrushDimensions=createSelector([selectBrushSettings,selectChartOffsetInternal,selectMargin],(e,t,n)=>({height:e.height,x:isNumber(e.x)?e.x:t.left,y:isNumber(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:isNumber(e.width)?e.width:t.width})),throttle$2={},debounce$1={},debounce={},hasRequiredDebounce$1;function requireDebounce$1(){return hasRequiredDebounce$1||(hasRequiredDebounce$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a,{signal:i,edges:s}={}){let o,c=null;const h=s!=null&&s.includes("leading"),f=s==null||s.includes("trailing"),u=()=>{c!==null&&(n.apply(o,c),o=void 0,c=null)},p=()=>{f&&u(),S()};let g=null;const v=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,p()},a)},m=()=>{g!==null&&(clearTimeout(g),g=null)},S=()=>{m(),o=void 0,c=null},E=()=>{u()},w=function(...T){if(i?.aborted)return;o=this,c=T;const A=g==null;v(),h&&A&&u()};return w.schedule=v,w.cancel=S,w.flush=E,i?.addEventListener("abort",S,{once:!0}),w}e.debounce=t})(debounce)),debounce}var hasRequiredDebounce;function requireDebounce(){return hasRequiredDebounce||(hasRequiredDebounce=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireDebounce$1();function n(a,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:c=!0,maxWait:h}=s,f=Array(2);o&&(f[0]="leading"),c&&(f[1]="trailing");let u,p=null;const g=t.debounce(function(...S){u=a.apply(this,S),p=null},i,{edges:f}),v=function(...S){return h!=null&&(p===null&&(p=Date.now()),Date.now()-p>=h)?(u=a.apply(this,S),p=Date.now(),g.cancel(),g.schedule(),u):(g.apply(this,S),u)},m=()=>(g.flush(),u);return v.cancel=g.cancel,v.flush=m,v}e.debounce=n})(debounce$1)),debounce$1}var hasRequiredThrottle$1;function requireThrottle$1(){return hasRequiredThrottle$1||(hasRequiredThrottle$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireDebounce();function n(a,i=0,s={}){const{leading:o=!0,trailing:c=!0}=s;return t.debounce(a,i,{leading:o,maxWait:i,trailing:c})}e.throttle=n})(throttle$2)),throttle$2}var throttle$1,hasRequiredThrottle;function requireThrottle(){return hasRequiredThrottle||(hasRequiredThrottle=1,throttle$1=requireThrottle$1().throttle),throttle$1}var throttleExports=requireThrottle();const throttle=getDefaultExportFromCjs(throttleExports);var warn=function e(t,n){for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s]},calculateChartDimensions=(e,t,n)=>{var{width:a="100%",height:i="100%",aspect:s,maxHeight:o}=n,c=isPercent(a)?e:Number(a),h=isPercent(i)?t:Number(i);return s&&s>0&&(c?h=c/s:h&&(c=h*s),o&&h>o&&(h=o)),{calculatedWidth:c,calculatedHeight:h}},bothOverflow={width:0,height:0,overflow:"visible"},overflowX={width:0,overflowX:"visible"},overflowY={height:0,overflowY:"visible"},noStyle={},getInnerDivStyle=e=>{var{width:t,height:n}=e,a=isPercent(t),i=isPercent(n);return a&&i?bothOverflow:a?overflowX:i?overflowY:noStyle};function getDefaultWidthAndHeight(e){var{width:t,height:n,aspect:a}=e,i=t,s=n;return i===void 0&&s===void 0?(i="100%",s="100%"):i===void 0?i=a&&a>0?void 0:"100%":s===void 0&&(s=a&&a>0?void 0:"100%"),{width:i,height:s}}function isWellBehavedNumber(e){return Number.isFinite(e)}function isPositiveNumber(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function _extends$i(){return _extends$i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$i.apply(null,arguments)}function ownKeys$o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$o(Object(n),!0).forEach(function(a){_defineProperty$q(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$o(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$q(e,t,n){return(t=_toPropertyKey$q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$q(e){var t=_toPrimitive$q(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$q(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ResponsiveContainerContext=reactExports.createContext({width:-1,height:-1});function ResponsiveContainerContextProvider(e){var{children:t,width:n,height:a}=e,i=reactExports.useMemo(()=>({width:n,height:a}),[n,a]);return n<=0||a<=0?null:reactExports.createElement(ResponsiveContainerContext.Provider,{value:i},t)}var useResponsiveContainerContext=()=>reactExports.useContext(ResponsiveContainerContext),SizeDetectorContainer=reactExports.forwardRef((e,t)=>{var{aspect:n,initialDimension:a={width:-1,height:-1},width:i,height:s,minWidth:o=0,minHeight:c,maxHeight:h,children:f,debounce:u=0,id:p,className:g,onResize:v,style:m={}}=e,S=reactExports.useRef(null),E=reactExports.useRef();E.current=v,reactExports.useImperativeHandle(t,()=>S.current);var[w,T]=reactExports.useState({containerWidth:a.width,containerHeight:a.height}),A=reactExports.useCallback((Y,z)=>{T(te=>{var Z=Math.round(Y),ne=Math.round(z);return te.containerWidth===Z&&te.containerHeight===ne?te:{containerWidth:Z,containerHeight:ne}})},[]);reactExports.useEffect(()=>{var Y=ne=>{var oe,{width:le,height:pe}=ne[0].contentRect;A(le,pe),(oe=E.current)===null||oe===void 0||oe.call(E,le,pe)};u>0&&(Y=throttle(Y,u,{trailing:!0,leading:!1}));var z=new ResizeObserver(Y),{width:te,height:Z}=S.current.getBoundingClientRect();return A(te,Z),z.observe(S.current),()=>{z.disconnect()}},[A,u]);var{containerWidth:L,containerHeight:k}=w;warn(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:D,calculatedHeight:N}=calculateChartDimensions(L,k,{width:i,height:s,aspect:n,maxHeight:h});return warn(D>0||N>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,D,N,i,s,o,c,n),reactExports.createElement("div",{id:p?"".concat(p):void 0,className:clsx("recharts-responsive-container",g),style:_objectSpread$o(_objectSpread$o({},m),{},{width:i,height:s,minWidth:o,minHeight:c,maxHeight:h}),ref:S},reactExports.createElement("div",{style:getInnerDivStyle({width:i,height:s})},reactExports.createElement(ResponsiveContainerContextProvider,{width:D,height:N},f)))}),ResponsiveContainer=reactExports.forwardRef((e,t)=>{var n=useResponsiveContainerContext();if(isPositiveNumber(n.width)&&isPositiveNumber(n.height))return e.children;var{width:a,height:i}=getDefaultWidthAndHeight({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=calculateChartDimensions(void 0,void 0,{width:a,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return isNumber(s)&&isNumber(o)?reactExports.createElement(ResponsiveContainerContextProvider,{width:s,height:o},e.children):reactExports.createElement(SizeDetectorContainer,_extends$i({},e,{width:a,height:i,ref:t}))}),useViewBox=()=>{var e,t=useIsPanorama(),n=useAppSelector(selectChartViewBox),a=useAppSelector(selectBrushDimensions),i=(e=useAppSelector(selectBrushSettings))===null||e===void 0?void 0:e.padding;return!t||!a||!i?n:{width:a.width-i.left-i.right,height:a.height-i.top-i.bottom,x:i.left,y:i.top}},manyComponentsThrowErrorsIfOffsetIsUndefined={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},useOffsetInternal=()=>{var e;return(e=useAppSelector(selectChartOffsetInternal))!==null&&e!==void 0?e:manyComponentsThrowErrorsIfOffsetIsUndefined},useChartWidth=()=>useAppSelector(selectChartWidth),useChartHeight=()=>useAppSelector(selectChartHeight),selectChartLayout=e=>e.layout.layoutType,useChartLayout=()=>useAppSelector(selectChartLayout),ReportChartSize=e=>{var t=useAppDispatch(),n=useIsPanorama(),{width:a,height:i}=e,s=useResponsiveContainerContext(),o=a,c=i;return s&&(o=s.width>0?s.width:a,c=s.height>0?s.height:i),reactExports.useEffect(()=>{!n&&isPositiveNumber(o)&&isPositiveNumber(c)&&t(setChartSize({width:o,height:c}))},[t,n,o,c]),null},initialState$9={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},legendSlice=createSlice({name:"legend",initialState:initialState$9,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:prepareAutoBatched()},removeLegendPayload:{reducer(e,t){var n=current(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:prepareAutoBatched()}}}),{setLegendSize,setLegendSettings,addLegendPayload,removeLegendPayload}=legendSlice.actions,legendReducer=legendSlice.reducer;function _extends$h(){return _extends$h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$h.apply(null,arguments)}function ownKeys$n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$n(Object(n),!0).forEach(function(a){_defineProperty$p(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$n(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$p(e,t,n){return(t=_toPropertyKey$p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$p(e){var t=_toPrimitive$p(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$p(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function defaultFormatter(e){return Array.isArray(e)&&isNumOrStr(e[0])&&isNumOrStr(e[1])?e.join(" ~ "):e}var DefaultTooltipContent=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:a={},labelStyle:i={},payload:s,formatter:o,itemSorter:c,wrapperClassName:h,labelClassName:f,label:u,labelFormatter:p,accessibilityLayer:g=!1}=e,v=()=>{if(s&&s.length){var k={padding:0,margin:0},D=(c?sortBy(s,c):s).map((N,Y)=>{if(N.type==="none")return null;var z=N.formatter||o||defaultFormatter,{value:te,name:Z}=N,ne=te,oe=Z;if(z){var le=z(te,Z,N,Y,s);if(Array.isArray(le))[ne,oe]=le;else if(le!=null)ne=le;else return null}var pe=_objectSpread$n({display:"block",paddingTop:4,paddingBottom:4,color:N.color||"#000"},a);return reactExports.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Y),style:pe},isNumOrStr(oe)?reactExports.createElement("span",{className:"recharts-tooltip-item-name"},oe):null,isNumOrStr(oe)?reactExports.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,reactExports.createElement("span",{className:"recharts-tooltip-item-value"},ne),reactExports.createElement("span",{className:"recharts-tooltip-item-unit"},N.unit||""))});return reactExports.createElement("ul",{className:"recharts-tooltip-item-list",style:k},D)}return null},m=_objectSpread$n({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),S=_objectSpread$n({margin:0},i),E=!isNullish(u),w=E?u:"",T=clsx("recharts-default-tooltip",h),A=clsx("recharts-tooltip-label",f);E&&p&&s!==void 0&&s!==null&&(w=p(u,s));var L=g?{role:"status","aria-live":"assertive"}:{};return reactExports.createElement("div",_extends$h({className:T,style:m},L),reactExports.createElement("p",{className:A,style:S},reactExports.isValidElement(w)?w:"".concat(w)),v())},CSS_CLASS_PREFIX="recharts-tooltip-wrapper",TOOLTIP_HIDDEN={visibility:"hidden"};function getTooltipCSSClassName(e){var{coordinate:t,translateX:n,translateY:a}=e;return clsx(CSS_CLASS_PREFIX,{["".concat(CSS_CLASS_PREFIX,"-right")]:isNumber(n)&&t&&isNumber(t.x)&&n>=t.x,["".concat(CSS_CLASS_PREFIX,"-left")]:isNumber(n)&&t&&isNumber(t.x)&&n<t.x,["".concat(CSS_CLASS_PREFIX,"-bottom")]:isNumber(a)&&t&&isNumber(t.y)&&a>=t.y,["".concat(CSS_CLASS_PREFIX,"-top")]:isNumber(a)&&t&&isNumber(t.y)&&a<t.y})}function getTooltipTranslateXY(e){var{allowEscapeViewBox:t,coordinate:n,key:a,offsetTopLeft:i,position:s,reverseDirection:o,tooltipDimension:c,viewBox:h,viewBoxDimension:f}=e;if(s&&isNumber(s[a]))return s[a];var u=n[a]-c-(i>0?i:0),p=n[a]+i;if(t[a])return o[a]?u:p;var g=h[a];if(g==null)return 0;if(o[a]){var v=u,m=g;return v<m?Math.max(p,g):Math.max(u,g)}if(f==null)return 0;var S=p+c,E=g+f;return S>E?Math.max(u,g):Math.max(p,g)}function getTransformStyle(e){var{translateX:t,translateY:n,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function getTooltipTranslate(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipBox:o,useTranslate3d:c,viewBox:h}=e,f,u,p;return o.height>0&&o.width>0&&n?(u=getTooltipTranslateXY({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.width,viewBox:h,viewBoxDimension:h.width}),p=getTooltipTranslateXY({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.height,viewBox:h,viewBoxDimension:h.height}),f=getTransformStyle({translateX:u,translateY:p,useTranslate3d:c})):f=TOOLTIP_HIDDEN,{cssProperties:f,cssClasses:getTooltipCSSClassName({translateX:u,translateY:p,coordinate:n})}}function ownKeys$m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$m(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$m(Object(n),!0).forEach(function(a){_defineProperty$o(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$m(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$o(e,t,n){return(t=_toPropertyKey$o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$o(e){var t=_toPrimitive$o(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$o(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class TooltipBoundingBox extends reactExports.PureComponent{constructor(){super(...arguments),_defineProperty$o(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),_defineProperty$o(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,a,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,children:s,coordinate:o,hasPayload:c,isAnimationActive:h,offset:f,position:u,reverseDirection:p,useTranslate3d:g,viewBox:v,wrapperStyle:m,lastBoundingBox:S,innerRef:E,hasPortalFromProps:w}=this.props,{cssClasses:T,cssProperties:A}=getTooltipTranslate({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:f,position:u,reverseDirection:p,tooltipBox:{height:S.height,width:S.width},useTranslate3d:g,viewBox:v}),L=w?{}:_objectSpread$m(_objectSpread$m({transition:h&&t?"transform ".concat(a,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),k=_objectSpread$m(_objectSpread$m({},L),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},m);return reactExports.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:k,ref:E},s)}}var parseIsSsrByDefault=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Global={devToolsEnabled:!1,isSsr:parseIsSsrByDefault()},useAccessibilityLayer=()=>useAppSelector(e=>e.rootProps.accessibilityLayer);function _extends$g(){return _extends$g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$g.apply(null,arguments)}function ownKeys$l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$l(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$l(Object(n),!0).forEach(function(a){_defineProperty$n(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$l(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$n(e,t,n){return(t=_toPropertyKey$n(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$n(e){var t=_toPrimitive$n(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$n(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CURVE_FACTORIES={curveBasisClosed,curveBasisOpen,curveBasis,curveBumpX:bumpX,curveBumpY:bumpY,curveLinearClosed,curveLinear,curveMonotoneX:monotoneX,curveMonotoneY:monotoneY,curveNatural,curveStep,curveStepAfter:stepAfter,curveStepBefore:stepBefore},defined=e=>isWellBehavedNumber(e.x)&&isWellBehavedNumber(e.y),getX=e=>e.x,getY=e=>e.y,getCurveFactory=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(upperFirst(e));return(n==="curveMonotone"||n==="curveBump")&&t?CURVE_FACTORIES["".concat(n).concat(t==="vertical"?"Y":"X")]:CURVE_FACTORIES[n]||curveLinear},getPath$1=e=>{var{type:t="linear",points:n=[],baseLine:a,layout:i,connectNulls:s=!1}=e,o=getCurveFactory(t,i),c=s?n.filter(defined):n,h;if(Array.isArray(a)){var f=s?a.filter(p=>defined(p)):a,u=c.map((p,g)=>_objectSpread$l(_objectSpread$l({},p),{},{base:f[g]}));return i==="vertical"?h=shapeArea().y(getY).x1(getX).x0(p=>p.base.x):h=shapeArea().x(getX).y1(getY).y0(p=>p.base.y),h.defined(defined).curve(o),h(u)}return i==="vertical"&&isNumber(a)?h=shapeArea().y(getY).x1(getX).x0(a):isNumber(a)?h=shapeArea().x(getX).y1(getY).y0(a):h=shapeLine().x(getX).y(getY),h.defined(defined).curve(o),h(c)},Curve=e=>{var{className:t,points:n,path:a,pathRef:i}=e;if((!n||!n.length)&&!a)return null;var s=n&&n.length?getPath$1(e):a;return reactExports.createElement("path",_extends$g({},svgPropertiesNoEvents(e),adaptEventHandlers(e),{className:clsx("recharts-curve",t),d:s===null?void 0:s,ref:i}))},_excluded$d=["x","y","top","left","width","height","className"];function _extends$f(){return _extends$f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$f.apply(null,arguments)}function ownKeys$k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$k(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$k(Object(n),!0).forEach(function(a){_defineProperty$m(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$k(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$m(e,t,n){return(t=_toPropertyKey$m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$m(e){var t=_toPrimitive$m(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$m(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$d(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$d(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$d(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var getPath=(e,t,n,a,i,s)=>"M".concat(e,",").concat(i,"v").concat(a,"M").concat(s,",").concat(t,"h").concat(n),Cross=e=>{var{x:t=0,y:n=0,top:a=0,left:i=0,width:s=0,height:o=0,className:c}=e,h=_objectWithoutProperties$d(e,_excluded$d),f=_objectSpread$k({x:t,y:n,top:a,left:i,width:s,height:o},h);return!isNumber(t)||!isNumber(n)||!isNumber(s)||!isNumber(o)||!isNumber(a)||!isNumber(i)?null:reactExports.createElement("path",_extends$f({},svgPropertiesAndEvents(f),{className:clsx("recharts-cross",c),d:getPath(t,n,s,o,a,i)}))};function getCursorRectangle(e,t,n,a){var i=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-i,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function ownKeys$j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$j(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$j(Object(n),!0).forEach(function(a){_defineProperty$l(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$j(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$l(e,t,n){return(t=_toPropertyKey$l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$l(e){var t=_toPrimitive$l(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$l(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function resolveDefaultProps(e,t){var n=_objectSpread$j({},e),a=t,i=Object.keys(t),s=i.reduce((o,c)=>(o[c]===void 0&&a[c]!==void 0&&(o[c]=a[c]),o),n);return s}function noop$2(){}function isNotNil(e){return e!=null}function ownKeys$i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$i(Object(n),!0).forEach(function(a){_defineProperty$k(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$i(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$k(e,t,n){return(t=_toPropertyKey$k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$k(e){var t=_toPrimitive$k(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$k(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var getDashCase=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),getTransitionVal=(e,t,n)=>e.map(a=>"".concat(getDashCase(a)," ").concat(t,"ms ").concat(n)).join(","),getIntersectionKeys=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,a)=>n.filter(i=>a.includes(i))),mapObject=(e,t)=>Object.keys(t).reduce((n,a)=>_objectSpread$i(_objectSpread$i({},n),{},{[a]:e(a,t[a])}),{});function ownKeys$h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$h(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$h(Object(n),!0).forEach(function(a){_defineProperty$j(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$h(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$j(e,t,n){return(t=_toPropertyKey$j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$j(e){var t=_toPrimitive$j(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$j(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var alpha=(e,t,n)=>e+(t-e)*n,needContinue=e=>{var{from:t,to:n}=e;return t!==n},calStepperVals=(e,t,n)=>{var a=mapObject((i,s)=>{if(needContinue(s)){var[o,c]=e(s.from,s.to,s.velocity);return _objectSpread$h(_objectSpread$h({},s),{},{from:o,velocity:c})}return s},t);return n<1?mapObject((i,s)=>needContinue(s)?_objectSpread$h(_objectSpread$h({},s),{},{velocity:alpha(s.velocity,a[i].velocity,n),from:alpha(s.from,a[i].from,n)}):s,t):calStepperVals(e,a,n-1)};function createStepperUpdate(e,t,n,a,i,s){var o,c=a.reduce((g,v)=>_objectSpread$h(_objectSpread$h({},g),{},{[v]:{from:e[v],velocity:0,to:t[v]}}),{}),h=()=>mapObject((g,v)=>v.from,c),f=()=>!Object.values(c).filter(needContinue).length,u=null,p=g=>{o||(o=g);var v=g-o,m=v/n.dt;c=calStepperVals(n,c,m),i(_objectSpread$h(_objectSpread$h(_objectSpread$h({},e),t),h())),o=g,f()||(u=s.setTimeout(p))};return()=>(u=s.setTimeout(p),()=>{u()})}function createTimingUpdate(e,t,n,a,i,s,o){var c=null,h=i.reduce((p,g)=>_objectSpread$h(_objectSpread$h({},p),{},{[g]:[e[g],t[g]]}),{}),f,u=p=>{f||(f=p);var g=(p-f)/a,v=mapObject((S,E)=>alpha(...E,n(g)),h);if(s(_objectSpread$h(_objectSpread$h(_objectSpread$h({},e),t),v)),g<1)c=o.setTimeout(u);else{var m=mapObject((S,E)=>alpha(...E,n(1)),h);s(_objectSpread$h(_objectSpread$h(_objectSpread$h({},e),t),m))}};return()=>(c=o.setTimeout(u),()=>{c()})}const configUpdate=(e,t,n,a,i,s)=>{var o=getIntersectionKeys(e,t);return n.isStepper===!0?createStepperUpdate(e,t,n,o,i,s):createTimingUpdate(e,t,n,a,o,i,s)};var ACCURACY=1e-4,cubicBezierFactor=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],evaluatePolynomial=(e,t)=>e.map((n,a)=>n*t**a).reduce((n,a)=>n+a),cubicBezier=(e,t)=>n=>{var a=cubicBezierFactor(e,t);return evaluatePolynomial(a,n)},derivativeCubicBezier=(e,t)=>n=>{var a=cubicBezierFactor(e,t),i=[...a.map((s,o)=>s*o).slice(1),0];return evaluatePolynomial(i,n)},configBezier=function e(){for(var t,n,a,i,s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];if(o.length===1)switch(o[0]){case"linear":[t,a,n,i]=[0,0,1,1];break;case"ease":[t,a,n,i]=[.25,.1,.25,1];break;case"ease-in":[t,a,n,i]=[.42,0,1,1];break;case"ease-out":[t,a,n,i]=[.42,0,.58,1];break;case"ease-in-out":[t,a,n,i]=[0,0,.58,1];break;default:{var h=o[0].split("(");h[0]==="cubic-bezier"&&h[1].split(")")[0].split(",").length===4&&([t,a,n,i]=h[1].split(")")[0].split(",").map(m=>parseFloat(m)))}}else o.length===4&&([t,a,n,i]=o);var f=cubicBezier(t,n),u=cubicBezier(a,i),p=derivativeCubicBezier(t,n),g=m=>m>1?1:m<0?0:m,v=m=>{for(var S=m>1?1:m,E=S,w=0;w<8;++w){var T=f(E)-S,A=p(E);if(Math.abs(T-S)<ACCURACY||A<ACCURACY)return u(E);E=g(E-T/A)}return u(E)};return v.isStepper=!1,v},configSpring=function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:i=17}=t,s=(o,c,h)=>{var f=-(o-c)*n,u=h*a,p=h+(f-u)*i/1e3,g=h*i/1e3+o;return Math.abs(g-c)<ACCURACY&&Math.abs(p)<ACCURACY?[c,0]:[g,p]};return s.isStepper=!0,s.dt=i,s},configEasing=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return configBezier(e);case"spring":return configSpring();default:if(e.split("(")[0]==="cubic-bezier")return configBezier(e)}return typeof e=="function"?e:null};function createAnimateManager(e){var t,n=()=>null,a=!1,i=null,s=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var c=o,[h,...f]=c;if(typeof h=="number"){i=e.setTimeout(s.bind(null,f),h);return}s(h),i=e.setTimeout(s.bind(null,f));return}typeof o=="string"&&(t=o,n(t)),typeof o=="object"&&(t=o,n(t)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,i&&(i(),i=null),s(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>e}}class RequestAnimationFrameTimeoutController{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),i=null,s=o=>{o-a>=n?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{cancelAnimationFrame(i)}}}function createDefaultAnimationManager(){return createAnimateManager(new RequestAnimationFrameTimeoutController)}var AnimationManagerContext=reactExports.createContext(createDefaultAnimationManager);function useAnimationManager(e,t){var n=reactExports.useContext(AnimationManagerContext);return reactExports.useMemo(()=>t??n(e),[e,t,n])}var defaultJavascriptAnimateProps={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},from={t:0},to={t:1};function JavascriptAnimate(e){var t=resolveDefaultProps(e,defaultJavascriptAnimateProps),{isActive:n,canBegin:a,duration:i,easing:s,begin:o,onAnimationEnd:c,onAnimationStart:h,children:f}=t,u=useAnimationManager(t.animationId,t.animationManager),[p,g]=reactExports.useState(n?from:to),v=reactExports.useRef(null);return reactExports.useEffect(()=>{n||g(to)},[n]),reactExports.useEffect(()=>{if(!n||!a)return noop$2;var m=configUpdate(from,to,configEasing(s),i,g,u.getTimeoutController()),S=()=>{v.current=m()};return u.start([h,o,S,i,c]),()=>{u.stop(),v.current&&v.current(),c()}},[n,a,i,s,o,h,c,u]),f(p.t)}function useAnimationId(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=reactExports.useRef(uniqueId(t)),a=reactExports.useRef(e);return a.current!==e&&(n.current=uniqueId(t),a.current=e),n.current}var _excluded$c=["radius"],_excluded2$7=["radius"];function ownKeys$g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$g(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$g(Object(n),!0).forEach(function(a){_defineProperty$i(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$g(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$i(e,t,n){return(t=_toPropertyKey$i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$i(e){var t=_toPrimitive$i(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$i(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _extends$e(){return _extends$e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$e.apply(null,arguments)}function _objectWithoutProperties$c(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$c(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$c(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var getRectanglePath=(e,t,n,a,i)=>{var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,h=a>=0&&n>=0||a<0&&n<0?1:0,f;if(s>0&&i instanceof Array){for(var u=[0,0,0,0],p=0,g=4;p<g;p++)u[p]=i[p]>s?s:i[p];f="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(f+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(h,",").concat(e+c*u[0],",").concat(t)),f+="L ".concat(e+n-c*u[1],",").concat(t),u[1]>0&&(f+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(h,`,
        `).concat(e+n,",").concat(t+o*u[1])),f+="L ".concat(e+n,",").concat(t+a-o*u[2]),u[2]>0&&(f+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(h,`,
        `).concat(e+n-c*u[2],",").concat(t+a)),f+="L ".concat(e+c*u[3],",").concat(t+a),u[3]>0&&(f+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(h,`,
        `).concat(e,",").concat(t+a-o*u[3])),f+="Z"}else if(s>0&&i===+i&&i>0){var v=Math.min(s,i);f="M ".concat(e,",").concat(t+o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(h,",").concat(e+c*v,",").concat(t,`
            L `).concat(e+n-c*v,",").concat(t,`
            A `).concat(v,",").concat(v,",0,0,").concat(h,",").concat(e+n,",").concat(t+o*v,`
            L `).concat(e+n,",").concat(t+a-o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(h,",").concat(e+n-c*v,",").concat(t+a,`
            L `).concat(e+c*v,",").concat(t+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(h,",").concat(e,",").concat(t+a-o*v," Z")}else f="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},defaultProps$3={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Rectangle=e=>{var t=resolveDefaultProps(e,defaultProps$3),n=reactExports.useRef(null),[a,i]=reactExports.useState(-1);reactExports.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var J=n.current.getTotalLength();J&&i(J)}catch{}},[]);var{x:s,y:o,width:c,height:h,radius:f,className:u}=t,{animationEasing:p,animationDuration:g,animationBegin:v,isAnimationActive:m,isUpdateAnimationActive:S}=t,E=reactExports.useRef(c),w=reactExports.useRef(h),T=reactExports.useRef(s),A=reactExports.useRef(o),L=reactExports.useMemo(()=>({x:s,y:o,width:c,height:h,radius:f}),[s,o,c,h,f]),k=useAnimationId(L,"rectangle-");if(s!==+s||o!==+o||c!==+c||h!==+h||c===0||h===0)return null;var D=clsx("recharts-rectangle",u);if(!S){var N=svgPropertiesAndEvents(t),{radius:Y}=N,z=_objectWithoutProperties$c(N,_excluded$c);return reactExports.createElement("path",_extends$e({},z,{radius:typeof f=="number"?f:void 0,className:D,d:getRectanglePath(s,o,c,h,f)}))}var te=E.current,Z=w.current,ne=T.current,oe=A.current,le="0px ".concat(a===-1?1:a,"px"),pe="".concat(a,"px 0px"),de=getTransitionVal(["strokeDasharray"],g,typeof p=="string"?p:void 0);return reactExports.createElement(JavascriptAnimate,{animationId:k,key:k,canBegin:a>0,duration:g,easing:p,isActive:S,begin:v},J=>{var V=interpolate$1(te,c,J),C=interpolate$1(Z,h,J),O=interpolate$1(ne,s,J),I=interpolate$1(oe,o,J);n.current&&(E.current=V,w.current=C,T.current=O,A.current=I);var M;m?J>0?M={transition:de,strokeDasharray:pe}:M={strokeDasharray:le}:M={strokeDasharray:pe};var H=svgPropertiesAndEvents(t),{radius:G}=H,j=_objectWithoutProperties$c(H,_excluded2$7);return reactExports.createElement("path",_extends$e({},j,{radius:typeof f=="number"?f:void 0,className:D,d:getRectanglePath(O,I,V,C,f),ref:n,style:_objectSpread$g(_objectSpread$g({},M),t.style)}))})};function getRadialCursorPoints(e){var{cx:t,cy:n,radius:a,startAngle:i,endAngle:s}=e,o=polarToCartesian(t,n,a,i),c=polarToCartesian(t,n,a,s);return{points:[o,c],cx:t,cy:n,radius:a,startAngle:i,endAngle:s}}function _extends$d(){return _extends$d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$d.apply(null,arguments)}var getDeltaAngle$1=(e,t)=>{var n=mathSign(t-e),a=Math.min(Math.abs(t-e),359.999);return n*a},getTangentCircle=e=>{var{cx:t,cy:n,radius:a,angle:i,sign:s,isExternal:o,cornerRadius:c,cornerIsExternal:h}=e,f=c*(o?1:-1)+a,u=Math.asin(c/f)/RADIAN,p=h?i:i+s*u,g=polarToCartesian(t,n,f,p),v=polarToCartesian(t,n,a,p),m=h?i-s*u:i,S=polarToCartesian(t,n,f*Math.cos(u*RADIAN),m);return{center:g,circleTangency:v,lineTangency:S,theta:u}},getSectorPath=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:i,startAngle:s,endAngle:o}=e,c=getDeltaAngle$1(s,o),h=s+c,f=polarToCartesian(t,n,i,s),u=polarToCartesian(t,n,i,h),p="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>h),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(a>0){var g=polarToCartesian(t,n,a,s),v=polarToCartesian(t,n,a,h);p+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=h),`,
            `).concat(g.x,",").concat(g.y," Z")}else p+="L ".concat(t,",").concat(n," Z");return p},getSectorWithCorner=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:h,endAngle:f}=e,u=mathSign(f-h),{circleTangency:p,lineTangency:g,theta:v}=getTangentCircle({cx:t,cy:n,radius:i,angle:h,sign:u,cornerRadius:s,cornerIsExternal:c}),{circleTangency:m,lineTangency:S,theta:E}=getTangentCircle({cx:t,cy:n,radius:i,angle:f,sign:-u,cornerRadius:s,cornerIsExternal:c}),w=c?Math.abs(h-f):Math.abs(h-f)-v-E;if(w<0)return o?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):getSectorPath({cx:t,cy:n,innerRadius:a,outerRadius:i,startAngle:h,endAngle:f});var T="M ".concat(g.x,",").concat(g.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(w>180),",").concat(+(u<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(S.x,",").concat(S.y,`
  `);if(a>0){var{circleTangency:A,lineTangency:L,theta:k}=getTangentCircle({cx:t,cy:n,radius:a,angle:h,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),{circleTangency:D,lineTangency:N,theta:Y}=getTangentCircle({cx:t,cy:n,radius:a,angle:f,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),z=c?Math.abs(h-f):Math.abs(h-f)-k-Y;if(z<0&&s===0)return"".concat(T,"L").concat(t,",").concat(n,"Z");T+="L".concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(z>180),",").concat(+(u>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(L.x,",").concat(L.y,"Z")}else T+="L".concat(t,",").concat(n,"Z");return T},defaultProps$2={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Sector=e=>{var t=resolveDefaultProps(e,defaultProps$2),{cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:c,cornerIsExternal:h,startAngle:f,endAngle:u,className:p}=t;if(s<i||f===u)return null;var g=clsx("recharts-sector",p),v=s-i,m=getPercentValue(o,v,0,!0),S;return m>0&&Math.abs(f-u)<360?S=getSectorWithCorner({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,v/2),forceCornerRadius:c,cornerIsExternal:h,startAngle:f,endAngle:u}):S=getSectorPath({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:f,endAngle:u}),reactExports.createElement("path",_extends$d({},svgPropertiesAndEvents(t),{className:g,d:S}))};function getCursorPoints(e,t,n){var a,i,s,o;if(e==="horizontal")a=t.x,s=a,i=n.top,o=n.top+n.height;else if(e==="vertical")i=t.y,o=i,a=n.left,s=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:c,cy:h,innerRadius:f,outerRadius:u,angle:p}=t,g=polarToCartesian(c,h,f,p),v=polarToCartesian(c,h,u,p);a=g.x,i=g.y,s=v.x,o=v.y}else return getRadialCursorPoints(t);return[{x:a,y:i},{x:s,y:o}]}var range$4={},toFinite={},toNumber={},hasRequiredToNumber;function requireToNumber(){return hasRequiredToNumber||(hasRequiredToNumber=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsSymbol();function n(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=n})(toNumber)),toNumber}var hasRequiredToFinite;function requireToFinite(){return hasRequiredToFinite||(hasRequiredToFinite=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireToNumber();function n(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=n})(toFinite)),toFinite}var hasRequiredRange$1;function requireRange$1(){return hasRequiredRange$1||(hasRequiredRange$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireIsIterateeCall(),n=requireToFinite();function a(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=n.toFinite(i),s===void 0?(s=i,i=0):s=n.toFinite(s),o=o===void 0?i<s?1:-1:n.toFinite(o);const c=Math.max(Math.ceil((s-i)/(o||1)),0),h=new Array(c);for(let f=0;f<c;f++)h[f]=i,i+=o;return h}e.range=a})(range$4)),range$4}var range$3,hasRequiredRange;function requireRange(){return hasRequiredRange||(hasRequiredRange=1,range$3=requireRange$1().range),range$3}var rangeExports=requireRange();const range$2=getDefaultExportFromCjs(rangeExports);function ascending(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function descending(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function bisector(e){let t,n,a;e.length!==2?(t=ascending,n=(c,h)=>ascending(e(c),h),a=(c,h)=>e(c)-h):(t=e===ascending||e===descending?e:zero$1,n=e,a=e);function i(c,h,f=0,u=c.length){if(f<u){if(t(h,h)!==0)return u;do{const p=f+u>>>1;n(c[p],h)<0?f=p+1:u=p}while(f<u)}return f}function s(c,h,f=0,u=c.length){if(f<u){if(t(h,h)!==0)return u;do{const p=f+u>>>1;n(c[p],h)<=0?f=p+1:u=p}while(f<u)}return f}function o(c,h,f=0,u=c.length){const p=i(c,h,f,u-1);return p>f&&a(c[p-1],h)>-a(c[p],h)?p-1:p}return{left:i,center:o,right:s}}function zero$1(){return 0}function number$2(e){return e===null?NaN:+e}function*numbers(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right;bisector(number$2).center;class InternMap extends Map{constructor(t,n=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[a,i]of t)this.set(a,i)}get(t){return super.get(intern_get(this,t))}has(t){return super.has(intern_get(this,t))}set(t,n){return super.set(intern_set(this,t),n)}delete(t){return super.delete(intern_delete(this,t))}}function intern_get({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function intern_set({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function intern_delete({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function keyof(e){return e!==null&&typeof e=="object"?e.valueOf():e}function compareDefined(e=ascending){if(e===ascending)return ascendingDefined;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const a=e(t,n);return a||a===0?a:(e(n,n)===0)-(e(t,t)===0)}}function ascendingDefined(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,n){const a=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(a)),s=a/Math.pow(10,i),o=s>=e10?10:s>=e5?5:s>=e2?2:1;let c,h,f;return i<0?(f=Math.pow(10,-i)/o,c=Math.round(e*f),h=Math.round(t*f),c/f<e&&++c,h/f>t&&--h,f=-f):(f=Math.pow(10,i)*o,c=Math.round(e/f),h=Math.round(t/f),c*f<e&&++c,h*f>t&&--h),h<c&&.5<=n&&n<2?tickSpec(e,t,n*2):[c,h,f]}function ticks(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const a=t<e,[i,s,o]=a?tickSpec(t,e,n):tickSpec(e,t,n);if(!(s>=i))return[];const c=s-i+1,h=new Array(c);if(a)if(o<0)for(let f=0;f<c;++f)h[f]=(s-f)/-o;else for(let f=0;f<c;++f)h[f]=(s-f)*o;else if(o<0)for(let f=0;f<c;++f)h[f]=(i+f)/-o;else for(let f=0;f<c;++f)h[f]=(i+f)*o;return h}function tickIncrement(e,t,n){return t=+t,e=+e,n=+n,tickSpec(e,t,n)[2]}function tickStep(e,t,n){t=+t,e=+e,n=+n;const a=t<e,i=a?tickIncrement(t,e,n):tickIncrement(e,t,n);return(a?-1:1)*(i<0?1/-i:i)}function max(e,t){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function min(e,t){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function quickselect(e,t,n=0,a=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=t&&t<=a))return e;for(i=i===void 0?ascendingDefined:compareDefined(i);a>n;){if(a-n>600){const h=a-n+1,f=t-n+1,u=Math.log(h),p=.5*Math.exp(2*u/3),g=.5*Math.sqrt(u*p*(h-p)/h)*(f-h/2<0?-1:1),v=Math.max(n,Math.floor(t-f*p/h+g)),m=Math.min(a,Math.floor(t+(h-f)*p/h+g));quickselect(e,t,v,m,i)}const s=e[t];let o=n,c=a;for(swap(e,n,t),i(e[a],s)>0&&swap(e,n,a);o<c;){for(swap(e,o,c),++o,--c;i(e[o],s)<0;)++o;for(;i(e[c],s)>0;)--c}i(e[n],s)===0?swap(e,n,c):(++c,swap(e,c,a)),c<=t&&(n=c+1),t<=c&&(a=c-1)}return e}function swap(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function quantile$1(e,t,n){if(e=Float64Array.from(numbers(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return min(e);if(t>=1)return max(e);var a,i=(a-1)*t,s=Math.floor(i),o=max(quickselect(e,s).subarray(0,s+1)),c=min(e.subarray(s+1));return o+(c-o)*(i-s)}}function quantileSorted(e,t,n=number$2){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+n(e[0],0,e);if(t>=1)return+n(e[a-1],a-1,e);var a,i=(a-1)*t,s=Math.floor(i),o=+n(e[s],s,e),c=+n(e[s+1],s+1,e);return o+(c-o)*(i-s)}}function range$1(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var a=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++a<i;)s[a]=e+a*n;return s}function initRange(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function initInterpolator(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const implicit=Symbol("implicit");function ordinal(){var e=new InternMap,t=[],n=[],a=implicit;function i(s){let o=e.get(s);if(o===void 0){if(a!==implicit)return a;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new InternMap;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return ordinal(t,n).unknown(a)},initRange.apply(i,arguments),i}function band(){var e=ordinal().unknown(void 0),t=e.domain,n=e.range,a=0,i=1,s,o,c=!1,h=0,f=0,u=.5;delete e.unknown;function p(){var g=t().length,v=i<a,m=v?i:a,S=v?a:i;s=(S-m)/Math.max(1,g-h+f*2),c&&(s=Math.floor(s)),m+=(S-m-s*(g-h))*u,o=s*(1-h),c&&(m=Math.round(m),o=Math.round(o));var E=range$1(g).map(function(w){return m+s*w});return n(v?E.reverse():E)}return e.domain=function(g){return arguments.length?(t(g),p()):t()},e.range=function(g){return arguments.length?([a,i]=g,a=+a,i=+i,p()):[a,i]},e.rangeRound=function(g){return[a,i]=g,a=+a,i=+i,c=!0,p()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(g){return arguments.length?(c=!!g,p()):c},e.padding=function(g){return arguments.length?(h=Math.min(1,f=+g),p()):h},e.paddingInner=function(g){return arguments.length?(h=Math.min(1,g),p()):h},e.paddingOuter=function(g){return arguments.length?(f=+g,p()):f},e.align=function(g){return arguments.length?(u=Math.max(0,Math.min(1,g)),p()):u},e.copy=function(){return band(t(),[a,i]).round(c).paddingInner(h).paddingOuter(f).align(u)},initRange.apply(p(),arguments)}function pointish(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pointish(t())},e}function point(){return pointish(band.apply(null,arguments).paddingInner(1))}function define(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function extend(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rgbn(t):n===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,n,a){return a<=0&&(e=t=n=NaN),new Rgb(e,t,n,a)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb$1(e,t,n,a){return arguments.length===1?rgbConvert(e):new Rgb(e,t,n,a??1)}function Rgb(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}define(Rgb,rgb$1,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,a)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,i=Math.min(t,n,a),s=Math.max(t,n,a),o=NaN,c=s-i,h=(s+i)/2;return c?(t===s?o=(n-a)/c+(n<a)*6:n===s?o=(a-t)/c+2:o=(t-n)/c+4,c/=h<.5?s+i:2-s-i,o*=60):c=h>0&&h<1?0:o,new Hsl(o,c,h,e.opacity)}function hsl(e,t,n,a){return arguments.length===1?hslConvert(e):new Hsl(e,t,n,a??1)}function Hsl(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new Rgb(hsl2rgb(e>=240?e-240:e+120,i,a),hsl2rgb(e,i,a),hsl2rgb(e<120?e+240:e-120,i,a),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const constant=e=>()=>e;function linear$1(e,t){return function(n){return e+n*t}}function exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}function gamma(e){return(e=+e)==1?nogamma:function(t,n){return n-t?exponential(t,n,e):constant(isNaN(t)?n:t)}}function nogamma(e,t){var n=t-e;return n?linear$1(e,n):constant(isNaN(e)?t:e)}const rgb=(function e(t){var n=gamma(t);function a(i,s){var o=n((i=rgb$1(i)).r,(s=rgb$1(s)).r),c=n(i.g,s.g),h=n(i.b,s.b),f=nogamma(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=c(u),i.b=h(u),i.opacity=f(u),i+""}}return a.gamma=e,a})(1);function numberArray(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,a=t.slice(),i;return function(s){for(i=0;i<n;++i)a[i]=e[i]*(1-s)+t[i]*s;return a}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function genericArray(e,t){var n=t?t.length:0,a=e?Math.min(n,e.length):0,i=new Array(a),s=new Array(n),o;for(o=0;o<a;++o)i[o]=interpolate(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(c){for(o=0;o<a;++o)s[o]=i[o](c);return s}}function date$1(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function interpolateNumber(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function object(e,t){var n={},a={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=interpolate(e[i],t[i]):a[i]=t[i];return function(s){for(i in n)a[i]=n[i](s);return a}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function string(e,t){var n=reA.lastIndex=reB.lastIndex=0,a,i,s,o=-1,c=[],h=[];for(e=e+"",t=t+"";(a=reA.exec(e))&&(i=reB.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),c[o]?c[o]+=s:c[++o]=s),(a=a[0])===(i=i[0])?c[o]?c[o]+=i:c[++o]=i:(c[++o]=null,h.push({i:o,x:interpolateNumber(a,i)})),n=reB.lastIndex;return n<t.length&&(s=t.slice(n),c[o]?c[o]+=s:c[++o]=s),c.length<2?h[0]?one(h[0].x):zero(t):(t=h.length,function(f){for(var u=0,p;u<t;++u)c[(p=h[u]).i]=p.x(f);return c.join("")})}function interpolate(e,t){var n=typeof t,a;return t==null||n==="boolean"?constant(t):(n==="number"?interpolateNumber:n==="string"?(a=color(t))?(t=a,rgb):string:t instanceof color?rgb:t instanceof Date?date$1:isNumberArray(t)?numberArray:Array.isArray(t)?genericArray:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?object:interpolateNumber)(e,t)}function interpolateRound(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function piecewise(e,t){t===void 0&&(t=e,e=interpolate);for(var n=0,a=t.length-1,i=t[0],s=new Array(a<0?0:a);n<a;)s[n]=e(i,i=t[++n]);return function(o){var c=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return s[c](o-c)}}function constants(e){return function(){return e}}function number$1(e){return+e}var unit=[0,1];function identity$3(e){return e}function normalize(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:constants(isNaN(t)?NaN:.5)}function clamper(e,t){var n;return e>t&&(n=e,e=t,t=n),function(a){return Math.max(e,Math.min(t,a))}}function bimap(e,t,n){var a=e[0],i=e[1],s=t[0],o=t[1];return i<a?(a=normalize(i,a),s=n(o,s)):(a=normalize(a,i),s=n(s,o)),function(c){return s(a(c))}}function polymap(e,t,n){var a=Math.min(e.length,t.length)-1,i=new Array(a),s=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)i[o]=normalize(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(c){var h=bisectRight(e,c,1,a)-1;return s[h](i[h](c))}}function copy$1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer$2(){var e=unit,t=unit,n=interpolate,a,i,s,o=identity$3,c,h,f;function u(){var g=Math.min(e.length,t.length);return o!==identity$3&&(o=clamper(e[0],e[g-1])),c=g>2?polymap:bimap,h=f=null,p}function p(g){return g==null||isNaN(g=+g)?s:(h||(h=c(e.map(a),t,n)))(a(o(g)))}return p.invert=function(g){return o(i((f||(f=c(t,e.map(a),interpolateNumber)))(g)))},p.domain=function(g){return arguments.length?(e=Array.from(g,number$1),u()):e.slice()},p.range=function(g){return arguments.length?(t=Array.from(g),u()):t.slice()},p.rangeRound=function(g){return t=Array.from(g),n=interpolateRound,u()},p.clamp=function(g){return arguments.length?(o=g?!0:identity$3,u()):o!==identity$3},p.interpolate=function(g){return arguments.length?(n=g,u()):n},p.unknown=function(g){return arguments.length?(s=g,p):s},function(g,v){return a=g,i=v,u()}}function continuous(){return transformer$2()(identity$3,identity$3)}function formatDecimal(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function exponent(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup(e,t){return function(n,a){for(var i=n.length,s=[],o=0,c=e[0],h=0;i>0&&c>0&&(h+c+1>a&&(c=Math.max(1,a-h)),s.push(n.substring(i-=c,i+c)),!((h+=c+1)>a));)c=e[o=(o+1)%e.length];return s.reverse().join(t)}}function formatNumerals(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t;return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(e){e:for(var t=e.length,n=1,a=-1,i;n<t;++n)switch(e[n]){case".":a=i=n;break;case"0":a===0&&(a=n),i=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(i+1):e}var prefixExponent;function formatPrefixAuto(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var a=n[0],i=n[1],s=i-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=a.length;return s===o?a:s>o?a+new Array(s-o+1).join("0"):s>0?a.slice(0,s)+"."+a.slice(s):"0."+new Array(1-s).join("0")+formatDecimalParts(e,Math.max(0,t+s-1))[0]}function formatRounded(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}const formatTypes={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded(e*100,t),r:formatRounded,s:formatPrefixAuto,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity$2(e){return e}var map$1=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(e){var t=e.grouping===void 0||e.thousands===void 0?identity$2:formatGroup(map$1.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?identity$2:formatNumerals(map$1.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function f(p){p=formatSpecifier(p);var g=p.fill,v=p.align,m=p.sign,S=p.symbol,E=p.zero,w=p.width,T=p.comma,A=p.precision,L=p.trim,k=p.type;k==="n"?(T=!0,k="g"):formatTypes[k]||(A===void 0&&(A=12),L=!0,k="g"),(E||g==="0"&&v==="=")&&(E=!0,g="0",v="=");var D=S==="$"?n:S==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",N=S==="$"?a:/[%p]/.test(k)?o:"",Y=formatTypes[k],z=/[defgprs%]/.test(k);A=A===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function te(Z){var ne=D,oe=N,le,pe,de;if(k==="c")oe=Y(Z)+oe,Z="";else{Z=+Z;var J=Z<0||1/Z<0;if(Z=isNaN(Z)?h:Y(Math.abs(Z),A),L&&(Z=formatTrim(Z)),J&&+Z==0&&m!=="+"&&(J=!1),ne=(J?m==="("?m:c:m==="-"||m==="("?"":m)+ne,oe=(k==="s"?prefixes[8+prefixExponent/3]:"")+oe+(J&&m==="("?")":""),z){for(le=-1,pe=Z.length;++le<pe;)if(de=Z.charCodeAt(le),48>de||de>57){oe=(de===46?i+Z.slice(le+1):Z.slice(le))+oe,Z=Z.slice(0,le);break}}}T&&!E&&(Z=t(Z,1/0));var V=ne.length+Z.length+oe.length,C=V<w?new Array(w-V+1).join(g):"";switch(T&&E&&(Z=t(C+Z,C.length?w-oe.length:1/0),C=""),v){case"<":Z=ne+Z+oe+C;break;case"=":Z=ne+C+Z+oe;break;case"^":Z=C.slice(0,V=C.length>>1)+ne+Z+oe+C.slice(V);break;default:Z=C+ne+Z+oe;break}return s(Z)}return te.toString=function(){return p+""},te}function u(p,g){var v=f((p=formatSpecifier(p),p.type="f",p)),m=Math.max(-8,Math.min(8,Math.floor(exponent(g)/3)))*3,S=Math.pow(10,-m),E=prefixes[8+m/3];return function(w){return v(S*w)+E}}return{format:f,formatPrefix:u}}var locale$1,format,formatPrefix;defaultLocale$1({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$1(e){return locale$1=formatLocale$1(e),format=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(e){return Math.max(0,-exponent(Math.abs(e)))}function precisionPrefix(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(t)/3)))*3-exponent(Math.abs(e)))}function precisionRound(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent(t)-exponent(e))+1}function tickFormat(e,t,n,a){var i=tickStep(e,t,n),s;switch(a=formatSpecifier(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(s=precisionPrefix(i,o))&&(a.precision=s),formatPrefix(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(s=precisionRound(i,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=s-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(s=precisionFixed(i))&&(a.precision=s-(a.type==="%")*2);break}}return format(a)}function linearish(e){var t=e.domain;return e.ticks=function(n){var a=t();return ticks(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var i=t();return tickFormat(i[0],i[i.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=t(),i=0,s=a.length-1,o=a[i],c=a[s],h,f,u=10;for(c<o&&(f=o,o=c,c=f,f=i,i=s,s=f);u-- >0;){if(f=tickIncrement(o,c,n),f===h)return a[i]=o,a[s]=c,t(a);if(f>0)o=Math.floor(o/f)*f,c=Math.ceil(c/f)*f;else if(f<0)o=Math.ceil(o*f)/f,c=Math.floor(c*f)/f;else break;h=f}return e},e}function linear(){var e=continuous();return e.copy=function(){return copy$1(e,linear())},initRange.apply(e,arguments),linearish(e)}function identity$1(e){var t;function n(a){return a==null||isNaN(a=+a)?t:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,number$1),n):e.slice()},n.unknown=function(a){return arguments.length?(t=a,n):t},n.copy=function(){return identity$1(e).unknown(t)},e=arguments.length?Array.from(e,number$1):[0,1],linearish(n)}function nice(e,t){e=e.slice();var n=0,a=e.length-1,i=e[n],s=e[a],o;return s<i&&(o=n,n=a,a=o,o=i,i=s,s=o),e[n]=t.floor(i),e[a]=t.ceil(s),e}function transformLog(e){return Math.log(e)}function transformExp(e){return Math.exp(e)}function transformLogn(e){return-Math.log(-e)}function transformExpn(e){return-Math.exp(-e)}function pow10(e){return isFinite(e)?+("1e"+e):e<0?0:e}function powp(e){return e===10?pow10:e===Math.E?Math.exp:t=>Math.pow(e,t)}function logp(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function reflect(e){return(t,n)=>-e(-t,n)}function loggish(e){const t=e(transformLog,transformExp),n=t.domain;let a=10,i,s;function o(){return i=logp(a),s=powp(a),n()[0]<0?(i=reflect(i),s=reflect(s),e(transformLogn,transformExpn)):e(transformLog,transformExp),t}return t.base=function(c){return arguments.length?(a=+c,o()):a},t.domain=function(c){return arguments.length?(n(c),o()):n()},t.ticks=c=>{const h=n();let f=h[0],u=h[h.length-1];const p=u<f;p&&([f,u]=[u,f]);let g=i(f),v=i(u),m,S;const E=c==null?10:+c;let w=[];if(!(a%1)&&v-g<E){if(g=Math.floor(g),v=Math.ceil(v),f>0){for(;g<=v;++g)for(m=1;m<a;++m)if(S=g<0?m/s(-g):m*s(g),!(S<f)){if(S>u)break;w.push(S)}}else for(;g<=v;++g)for(m=a-1;m>=1;--m)if(S=g>0?m/s(-g):m*s(g),!(S<f)){if(S>u)break;w.push(S)}w.length*2<E&&(w=ticks(f,u,E))}else w=ticks(g,v,Math.min(v-g,E)).map(s);return p?w.reverse():w},t.tickFormat=(c,h)=>{if(c==null&&(c=10),h==null&&(h=a===10?"s":","),typeof h!="function"&&(!(a%1)&&(h=formatSpecifier(h)).precision==null&&(h.trim=!0),h=format(h)),c===1/0)return h;const f=Math.max(1,a*c/t.ticks().length);return u=>{let p=u/s(Math.round(i(u)));return p*a<a-.5&&(p*=a),p<=f?h(u):""}},t.nice=()=>n(nice(n(),{floor:c=>s(Math.floor(i(c))),ceil:c=>s(Math.ceil(i(c)))})),t}function log(){const e=loggish(transformer$2()).domain([1,10]);return e.copy=()=>copy$1(e,log()).base(e.base()),initRange.apply(e,arguments),e}function transformSymlog(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function transformSymexp(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function symlogish(e){var t=1,n=e(transformSymlog(t),transformSymexp(t));return n.constant=function(a){return arguments.length?e(transformSymlog(t=+a),transformSymexp(t)):t},linearish(n)}function symlog(){var e=symlogish(transformer$2());return e.copy=function(){return copy$1(e,symlog()).constant(e.constant())},initRange.apply(e,arguments)}function transformPow(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function transformSqrt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function transformSquare(e){return e<0?-e*e:e*e}function powish(e){var t=e(identity$3,identity$3),n=1;function a(){return n===1?e(identity$3,identity$3):n===.5?e(transformSqrt,transformSquare):e(transformPow(n),transformPow(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,a()):n},linearish(t)}function pow(){var e=powish(transformer$2());return e.copy=function(){return copy$1(e,pow()).exponent(e.exponent())},initRange.apply(e,arguments),e}function sqrt(){return pow.apply(null,arguments).exponent(.5)}function square(e){return Math.sign(e)*e*e}function unsquare(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function radial(){var e=continuous(),t=[0,1],n=!1,a;function i(s){var o=unsquare(e(s));return isNaN(o)?a:n?Math.round(o):o}return i.invert=function(s){return e.invert(square(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,number$1)).map(square)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(n=!!s,i):n},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return radial(e.domain(),t).round(n).clamp(e.clamp()).unknown(a)},initRange.apply(i,arguments),linearish(i)}function quantile(){var e=[],t=[],n=[],a;function i(){var o=0,c=Math.max(1,t.length);for(n=new Array(c-1);++o<c;)n[o-1]=quantileSorted(e,o/c);return s}function s(o){return o==null||isNaN(o=+o)?a:t[bisectRight(n,o)]}return s.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?n[c-1]:e[0],c<n.length?n[c]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ascending),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(a=o,s):a},s.quantiles=function(){return n.slice()},s.copy=function(){return quantile().domain(e).range(t).unknown(a)},initRange.apply(s,arguments)}function quantize(){var e=0,t=1,n=1,a=[.5],i=[0,1],s;function o(h){return h!=null&&h<=h?i[bisectRight(a,h,0,n)]:s}function c(){var h=-1;for(a=new Array(n);++h<n;)a[h]=((h+1)*t-(h-n)*e)/(n+1);return o}return o.domain=function(h){return arguments.length?([e,t]=h,e=+e,t=+t,c()):[e,t]},o.range=function(h){return arguments.length?(n=(i=Array.from(h)).length-1,c()):i.slice()},o.invertExtent=function(h){var f=i.indexOf(h);return f<0?[NaN,NaN]:f<1?[e,a[0]]:f>=n?[a[n-1],t]:[a[f-1],a[f]]},o.unknown=function(h){return arguments.length&&(s=h),o},o.thresholds=function(){return a.slice()},o.copy=function(){return quantize().domain([e,t]).range(i).unknown(s)},initRange.apply(linearish(o),arguments)}function threshold(){var e=[.5],t=[0,1],n,a=1;function i(s){return s!=null&&s<=s?t[bisectRight(e,s,0,a)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),a=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),a=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return threshold().domain(e).range(t).unknown(n)},initRange.apply(i,arguments)}const t0=new Date,t1=new Date;function timeInterval(e,t,n,a){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),c=i.ceil(s);return s-o<c-s?o:c},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,c)=>{const h=[];if(s=i.ceil(s),c=c==null?1:Math.floor(c),!(s<o)||!(c>0))return h;let f;do h.push(f=new Date(+s)),t(s,c),e(s);while(f<s&&s<o);return h},i.filter=s=>timeInterval(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!s(o););else for(;--c>=0;)for(;t(o,1),!s(o););}),n&&(i.count=(s,o)=>(t0.setTime(+s),t1.setTime(+o),e(t0),e(t1),Math.floor(n(t0,t1))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(a?o=>a(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const millisecond=timeInterval(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);millisecond.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?timeInterval(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):millisecond);millisecond.range;const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*durationSecond)},(e,t)=>(t-e)/durationSecond,e=>e.getUTCSeconds());second.range;const timeMinute=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getMinutes());timeMinute.range;const utcMinute=timeInterval(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*durationMinute)},(e,t)=>(t-e)/durationMinute,e=>e.getUTCMinutes());utcMinute.range;const timeHour=timeInterval(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*durationSecond-e.getMinutes()*durationMinute)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getHours());timeHour.range;const utcHour=timeInterval(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*durationHour)},(e,t)=>(t-e)/durationHour,e=>e.getUTCHours());utcHour.range;const timeDay=timeInterval(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationDay,e=>e.getDate()-1);timeDay.range;const utcDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>e.getUTCDate()-1);utcDay.range;const unixDay=timeInterval(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/durationDay,e=>Math.floor(e/durationDay));unixDay.range;function timeWeekday(e){return timeInterval(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(e){return timeInterval(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());timeMonth.range;const utcMonth=timeInterval(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());utcMonth.range;const timeYear=timeInterval(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());timeYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});timeYear.range;const utcYear=timeInterval(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());utcYear.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:timeInterval(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});utcYear.range;function ticker(e,t,n,a,i,s){const o=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[s,1,durationMinute],[s,5,5*durationMinute],[s,15,15*durationMinute],[s,30,30*durationMinute],[i,1,durationHour],[i,3,3*durationHour],[i,6,6*durationHour],[i,12,12*durationHour],[a,1,durationDay],[a,2,2*durationDay],[n,1,durationWeek],[t,1,durationMonth],[t,3,3*durationMonth],[e,1,durationYear]];function c(f,u,p){const g=u<f;g&&([f,u]=[u,f]);const v=p&&typeof p.range=="function"?p:h(f,u,p),m=v?v.range(f,+u+1):[];return g?m.reverse():m}function h(f,u,p){const g=Math.abs(u-f)/p,v=bisector(([,,E])=>E).right(o,g);if(v===o.length)return e.every(tickStep(f/durationYear,u/durationYear,p));if(v===0)return millisecond.every(Math.max(tickStep(f,u,p),1));const[m,S]=o[g/o[v-1][2]<o[v][2]/g?v-1:v];return m.every(S)}return[c,h]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newDate(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function formatLocale(e){var t=e.dateTime,n=e.date,a=e.time,i=e.periods,s=e.days,o=e.shortDays,c=e.months,h=e.shortMonths,f=formatRe(i),u=formatLookup(i),p=formatRe(s),g=formatLookup(s),v=formatRe(o),m=formatLookup(o),S=formatRe(c),E=formatLookup(c),w=formatRe(h),T=formatLookup(h),A={a:J,A:V,b:C,B:O,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:I,q:M,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},L={a:H,A:G,b:j,B:F,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:q,q:X,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},k={a:te,A:Z,b:ne,B:oe,c:le,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:z,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:pe,X:de,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};A.x=D(n,A),A.X=D(a,A),A.c=D(t,A),L.x=D(n,L),L.X=D(a,L),L.c=D(t,L);function D(W,K){return function(ae){var U=[],ve=-1,be=0,ye=W.length,_e,ge,Re;for(ae instanceof Date||(ae=new Date(+ae));++ve<ye;)W.charCodeAt(ve)===37&&(U.push(W.slice(be,ve)),(ge=pads[_e=W.charAt(++ve)])!=null?_e=W.charAt(++ve):ge=_e==="e"?" ":"0",(Re=K[_e])&&(_e=Re(ae,ge)),U.push(_e),be=ve+1);return U.push(W.slice(be,ve)),U.join("")}}function N(W,K){return function(ae){var U=newDate(1900,void 0,1),ve=Y(U,W,ae+="",0),be,ye;if(ve!=ae.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(K&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(be=utcDate(newDate(U.y,0,1)),ye=be.getUTCDay(),be=ye>4||ye===0?utcMonday.ceil(be):utcMonday(be),be=utcDay.offset(be,(U.V-1)*7),U.y=be.getUTCFullYear(),U.m=be.getUTCMonth(),U.d=be.getUTCDate()+(U.w+6)%7):(be=localDate(newDate(U.y,0,1)),ye=be.getDay(),be=ye>4||ye===0?timeMonday.ceil(be):timeMonday(be),be=timeDay.offset(be,(U.V-1)*7),U.y=be.getFullYear(),U.m=be.getMonth(),U.d=be.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),ye="Z"in U?utcDate(newDate(U.y,0,1)).getUTCDay():localDate(newDate(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(ye+5)%7:U.w+U.U*7-(ye+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,utcDate(U)):localDate(U)}}function Y(W,K,ae,U){for(var ve=0,be=K.length,ye=ae.length,_e,ge;ve<be;){if(U>=ye)return-1;if(_e=K.charCodeAt(ve++),_e===37){if(_e=K.charAt(ve++),ge=k[_e in pads?K.charAt(ve++):_e],!ge||(U=ge(W,ae,U))<0)return-1}else if(_e!=ae.charCodeAt(U++))return-1}return U}function z(W,K,ae){var U=f.exec(K.slice(ae));return U?(W.p=u.get(U[0].toLowerCase()),ae+U[0].length):-1}function te(W,K,ae){var U=v.exec(K.slice(ae));return U?(W.w=m.get(U[0].toLowerCase()),ae+U[0].length):-1}function Z(W,K,ae){var U=p.exec(K.slice(ae));return U?(W.w=g.get(U[0].toLowerCase()),ae+U[0].length):-1}function ne(W,K,ae){var U=w.exec(K.slice(ae));return U?(W.m=T.get(U[0].toLowerCase()),ae+U[0].length):-1}function oe(W,K,ae){var U=S.exec(K.slice(ae));return U?(W.m=E.get(U[0].toLowerCase()),ae+U[0].length):-1}function le(W,K,ae){return Y(W,t,K,ae)}function pe(W,K,ae){return Y(W,n,K,ae)}function de(W,K,ae){return Y(W,a,K,ae)}function J(W){return o[W.getDay()]}function V(W){return s[W.getDay()]}function C(W){return h[W.getMonth()]}function O(W){return c[W.getMonth()]}function I(W){return i[+(W.getHours()>=12)]}function M(W){return 1+~~(W.getMonth()/3)}function H(W){return o[W.getUTCDay()]}function G(W){return s[W.getUTCDay()]}function j(W){return h[W.getUTCMonth()]}function F(W){return c[W.getUTCMonth()]}function q(W){return i[+(W.getUTCHours()>=12)]}function X(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var K=D(W+="",A);return K.toString=function(){return W},K},parse:function(W){var K=N(W+="",!1);return K.toString=function(){return W},K},utcFormat:function(W){var K=D(W+="",L);return K.toString=function(){return W},K},utcParse:function(W){var K=N(W+="",!0);return K.toString=function(){return W},K}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",s=i.length;return a+(s<n?new Array(n-s+1).join(t)+i:i)}function requote(e){return e.replace(requoteRe,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function parseWeekdayNumberSunday(e,t,n){var a=numberRe.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function parseWeekdayNumberMonday(e,t,n){var a=numberRe.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function parseWeekNumberSunday(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function parseWeekNumberISO(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function parseWeekNumberMonday(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function parseFullYear(e,t,n){var a=numberRe.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function parseYear(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function parseZone(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function parseQuarter(e,t,n){var a=numberRe.exec(t.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function parseMonthNumber(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function parseDayOfMonth(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function parseDayOfYear(e,t,n){var a=numberRe.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function parseHour24(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function parseMinutes(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function parseSeconds(e,t,n){var a=numberRe.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function parseMilliseconds(e,t,n){var a=numberRe.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function parseMicroseconds(e,t,n){var a=numberRe.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function parseLiteralPercent(e,t,n){var a=percentRe.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function parseUnixTimestamp(e,t,n){var a=numberRe.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function parseUnixTimestampSeconds(e,t,n){var a=numberRe.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function formatDayOfMonth(e,t){return pad(e.getDate(),t,2)}function formatHour24(e,t){return pad(e.getHours(),t,2)}function formatHour12(e,t){return pad(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return pad(1+timeDay.count(timeYear(e),e),t,3)}function formatMilliseconds(e,t){return pad(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+"000"}function formatMonthNumber(e,t){return pad(e.getMonth()+1,t,2)}function formatMinutes(e,t){return pad(e.getMinutes(),t,2)}function formatSeconds(e,t){return pad(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return t===0?7:t}function formatWeekNumberSunday(e,t){return pad(timeSunday.count(timeYear(e)-1,e),t,2)}function dISO(e){var t=e.getDay();return t>=4||t===0?timeThursday(e):timeThursday.ceil(e)}function formatWeekNumberISO(e,t){return e=dISO(e),pad(timeThursday.count(timeYear(e),e)+(timeYear(e).getDay()===4),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return pad(timeMonday.count(timeYear(e)-1,e),t,2)}function formatYear(e,t){return pad(e.getFullYear()%100,t,2)}function formatYearISO(e,t){return e=dISO(e),pad(e.getFullYear()%100,t,2)}function formatFullYear(e,t){return pad(e.getFullYear()%1e4,t,4)}function formatFullYearISO(e,t){var n=e.getDay();return e=n>=4||n===0?timeThursday(e):timeThursday.ceil(e),pad(e.getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+pad(t/60|0,"0",2)+pad(t%60,"0",2)}function formatUTCDayOfMonth(e,t){return pad(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return pad(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return pad(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return pad(1+utcDay.count(utcYear(e),e),t,3)}function formatUTCMilliseconds(e,t){return pad(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+"000"}function formatUTCMonthNumber(e,t){return pad(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return pad(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return pad(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return t===0?7:t}function formatUTCWeekNumberSunday(e,t){return pad(utcSunday.count(utcYear(e)-1,e),t,2)}function UTCdISO(e){var t=e.getUTCDay();return t>=4||t===0?utcThursday(e):utcThursday.ceil(e)}function formatUTCWeekNumberISO(e,t){return e=UTCdISO(e),pad(utcThursday.count(utcYear(e),e)+(utcYear(e).getUTCDay()===4),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return pad(utcMonday.count(utcYear(e)-1,e),t,2)}function formatUTCYear(e,t){return pad(e.getUTCFullYear()%100,t,2)}function formatUTCYearISO(e,t){return e=UTCdISO(e),pad(e.getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCFullYearISO(e,t){var n=e.getUTCDay();return e=n>=4||n===0?utcThursday(e):utcThursday.ceil(e),pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}var locale,timeFormat,utcFormat;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(e){return locale=formatLocale(e),timeFormat=locale.format,locale.parse,utcFormat=locale.utcFormat,locale.utcParse,locale}function date(e){return new Date(e)}function number(e){return e instanceof Date?+e:+new Date(+e)}function calendar(e,t,n,a,i,s,o,c,h,f){var u=continuous(),p=u.invert,g=u.domain,v=f(".%L"),m=f(":%S"),S=f("%I:%M"),E=f("%I %p"),w=f("%a %d"),T=f("%b %d"),A=f("%B"),L=f("%Y");function k(D){return(h(D)<D?v:c(D)<D?m:o(D)<D?S:s(D)<D?E:a(D)<D?i(D)<D?w:T:n(D)<D?A:L)(D)}return u.invert=function(D){return new Date(p(D))},u.domain=function(D){return arguments.length?g(Array.from(D,number)):g().map(date)},u.ticks=function(D){var N=g();return e(N[0],N[N.length-1],D??10)},u.tickFormat=function(D,N){return N==null?k:f(N)},u.nice=function(D){var N=g();return(!D||typeof D.range!="function")&&(D=t(N[0],N[N.length-1],D??10)),D?g(nice(N,D)):u},u.copy=function(){return copy$1(u,calendar(e,t,n,a,i,s,o,c,h,f))},u}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer$1(){var e=0,t=1,n,a,i,s,o=identity$3,c=!1,h;function f(p){return p==null||isNaN(p=+p)?h:o(i===0?.5:(p=(s(p)-n)*i,c?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([e,t]=p,n=s(e=+e),a=s(t=+t),i=n===a?0:1/(a-n),f):[e,t]},f.clamp=function(p){return arguments.length?(c=!!p,f):c},f.interpolator=function(p){return arguments.length?(o=p,f):o};function u(p){return function(g){var v,m;return arguments.length?([v,m]=g,o=p(v,m),f):[o(0),o(1)]}}return f.range=u(interpolate),f.rangeRound=u(interpolateRound),f.unknown=function(p){return arguments.length?(h=p,f):h},function(p){return s=p,n=p(e),a=p(t),i=n===a?0:1/(a-n),f}}function copy(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sequential(){var e=linearish(transformer$1()(identity$3));return e.copy=function(){return copy(e,sequential())},initInterpolator.apply(e,arguments)}function sequentialLog(){var e=loggish(transformer$1()).domain([1,10]);return e.copy=function(){return copy(e,sequentialLog()).base(e.base())},initInterpolator.apply(e,arguments)}function sequentialSymlog(){var e=symlogish(transformer$1());return e.copy=function(){return copy(e,sequentialSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function sequentialPow(){var e=powish(transformer$1());return e.copy=function(){return copy(e,sequentialPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function sequentialSqrt(){return sequentialPow.apply(null,arguments).exponent(.5)}function sequentialQuantile(){var e=[],t=identity$3;function n(a){if(a!=null&&!isNaN(a=+a))return t((bisectRight(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let i of a)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(ascending),n},n.interpolator=function(a){return arguments.length?(t=a,n):t},n.range=function(){return e.map((a,i)=>t(i/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(i,s)=>quantile$1(e,s/a))},n.copy=function(){return sequentialQuantile(t).domain(e)},initInterpolator.apply(n,arguments)}function transformer(){var e=0,t=.5,n=1,a=1,i,s,o,c,h,f=identity$3,u,p=!1,g;function v(S){return isNaN(S=+S)?g:(S=.5+((S=+u(S))-s)*(a*S<a*s?c:h),f(p?Math.max(0,Math.min(1,S)):S))}v.domain=function(S){return arguments.length?([e,t,n]=S,i=u(e=+e),s=u(t=+t),o=u(n=+n),c=i===s?0:.5/(s-i),h=s===o?0:.5/(o-s),a=s<i?-1:1,v):[e,t,n]},v.clamp=function(S){return arguments.length?(p=!!S,v):p},v.interpolator=function(S){return arguments.length?(f=S,v):f};function m(S){return function(E){var w,T,A;return arguments.length?([w,T,A]=E,f=piecewise(S,[w,T,A]),v):[f(0),f(.5),f(1)]}}return v.range=m(interpolate),v.rangeRound=m(interpolateRound),v.unknown=function(S){return arguments.length?(g=S,v):g},function(S){return u=S,i=S(e),s=S(t),o=S(n),c=i===s?0:.5/(s-i),h=s===o?0:.5/(o-s),a=s<i?-1:1,v}}function diverging(){var e=linearish(transformer()(identity$3));return e.copy=function(){return copy(e,diverging())},initInterpolator.apply(e,arguments)}function divergingLog(){var e=loggish(transformer()).domain([.1,1,10]);return e.copy=function(){return copy(e,divergingLog()).base(e.base())},initInterpolator.apply(e,arguments)}function divergingSymlog(){var e=symlogish(transformer());return e.copy=function(){return copy(e,divergingSymlog()).constant(e.constant())},initInterpolator.apply(e,arguments)}function divergingPow(){var e=powish(transformer());return e.copy=function(){return copy(e,divergingPow()).exponent(e.exponent())},initInterpolator.apply(e,arguments)}function divergingSqrt(){return divergingPow.apply(null,arguments).exponent(.5)}const d3Scales=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:band,scaleDiverging:diverging,scaleDivergingLog:divergingLog,scaleDivergingPow:divergingPow,scaleDivergingSqrt:divergingSqrt,scaleDivergingSymlog:divergingSymlog,scaleIdentity:identity$1,scaleImplicit:implicit,scaleLinear:linear,scaleLog:log,scaleOrdinal:ordinal,scalePoint:point,scalePow:pow,scaleQuantile:quantile,scaleQuantize:quantize,scaleRadial:radial,scaleSequential:sequential,scaleSequentialLog:sequentialLog,scaleSequentialPow:sequentialPow,scaleSequentialQuantile:sequentialQuantile,scaleSequentialSqrt:sequentialSqrt,scaleSequentialSymlog:sequentialSymlog,scaleSqrt:sqrt,scaleSymlog:symlog,scaleThreshold:threshold,scaleTime:time,scaleUtc:utcTime,tickFormat},Symbol.toStringTag,{value:"Module"}));var selectChartDataWithIndexes=e=>e.chartData,selectChartDataAndAlwaysIgnoreIndexes=createSelector([selectChartDataWithIndexes],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),selectChartDataWithIndexesIfNotInPanorama=(e,t,n,a)=>a?selectChartDataAndAlwaysIgnoreIndexes(e):selectChartDataWithIndexes(e);function isWellFormedNumberDomain(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(isWellBehavedNumber(t)&&isWellBehavedNumber(n))return!0}return!1}function extendDomain(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function numericalDomainSpecifiedWithoutRequiringData(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,a]=e,i,s;if(isWellBehavedNumber(n))i=n;else if(typeof n=="function")return;if(isWellBehavedNumber(a))s=a;else if(typeof a=="function")return;var o=[i,s];if(isWellFormedNumberDomain(o))return o}}function parseNumericalUserDomain(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,n);if(isWellFormedNumberDomain(a))return extendDomain(a,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,c;if(i==="auto")t!=null&&(o=Math.min(...t));else if(isNumber(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t?.[0]))}catch{}else if(typeof i=="string"&&MIN_VALUE_REG.test(i)){var h=MIN_VALUE_REG.exec(i);if(h==null||t==null)o=void 0;else{var f=+h[1];o=t[0]-f}}else o=t?.[0];if(s==="auto")t!=null&&(c=Math.max(...t));else if(isNumber(s))c=s;else if(typeof s=="function")try{t!=null&&(c=s(t?.[1]))}catch{}else if(typeof s=="string"&&MAX_VALUE_REG.test(s)){var u=MAX_VALUE_REG.exec(s);if(u==null||t==null)c=void 0;else{var p=+u[1];c=t[1]+p}}else c=t?.[1];var g=[o,c];if(isWellFormedNumberDomain(g))return t==null?g:extendDomain(g,t,n)}}}var MAX_DIGITS=1e9,defaults={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Decimal,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",exponentOutOfRange=decimalError+"Exponent out of range: ",mathfloor=Math.floor,mathpow=Math.pow,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ONE,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,MAX_E=mathfloor(MAX_SAFE_INTEGER/LOG_BASE),P={};P.absoluteValue=P.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};P.comparedTo=P.cmp=function(e){var t,n,a,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(a=s.d.length,i=e.d.length,t=0,n=a<i?a:i;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return a===i?0:a>i^s.s<0?1:-1};P.decimalPlaces=P.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*LOG_BASE;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};P.dividedBy=P.div=function(e){return divide(this,new this.constructor(e))};P.dividedToIntegerBy=P.idiv=function(e){var t=this,n=t.constructor;return round(divide(t,new n(e),0,1),n.precision)};P.equals=P.eq=function(e){return!this.cmp(e)};P.exponent=function(){return getBase10Exponent(this)};P.greaterThan=P.gt=function(e){return this.cmp(e)>0};P.greaterThanOrEqualTo=P.gte=function(e){return this.cmp(e)>=0};P.isInteger=P.isint=function(){return this.e>this.d.length-2};P.isNegative=P.isneg=function(){return this.s<0};P.isPositive=P.ispos=function(){return this.s>0};P.isZero=function(){return this.s===0};P.lessThan=P.lt=function(e){return this.cmp(e)<0};P.lessThanOrEqualTo=P.lte=function(e){return this.cmp(e)<1};P.logarithm=P.log=function(e){var t,n=this,a=n.constructor,i=a.precision,s=i+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(ONE))throw Error(decimalError+"NaN");if(n.s<1)throw Error(decimalError+(n.s?"NaN":"-Infinity"));return n.eq(ONE)?new a(0):(external=!1,t=divide(ln(n,s),ln(e,s),s),external=!0,round(t,i))};P.minus=P.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?subtract(t,e):add(t,(e.s=-e.s,e))};P.modulo=P.mod=function(e){var t,n=this,a=n.constructor,i=a.precision;if(e=new a(e),!e.s)throw Error(decimalError+"NaN");return n.s?(external=!1,t=divide(n,e,0,1).times(e),external=!0,n.minus(t)):round(new a(n),i)};P.naturalExponential=P.exp=function(){return exp(this)};P.naturalLogarithm=P.ln=function(){return ln(this)};P.negated=P.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};P.plus=P.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?add(t,e):subtract(t,(e.s=-e.s,e))};P.precision=P.sd=function(e){var t,n,a,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(invalidArgument+e);if(t=getBase10Exponent(i)+1,a=i.d.length-1,n=a*LOG_BASE+1,a=i.d[a],a){for(;a%10==0;a/=10)n--;for(a=i.d[0];a>=10;a/=10)n++}return e&&t>n?t:n};P.squareRoot=P.sqrt=function(){var e,t,n,a,i,s,o,c=this,h=c.constructor;if(c.s<1){if(!c.s)return new h(0);throw Error(decimalError+"NaN")}for(e=getBase10Exponent(c),external=!1,i=Math.sqrt(+c),i==0||i==1/0?(t=digitsToString(c.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=mathfloor((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new h(t)):a=new h(i.toString()),n=h.precision,i=o=n+3;;)if(s=a,a=s.plus(divide(c,s,o+2)).times(.5),digitsToString(s.d).slice(0,o)===(t=digitsToString(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(round(s,n+1,0),s.times(s).eq(c)){a=s;break}}else if(t!="9999")break;o+=4}return external=!0,round(a,n)};P.times=P.mul=function(e){var t,n,a,i,s,o,c,h,f,u=this,p=u.constructor,g=u.d,v=(e=new p(e)).d;if(!u.s||!e.s)return new p(0);for(e.s*=u.s,n=u.e+e.e,h=g.length,f=v.length,h<f&&(s=g,g=v,v=s,o=h,h=f,f=o),s=[],o=h+f,a=o;a--;)s.push(0);for(a=f;--a>=0;){for(t=0,i=h+a;i>a;)c=s[i]+v[a]*g[i-a-1]+t,s[i--]=c%BASE|0,t=c/BASE|0;s[i]=(s[i]+t)%BASE|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,external?round(e,p.precision):e};P.toDecimalPlaces=P.todp=function(e,t){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(checkInt32(e,0,MAX_DIGITS),t===void 0?t=a.rounding:checkInt32(t,0,8),round(n,e+getBase10Exponent(n)+1,t))};P.toExponential=function(e,t){var n,a=this,i=a.constructor;return e===void 0?n=toString(a,!0):(checkInt32(e,0,MAX_DIGITS),t===void 0?t=i.rounding:checkInt32(t,0,8),a=round(new i(a),e+1,t),n=toString(a,!0,e+1)),n};P.toFixed=function(e,t){var n,a,i=this,s=i.constructor;return e===void 0?toString(i):(checkInt32(e,0,MAX_DIGITS),t===void 0?t=s.rounding:checkInt32(t,0,8),a=round(new s(i),e+getBase10Exponent(i)+1,t),n=toString(a.abs(),!1,e+getBase10Exponent(a)+1),i.isneg()&&!i.isZero()?"-"+n:n)};P.toInteger=P.toint=function(){var e=this,t=e.constructor;return round(new t(e),getBase10Exponent(e)+1,t.rounding)};P.toNumber=function(){return+this};P.toPower=P.pow=function(e){var t,n,a,i,s,o,c=this,h=c.constructor,f=12,u=+(e=new h(e));if(!e.s)return new h(ONE);if(c=new h(c),!c.s){if(e.s<1)throw Error(decimalError+"Infinity");return c}if(c.eq(ONE))return c;if(a=h.precision,e.eq(ONE))return round(c,a);if(t=e.e,n=e.d.length-1,o=t>=n,s=c.s,o){if((n=u<0?-u:u)<=MAX_SAFE_INTEGER){for(i=new h(ONE),t=Math.ceil(a/LOG_BASE+4),external=!1;n%2&&(i=i.times(c),truncate(i.d,t)),n=mathfloor(n/2),n!==0;)c=c.times(c),truncate(c.d,t);return external=!0,e.s<0?new h(ONE).div(i):round(i,a)}}else if(s<0)throw Error(decimalError+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,c.s=1,external=!1,i=e.times(ln(c,a+f)),external=!0,i=exp(i),i.s=s,i};P.toPrecision=function(e,t){var n,a,i=this,s=i.constructor;return e===void 0?(n=getBase10Exponent(i),a=toString(i,n<=s.toExpNeg||n>=s.toExpPos)):(checkInt32(e,1,MAX_DIGITS),t===void 0?t=s.rounding:checkInt32(t,0,8),i=round(new s(i),e,t),n=getBase10Exponent(i),a=toString(i,e<=n||n<=s.toExpNeg,e)),a};P.toSignificantDigits=P.tosd=function(e,t){var n=this,a=n.constructor;return e===void 0?(e=a.precision,t=a.rounding):(checkInt32(e,1,MAX_DIGITS),t===void 0?t=a.rounding:checkInt32(t,0,8)),round(new a(n),e,t)};P.toString=P.valueOf=P.val=P.toJSON=P[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=getBase10Exponent(e),n=e.constructor;return toString(e,t<=n.toExpNeg||t>=n.toExpPos)};function add(e,t){var n,a,i,s,o,c,h,f,u=e.constructor,p=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),external?round(t,p):t;if(h=e.d,f=t.d,o=e.e,i=t.e,h=h.slice(),s=o-i,s){for(s<0?(a=h,s=-s,c=f.length):(a=f,i=o,c=h.length),o=Math.ceil(p/LOG_BASE),c=o>c?o+1:c+1,s>c&&(s=c,a.length=1),a.reverse();s--;)a.push(0);a.reverse()}for(c=h.length,s=f.length,c-s<0&&(s=c,a=f,f=h,h=a),n=0;s;)n=(h[--s]=h[s]+f[s]+n)/BASE|0,h[s]%=BASE;for(n&&(h.unshift(n),++i),c=h.length;h[--c]==0;)h.pop();return t.d=h,t.e=i,external?round(t,p):t}function checkInt32(e,t,n){if(e!==~~e||e<t||e>n)throw Error(invalidArgument+e)}function digitsToString(e){var t,n,a,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)a=e[t]+"",n=LOG_BASE-a.length,n&&(s+=getZeroString(n)),s+=a;o=e[t],a=o+"",n=LOG_BASE-a.length,n&&(s+=getZeroString(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var divide=(function(){function e(a,i){var s,o=0,c=a.length;for(a=a.slice();c--;)s=a[c]*i+o,a[c]=s%BASE|0,o=s/BASE|0;return o&&a.unshift(o),a}function t(a,i,s,o){var c,h;if(s!=o)h=s>o?1:-1;else for(c=h=0;c<s;c++)if(a[c]!=i[c]){h=a[c]>i[c]?1:-1;break}return h}function n(a,i,s){for(var o=0;s--;)a[s]-=o,o=a[s]<i[s]?1:0,a[s]=o*BASE+a[s]-i[s];for(;!a[0]&&a.length>1;)a.shift()}return function(a,i,s,o){var c,h,f,u,p,g,v,m,S,E,w,T,A,L,k,D,N,Y,z=a.constructor,te=a.s==i.s?1:-1,Z=a.d,ne=i.d;if(!a.s)return new z(a);if(!i.s)throw Error(decimalError+"Division by zero");for(h=a.e-i.e,N=ne.length,k=Z.length,v=new z(te),m=v.d=[],f=0;ne[f]==(Z[f]||0);)++f;if(ne[f]>(Z[f]||0)&&--h,s==null?T=s=z.precision:o?T=s+(getBase10Exponent(a)-getBase10Exponent(i))+1:T=s,T<0)return new z(0);if(T=T/LOG_BASE+2|0,f=0,N==1)for(u=0,ne=ne[0],T++;(f<k||u)&&T--;f++)A=u*BASE+(Z[f]||0),m[f]=A/ne|0,u=A%ne|0;else{for(u=BASE/(ne[0]+1)|0,u>1&&(ne=e(ne,u),Z=e(Z,u),N=ne.length,k=Z.length),L=N,S=Z.slice(0,N),E=S.length;E<N;)S[E++]=0;Y=ne.slice(),Y.unshift(0),D=ne[0],ne[1]>=BASE/2&&++D;do u=0,c=t(ne,S,N,E),c<0?(w=S[0],N!=E&&(w=w*BASE+(S[1]||0)),u=w/D|0,u>1?(u>=BASE&&(u=BASE-1),p=e(ne,u),g=p.length,E=S.length,c=t(p,S,g,E),c==1&&(u--,n(p,N<g?Y:ne,g))):(u==0&&(c=u=1),p=ne.slice()),g=p.length,g<E&&p.unshift(0),n(S,p,E),c==-1&&(E=S.length,c=t(ne,S,N,E),c<1&&(u++,n(S,N<E?Y:ne,E))),E=S.length):c===0&&(u++,S=[0]),m[f++]=u,c&&S[0]?S[E++]=Z[L]||0:(S=[Z[L]],E=1);while((L++<k||S[0]!==void 0)&&T--)}return m[0]||m.shift(),v.e=h,round(v,o?s+getBase10Exponent(v)+1:s)}})();function exp(e,t){var n,a,i,s,o,c,h=0,f=0,u=e.constructor,p=u.precision;if(getBase10Exponent(e)>16)throw Error(exponentOutOfRange+getBase10Exponent(e));if(!e.s)return new u(ONE);for(external=!1,c=p,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),f+=5;for(a=Math.log(mathpow(2,f))/Math.LN10*2+5|0,c+=a,n=i=s=new u(ONE),u.precision=c;;){if(i=round(i.times(e),c),n=n.times(++h),o=s.plus(divide(i,n,c)),digitsToString(o.d).slice(0,c)===digitsToString(s.d).slice(0,c)){for(;f--;)s=round(s.times(s),c);return u.precision=p,t==null?(external=!0,round(s,p)):s}s=o}}function getBase10Exponent(e){for(var t=e.e*LOG_BASE,n=e.d[0];n>=10;n/=10)t++;return t}function getLn10(e,t,n){if(t>e.LN10.sd())throw external=!0,n&&(e.precision=n),Error(decimalError+"LN10 precision limit exceeded");return round(new e(e.LN10),t)}function getZeroString(e){for(var t="";e--;)t+="0";return t}function ln(e,t){var n,a,i,s,o,c,h,f,u,p=1,g=10,v=e,m=v.d,S=v.constructor,E=S.precision;if(v.s<1)throw Error(decimalError+(v.s?"NaN":"-Infinity"));if(v.eq(ONE))return new S(0);if(t==null?(external=!1,f=E):f=t,v.eq(10))return t==null&&(external=!0),getLn10(S,f);if(f+=g,S.precision=f,n=digitsToString(m),a=n.charAt(0),s=getBase10Exponent(v),Math.abs(s)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)v=v.times(e),n=digitsToString(v.d),a=n.charAt(0),p++;s=getBase10Exponent(v),a>1?(v=new S("0."+n),s++):v=new S(a+"."+n.slice(1))}else return h=getLn10(S,f+2,E).times(s+""),v=ln(new S(a+"."+n.slice(1)),f-g).plus(h),S.precision=E,t==null?(external=!0,round(v,E)):v;for(c=o=v=divide(v.minus(ONE),v.plus(ONE),f),u=round(v.times(v),f),i=3;;){if(o=round(o.times(u),f),h=c.plus(divide(o,new S(i),f)),digitsToString(h.d).slice(0,f)===digitsToString(c.d).slice(0,f))return c=c.times(2),s!==0&&(c=c.plus(getLn10(S,f+2,E).times(s+""))),c=divide(c,new S(p),f),S.precision=E,t==null?(external=!0,round(c,E)):c;c=h,i+=2}}function parseDecimal(e,t){var n,a,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(n<0&&(n=a),n+=+t.slice(a+1),t=t.substring(0,a)):n<0&&(n=t.length),a=0;t.charCodeAt(a)===48;)++a;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(a,i),t){if(i-=a,n=n-a-1,e.e=mathfloor(n/LOG_BASE),e.d=[],a=(n+1)%LOG_BASE,n<0&&(a+=LOG_BASE),a<i){for(a&&e.d.push(+t.slice(0,a)),i-=LOG_BASE;a<i;)e.d.push(+t.slice(a,a+=LOG_BASE));t=t.slice(a),a=LOG_BASE-t.length}else a-=i;for(;a--;)t+="0";if(e.d.push(+t),external&&(e.e>MAX_E||e.e<-MAX_E))throw Error(exponentOutOfRange+n)}else e.s=0,e.e=0,e.d=[0];return e}function round(e,t,n){var a,i,s,o,c,h,f,u,p=e.d;for(o=1,s=p[0];s>=10;s/=10)o++;if(a=t-o,a<0)a+=LOG_BASE,i=t,f=p[u=0];else{if(u=Math.ceil((a+1)/LOG_BASE),s=p.length,u>=s)return e;for(f=s=p[u],o=1;s>=10;s/=10)o++;a%=LOG_BASE,i=a-LOG_BASE+o}if(n!==void 0&&(s=mathpow(10,o-i-1),c=f/s%10|0,h=t<0||p[u+1]!==void 0||f%s,h=n<4?(c||h)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||h||n==6&&(a>0?i>0?f/mathpow(10,o-i):0:p[u-1])%10&1||n==(e.s<0?8:7))),t<1||!p[0])return h?(s=getBase10Exponent(e),p.length=1,t=t-s-1,p[0]=mathpow(10,(LOG_BASE-t%LOG_BASE)%LOG_BASE),e.e=mathfloor(-t/LOG_BASE)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(a==0?(p.length=u,s=1,u--):(p.length=u+1,s=mathpow(10,LOG_BASE-a),p[u]=i>0?(f/mathpow(10,o-i)%mathpow(10,i)|0)*s:0),h)for(;;)if(u==0){(p[0]+=s)==BASE&&(p[0]=1,++e.e);break}else{if(p[u]+=s,p[u]!=BASE)break;p[u--]=0,s=1}for(a=p.length;p[--a]===0;)p.pop();if(external&&(e.e>MAX_E||e.e<-MAX_E))throw Error(exponentOutOfRange+getBase10Exponent(e));return e}function subtract(e,t){var n,a,i,s,o,c,h,f,u,p,g=e.constructor,v=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),external?round(t,v):t;if(h=e.d,p=t.d,a=t.e,f=e.e,h=h.slice(),o=f-a,o){for(u=o<0,u?(n=h,o=-o,c=p.length):(n=p,a=f,c=h.length),i=Math.max(Math.ceil(v/LOG_BASE),c)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=h.length,c=p.length,u=i<c,u&&(c=i),i=0;i<c;i++)if(h[i]!=p[i]){u=h[i]<p[i];break}o=0}for(u&&(n=h,h=p,p=n,t.s=-t.s),c=h.length,i=p.length-c;i>0;--i)h[c++]=0;for(i=p.length;i>o;){if(h[--i]<p[i]){for(s=i;s&&h[--s]===0;)h[s]=BASE-1;--h[s],h[i]+=BASE}h[i]-=p[i]}for(;h[--c]===0;)h.pop();for(;h[0]===0;h.shift())--a;return h[0]?(t.d=h,t.e=a,external?round(t,v):t):new g(0)}function toString(e,t,n){var a,i=getBase10Exponent(e),s=digitsToString(e.d),o=s.length;return t?(n&&(a=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+getZeroString(a):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+getZeroString(-i-1)+s,n&&(a=n-o)>0&&(s+=getZeroString(a))):i>=o?(s+=getZeroString(i+1-o),n&&(a=n-i-1)>0&&(s=s+"."+getZeroString(a))):((a=i+1)<o&&(s=s.slice(0,a)+"."+s.slice(a)),n&&(a=n-o)>0&&(i+1===o&&(s+="."),s+=getZeroString(a))),e.s<0?"-"+s:s}function truncate(e,t){if(e.length>t)return e.length=t,!0}function clone(e){var t,n,a;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(invalidArgument+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return parseDecimal(o,s.toString())}else if(typeof s!="string")throw Error(invalidArgument+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,isDecimal.test(s))parseDecimal(o,s);else throw Error(invalidArgument+s)}if(i.prototype=P,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=clone,i.config=i.set=config,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(n=a[t++])||(e[n]=this[n]);return i.config(e),i}function config(e){if(!e||typeof e!="object")throw Error(decimalError+"Object expected");var t,n,a,i=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((a=e[n=i[t]])!==void 0)if(mathfloor(a)===a&&a>=i[t+1]&&a<=i[t+2])this[n]=a;else throw Error(invalidArgument+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(invalidArgument+n+": "+a);return this}var Decimal=clone(defaults);ONE=new Decimal(1);const Decimal$1=Decimal;var identity=e=>e,PLACE_HOLDER={},isPlaceHolder=e=>e===PLACE_HOLDER,curry0=e=>function t(){return arguments.length===0||arguments.length===1&&isPlaceHolder(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},curryN=(e,t)=>e===1?t:curry0(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(o=>o!==PLACE_HOLDER).length;return s>=e?t(...a):curryN(e-s,curry0(function(){for(var o=arguments.length,c=new Array(o),h=0;h<o;h++)c[h]=arguments[h];var f=a.map(u=>isPlaceHolder(u)?c.shift():u);return t(...f,...c)}))}),curry=e=>curryN(e.length,e),range=(e,t)=>{for(var n=[],a=e;a<t;++a)n[a-e]=a;return n},map=curry((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),compose=function e(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];if(!n.length)return identity;var i=n.reverse(),s=i[0],o=i.slice(1);return function(){return o.reduce((c,h)=>h(c),s(...arguments))}},reverse=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),memoize=e=>{var t=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return t&&i.every((o,c)=>{var h;return o===((h=t)===null||h===void 0?void 0:h[c])})||(t=i,n=e(...i)),n}};function getDigitCount(e){var t;return e===0?t=1:t=Math.floor(new Decimal$1(e).abs().log(10).toNumber())+1,t}function rangeStep(e,t,n){for(var a=new Decimal$1(e),i=0,s=[];a.lt(t)&&i<1e5;)s.push(a.toNumber()),a=a.add(n),i++;return s}curry((e,t,n)=>{var a=+e,i=+t;return a+n*(i-a)});curry((e,t,n)=>{var a=t-+e;return a=a||1/0,(n-e)/a});curry((e,t,n)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(n-e)/a))});var getValidInterval=e=>{var[t,n]=e,[a,i]=[t,n];return t>n&&([a,i]=[n,t]),[a,i]},getFormatStep=(e,t,n)=>{if(e.lte(0))return new Decimal$1(0);var a=getDigitCount(e.toNumber()),i=new Decimal$1(10).pow(a),s=e.div(i),o=a!==1?.05:.1,c=new Decimal$1(Math.ceil(s.div(o).toNumber())).add(n).mul(o),h=c.mul(i);return t?new Decimal$1(h.toNumber()):new Decimal$1(Math.ceil(h.toNumber()))},getTickOfSingleValue=(e,t,n)=>{var a=new Decimal$1(1),i=new Decimal$1(e);if(!i.isint()&&n){var s=Math.abs(e);s<1?(a=new Decimal$1(10).pow(getDigitCount(e)-1),i=new Decimal$1(Math.floor(i.div(a).toNumber())).mul(a)):s>1&&(i=new Decimal$1(Math.floor(e)))}else e===0?i=new Decimal$1(Math.floor((t-1)/2)):n||(i=new Decimal$1(Math.floor(e)));var o=Math.floor((t-1)/2),c=compose(map(h=>i.add(new Decimal$1(h-o).mul(a)).toNumber()),range);return c(0,t)},_calculateStep=function e(t,n,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(a-1)))return{step:new Decimal$1(0),tickMin:new Decimal$1(0),tickMax:new Decimal$1(0)};var o=getFormatStep(new Decimal$1(n).sub(t).div(a-1),i,s),c;t<=0&&n>=0?c=new Decimal$1(0):(c=new Decimal$1(t).add(n).div(2),c=c.sub(new Decimal$1(c).mod(o)));var h=Math.ceil(c.sub(t).div(o).toNumber()),f=Math.ceil(new Decimal$1(n).sub(c).div(o).toNumber()),u=h+f+1;return u>a?_calculateStep(t,n,a,i,s+1):(u<a&&(f=n>0?f+(a-u):f,h=n>0?h:h+(a-u)),{step:o,tickMin:c.sub(new Decimal$1(h).mul(o)),tickMax:c.add(new Decimal$1(f).mul(o))})};function getNiceTickValuesFn(e){var[t,n]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[o,c]=getValidInterval([t,n]);if(o===-1/0||c===1/0){var h=c===1/0?[o,...range(0,a-1).map(()=>1/0)]:[...range(0,a-1).map(()=>-1/0),c];return t>n?reverse(h):h}if(o===c)return getTickOfSingleValue(o,a,i);var{step:f,tickMin:u,tickMax:p}=_calculateStep(o,c,s,i,0),g=rangeStep(u,p.add(new Decimal$1(.1).mul(f)),f);return t>n?reverse(g):g}function getTickValuesFixedDomainFn(e,t){var[n,a]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=getValidInterval([n,a]);if(s===-1/0||o===1/0)return[n,a];if(s===o)return[s];var c=Math.max(t,2),h=getFormatStep(new Decimal$1(o).sub(s).div(c-1),i,0),f=[...rangeStep(new Decimal$1(s),new Decimal$1(o),h),o];return i===!1&&(f=f.map(u=>Math.round(u))),n>a?reverse(f):f}var getNiceTickValues=memoize(getNiceTickValuesFn),getTickValuesFixedDomain=memoize(getTickValuesFixedDomainFn),selectBarCategoryGap=e=>e.rootProps.barCategoryGap,selectStackOffsetType=e=>e.rootProps.stackOffset,selectChartName=e=>e.options.chartName,selectSyncId=e=>e.rootProps.syncId,selectSyncMethod=e=>e.rootProps.syncMethod,selectEventEmitter=e=>e.options.eventEmitter,defaultPolarAngleAxisProps={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},defaultPolarRadiusAxisProps={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},combineAxisRangeWithReverse=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},implicitAngleAxis={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:defaultPolarAngleAxisProps.angleAxisId,includeHidden:!1,name:void 0,reversed:defaultPolarAngleAxisProps.reversed,scale:defaultPolarAngleAxisProps.scale,tick:defaultPolarAngleAxisProps.tick,tickCount:void 0,ticks:void 0,type:defaultPolarAngleAxisProps.type,unit:void 0},implicitRadiusAxis={allowDataOverflow:defaultPolarRadiusAxisProps.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:defaultPolarRadiusAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarRadiusAxisProps.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarRadiusAxisProps.scale,tick:defaultPolarRadiusAxisProps.tick,tickCount:defaultPolarRadiusAxisProps.tickCount,ticks:void 0,type:defaultPolarRadiusAxisProps.type,unit:void 0},implicitRadialBarAngleAxis={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:defaultPolarAngleAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarAngleAxisProps.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarAngleAxisProps.scale,tick:defaultPolarAngleAxisProps.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},implicitRadialBarRadiusAxis={allowDataOverflow:defaultPolarRadiusAxisProps.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:defaultPolarRadiusAxisProps.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:defaultPolarRadiusAxisProps.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:defaultPolarRadiusAxisProps.scale,tick:defaultPolarRadiusAxisProps.tick,tickCount:defaultPolarRadiusAxisProps.tickCount,ticks:void 0,type:"category",unit:void 0},selectAngleAxis=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?implicitRadialBarAngleAxis:implicitAngleAxis,selectRadiusAxis=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?implicitRadialBarRadiusAxis:implicitRadiusAxis,selectPolarOptions=e=>e.polarOptions,selectMaxRadius=createSelector([selectChartWidth,selectChartHeight,selectChartOffsetInternal],getMaxRadius),selectInnerRadius=createSelector([selectPolarOptions,selectMaxRadius],(e,t)=>{if(e!=null)return getPercentValue(e.innerRadius,t,0)}),selectOuterRadius=createSelector([selectPolarOptions,selectMaxRadius],(e,t)=>{if(e!=null)return getPercentValue(e.outerRadius,t,t*.8)}),combineAngleAxisRange=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},selectAngleAxisRange=createSelector([selectPolarOptions],combineAngleAxisRange);createSelector([selectAngleAxis,selectAngleAxisRange],combineAxisRangeWithReverse);var selectRadiusAxisRange=createSelector([selectMaxRadius,selectInnerRadius,selectOuterRadius],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});createSelector([selectRadiusAxis,selectRadiusAxisRange],combineAxisRangeWithReverse);var selectPolarViewBox=createSelector([selectChartLayout,selectPolarOptions,selectInnerRadius,selectOuterRadius,selectChartWidth,selectChartHeight],(e,t,n,a,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||a==null)){var{cx:o,cy:c,startAngle:h,endAngle:f}=t;return{cx:getPercentValue(o,i,i/2),cy:getPercentValue(c,s,s/2),innerRadius:n,outerRadius:a,startAngle:h,endAngle:f,clockWise:!1}}}),pickAxisType=(e,t)=>t,pickAxisId=(e,t,n)=>n;function getStackSeriesIdentifier(e){return e?.id}var selectTooltipAxisType=e=>{var t=selectChartLayout(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},selectTooltipAxisId=e=>e.tooltip.settings.axisId,selectTooltipAxis=e=>{var t=selectTooltipAxisType(e),n=selectTooltipAxisId(e);return selectAxisSettings(e,t,n)},selectTooltipAxisDataKey=createSelector([selectTooltipAxis],e=>e?.dataKey);function combineDisplayedStackedData(e,t,n){var{chartData:a=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=n,o=new Map;return e.forEach(c=>{var h,f=(h=c.data)!==null&&h!==void 0?h:a;if(!(f==null||f.length===0)){var u=getStackSeriesIdentifier(c);f.forEach((p,g)=>{var v=s==null||i?g:String(getValueByDataKey(p,s,null)),m=getValueByDataKey(p,c.dataKey,0),S;o.has(v)?S=o.get(v):S={},Object.assign(S,{[u]:m}),o.set(v,S)})}}),Array.from(o.values())}function isStacked(e){return e.stackId!=null&&e.dataKey!=null}var numberDomainEqualityCheck=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function arrayEqualityCheck(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function ownKeys$f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$f(Object(n),!0).forEach(function(a){_defineProperty$h(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$f(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$h(e,t,n){return(t=_toPropertyKey$h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$h(e){var t=_toPrimitive$h(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$h(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var defaultNumericDomain=[0,"auto"],implicitXAxis={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},selectXAxisSettingsNoDefaults=(e,t)=>e.cartesianAxis.xAxis[t],selectXAxisSettings=(e,t)=>{var n=selectXAxisSettingsNoDefaults(e,t);return n??implicitXAxis},implicitYAxis={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:defaultNumericDomain,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:DEFAULT_Y_AXIS_WIDTH},selectYAxisSettingsNoDefaults=(e,t)=>e.cartesianAxis.yAxis[t],selectYAxisSettings=(e,t)=>{var n=selectYAxisSettingsNoDefaults(e,t);return n??implicitYAxis},implicitZAxis={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},selectZAxisSettings=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??implicitZAxis},selectBaseAxis=(e,t,n)=>{switch(t){case"xAxis":return selectXAxisSettings(e,n);case"yAxis":return selectYAxisSettings(e,n);case"zAxis":return selectZAxisSettings(e,n);case"angleAxis":return selectAngleAxis(e,n);case"radiusAxis":return selectRadiusAxis(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},selectCartesianAxisSettings=(e,t,n)=>{switch(t){case"xAxis":return selectXAxisSettings(e,n);case"yAxis":return selectYAxisSettings(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},selectAxisSettings=(e,t,n)=>{switch(t){case"xAxis":return selectXAxisSettings(e,n);case"yAxis":return selectYAxisSettings(e,n);case"angleAxis":return selectAngleAxis(e,n);case"radiusAxis":return selectRadiusAxis(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},selectHasBar=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function itemAxisPredicate(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var selectUnfilteredCartesianItems=e=>e.graphicalItems.cartesianItems,selectAxisPredicate=createSelector([pickAxisType,pickAxisId],itemAxisPredicate),combineGraphicalItemsSettings=(e,t,n)=>e.filter(n).filter(a=>t?.includeHidden===!0?!0:!a.hide),selectCartesianItemsSettings=createSelector([selectUnfilteredCartesianItems,selectBaseAxis,selectAxisPredicate],combineGraphicalItemsSettings,{memoizeOptions:{resultEqualityCheck:arrayEqualityCheck}}),selectStackedCartesianItemsSettings=createSelector([selectCartesianItemsSettings],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(isStacked)),filterGraphicalNotStackedItems=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),selectCartesianItemsSettingsExceptStacked=createSelector([selectCartesianItemsSettings],filterGraphicalNotStackedItems),combineGraphicalItemsData=e=>e.map(t=>t.data).filter(Boolean).flat(1),selectCartesianGraphicalItemsData=createSelector([selectCartesianItemsSettings],combineGraphicalItemsData,{memoizeOptions:{resultEqualityCheck:arrayEqualityCheck}}),combineDisplayedData=(e,t)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:i}=t;return e.length>0?e:n.slice(a,i+1)},selectDisplayedData=createSelector([selectCartesianGraphicalItemsData,selectChartDataWithIndexesIfNotInPanorama],combineDisplayedData),combineAppliedValues=(e,t,n)=>t?.dataKey!=null?e.map(a=>({value:getValueByDataKey(a,t.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>e.map(i=>({value:getValueByDataKey(i,a)}))):e.map(a=>({value:a})),selectAllAppliedValues=createSelector([selectDisplayedData,selectBaseAxis,selectCartesianItemsSettings],combineAppliedValues);function isErrorBarRelevantForAxisType(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function makeNumber(e){if(isNumOrStr(e)||e instanceof Date){var t=Number(e);if(isWellBehavedNumber(t))return t}}function makeDomain(e){if(Array.isArray(e)){var t=[makeNumber(e[0]),makeNumber(e[1])];return isWellFormedNumberDomain(t)?t:void 0}var n=makeNumber(e);if(n!=null)return[n,n]}function onlyAllowNumbers(e){return e.map(makeNumber).filter(isNotNil)}function getErrorDomainByDataKey(e,t,n){return!n||typeof t!="number"||isNan(t)?[]:n.length?onlyAllowNumbers(n.flatMap(a=>{var i=getValueByDataKey(e,a.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!isWellBehavedNumber(s)||!isWellBehavedNumber(o)))return[t-s,t+o]})):[]}var selectDisplayedStackedData=createSelector([selectStackedCartesianItemsSettings,selectChartDataWithIndexesIfNotInPanorama,selectTooltipAxis],combineDisplayedStackedData),combineStackGroups=(e,t,n)=>{var a={},i=t.reduce((s,o)=>(o.stackId==null||(s[o.stackId]==null&&(s[o.stackId]=[]),s[o.stackId].push(o)),s),a);return Object.fromEntries(Object.entries(i).map(s=>{var[o,c]=s,h=c.map(getStackSeriesIdentifier);return[o,{stackedData:getStackedData(e,h,n),graphicalItems:c}]}))},selectStackGroups=createSelector([selectDisplayedStackedData,selectStackedCartesianItemsSettings,selectStackOffsetType],combineStackGroups),combineDomainOfStackGroups=(e,t,n,a)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(a==null&&n!=="zAxis"){var o=getDomainOfStackGroups(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},selectAllowsDataOverflow=createSelector([selectBaseAxis],e=>e.allowDataOverflow),getDomainDefinition=e=>{var t;if(e==null||!("domain"in e))return defaultNumericDomain;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var n=onlyAllowNumbers(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:defaultNumericDomain},selectDomainDefinition=createSelector([selectBaseAxis],getDomainDefinition),selectDomainFromUserPreference=createSelector([selectDomainDefinition,selectAllowsDataOverflow],numericalDomainSpecifiedWithoutRequiringData),selectDomainOfStackGroups=createSelector([selectStackGroups,selectChartDataWithIndexes,pickAxisType,selectDomainFromUserPreference],combineDomainOfStackGroups,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),selectAllErrorBarSettings=e=>e.errorBars,combineRelevantErrorBarSettings=(e,t,n)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>isErrorBarRelevantForAxisType(n,a)),mergeDomains=function e(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var i=n.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),c=Math.max(...s);return[o,c]}},combineDomainOfAllAppliedNumericalValuesIncludingErrorValues=(e,t,n,a,i)=>{var s,o;if(n.length>0&&e.forEach(c=>{n.forEach(h=>{var f,u,p=(f=a[h.id])===null||f===void 0?void 0:f.filter(w=>isErrorBarRelevantForAxisType(i,w)),g=getValueByDataKey(c,(u=t.dataKey)!==null&&u!==void 0?u:h.dataKey),v=getErrorDomainByDataKey(c,g,p);if(v.length>=2){var m=Math.min(...v),S=Math.max(...v);(s==null||m<s)&&(s=m),(o==null||S>o)&&(o=S)}var E=makeDomain(g);E!=null&&(s=s==null?E[0]:Math.min(s,E[0]),o=o==null?E[1]:Math.max(o,E[1]))})}),t?.dataKey!=null&&e.forEach(c=>{var h=makeDomain(getValueByDataKey(c,t.dataKey));h!=null&&(s=s==null?h[0]:Math.min(s,h[0]),o=o==null?h[1]:Math.max(o,h[1]))}),isWellBehavedNumber(s)&&isWellBehavedNumber(o))return[s,o]},selectDomainOfAllAppliedNumericalValuesIncludingErrorValues$1=createSelector([selectDisplayedData,selectBaseAxis,selectCartesianItemsSettingsExceptStacked,selectAllErrorBarSettings,pickAxisType],combineDomainOfAllAppliedNumericalValuesIncludingErrorValues,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}});function onlyAllowNumbersAndStringsAndDates(e){var{value:t}=e;if(isNumOrStr(t)||t instanceof Date)return t}var computeDomainOfTypeCategory=(e,t,n)=>{var a=e.map(onlyAllowNumbersAndStringsAndDates).filter(i=>i!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&hasDuplicate(a))?range$2(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},selectReferenceDots=e=>e.referenceElements.dots,filterReferenceElements=(e,t,n)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===n:a.yAxisId===n),selectReferenceDotsByAxis=createSelector([selectReferenceDots,pickAxisType,pickAxisId],filterReferenceElements),selectReferenceAreas=e=>e.referenceElements.areas,selectReferenceAreasByAxis=createSelector([selectReferenceAreas,pickAxisType,pickAxisId],filterReferenceElements),selectReferenceLines=e=>e.referenceElements.lines,selectReferenceLinesByAxis=createSelector([selectReferenceLines,pickAxisType,pickAxisId],filterReferenceElements),combineDotsDomain=(e,t)=>{var n=onlyAllowNumbers(e.map(a=>t==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},selectReferenceDotsDomain=createSelector(selectReferenceDotsByAxis,pickAxisType,combineDotsDomain),combineAreasDomain=(e,t)=>{var n=onlyAllowNumbers(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},selectReferenceAreasDomain=createSelector([selectReferenceAreasByAxis,pickAxisType],combineAreasDomain),combineLinesDomain=(e,t)=>{var n=onlyAllowNumbers(e.map(a=>t==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},selectReferenceLinesDomain=createSelector(selectReferenceLinesByAxis,pickAxisType,combineLinesDomain),selectReferenceElementsDomain=createSelector(selectReferenceDotsDomain,selectReferenceLinesDomain,selectReferenceAreasDomain,(e,t,n)=>mergeDomains(e,n,t)),combineNumericalDomain=(e,t,n,a,i,s,o,c)=>{if(n!=null)return n;var h=o==="vertical"&&c==="xAxis"||o==="horizontal"&&c==="yAxis",f=h?mergeDomains(a,s,i):mergeDomains(s,i);return parseNumericalUserDomain(t,f,e.allowDataOverflow)},selectNumericalDomain=createSelector([selectBaseAxis,selectDomainDefinition,selectDomainFromUserPreference,selectDomainOfStackGroups,selectDomainOfAllAppliedNumericalValuesIncludingErrorValues$1,selectReferenceElementsDomain,selectChartLayout,pickAxisType],combineNumericalDomain,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),expandDomain=[0,1],combineAxisDomain=(e,t,n,a,i,s,o)=>{if(!((e==null||n==null||n.length===0)&&o===void 0)){var{dataKey:c,type:h}=e,f=isCategoricalAxis(t,s);return f&&c==null?range$2(0,n.length):h==="category"?computeDomainOfTypeCategory(a,e,f):i==="expand"?expandDomain:o}},selectAxisDomain=createSelector([selectBaseAxis,selectChartLayout,selectDisplayedData,selectAllAppliedValues,selectStackOffsetType,pickAxisType,selectNumericalDomain],combineAxisDomain),combineRealScaleType=(e,t,n,a,i)=>{if(e!=null){var{scale:s,type:o}=e;if(s==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var c="scale".concat(upperFirst(s));return c in d3Scales?c:"point"}}},selectRealScaleType=createSelector([selectBaseAxis,selectChartLayout,selectHasBar,selectChartName,pickAxisType],combineRealScaleType);function getD3ScaleFromType(e){if(e!=null){if(e in d3Scales)return d3Scales[e]();var t="scale".concat(upperFirst(e));if(t in d3Scales)return d3Scales[t]()}}function combineScaleFunction(e,t,n,a){if(!(n==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(a);var i=getD3ScaleFromType(t);if(i!=null){var s=i.domain(n).range(a);return checkDomainOfScale(s),s}}}var combineNiceTicks=(e,t,n)=>{var a=getDomainDefinition(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&isWellFormedNumberDomain(e))return getNiceTickValues(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&isWellFormedNumberDomain(e))return getTickValuesFixedDomain(e,t.tickCount,t.allowDecimals)}},selectNiceTicks=createSelector([selectAxisDomain,selectAxisSettings,selectRealScaleType],combineNiceTicks),combineAxisDomainWithNiceTicks=(e,t,n,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&isWellFormedNumberDomain(t)&&Array.isArray(n)&&n.length>0){var i=t[0],s=n[0],o=t[1],c=n[n.length-1];return[Math.min(i,s),Math.max(o,c)]}return t},selectAxisDomainIncludingNiceTicks=createSelector([selectBaseAxis,selectAxisDomain,selectNiceTicks,pickAxisType],combineAxisDomainWithNiceTicks),selectSmallestDistanceBetweenValues=createSelector(selectAllAppliedValues,selectBaseAxis,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,a=Array.from(onlyAllowNumbers(e.map(c=>c.value))).sort((c,h)=>c-h);if(a.length<2)return 1/0;var i=a[a.length-1]-a[0];if(i===0)return 1/0;for(var s=0;s<a.length-1;s++){var o=a[s+1]-a[s];n=Math.min(n,o)}return n/i}}),selectCalculatedPadding=createSelector(selectSmallestDistanceBetweenValues,selectChartLayout,selectBarCategoryGap,selectChartOffsetInternal,(e,t,n,a)=>a,(e,t,n,a,i)=>{if(!isWellBehavedNumber(e))return 0;var s=t==="vertical"?a.height:a.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=getPercentValue(n,e*s),c=e*s/2;return c-o-(c-o)/s*o}return 0}),selectCalculatedXAxisPadding=(e,t)=>{var n=selectXAxisSettings(e,t);return n==null||typeof n.padding!="string"?0:selectCalculatedPadding(e,"xAxis",t,n.padding)},selectCalculatedYAxisPadding=(e,t)=>{var n=selectYAxisSettings(e,t);return n==null||typeof n.padding!="string"?0:selectCalculatedPadding(e,"yAxis",t,n.padding)},selectXAxisPadding=createSelector(selectXAxisSettings,selectCalculatedXAxisPadding,(e,t)=>{var n,a;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((n=i.left)!==null&&n!==void 0?n:0)+t,right:((a=i.right)!==null&&a!==void 0?a:0)+t}}),selectYAxisPadding=createSelector(selectYAxisSettings,selectCalculatedYAxisPadding,(e,t)=>{var n,a;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((n=i.top)!==null&&n!==void 0?n:0)+t,bottom:((a=i.bottom)!==null&&a!==void 0?a:0)+t}}),combineXAxisRange=createSelector([selectChartOffsetInternal,selectXAxisPadding,selectBrushDimensions,selectBrushSettings,(e,t,n)=>n],(e,t,n,a,i)=>{var{padding:s}=a;return i?[s.left,n.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),combineYAxisRange=createSelector([selectChartOffsetInternal,selectChartLayout,selectYAxisPadding,selectBrushDimensions,selectBrushSettings,(e,t,n)=>n],(e,t,n,a,i,s)=>{var{padding:o}=i;return s?[a.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),selectAxisRange=(e,t,n,a)=>{var i;switch(t){case"xAxis":return combineXAxisRange(e,n,a);case"yAxis":return combineYAxisRange(e,n,a);case"zAxis":return(i=selectZAxisSettings(e,n))===null||i===void 0?void 0:i.range;case"angleAxis":return selectAngleAxisRange(e);case"radiusAxis":return selectRadiusAxisRange(e,n);default:return}},selectAxisRangeWithReverse=createSelector([selectBaseAxis,selectAxisRange],combineAxisRangeWithReverse),selectAxisScale=createSelector([selectBaseAxis,selectRealScaleType,selectAxisDomainIncludingNiceTicks,selectAxisRangeWithReverse],combineScaleFunction);createSelector([selectCartesianItemsSettings,selectAllErrorBarSettings,pickAxisType],combineRelevantErrorBarSettings);function compareIds(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var pickAxisOrientation=(e,t)=>t,pickMirror=(e,t,n)=>n,selectAllXAxesWithOffsetType=createSelector(selectAllXAxes,pickAxisOrientation,pickMirror,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(compareIds)),selectAllYAxesWithOffsetType=createSelector(selectAllYAxes,pickAxisOrientation,pickMirror,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(compareIds)),getXAxisSize=(e,t)=>({width:e.width,height:t.height}),getYAxisSize=(e,t)=>{var n=typeof t.width=="number"?t.width:DEFAULT_Y_AXIS_WIDTH;return{width:n,height:e.height}},selectXAxisSize=createSelector(selectChartOffsetInternal,selectXAxisSettings,getXAxisSize),combineXAxisPositionStartingPoint=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},combineYAxisPositionStartingPoint=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},selectAllXAxesOffsetSteps=createSelector(selectChartHeight,selectChartOffsetInternal,selectAllXAxesWithOffsetType,pickAxisOrientation,pickMirror,(e,t,n,a,i)=>{var s={},o;return n.forEach(c=>{var h=getXAxisSize(t,c);o==null&&(o=combineXAxisPositionStartingPoint(t,a,e));var f=a==="top"&&!i||a==="bottom"&&i;s[c.id]=o-Number(f)*h.height,o+=(f?-1:1)*h.height}),s}),selectAllYAxesOffsetSteps=createSelector(selectChartWidth,selectChartOffsetInternal,selectAllYAxesWithOffsetType,pickAxisOrientation,pickMirror,(e,t,n,a,i)=>{var s={},o;return n.forEach(c=>{var h=getYAxisSize(t,c);o==null&&(o=combineYAxisPositionStartingPoint(t,a,e));var f=a==="left"&&!i||a==="right"&&i;s[c.id]=o-Number(f)*h.width,o+=(f?-1:1)*h.width}),s}),selectXAxisOffsetSteps=(e,t)=>{var n=selectXAxisSettings(e,t);if(n!=null)return selectAllXAxesOffsetSteps(e,n.orientation,n.mirror)},selectXAxisPosition=createSelector([selectChartOffsetInternal,selectXAxisSettings,selectXAxisOffsetSteps,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var i=n?.[a];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),selectYAxisOffsetSteps=(e,t)=>{var n=selectYAxisSettings(e,t);if(n!=null)return selectAllYAxesOffsetSteps(e,n.orientation,n.mirror)},selectYAxisPosition=createSelector([selectChartOffsetInternal,selectYAxisSettings,selectYAxisOffsetSteps,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var i=n?.[a];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),selectYAxisSize=createSelector(selectChartOffsetInternal,selectYAxisSettings,(e,t)=>{var n=typeof t.width=="number"?t.width:DEFAULT_Y_AXIS_WIDTH;return{width:n,height:e.height}}),combineDuplicateDomain=(e,t,n,a)=>{if(n!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=n,c=isCategoricalAxis(e,a),h=t.map(f=>f.value);if(o&&c&&s==="category"&&i&&hasDuplicate(h))return h}},selectDuplicateDomain=createSelector([selectChartLayout,selectAllAppliedValues,selectBaseAxis,pickAxisType],combineDuplicateDomain),combineCategoricalDomain=(e,t,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:i,scale:s}=n,o=isCategoricalAxis(e,a);if(o&&(i==="number"||s!=="auto"))return t.map(c=>c.value)}},selectCategoricalDomain=createSelector([selectChartLayout,selectAllAppliedValues,selectAxisSettings,pickAxisType],combineCategoricalDomain),selectAxisPropsNeededForCartesianGridTicksGenerator=createSelector([selectChartLayout,selectCartesianAxisSettings,selectRealScaleType,selectAxisScale,selectDuplicateDomain,selectCategoricalDomain,selectAxisRange,selectNiceTicks,pickAxisType],(e,t,n,a,i,s,o,c,h)=>{if(t==null)return null;var f=isCategoricalAxis(e,h);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:h,categoricalDomain:s,duplicateDomain:i,isCategorical:f,niceTicks:c,range:o,realScaleType:n,scale:a}}),combineAxisTicks=(e,t,n,a,i,s,o,c,h)=>{if(!(t==null||a==null)){var f=isCategoricalAxis(e,h),{type:u,ticks:p,tickCount:g}=t,v=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,m=u==="category"&&a.bandwidth?a.bandwidth()/v:0;m=h==="angleAxis"&&s!=null&&s.length>=2?mathSign(s[0]-s[1])*2*m:m;var S=p||i;if(S){var E=S.map((w,T)=>{var A=o?o.indexOf(w):w;return{index:T,coordinate:a(A)+m,value:w,offset:m}});return E.filter(w=>!isNan(w.coordinate))}return f&&c?c.map((w,T)=>({coordinate:a(w)+m,value:w,index:T,offset:m})):a.ticks?a.ticks(g).map(w=>({coordinate:a(w)+m,value:w,offset:m})):a.domain().map((w,T)=>({coordinate:a(w)+m,value:o?o[w]:w,index:T,offset:m}))}},selectTicksOfAxis=createSelector([selectChartLayout,selectAxisSettings,selectRealScaleType,selectAxisScale,selectNiceTicks,selectAxisRange,selectDuplicateDomain,selectCategoricalDomain,pickAxisType],combineAxisTicks),combineGraphicalItemTicks=(e,t,n,a,i,s,o)=>{if(!(t==null||n==null||a==null||a[0]===a[1])){var c=isCategoricalAxis(e,o),{tickCount:h}=t,f=0;return f=o==="angleAxis"&&a?.length>=2?mathSign(a[0]-a[1])*2*f:f,c&&s?s.map((u,p)=>({coordinate:n(u)+f,value:u,index:p,offset:f})):n.ticks?n.ticks(h).map(u=>({coordinate:n(u)+f,value:u,offset:f})):n.domain().map((u,p)=>({coordinate:n(u)+f,value:i?i[u]:u,index:p,offset:f}))}},selectTicksOfGraphicalItem=createSelector([selectChartLayout,selectAxisSettings,selectAxisScale,selectAxisRange,selectDuplicateDomain,selectCategoricalDomain,pickAxisType],combineGraphicalItemTicks),selectAxisWithScale=createSelector(selectBaseAxis,selectAxisScale,(e,t)=>{if(!(e==null||t==null))return _objectSpread$f(_objectSpread$f({},e),{},{scale:t})}),selectZAxisScale=createSelector([selectBaseAxis,selectRealScaleType,selectAxisDomain,selectAxisRangeWithReverse],combineScaleFunction);createSelector((e,t,n)=>selectZAxisSettings(e,n),selectZAxisScale,(e,t)=>{if(!(e==null||t==null))return _objectSpread$f(_objectSpread$f({},e),{},{scale:t})});var selectChartDirection=createSelector([selectChartLayout,selectAllXAxes,selectAllYAxes],(e,t,n)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),selectDefaultTooltipEventType=e=>e.options.defaultTooltipEventType,selectValidateTooltipEventTypes=e=>e.options.validateTooltipEventTypes;function combineTooltipEventType(e,t,n){if(e==null)return t;var a=e?"axis":"item";return n==null?t:n.includes(a)?a:t}function selectTooltipEventType$1(e,t){var n=selectDefaultTooltipEventType(e),a=selectValidateTooltipEventTypes(e);return combineTooltipEventType(t,n,a)}function useTooltipEventType(e){return useAppSelector(t=>selectTooltipEventType$1(t,e))}var combineActiveLabel=(e,t)=>{var n,a=Number(t);if(!(isNan(a)||t==null))return a>=0?e==null||(n=e[a])===null||n===void 0?void 0:n.value:void 0},selectTooltipSettings=e=>e.tooltip.settings,noInteraction={active:!1,index:null,dataKey:void 0,coordinate:void 0},initialState$8={itemInteraction:{click:noInteraction,hover:noInteraction},axisInteraction:{click:noInteraction,hover:noInteraction},keyboardInteraction:noInteraction,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},tooltipSlice=createSlice({name:"tooltip",initialState:initialState$8,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:prepareAutoBatched()},removeTooltipEntrySettings:{reducer(e,t){var n=current(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:prepareAutoBatched()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings,removeTooltipEntrySettings,setTooltipSettingsState,setActiveMouseOverItemIndex,mouseLeaveItem,mouseLeaveChart,setActiveClickItemIndex,setMouseOverAxisIndex,setMouseClickAxisIndex,setSyncInteraction,setKeyboardInteraction}=tooltipSlice.actions,tooltipReducer=tooltipSlice.reducer;function ownKeys$e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$e(Object(n),!0).forEach(function(a){_defineProperty$g(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$e(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$g(e,t,n){return(t=_toPropertyKey$g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$g(e){var t=_toPrimitive$g(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$g(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function chooseAppropriateMouseInteraction(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function hasBeenActivePreviously(e){return e.index!=null}var combineTooltipInteractionState=(e,t,n,a)=>{if(t==null)return noInteraction;var i=chooseAppropriateMouseInteraction(e,t,n);if(i==null)return noInteraction;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(hasBeenActivePreviously(i)){if(s)return _objectSpread$e(_objectSpread$e({},i),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return _objectSpread$e(_objectSpread$e({},noInteraction),{},{coordinate:i.coordinate})},combineActiveTooltipIndex=(e,t)=>{var n=e?.index;if(n==null)return null;var a=Number(n);if(!isWellBehavedNumber(a))return n;var i=0,s=1/0;return t.length>0&&(s=t.length-1),String(Math.max(i,Math.min(a,s)))},combineCoordinateForDefaultIndex=(e,t,n,a,i,s,o,c)=>{if(!(s==null||c==null)){var h=o[0],f=h==null?void 0:c(h.positions,s);if(f!=null)return f;var u=i?.[Number(s)];if(u)switch(n){case"horizontal":return{x:u.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:u.coordinate}}}},combineTooltipPayloadConfigurations=(e,t,n,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return n==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.dataKey)===i})},selectTooltipPayloadSearcher=e=>e.options.tooltipPayloadSearcher,selectTooltipState=e=>e.tooltip;function ownKeys$d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$d(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$d(Object(n),!0).forEach(function(a){_defineProperty$f(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$d(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$f(e,t,n){return(t=_toPropertyKey$f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$f(e){var t=_toPrimitive$f(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$f(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function selectFinalData(e,t){return e??t}var combineTooltipPayload=(e,t,n,a,i,s,o)=>{if(!(t==null||s==null)){var{chartData:c,computedData:h,dataStartIndex:f,dataEndIndex:u}=n,p=[];return e.reduce((g,v)=>{var m,{dataDefinedOnItem:S,settings:E}=v,w=selectFinalData(S,c),T=Array.isArray(w)?getSliced(w,f,u):w,A=(m=E?.dataKey)!==null&&m!==void 0?m:a,L=E?.nameKey,k;if(a&&Array.isArray(T)&&!Array.isArray(T[0])&&o==="axis"?k=findEntryInArray(T,a,i):k=s(T,t,h,L),Array.isArray(k))k.forEach(N=>{var Y=_objectSpread$d(_objectSpread$d({},E),{},{name:N.name,unit:N.unit,color:void 0,fill:void 0});g.push(getTooltipEntry({tooltipEntrySettings:Y,dataKey:N.dataKey,payload:N.payload,value:getValueByDataKey(N.payload,N.dataKey),name:N.name}))});else{var D;g.push(getTooltipEntry({tooltipEntrySettings:E,dataKey:A,payload:k,value:getValueByDataKey(k,A),name:(D=getValueByDataKey(k,L))!==null&&D!==void 0?D:E?.name}))}return g},p)}},selectTooltipAxisRealScaleType=createSelector([selectTooltipAxis,selectChartLayout,selectHasBar,selectChartName,selectTooltipAxisType],combineRealScaleType),selectAllUnfilteredGraphicalItems=createSelector([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),selectTooltipAxisPredicate=createSelector([selectTooltipAxisType,selectTooltipAxisId],itemAxisPredicate),selectAllGraphicalItemsSettings=createSelector([selectAllUnfilteredGraphicalItems,selectTooltipAxis,selectTooltipAxisPredicate],combineGraphicalItemsSettings,{memoizeOptions:{resultEqualityCheck:arrayEqualityCheck}}),selectAllStackedGraphicalItemsSettings=createSelector([selectAllGraphicalItemsSettings],e=>e.filter(isStacked)),selectTooltipGraphicalItemsData=createSelector([selectAllGraphicalItemsSettings],combineGraphicalItemsData,{memoizeOptions:{resultEqualityCheck:arrayEqualityCheck}}),selectTooltipDisplayedData=createSelector([selectTooltipGraphicalItemsData,selectChartDataWithIndexes],combineDisplayedData),selectTooltipStackedData=createSelector([selectAllStackedGraphicalItemsSettings,selectChartDataWithIndexes,selectTooltipAxis],combineDisplayedStackedData),selectAllTooltipAppliedValues=createSelector([selectTooltipDisplayedData,selectTooltipAxis,selectAllGraphicalItemsSettings],combineAppliedValues),selectTooltipAxisDomainDefinition=createSelector([selectTooltipAxis],getDomainDefinition),selectTooltipDataOverflow=createSelector([selectTooltipAxis],e=>e.allowDataOverflow),selectTooltipDomainFromUserPreferences=createSelector([selectTooltipAxisDomainDefinition,selectTooltipDataOverflow],numericalDomainSpecifiedWithoutRequiringData),selectAllStackedGraphicalItems=createSelector([selectAllGraphicalItemsSettings],e=>e.filter(isStacked)),selectTooltipStackGroups=createSelector([selectTooltipStackedData,selectAllStackedGraphicalItems,selectStackOffsetType],combineStackGroups),selectTooltipDomainOfStackGroups=createSelector([selectTooltipStackGroups,selectChartDataWithIndexes,selectTooltipAxisType,selectTooltipDomainFromUserPreferences],combineDomainOfStackGroups),selectTooltipItemsSettingsExceptStacked=createSelector([selectAllGraphicalItemsSettings],filterGraphicalNotStackedItems),selectDomainOfAllAppliedNumericalValuesIncludingErrorValues=createSelector([selectTooltipDisplayedData,selectTooltipAxis,selectTooltipItemsSettingsExceptStacked,selectAllErrorBarSettings,selectTooltipAxisType],combineDomainOfAllAppliedNumericalValuesIncludingErrorValues,{memoizeOptions:{resultEqualityCheck:numberDomainEqualityCheck}}),selectReferenceDotsByTooltipAxis=createSelector([selectReferenceDots,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceDotsDomain=createSelector([selectReferenceDotsByTooltipAxis,selectTooltipAxisType],combineDotsDomain),selectReferenceAreasByTooltipAxis=createSelector([selectReferenceAreas,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceAreasDomain=createSelector([selectReferenceAreasByTooltipAxis,selectTooltipAxisType],combineAreasDomain),selectReferenceLinesByTooltipAxis=createSelector([selectReferenceLines,selectTooltipAxisType,selectTooltipAxisId],filterReferenceElements),selectTooltipReferenceLinesDomain=createSelector([selectReferenceLinesByTooltipAxis,selectTooltipAxisType],combineLinesDomain),selectTooltipReferenceElementsDomain=createSelector([selectTooltipReferenceDotsDomain,selectTooltipReferenceLinesDomain,selectTooltipReferenceAreasDomain],mergeDomains),selectTooltipNumericalDomain=createSelector([selectTooltipAxis,selectTooltipAxisDomainDefinition,selectTooltipDomainFromUserPreferences,selectTooltipDomainOfStackGroups,selectDomainOfAllAppliedNumericalValuesIncludingErrorValues,selectTooltipReferenceElementsDomain,selectChartLayout,selectTooltipAxisType],combineNumericalDomain),selectTooltipAxisDomain=createSelector([selectTooltipAxis,selectChartLayout,selectTooltipDisplayedData,selectAllTooltipAppliedValues,selectStackOffsetType,selectTooltipAxisType,selectTooltipNumericalDomain],combineAxisDomain),selectTooltipNiceTicks=createSelector([selectTooltipAxisDomain,selectTooltipAxis,selectTooltipAxisRealScaleType],combineNiceTicks),selectTooltipAxisDomainIncludingNiceTicks=createSelector([selectTooltipAxis,selectTooltipAxisDomain,selectTooltipNiceTicks,selectTooltipAxisType],combineAxisDomainWithNiceTicks),selectTooltipAxisRange=e=>{var t=selectTooltipAxisType(e),n=selectTooltipAxisId(e),a=!1;return selectAxisRange(e,t,n,a)},selectTooltipAxisRangeWithReverse=createSelector([selectTooltipAxis,selectTooltipAxisRange],combineAxisRangeWithReverse),selectTooltipAxisScale=createSelector([selectTooltipAxis,selectTooltipAxisRealScaleType,selectTooltipAxisDomainIncludingNiceTicks,selectTooltipAxisRangeWithReverse],combineScaleFunction),selectTooltipDuplicateDomain=createSelector([selectChartLayout,selectAllTooltipAppliedValues,selectTooltipAxis,selectTooltipAxisType],combineDuplicateDomain),selectTooltipCategoricalDomain=createSelector([selectChartLayout,selectAllTooltipAppliedValues,selectTooltipAxis,selectTooltipAxisType],combineCategoricalDomain),combineTicksOfTooltipAxis=(e,t,n,a,i,s,o,c)=>{if(t){var{type:h}=t,f=isCategoricalAxis(e,c);if(a){var u=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,p=h==="category"&&a.bandwidth?a.bandwidth()/u:0;return p=c==="angleAxis"&&i!=null&&i?.length>=2?mathSign(i[0]-i[1])*2*p:p,f&&o?o.map((g,v)=>({coordinate:a(g)+p,value:g,index:v,offset:p})):a.domain().map((g,v)=>({coordinate:a(g)+p,value:s?s[g]:g,index:v,offset:p}))}}},selectTooltipAxisTicks=createSelector([selectChartLayout,selectTooltipAxis,selectTooltipAxisRealScaleType,selectTooltipAxisScale,selectTooltipAxisRange,selectTooltipDuplicateDomain,selectTooltipCategoricalDomain,selectTooltipAxisType],combineTicksOfTooltipAxis),selectTooltipEventType=createSelector([selectDefaultTooltipEventType,selectValidateTooltipEventTypes,selectTooltipSettings],(e,t,n)=>combineTooltipEventType(n.shared,e,t)),selectTooltipTrigger=e=>e.tooltip.settings.trigger,selectDefaultIndex=e=>e.tooltip.settings.defaultIndex,selectTooltipInteractionState$1=createSelector([selectTooltipState,selectTooltipEventType,selectTooltipTrigger,selectDefaultIndex],combineTooltipInteractionState),selectActiveTooltipIndex=createSelector([selectTooltipInteractionState$1,selectTooltipDisplayedData],combineActiveTooltipIndex),selectActiveLabel$1=createSelector([selectTooltipAxisTicks,selectActiveTooltipIndex],combineActiveLabel),selectActiveTooltipDataKey=createSelector([selectTooltipInteractionState$1],e=>{if(e)return e.dataKey}),selectTooltipPayloadConfigurations$1=createSelector([selectTooltipState,selectTooltipEventType,selectTooltipTrigger,selectDefaultIndex],combineTooltipPayloadConfigurations),selectTooltipCoordinateForDefaultIndex=createSelector([selectChartWidth,selectChartHeight,selectChartLayout,selectChartOffsetInternal,selectTooltipAxisTicks,selectDefaultIndex,selectTooltipPayloadConfigurations$1,selectTooltipPayloadSearcher],combineCoordinateForDefaultIndex),selectActiveTooltipCoordinate=createSelector([selectTooltipInteractionState$1,selectTooltipCoordinateForDefaultIndex],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),selectIsTooltipActive$1=createSelector([selectTooltipInteractionState$1],e=>e.active),selectActiveTooltipPayload=createSelector([selectTooltipPayloadConfigurations$1,selectActiveTooltipIndex,selectChartDataWithIndexes,selectTooltipAxisDataKey,selectActiveLabel$1,selectTooltipPayloadSearcher,selectTooltipEventType],combineTooltipPayload),selectActiveTooltipDataPoints=createSelector([selectActiveTooltipPayload],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function ownKeys$c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$c(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$c(Object(n),!0).forEach(function(a){_defineProperty$e(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$c(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$e(e,t,n){return(t=_toPropertyKey$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$e(e){var t=_toPrimitive$e(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var useTooltipAxis=()=>useAppSelector(selectTooltipAxis),useTooltipAxisBandSize=()=>{var e=useTooltipAxis(),t=useAppSelector(selectTooltipAxisTicks),n=useAppSelector(selectTooltipAxisScale);return getBandSizeOfAxis(_objectSpread$c(_objectSpread$c({},e),{},{scale:n}),t)},useChartName=()=>useAppSelector(selectChartName),pickTooltipEventType=(e,t)=>t,pickTrigger=(e,t,n)=>n,pickDefaultIndex=(e,t,n,a)=>a,selectOrderedTooltipTicks=createSelector(selectTooltipAxisTicks,e=>sortBy(e,t=>t.coordinate)),selectTooltipInteractionState=createSelector([selectTooltipState,pickTooltipEventType,pickTrigger,pickDefaultIndex],combineTooltipInteractionState),selectActiveIndex=createSelector([selectTooltipInteractionState,selectTooltipDisplayedData],combineActiveTooltipIndex),selectTooltipDataKey=(e,t,n)=>{if(t!=null){var a=selectTooltipState(e);return t==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},selectTooltipPayloadConfigurations=createSelector([selectTooltipState,pickTooltipEventType,pickTrigger,pickDefaultIndex],combineTooltipPayloadConfigurations),selectCoordinateForDefaultIndex=createSelector([selectChartWidth,selectChartHeight,selectChartLayout,selectChartOffsetInternal,selectTooltipAxisTicks,pickDefaultIndex,selectTooltipPayloadConfigurations,selectTooltipPayloadSearcher],combineCoordinateForDefaultIndex),selectActiveCoordinate=createSelector([selectTooltipInteractionState,selectCoordinateForDefaultIndex],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),selectActiveLabel=createSelector(selectTooltipAxisTicks,selectActiveIndex,combineActiveLabel),selectTooltipPayload=createSelector([selectTooltipPayloadConfigurations,selectActiveIndex,selectChartDataWithIndexes,selectTooltipAxisDataKey,selectActiveLabel,selectTooltipPayloadSearcher,pickTooltipEventType],combineTooltipPayload),selectIsTooltipActive=createSelector([selectTooltipInteractionState],e=>({isActive:e.active,activeIndex:e.index})),combineActiveProps=(e,t,n,a,i,s,o,c)=>{if(!(!e||!t||!a||!i||!s)){var h=inRange(e.chartX,e.chartY,t,n,c);if(h){var f=calculateTooltipPos(h,t),u=calculateActiveTickIndex(f,o,s,a,i),p=getActiveCoordinate(t,s,u,h);return{activeIndex:String(u),activeCoordinate:p}}}};function _extends$c(){return _extends$c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$c.apply(null,arguments)}function ownKeys$b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$b(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$b(Object(n),!0).forEach(function(a){_defineProperty$d(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$b(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$d(e,t,n){return(t=_toPropertyKey$d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$d(e){var t=_toPrimitive$d(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$d(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CursorInternal(e){var{coordinate:t,payload:n,index:a,offset:i,tooltipAxisBandSize:s,layout:o,cursor:c,tooltipEventType:h,chartName:f}=e,u=t,p=n,g=a;if(!c||!u||f!=="ScatterChart"&&h!=="axis")return null;var v,m;if(f==="ScatterChart")v=u,m=Cross;else if(f==="BarChart")v=getCursorRectangle(o,u,i,s),m=Rectangle;else if(o==="radial"){var{cx:S,cy:E,radius:w,startAngle:T,endAngle:A}=getRadialCursorPoints(u);v={cx:S,cy:E,startAngle:T,endAngle:A,innerRadius:w,outerRadius:w},m=Sector}else v={points:getCursorPoints(o,u,i)},m=Curve;var L=typeof c=="object"&&"className"in c?c.className:void 0,k=_objectSpread$b(_objectSpread$b(_objectSpread$b(_objectSpread$b({stroke:"#ccc",pointerEvents:"none"},i),v),svgPropertiesNoEventsFromUnknown(c)),{},{payload:p,payloadIndex:g,className:clsx("recharts-tooltip-cursor",L)});return reactExports.isValidElement(c)?reactExports.cloneElement(c,k):reactExports.createElement(m,k)}function Cursor(e){var t=useTooltipAxisBandSize(),n=useOffsetInternal(),a=useChartLayout(),i=useChartName();return reactExports.createElement(CursorInternal,_extends$c({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:a,tooltipAxisBandSize:t,chartName:i}))}var TooltipPortalContext=reactExports.createContext(null),useTooltipPortal=()=>reactExports.useContext(TooltipPortalContext),eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function i(h,f,u){this.fn=h,this.context=f,this.once=u||!1}function s(h,f,u,p,g){if(typeof u!="function")throw new TypeError("The listener must be a function");var v=new i(u,p||h,g),m=n?n+f:f;return h._events[m]?h._events[m].fn?h._events[m]=[h._events[m],v]:h._events[m].push(v):(h._events[m]=v,h._eventsCount++),h}function o(h,f){--h._eventsCount===0?h._events=new a:delete h._events[f]}function c(){this._events=new a,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],u,p;if(this._eventsCount===0)return f;for(p in u=this._events)t.call(u,p)&&f.push(n?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(u)):f},c.prototype.listeners=function(f){var u=n?n+f:f,p=this._events[u];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,v=p.length,m=new Array(v);g<v;g++)m[g]=p[g].fn;return m},c.prototype.listenerCount=function(f){var u=n?n+f:f,p=this._events[u];return p?p.fn?1:p.length:0},c.prototype.emit=function(f,u,p,g,v,m){var S=n?n+f:f;if(!this._events[S])return!1;var E=this._events[S],w=arguments.length,T,A;if(E.fn){switch(E.once&&this.removeListener(f,E.fn,void 0,!0),w){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,u),!0;case 3:return E.fn.call(E.context,u,p),!0;case 4:return E.fn.call(E.context,u,p,g),!0;case 5:return E.fn.call(E.context,u,p,g,v),!0;case 6:return E.fn.call(E.context,u,p,g,v,m),!0}for(A=1,T=new Array(w-1);A<w;A++)T[A-1]=arguments[A];E.fn.apply(E.context,T)}else{var L=E.length,k;for(A=0;A<L;A++)switch(E[A].once&&this.removeListener(f,E[A].fn,void 0,!0),w){case 1:E[A].fn.call(E[A].context);break;case 2:E[A].fn.call(E[A].context,u);break;case 3:E[A].fn.call(E[A].context,u,p);break;case 4:E[A].fn.call(E[A].context,u,p,g);break;default:if(!T)for(k=1,T=new Array(w-1);k<w;k++)T[k-1]=arguments[k];E[A].fn.apply(E[A].context,T)}}return!0},c.prototype.on=function(f,u,p){return s(this,f,u,p,!1)},c.prototype.once=function(f,u,p){return s(this,f,u,p,!0)},c.prototype.removeListener=function(f,u,p,g){var v=n?n+f:f;if(!this._events[v])return this;if(!u)return o(this,v),this;var m=this._events[v];if(m.fn)m.fn===u&&(!g||m.once)&&(!p||m.context===p)&&o(this,v);else{for(var S=0,E=[],w=m.length;S<w;S++)(m[S].fn!==u||g&&!m[S].once||p&&m[S].context!==p)&&E.push(m[S]);E.length?this._events[v]=E.length===1?E[0]:E:o(this,v)}return this},c.prototype.removeAllListeners=function(f){var u;return f?(u=n?n+f:f,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,e.exports=c})(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3();const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);var eventCenter=new EventEmitter,TOOLTIP_SYNC_EVENT="recharts.syncEvent.tooltip",BRUSH_SYNC_EVENT="recharts.syncEvent.brush";function arrayTooltipSearcher(e,t){if(t){var n=Number.parseInt(t,10);if(!isNan(n))return e?.[n]}}var initialState$7={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},optionsSlice=createSlice({name:"options",initialState:initialState$7,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),optionsReducer=optionsSlice.reducer,{createEventEmitter}=optionsSlice.actions;function selectSynchronisedTooltipState(e){return e.tooltip.syncInteraction}var initialChartDataState={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},chartDataSlice=createSlice({name:"chartData",initialState:initialChartDataState,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:a}=t.payload;n!=null&&(e.dataStartIndex=n),a!=null&&(e.dataEndIndex=a)}}}),{setChartData,setDataStartEndIndexes,setComputedData}=chartDataSlice.actions,chartDataReducer=chartDataSlice.reducer,_excluded$b=["x","y"];function ownKeys$a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$a(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$a(Object(n),!0).forEach(function(a){_defineProperty$c(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$a(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$c(e,t,n){return(t=_toPropertyKey$c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$c(e){var t=_toPrimitive$c(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$c(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$b(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$b(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$b(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var noop$1=()=>{};function useTooltipSyncEventsListener(){var e=useAppSelector(selectSyncId),t=useAppSelector(selectEventEmitter),n=useAppDispatch(),a=useAppSelector(selectSyncMethod),i=useAppSelector(selectTooltipAxisTicks),s=useChartLayout(),o=useViewBox(),c=useAppSelector(h=>h.rootProps.className);reactExports.useEffect(()=>{if(e==null)return noop$1;var h=(f,u,p)=>{if(t!==p&&e===f){if(a==="index"){var g;if(o&&u!==null&&u!==void 0&&(g=u.payload)!==null&&g!==void 0&&g.coordinate&&u.payload.sourceViewBox){var v=u.payload.coordinate,{x:m,y:S}=v,E=_objectWithoutProperties$b(v,_excluded$b),{x:w,y:T,width:A,height:L}=u.payload.sourceViewBox,k=_objectSpread$a(_objectSpread$a({},E),{},{x:o.x+(A?(m-w)/A:0)*o.width,y:o.y+(L?(S-T)/L:0)*o.height});n(_objectSpread$a(_objectSpread$a({},u),{},{payload:_objectSpread$a(_objectSpread$a({},u.payload),{},{coordinate:k})}))}else n(u);return}if(i!=null){var D;if(typeof a=="function"){var N={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},Y=a(i,N);D=i[Y]}else a==="value"&&(D=i.find(de=>String(de.value)===u.payload.label));var{coordinate:z}=u.payload;if(D==null||u.payload.active===!1||z==null||o==null){n(setSyncInteraction({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:te,y:Z}=z,ne=Math.min(te,o.x+o.width),oe=Math.min(Z,o.y+o.height),le={x:s==="horizontal"?D.coordinate:ne,y:s==="horizontal"?oe:D.coordinate},pe=setSyncInteraction({active:u.payload.active,coordinate:le,dataKey:u.payload.dataKey,index:String(D.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox});n(pe)}}};return eventCenter.on(TOOLTIP_SYNC_EVENT,h),()=>{eventCenter.off(TOOLTIP_SYNC_EVENT,h)}},[c,n,t,e,a,i,s,o])}function useBrushSyncEventsListener(){var e=useAppSelector(selectSyncId),t=useAppSelector(selectEventEmitter),n=useAppDispatch();reactExports.useEffect(()=>{if(e==null)return noop$1;var a=(i,s,o)=>{t!==o&&e===i&&n(setDataStartEndIndexes(s))};return eventCenter.on(BRUSH_SYNC_EVENT,a),()=>{eventCenter.off(BRUSH_SYNC_EVENT,a)}},[n,t,e])}function useSynchronisedEventsFromOtherCharts(){var e=useAppDispatch();reactExports.useEffect(()=>{e(createEventEmitter())},[e]),useTooltipSyncEventsListener(),useBrushSyncEventsListener()}function useTooltipChartSynchronisation(e,t,n,a,i,s){var o=useAppSelector(v=>selectTooltipDataKey(v,e,t)),c=useAppSelector(selectEventEmitter),h=useAppSelector(selectSyncId),f=useAppSelector(selectSyncMethod),u=useAppSelector(selectSynchronisedTooltipState),p=u?.active,g=useViewBox();reactExports.useEffect(()=>{if(!p&&h!=null&&c!=null){var v=setSyncInteraction({active:s,coordinate:n,dataKey:o,index:i,label:typeof a=="number"?String(a):a,sourceViewBox:g});eventCenter.emit(TOOLTIP_SYNC_EVENT,h,v,c)}},[p,n,o,i,a,c,h,f,s,g])}function ownKeys$9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$9(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$9(Object(n),!0).forEach(function(a){_defineProperty$b(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$9(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$b(e,t,n){return(t=_toPropertyKey$b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$b(e){var t=_toPrimitive$b(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$b(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function defaultUniqBy(e){return e.dataKey}function renderContent(e,t){return reactExports.isValidElement(e)?reactExports.cloneElement(e,t):typeof e=="function"?reactExports.createElement(e,t):reactExports.createElement(DefaultTooltipContent,t)}var emptyPayload=[],defaultTooltipProps={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Global.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Tooltip(e){var t=resolveDefaultProps(e,defaultTooltipProps),{active:n,allowEscapeViewBox:a,animationDuration:i,animationEasing:s,content:o,filterNull:c,isAnimationActive:h,offset:f,payloadUniqBy:u,position:p,reverseDirection:g,useTranslate3d:v,wrapperStyle:m,cursor:S,shared:E,trigger:w,defaultIndex:T,portal:A,axisId:L}=t,k=useAppDispatch(),D=typeof T=="number"?String(T):T;reactExports.useEffect(()=>{k(setTooltipSettingsState({shared:E,trigger:w,axisId:L,active:n,defaultIndex:D}))},[k,E,w,L,n,D]);var N=useViewBox(),Y=useAccessibilityLayer(),z=useTooltipEventType(E),{activeIndex:te,isActive:Z}=useAppSelector(j=>selectIsTooltipActive(j,z,w,D)),ne=useAppSelector(j=>selectTooltipPayload(j,z,w,D)),oe=useAppSelector(j=>selectActiveLabel(j,z,w,D)),le=useAppSelector(j=>selectActiveCoordinate(j,z,w,D)),pe=ne,de=useTooltipPortal(),J=n??Z,[V,C]=useElementOffset([pe,J]),O=z==="axis"?oe:void 0;useTooltipChartSynchronisation(z,w,le,O,te,J);var I=A??de;if(I==null)return null;var M=pe??emptyPayload;J||(M=emptyPayload),c&&M.length&&(M=getUniqPayload(pe.filter(j=>j.value!=null&&(j.hide!==!0||t.includeHidden)),u,defaultUniqBy));var H=M.length>0,G=reactExports.createElement(TooltipBoundingBox,{allowEscapeViewBox:a,animationDuration:i,animationEasing:s,isAnimationActive:h,active:J,coordinate:le,hasPayload:H,offset:f,position:p,reverseDirection:g,useTranslate3d:v,viewBox:N,wrapperStyle:m,lastBoundingBox:V,innerRef:C,hasPortalFromProps:!!A},renderContent(o,_objectSpread$9(_objectSpread$9({},t),{},{payload:M,label:O,active:J,coordinate:le,accessibilityLayer:Y})));return reactExports.createElement(reactExports.Fragment,null,reactDomExports.createPortal(G,I),J&&reactExports.createElement(Cursor,{cursor:S,tooltipEventType:z,coordinate:le,payload:pe,index:te}))}function _defineProperty$a(e,t,n){return(t=_toPropertyKey$a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$a(e){var t=_toPrimitive$a(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$a(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class LRUCache{constructor(t){_defineProperty$a(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function ownKeys$8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$8(Object(n),!0).forEach(function(a){_defineProperty$9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$8(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$9(e,t,n){return(t=_toPropertyKey$9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$9(e){var t=_toPrimitive$9(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$9(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var defaultConfig={cacheSize:2e3,enableCache:!0},currentConfig=_objectSpread$8({},defaultConfig),stringCache=new LRUCache(currentConfig.cacheSize),SPAN_STYLE={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MEASUREMENT_SPAN_ID="recharts_measurement_span";function createCacheKey(e,t){var n=t.fontSize||"",a=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(c)}var measureTextWithDOM=(e,t)=>{try{var n=document.getElementById(MEASUREMENT_SPAN_ID);n||(n=document.createElement("span"),n.setAttribute("id",MEASUREMENT_SPAN_ID),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,SPAN_STYLE,t),n.textContent="".concat(e);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},getStringSize=function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Global.isSsr)return{width:0,height:0};if(!currentConfig.enableCache)return measureTextWithDOM(t,n);var a=createCacheKey(t,n),i=stringCache.get(a);if(i)return i;var s=measureTextWithDOM(t,n);return stringCache.set(a,s),s},MULTIPLY_OR_DIVIDE_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ADD_OR_SUBTRACT_REGEX=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CSS_LENGTH_UNIT_REGEX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,NUM_SPLIT_REGEX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,CONVERSION_RATES={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},FIXED_CSS_LENGTH_UNITS=Object.keys(CONVERSION_RATES),STR_NAN="NaN";function convertToPx(e,t){return e*CONVERSION_RATES[t]}class DecimalCSS{static parse(t){var n,[,a,i]=(n=NUM_SPLIT_REGEX.exec(t))!==null&&n!==void 0?n:[];return new DecimalCSS(parseFloat(a),i??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,isNan(t)&&(this.unit=""),n!==""&&!CSS_LENGTH_UNIT_REGEX.test(n)&&(this.num=NaN,this.unit=""),FIXED_CSS_LENGTH_UNITS.includes(n)&&(this.num=convertToPx(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new DecimalCSS(NaN,""):new DecimalCSS(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return isNan(this.num)}}function calculateArithmetic(e){if(e.includes(STR_NAN))return STR_NAN;for(var t=e;t.includes("*")||t.includes("/");){var n,[,a,i,s]=(n=MULTIPLY_OR_DIVIDE_REGEX.exec(t))!==null&&n!==void 0?n:[],o=DecimalCSS.parse(a??""),c=DecimalCSS.parse(s??""),h=i==="*"?o.multiply(c):o.divide(c);if(h.isNaN())return STR_NAN;t=t.replace(MULTIPLY_OR_DIVIDE_REGEX,h.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,u,p,g]=(f=ADD_OR_SUBTRACT_REGEX.exec(t))!==null&&f!==void 0?f:[],v=DecimalCSS.parse(u??""),m=DecimalCSS.parse(g??""),S=p==="+"?v.add(m):v.subtract(m);if(S.isNaN())return STR_NAN;t=t.replace(ADD_OR_SUBTRACT_REGEX,S.toString())}return t}var PARENTHESES_REGEX=/\(([^()]*)\)/;function calculateParentheses(e){for(var t=e,n;(n=PARENTHESES_REGEX.exec(t))!=null;){var[,a]=n;t=t.replace(PARENTHESES_REGEX,calculateArithmetic(a))}return t}function evaluateExpression(e){var t=e.replace(/\s+/g,"");return t=calculateParentheses(t),t=calculateArithmetic(t),t}function safeEvaluateExpression(e){try{return evaluateExpression(e)}catch{return STR_NAN}}function reduceCSSCalc(e){var t=safeEvaluateExpression(e.slice(5,-1));return t===STR_NAN?"":t}var _excluded$a=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],_excluded2$6=["dx","dy","angle","className","breakAll"];function _extends$b(){return _extends$b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$b.apply(null,arguments)}function _objectWithoutProperties$a(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$a(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$a(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var BREAKING_SPACES=/[ \f\n\r\t\v\u2028\u2029]+/,calculateWordWidths=e=>{var{children:t,breakAll:n,style:a}=e;try{var i=[];isNullish(t)||(n?i=t.toString().split(""):i=t.toString().split(BREAKING_SPACES));var s=i.map(c=>({word:c,width:getStringSize(c,a).width})),o=n?0:getStringSize("",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},calculateWordsByLines=(e,t,n,a,i)=>{var{maxLines:s,children:o,style:c,breakAll:h}=e,f=isNumber(s),u=o,p=function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Z.reduce((ne,oe)=>{var{word:le,width:pe}=oe,de=ne[ne.length-1];if(de&&(a==null||i||de.width+pe+n<Number(a)))de.words.push(le),de.width+=pe+n;else{var J={words:[le],width:pe};ne.push(J)}return ne},[])},g=p(t),v=te=>te.reduce((Z,ne)=>Z.width>ne.width?Z:ne);if(!f||i)return g;var m=g.length>s||v(g).width>Number(a);if(!m)return g;for(var S="",E=te=>{var Z=u.slice(0,te),ne=calculateWordWidths({breakAll:h,style:c,children:Z+S}).wordsWithComputedWidth,oe=p(ne),le=oe.length>s||v(oe).width>Number(a);return[le,oe]},w=0,T=u.length-1,A=0,L;w<=T&&A<=u.length-1;){var k=Math.floor((w+T)/2),D=k-1,[N,Y]=E(D),[z]=E(k);if(!N&&!z&&(w=k+1),N&&z&&(T=k-1),!N&&z){L=Y;break}A++}return L||g},getWordsWithoutCalculate=e=>{var t=isNullish(e)?[]:e.toString().split(BREAKING_SPACES);return[{words:t}]},getWordsByLines=e=>{var{width:t,scaleToFit:n,children:a,style:i,breakAll:s,maxLines:o}=e;if((t||n)&&!Global.isSsr){var c,h,f=calculateWordWidths({breakAll:s,children:a,style:i});if(f){var{wordsWithComputedWidth:u,spaceWidth:p}=f;c=u,h=p}else return getWordsWithoutCalculate(a);return calculateWordsByLines({breakAll:s,children:a,maxLines:o,style:i},c,h,t,n)}return getWordsWithoutCalculate(a)},DEFAULT_FILL="#808080",Text=reactExports.forwardRef((e,t)=>{var{x:n=0,y:a=0,lineHeight:i="1em",capHeight:s="0.71em",scaleToFit:o=!1,textAnchor:c="start",verticalAnchor:h="end",fill:f=DEFAULT_FILL}=e,u=_objectWithoutProperties$a(e,_excluded$a),p=reactExports.useMemo(()=>getWordsByLines({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:g,dy:v,angle:m,className:S,breakAll:E}=u,w=_objectWithoutProperties$a(u,_excluded2$6);if(!isNumOrStr(n)||!isNumOrStr(a)||p.length===0)return null;var T=n+(isNumber(g)?g:0),A=a+(isNumber(v)?v:0),L;switch(h){case"start":L=reduceCSSCalc("calc(".concat(s,")"));break;case"middle":L=reduceCSSCalc("calc(".concat((p.length-1)/2," * -").concat(i," + (").concat(s," / 2))"));break;default:L=reduceCSSCalc("calc(".concat(p.length-1," * -").concat(i,")"));break}var k=[];if(o){var D=p[0].width,{width:N}=u;k.push("scale(".concat(isNumber(N)?N/D:1,")"))}return m&&k.push("rotate(".concat(m,", ").concat(T,", ").concat(A,")")),k.length&&(w.transform=k.join(" ")),reactExports.createElement("text",_extends$b({},svgPropertiesAndEvents(w),{ref:t,x:T,y:A,className:clsx("recharts-text",S),textAnchor:c,fill:f.includes("url")?DEFAULT_FILL:f}),p.map((Y,z)=>{var te=Y.words.join(E?"":" ");return reactExports.createElement("tspan",{x:T,dy:z===0?L:i,key:"".concat(te,"-").concat(z)},te)}))});Text.displayName="Text";var _excluded$9=["labelRef"];function _objectWithoutProperties$9(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$9(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$9(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function ownKeys$7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$7(Object(n),!0).forEach(function(a){_defineProperty$8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$7(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$8(e,t,n){return(t=_toPropertyKey$8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$8(e){var t=_toPrimitive$8(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _extends$a(){return _extends$a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$a.apply(null,arguments)}var CartesianLabelContext=reactExports.createContext(null),CartesianLabelContextProvider=e=>{var{x:t,y:n,width:a,height:i,children:s}=e,o=reactExports.useMemo(()=>({x:t,y:n,width:a,height:i}),[t,n,a,i]);return reactExports.createElement(CartesianLabelContext.Provider,{value:o},s)},useCartesianLabelContext=()=>{var e=reactExports.useContext(CartesianLabelContext),t=useViewBox();return e||t},PolarLabelContext=reactExports.createContext(null),usePolarLabelContext=()=>{var e=reactExports.useContext(PolarLabelContext),t=useAppSelector(selectPolarViewBox);return e||t},getLabel=e=>{var{value:t,formatter:n}=e,a=isNullish(e.children)?t:e.children;return typeof n=="function"?n(a):a},isLabelContentAFunction=e=>e!=null&&typeof e=="function",getDeltaAngle=(e,t)=>{var n=mathSign(t-e),a=Math.min(Math.abs(t-e),360);return n*a},renderRadialLabel=(e,t,n,a,i)=>{var{offset:s,className:o}=e,{cx:c,cy:h,innerRadius:f,outerRadius:u,startAngle:p,endAngle:g,clockWise:v}=i,m=(f+u)/2,S=getDeltaAngle(p,g),E=S>=0?1:-1,w,T;switch(t){case"insideStart":w=p+E*s,T=v;break;case"insideEnd":w=g-E*s,T=!v;break;case"end":w=g+E*s,T=v;break;default:throw new Error("Unsupported position ".concat(t))}T=S<=0?T:!T;var A=polarToCartesian(c,h,m,w),L=polarToCartesian(c,h,m,w+(T?1:-1)*359),k="M".concat(A.x,",").concat(A.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(T?0:1,`,
    `).concat(L.x,",").concat(L.y),D=isNullish(e.id)?uniqueId("recharts-radial-line-"):e.id;return reactExports.createElement("text",_extends$a({},a,{dominantBaseline:"central",className:clsx("recharts-radial-bar-label",o)}),reactExports.createElement("defs",null,reactExports.createElement("path",{id:D,d:k})),reactExports.createElement("textPath",{xlinkHref:"#".concat(D)},n))},getAttrsOfPolarLabel=(e,t,n)=>{var{cx:a,cy:i,innerRadius:s,outerRadius:o,startAngle:c,endAngle:h}=e,f=(c+h)/2;if(n==="outside"){var{x:u,y:p}=polarToCartesian(a,i,o+t,f);return{x:u,y:p,textAnchor:u>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var g=(s+o)/2,{x:v,y:m}=polarToCartesian(a,i,g,f);return{x:v,y:m,textAnchor:"middle",verticalAnchor:"middle"}},isPolar=e=>"cx"in e&&isNumber(e.cx),getAttrsOfCartesianLabel=(e,t)=>{var{parentViewBox:n,offset:a,position:i}=e,s;n!=null&&!isPolar(n)&&(s=n);var{x:o,y:c,width:h,height:f}=t,u=f>=0?1:-1,p=u*a,g=u>0?"end":"start",v=u>0?"start":"end",m=h>=0?1:-1,S=m*a,E=m>0?"end":"start",w=m>0?"start":"end";if(i==="top"){var T={x:o+h/2,y:c-u*a,textAnchor:"middle",verticalAnchor:g};return _objectSpread$7(_objectSpread$7({},T),s?{height:Math.max(c-s.y,0),width:h}:{})}if(i==="bottom"){var A={x:o+h/2,y:c+f+p,textAnchor:"middle",verticalAnchor:v};return _objectSpread$7(_objectSpread$7({},A),s?{height:Math.max(s.y+s.height-(c+f),0),width:h}:{})}if(i==="left"){var L={x:o-S,y:c+f/2,textAnchor:E,verticalAnchor:"middle"};return _objectSpread$7(_objectSpread$7({},L),s?{width:Math.max(L.x-s.x,0),height:f}:{})}if(i==="right"){var k={x:o+h+S,y:c+f/2,textAnchor:w,verticalAnchor:"middle"};return _objectSpread$7(_objectSpread$7({},k),s?{width:Math.max(s.x+s.width-k.x,0),height:f}:{})}var D=s?{width:h,height:f}:{};return i==="insideLeft"?_objectSpread$7({x:o+S,y:c+f/2,textAnchor:w,verticalAnchor:"middle"},D):i==="insideRight"?_objectSpread$7({x:o+h-S,y:c+f/2,textAnchor:E,verticalAnchor:"middle"},D):i==="insideTop"?_objectSpread$7({x:o+h/2,y:c+p,textAnchor:"middle",verticalAnchor:v},D):i==="insideBottom"?_objectSpread$7({x:o+h/2,y:c+f-p,textAnchor:"middle",verticalAnchor:g},D):i==="insideTopLeft"?_objectSpread$7({x:o+S,y:c+p,textAnchor:w,verticalAnchor:v},D):i==="insideTopRight"?_objectSpread$7({x:o+h-S,y:c+p,textAnchor:E,verticalAnchor:v},D):i==="insideBottomLeft"?_objectSpread$7({x:o+S,y:c+f-p,textAnchor:w,verticalAnchor:g},D):i==="insideBottomRight"?_objectSpread$7({x:o+h-S,y:c+f-p,textAnchor:E,verticalAnchor:g},D):i&&typeof i=="object"&&(isNumber(i.x)||isPercent(i.x))&&(isNumber(i.y)||isPercent(i.y))?_objectSpread$7({x:o+getPercentValue(i.x,h),y:c+getPercentValue(i.y,f),textAnchor:"end",verticalAnchor:"end"},D):_objectSpread$7({x:o+h/2,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},D)},defaultLabelProps={offset:5};function Label(e){var t=resolveDefaultProps(e,defaultLabelProps),{viewBox:n,position:a,value:i,children:s,content:o,className:c="",textBreakAll:h,labelRef:f}=t,u=usePolarLabelContext(),p=useCartesianLabelContext(),g=a==="center"?p:u??p,v=n||g;if(!v||isNullish(i)&&isNullish(s)&&!reactExports.isValidElement(o)&&typeof o!="function")return null;var m=_objectSpread$7(_objectSpread$7({},t),{},{viewBox:v});if(reactExports.isValidElement(o)){var{labelRef:S}=m,E=_objectWithoutProperties$9(m,_excluded$9);return reactExports.cloneElement(o,E)}var w;if(typeof o=="function"){if(w=reactExports.createElement(o,m),reactExports.isValidElement(w))return w}else w=getLabel(t);var T=isPolar(v),A=svgPropertiesAndEvents(t);if(T&&(a==="insideStart"||a==="insideEnd"||a==="end"))return renderRadialLabel(t,a,w,A,v);var L=T?getAttrsOfPolarLabel(v,t.offset,t.position):getAttrsOfCartesianLabel(t,v);return reactExports.createElement(Text,_extends$a({ref:f,className:clsx("recharts-label",c)},A,L,{breakAll:h}),w)}Label.displayName="Label";var parseLabel=(e,t,n)=>{if(!e)return null;var a={viewBox:t,labelRef:n};return e===!0?reactExports.createElement(Label,_extends$a({key:"label-implicit"},a)):isNumOrStr(e)?reactExports.createElement(Label,_extends$a({key:"label-implicit",value:e},a)):reactExports.isValidElement(e)?e.type===Label?reactExports.cloneElement(e,_objectSpread$7({key:"label-implicit"},a)):reactExports.createElement(Label,_extends$a({key:"label-implicit",content:e},a)):isLabelContentAFunction(e)?reactExports.createElement(Label,_extends$a({key:"label-implicit",content:e},a)):e&&typeof e=="object"?reactExports.createElement(Label,_extends$a({},e,{key:"label-implicit"},a)):null};function CartesianLabelFromLabelProp(e){var{label:t,labelRef:n}=e,a=useCartesianLabelContext();return parseLabel(t,a,n)||null}var last$3={},last$2={},hasRequiredLast$2;function requireLast$2(){return hasRequiredLast$2||(hasRequiredLast$2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(last$2)),last$2}var toArray={},hasRequiredToArray;function requireToArray(){return hasRequiredToArray||(hasRequiredToArray=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(toArray)),toArray}var hasRequiredLast$1;function requireLast$1(){return hasRequiredLast$1||(hasRequiredLast$1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=requireLast$2(),n=requireToArray(),a=requireIsArrayLike();function i(s){if(a.isArrayLike(s))return t.last(n.toArray(s))}e.last=i})(last$3)),last$3}var last$1,hasRequiredLast;function requireLast(){return hasRequiredLast||(hasRequiredLast=1,last$1=requireLast$1().last),last$1}var lastExports=requireLast();const last=getDefaultExportFromCjs(lastExports);var _excluded$8=["valueAccessor"],_excluded2$5=["dataKey","clockWise","id","textBreakAll"];function _extends$9(){return _extends$9=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$9.apply(null,arguments)}function _objectWithoutProperties$8(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$8(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var defaultAccessor=e=>Array.isArray(e.value)?last(e.value):e.value,CartesianLabelListContext=reactExports.createContext(void 0),CartesianLabelListContextProvider=CartesianLabelListContext.Provider,PolarLabelListContext=reactExports.createContext(void 0);PolarLabelListContext.Provider;function useCartesianLabelListContext(){return reactExports.useContext(CartesianLabelListContext)}function usePolarLabelListContext(){return reactExports.useContext(PolarLabelListContext)}function LabelList(e){var{valueAccessor:t=defaultAccessor}=e,n=_objectWithoutProperties$8(e,_excluded$8),{dataKey:a,clockWise:i,id:s,textBreakAll:o}=n,c=_objectWithoutProperties$8(n,_excluded2$5),h=useCartesianLabelListContext(),f=usePolarLabelListContext(),u=h||f;return!u||!u.length?null:reactExports.createElement(Layer,{className:"recharts-label-list"},u.map((p,g)=>{var v,m=isNullish(a)?t(p,g):getValueByDataKey(p&&p.payload,a),S=isNullish(s)?{}:{id:"".concat(s,"-").concat(g)};return reactExports.createElement(Label,_extends$9({key:"label-".concat(g)},svgPropertiesAndEvents(p),c,S,{fill:(v=n.fill)!==null&&v!==void 0?v:p.fill,parentViewBox:p.parentViewBox,value:m,textBreakAll:o,viewBox:p.viewBox,index:g}))}))}LabelList.displayName="LabelList";function LabelListFromLabelProp(e){var{label:t}=e;return t?t===!0?reactExports.createElement(LabelList,{key:"labelList-implicit"}):reactExports.isValidElement(t)||isLabelContentAFunction(t)?reactExports.createElement(LabelList,{key:"labelList-implicit",content:t}):typeof t=="object"?reactExports.createElement(LabelList,_extends$9({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function _extends$8(){return _extends$8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$8.apply(null,arguments)}var Dot=e=>{var{cx:t,cy:n,r:a,className:i}=e,s=clsx("recharts-dot",i);return t===+t&&n===+n&&a===+a?reactExports.createElement("circle",_extends$8({},svgPropertiesNoEvents(e),adaptEventHandlers(e),{className:s,cx:t,cy:n,r:a})):null},initialState$6={radiusAxis:{},angleAxis:{}},polarAxisSlice=createSlice({name:"polarAxis",initialState:initialState$6,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis,removeRadiusAxis,addAngleAxis,removeAngleAxis}=polarAxisSlice.actions,polarAxisReducer=polarAxisSlice.reducer,isClipDot=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0;function SetTooltipEntrySettings(e){var{fn:t,args:n}=e,a=useAppDispatch(),i=useIsPanorama();return reactExports.useLayoutEffect(()=>{if(!i){var s=t(n);return a(addTooltipEntrySettings(s)),()=>{a(removeTooltipEntrySettings(s))}}},[t,n,a,i]),null}var noop=()=>{};function SetLegendPayload(e){var{legendPayload:t}=e,n=useAppDispatch(),a=useIsPanorama();return reactExports.useLayoutEffect(()=>a?noop:(n(addLegendPayload(t)),()=>{n(removeLegendPayload(t))}),[n,a,t]),null}var _ref,useIdFallback=()=>{var[e]=reactExports.useState(()=>uniqueId("uid-"));return e},useId=(_ref=React$1.useId)!==null&&_ref!==void 0?_ref:useIdFallback;function useUniqueId(e,t){var n=useId();return t||(e?"".concat(e,"-").concat(n):n)}var GraphicalItemIdContext=reactExports.createContext(void 0),RegisterGraphicalItemId=e=>{var{id:t,type:n,children:a}=e,i=useUniqueId("recharts-".concat(n),t);return reactExports.createElement(GraphicalItemIdContext.Provider,{value:i},a(i))},initialState$5={cartesianItems:[],polarItems:[]},graphicalItemsSlice=createSlice({name:"graphicalItems",initialState:initialState$5,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:prepareAutoBatched()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:a}=t.payload,i=current(e).cartesianItems.indexOf(n);i>-1&&(e.cartesianItems[i]=a)},prepare:prepareAutoBatched()},removeCartesianGraphicalItem:{reducer(e,t){var n=current(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:prepareAutoBatched()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:prepareAutoBatched()},removePolarGraphicalItem:{reducer(e,t){var n=current(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:prepareAutoBatched()}}}),{addCartesianGraphicalItem,replaceCartesianGraphicalItem,removeCartesianGraphicalItem,addPolarGraphicalItem,removePolarGraphicalItem}=graphicalItemsSlice.actions,graphicalItemsReducer=graphicalItemsSlice.reducer;function SetCartesianGraphicalItem(e){var t=useAppDispatch(),n=reactExports.useRef(null);return reactExports.useLayoutEffect(()=>{n.current===null?t(addCartesianGraphicalItem(e)):n.current!==e&&t(replaceCartesianGraphicalItem({prev:n.current,next:e})),n.current=e},[t,e]),reactExports.useLayoutEffect(()=>()=>{n.current&&(t(removeCartesianGraphicalItem(n.current)),n.current=null)},[t]),null}function ownKeys$6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$6(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$6(Object(n),!0).forEach(function(a){_defineProperty$7(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$6(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$7(e,t,n){return(t=_toPropertyKey$7(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$7(e){var t=_toPrimitive$7(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$7(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var initialState$4={xAxis:{},yAxis:{},zAxis:{}},cartesianAxisSlice=createSlice({name:"cartesianAxis",initialState:initialState$4,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:prepareAutoBatched()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:prepareAutoBatched()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:prepareAutoBatched()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:prepareAutoBatched()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:prepareAutoBatched()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:prepareAutoBatched()},updateYAxisWidth(e,t){var{id:n,width:a}=t.payload,i=e.yAxis[n];if(i){var s=i.widthHistory||[];if(s.length===3&&s[0]===s[2]&&a===s[1]&&a!==i.width&&Math.abs(a-s[0])<=1)return;var o=[...s,a].slice(-3);e.yAxis[n]=_objectSpread$6(_objectSpread$6({},e.yAxis[n]),{},{width:a,widthHistory:o})}}}}),{addXAxis,removeXAxis,addYAxis,removeYAxis,addZAxis,removeZAxis,updateYAxisWidth}=cartesianAxisSlice.actions,cartesianAxisReducer=cartesianAxisSlice.reducer,selectChartOffset=createSelector([selectChartOffsetInternal],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),selectPlotArea=createSelector([selectChartOffset,selectChartWidth,selectChartHeight],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),usePlotArea=()=>useAppSelector(selectPlotArea),useActiveTooltipDataPoints=()=>useAppSelector(selectActiveTooltipDataPoints);function ownKeys$5(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$5(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$5(Object(n),!0).forEach(function(a){_defineProperty$6(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$5(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$6(e,t,n){return(t=_toPropertyKey$6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$6(e){var t=_toPrimitive$6(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$6(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var renderActivePoint=e=>{var{point:t,childIndex:n,mainColor:a,activeDot:i,dataKey:s}=e;if(i===!1||t.x==null||t.y==null)return null;var o=_objectSpread$5(_objectSpread$5({index:n,dataKey:s,cx:t.x,cy:t.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},svgPropertiesNoEventsFromUnknown(i)),adaptEventHandlers(i)),c;return reactExports.isValidElement(i)?c=reactExports.cloneElement(i,o):typeof i=="function"?c=i(o):c=reactExports.createElement(Dot,o),reactExports.createElement(Layer,{className:"recharts-active-dot"},c)};function ActivePoints(e){var{points:t,mainColor:n,activeDot:a,itemDataKey:i}=e,s=useAppSelector(selectActiveTooltipIndex),o=useActiveTooltipDataPoints();if(t==null||o==null)return null;var c=t.find(h=>o.includes(h.payload));return isNullish(c)?null:renderActivePoint({point:c,childIndex:Number(s),mainColor:n,dataKey:i,activeDot:a})}var initialState$3={},errorBarSlice=createSlice({name:"errorBars",initialState:initialState$3,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]||(e[n]=[]),e[n].push(a)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:a,next:i}=t.payload;e[n]&&(e[n]=e[n].map(s=>s.dataKey===a.dataKey&&s.direction===a.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]&&(e[n]=e[n].filter(i=>i.dataKey!==a.dataKey||i.direction!==a.direction))}}}),{addErrorBar,replaceErrorBar,removeErrorBar}=errorBarSlice.actions,errorBarReducer=errorBarSlice.reducer,_excluded$7=["children"];function _objectWithoutProperties$7(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$7(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$7(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var initialContextState={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},ErrorBarContext=reactExports.createContext(initialContextState);function SetErrorBarContext(e){var{children:t}=e,n=_objectWithoutProperties$7(e,_excluded$7);return reactExports.createElement(ErrorBarContext.Provider,{value:n},t)}function useNeedsClip(e,t){var n,a,i=useAppSelector(f=>selectXAxisSettings(f,e)),s=useAppSelector(f=>selectYAxisSettings(f,t)),o=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:implicitXAxis.allowDataOverflow,c=(a=s?.allowDataOverflow)!==null&&a!==void 0?a:implicitYAxis.allowDataOverflow,h=o||c;return{needClip:h,needClipX:o,needClipY:c}}function GraphicalItemClipPath(e){var{xAxisId:t,yAxisId:n,clipPathId:a}=e,i=usePlotArea(),{needClipX:s,needClipY:o,needClip:c}=useNeedsClip(t,n);if(!c)return null;var{x:h,y:f,width:u,height:p}=i;return reactExports.createElement("clipPath",{id:"clipPath-".concat(a)},reactExports.createElement("rect",{x:s?h:h-u/2,y:o?f:f-p/2,width:s?u:u*2,height:o?p:p*2}))}var ChartDataContextProvider=e=>{var{chartData:t}=e,n=useAppDispatch(),a=useIsPanorama();return reactExports.useEffect(()=>a?()=>{}:(n(setChartData(t)),()=>{n(setChartData(void 0))}),[t,n,a]),null},initialState$2={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},brushSlice=createSlice({name:"brush",initialState:initialState$2,reducers:{setBrushSettings(e,t){return t.payload==null?initialState$2:t.payload}}}),{setBrushSettings}=brushSlice.actions,brushReducer=brushSlice.reducer;function _defineProperty$5(e,t,n){return(t=_toPropertyKey$5(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$5(e){var t=_toPrimitive$5(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$5(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class ScaleHelper{static create(t){return new ScaleHelper(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?t>=a&&t<=i:t>=i&&t<=a}}_defineProperty$5(ScaleHelper,"EPS",1e-4);function normalizeAngle(e){return(e%180+180)%180}var getAngledRectangleWidth=function e(t){var{width:n,height:a}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=normalizeAngle(i),o=s*Math.PI/180,c=Math.atan(a/n),h=o>c&&o<Math.PI-c?a/Math.sin(o):n/Math.cos(o);return Math.abs(h)},initialState$1={dots:[],areas:[],lines:[]},referenceElementsSlice=createSlice({name:"referenceElements",initialState:initialState$1,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=current(e).dots.findIndex(a=>a===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=current(e).areas.findIndex(a=>a===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=current(e).lines.findIndex(a=>a===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot,removeDot,addArea,removeArea,addLine,removeLine}=referenceElementsSlice.actions,referenceElementsReducer=referenceElementsSlice.reducer,ClipPathIdContext=reactExports.createContext(void 0),ClipPathProvider=e=>{var{children:t}=e,[n]=reactExports.useState("".concat(uniqueId("recharts"),"-clip")),a=usePlotArea();if(a==null)return null;var{x:i,y:s,width:o,height:c}=a;return reactExports.createElement(ClipPathIdContext.Provider,{value:n},reactExports.createElement("defs",null,reactExports.createElement("clipPath",{id:n},reactExports.createElement("rect",{x:i,y:s,height:c,width:o}))),t)};function shallowEqual(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function getEveryNthWithCondition(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var a=[],i=0;i<e.length;i+=t)a.push(e[i]);return a}function getAngledTickWidth(e,t,n){var a={width:e.width+t.width,height:e.height+t.height};return getAngledRectangleWidth(a,n)}function getTickBoundaries(e,t,n){var a=n==="width",{x:i,y:s,width:o,height:c}=e;return t===1?{start:a?i:s,end:a?i+o:s+c}:{start:a?i+o:s+c,end:a?i:s}}function isVisible(e,t,n,a,i){if(e*t<e*a||e*t>e*i)return!1;var s=n();return e*(t-e*s/2-a)>=0&&e*(t+e*s/2-i)<=0}function getNumberIntervalTicks(e,t){return getEveryNthWithCondition(e,t+1)}function getEquidistantTicks(e,t,n,a,i){for(var s=(a||[]).slice(),{start:o,end:c}=t,h=0,f=1,u=o,p=function(){var m=a?.[h];if(m===void 0)return{v:getEveryNthWithCondition(a,f)};var S=h,E,w=()=>(E===void 0&&(E=n(m,S)),E),T=m.coordinate,A=h===0||isVisible(e,T,w,u,c);A||(h=0,u=o,f+=1),A&&(u=T+e*(w()/2+i),h+=f)},g;f<=s.length;)if(g=p(),g)return g.v;return[]}function ownKeys$4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$4(Object(n),!0).forEach(function(a){_defineProperty$4(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$4(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$4(e,t,n){return(t=_toPropertyKey$4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$4(e){var t=_toPrimitive$4(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$4(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function getTicksEnd(e,t,n,a,i){for(var s=(a||[]).slice(),o=s.length,{start:c}=t,{end:h}=t,f=function(g){var v=s[g],m,S=()=>(m===void 0&&(m=n(v,g)),m);if(g===o-1){var E=e*(v.coordinate+e*S()/2-h);s[g]=v=_objectSpread$4(_objectSpread$4({},v),{},{tickCoord:E>0?v.coordinate-E*e:v.coordinate})}else s[g]=v=_objectSpread$4(_objectSpread$4({},v),{},{tickCoord:v.coordinate});var w=isVisible(e,v.tickCoord,S,c,h);w&&(h=v.tickCoord-e*(S()/2+i),s[g]=_objectSpread$4(_objectSpread$4({},v),{},{isShow:!0}))},u=o-1;u>=0;u--)f(u);return s}function getTicksStart(e,t,n,a,i,s){var o=(a||[]).slice(),c=o.length,{start:h,end:f}=t;if(s){var u=a[c-1],p=n(u,c-1),g=e*(u.coordinate+e*p/2-f);o[c-1]=u=_objectSpread$4(_objectSpread$4({},u),{},{tickCoord:g>0?u.coordinate-g*e:u.coordinate});var v=isVisible(e,u.tickCoord,()=>p,h,f);v&&(f=u.tickCoord-e*(p/2+i),o[c-1]=_objectSpread$4(_objectSpread$4({},u),{},{isShow:!0}))}for(var m=s?c-1:c,S=function(T){var A=o[T],L,k=()=>(L===void 0&&(L=n(A,T)),L);if(T===0){var D=e*(A.coordinate-e*k()/2-h);o[T]=A=_objectSpread$4(_objectSpread$4({},A),{},{tickCoord:D<0?A.coordinate-D*e:A.coordinate})}else o[T]=A=_objectSpread$4(_objectSpread$4({},A),{},{tickCoord:A.coordinate});var N=isVisible(e,A.tickCoord,k,h,f);N&&(h=A.tickCoord+e*(k()/2+i),o[T]=_objectSpread$4(_objectSpread$4({},A),{},{isShow:!0}))},E=0;E<m;E++)S(E);return o}function getTicks(e,t,n){var{tick:a,ticks:i,viewBox:s,minTickGap:o,orientation:c,interval:h,tickFormatter:f,unit:u,angle:p}=e;if(!i||!i.length||!a)return[];if(isNumber(h)||Global.isSsr){var g;return(g=getNumberIntervalTicks(i,isNumber(h)?h:0))!==null&&g!==void 0?g:[]}var v=[],m=c==="top"||c==="bottom"?"width":"height",S=u&&m==="width"?getStringSize(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},E=(A,L)=>{var k=typeof f=="function"?f(A.value,L):A.value;return m==="width"?getAngledTickWidth(getStringSize(k,{fontSize:t,letterSpacing:n}),S,p):getStringSize(k,{fontSize:t,letterSpacing:n})[m]},w=i.length>=2?mathSign(i[1].coordinate-i[0].coordinate):1,T=getTickBoundaries(s,w,m);return h==="equidistantPreserveStart"?getEquidistantTicks(w,T,E,i,o):(h==="preserveStart"||h==="preserveStartEnd"?v=getTicksStart(w,T,E,i,o,h==="preserveStartEnd"):v=getTicksEnd(w,T,E,i,o),v.filter(A=>A.isShow))}var getCalculatedYAxisWidth=e=>{var{ticks:t,label:n,labelGapWithTick:a=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(u=>{if(u){var p=u.getBoundingClientRect();p.width>o&&(o=p.width)}});var c=n?n.getBoundingClientRect().width:0,h=i+s,f=o+h+c+(n?a:0);return Math.round(f)}return 0},_excluded$6=["axisLine","width","height","className","hide","ticks"],_excluded2$4=["viewBox"],_excluded3$4=["viewBox"];function _objectWithoutProperties$6(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$6(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function _extends$7(){return _extends$7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$7.apply(null,arguments)}function ownKeys$3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$3(Object(n),!0).forEach(function(a){_defineProperty$3(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$3(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$3(e,t,n){return(t=_toPropertyKey$3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$3(e){var t=_toPrimitive$3(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$3(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var defaultCartesianAxisProps={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function AxisLine(e){var{x:t,y:n,width:a,height:i,orientation:s,mirror:o,axisLine:c,otherSvgProps:h}=e;if(!c)return null;var f=_objectSpread$3(_objectSpread$3(_objectSpread$3({},h),svgPropertiesNoEvents(c)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);f=_objectSpread$3(_objectSpread$3({},f),{},{x1:t,y1:n+u*i,x2:t+a,y2:n+u*i})}else{var p=+(s==="left"&&!o||s==="right"&&o);f=_objectSpread$3(_objectSpread$3({},f),{},{x1:t+p*a,y1:n,x2:t+p*a,y2:n+i})}return reactExports.createElement("line",_extends$7({},f,{className:clsx("recharts-cartesian-axis-line",get(c,"className"))}))}function getTickLineCoord(e,t,n,a,i,s,o,c,h){var f,u,p,g,v,m,S=c?-1:1,E=e.tickSize||o,w=isNumber(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":f=u=e.coordinate,g=n+ +!c*i,p=g-S*E,m=p-S*h,v=w;break;case"left":p=g=e.coordinate,u=t+ +!c*a,f=u-S*E,v=f-S*h,m=w;break;case"right":p=g=e.coordinate,u=t+ +c*a,f=u+S*E,v=f+S*h,m=w;break;default:f=u=e.coordinate,g=n+ +c*i,p=g+S*E,m=p+S*h,v=w;break}return{line:{x1:f,y1:p,x2:u,y2:g},tick:{x:v,y:m}}}function getTickTextAnchor(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function getTickVerticalAnchor(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function TickItem(e){var{option:t,tickProps:n,value:a}=e,i,s=clsx(n.className,"recharts-cartesian-axis-tick-value");if(reactExports.isValidElement(t))i=reactExports.cloneElement(t,_objectSpread$3(_objectSpread$3({},n),{},{className:s}));else if(typeof t=="function")i=t(_objectSpread$3(_objectSpread$3({},n),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=clsx(o,t?.className)),i=reactExports.createElement(Text,_extends$7({},n,{className:o}),a)}return i}function Ticks(e){var{ticks:t=[],tick:n,tickLine:a,stroke:i,tickFormatter:s,unit:o,padding:c,tickTextProps:h,orientation:f,mirror:u,x:p,y:g,width:v,height:m,tickSize:S,tickMargin:E,fontSize:w,letterSpacing:T,getTicksConfig:A,events:L}=e,k=getTicks(_objectSpread$3(_objectSpread$3({},A),{},{ticks:t}),w,T),D=getTickTextAnchor(f,u),N=getTickVerticalAnchor(f,u),Y=svgPropertiesNoEvents(A),z=svgPropertiesNoEventsFromUnknown(n),te={};typeof a=="object"&&(te=a);var Z=_objectSpread$3(_objectSpread$3({},Y),{},{fill:"none"},te),ne=k.map((oe,le)=>{var{line:pe,tick:de}=getTickLineCoord(oe,p,g,v,m,f,S,u,E),J=_objectSpread$3(_objectSpread$3(_objectSpread$3(_objectSpread$3({textAnchor:D,verticalAnchor:N},Y),{},{stroke:"none",fill:i},z),de),{},{index:le,payload:oe,visibleTicksCount:k.length,tickFormatter:s,padding:c},h);return reactExports.createElement(Layer,_extends$7({className:"recharts-cartesian-axis-tick",key:"tick-".concat(oe.value,"-").concat(oe.coordinate,"-").concat(oe.tickCoord)},adaptEventsOfChild(L,oe,le)),a&&reactExports.createElement("line",_extends$7({},Z,pe,{className:clsx("recharts-cartesian-axis-tick-line",get(a,"className"))})),n&&reactExports.createElement(TickItem,{option:n,tickProps:J,value:"".concat(typeof s=="function"?s(oe.value,le):oe.value).concat(o||"")}))});return ne.length>0?reactExports.createElement("g",{className:"recharts-cartesian-axis-ticks"},ne):null}var CartesianAxisComponent=reactExports.forwardRef((e,t)=>{var{axisLine:n,width:a,height:i,className:s,hide:o,ticks:c}=e,h=_objectWithoutProperties$6(e,_excluded$6),[f,u]=reactExports.useState(""),[p,g]=reactExports.useState(""),v=reactExports.useRef(null);reactExports.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var S;return getCalculatedYAxisWidth({ticks:v.current,label:(S=e.labelRef)===null||S===void 0?void 0:S.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var m=reactExports.useCallback(S=>{if(S){var E=S.getElementsByClassName("recharts-cartesian-axis-tick-value");v.current=E;var w=E[0];if(w){var T=window.getComputedStyle(w),A=T.fontSize,L=T.letterSpacing;(A!==f||L!==p)&&(u(A),g(L))}}},[f,p]);return o||a!=null&&a<=0||i!=null&&i<=0?null:reactExports.createElement(Layer,{className:clsx("recharts-cartesian-axis",s),ref:m},reactExports.createElement(AxisLine,{x:e.x,y:e.y,width:a,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:svgPropertiesNoEvents(e)}),reactExports.createElement(Ticks,{ticks:c,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:f,letterSpacing:p,getTicksConfig:e,events:h}),reactExports.createElement(CartesianLabelContextProvider,{x:e.x,y:e.y,width:e.width,height:e.height},reactExports.createElement(CartesianLabelFromLabelProp,{label:e.label,labelRef:e.labelRef}),e.children))}),MemoCartesianAxis=reactExports.memo(CartesianAxisComponent,(e,t)=>{var{viewBox:n}=e,a=_objectWithoutProperties$6(e,_excluded2$4),{viewBox:i}=t,s=_objectWithoutProperties$6(t,_excluded3$4);return shallowEqual(n,i)&&shallowEqual(a,s)}),CartesianAxis=reactExports.forwardRef((e,t)=>{var n=resolveDefaultProps(e,defaultCartesianAxisProps);return reactExports.createElement(MemoCartesianAxis,_extends$7({},n,{ref:t}))});CartesianAxis.displayName="CartesianAxis";var _excluded$5=["x1","y1","x2","y2","key"],_excluded2$3=["offset"],_excluded3$3=["xAxisId","yAxisId"],_excluded4$2=["xAxisId","yAxisId"];function ownKeys$2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$2(Object(n),!0).forEach(function(a){_defineProperty$2(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$2(e,t,n){return(t=_toPropertyKey$2(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$2(e){var t=_toPrimitive$2(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$2(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _extends$6(){return _extends$6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$6.apply(null,arguments)}function _objectWithoutProperties$5(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$5(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$5(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var Background=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:a,y:i,width:s,height:o,ry:c}=e;return reactExports.createElement("rect",{x:a,y:i,ry:c,width:s,height:o,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function renderLineItem(e,t){var n;if(reactExports.isValidElement(e))n=reactExports.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var{x1:a,y1:i,x2:s,y2:o,key:c}=t,h=_objectWithoutProperties$5(t,_excluded$5),f=svgPropertiesNoEvents(h),{offset:u}=f,p=_objectWithoutProperties$5(f,_excluded2$3);n=reactExports.createElement("line",_extends$6({},p,{x1:a,y1:i,x2:s,y2:o,fill:"none",key:c}))}return n}function HorizontalGridLines(e){var{x:t,width:n,horizontal:a=!0,horizontalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,c=_objectWithoutProperties$5(e,_excluded3$3),h=i.map((f,u)=>{var p=_objectSpread$2(_objectSpread$2({},c),{},{x1:t,y1:f,x2:t+n,y2:f,key:"line-".concat(u),index:u});return renderLineItem(a,p)});return reactExports.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function VerticalGridLines(e){var{y:t,height:n,vertical:a=!0,verticalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,c=_objectWithoutProperties$5(e,_excluded4$2),h=i.map((f,u)=>{var p=_objectSpread$2(_objectSpread$2({},c),{},{x1:f,y1:t,x2:f,y2:t+n,key:"line-".concat(u),index:u});return renderLineItem(a,p)});return reactExports.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function HorizontalStripes(e){var{horizontalFill:t,fillOpacity:n,x:a,y:i,width:s,height:o,horizontalPoints:c,horizontal:h=!0}=e;if(!h||!t||!t.length)return null;var f=c.map(p=>Math.round(p+i-i)).sort((p,g)=>p-g);i!==f[0]&&f.unshift(0);var u=f.map((p,g)=>{var v=!f[g+1],m=v?i+o-p:f[g+1]-p;if(m<=0)return null;var S=g%t.length;return reactExports.createElement("rect",{key:"react-".concat(g),y:p,x:a,height:m,width:s,stroke:"none",fill:t[S],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return reactExports.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function VerticalStripes(e){var{vertical:t=!0,verticalFill:n,fillOpacity:a,x:i,y:s,width:o,height:c,verticalPoints:h}=e;if(!t||!n||!n.length)return null;var f=h.map(p=>Math.round(p+i-i)).sort((p,g)=>p-g);i!==f[0]&&f.unshift(0);var u=f.map((p,g)=>{var v=!f[g+1],m=v?i+o-p:f[g+1]-p;if(m<=0)return null;var S=g%n.length;return reactExports.createElement("rect",{key:"react-".concat(g),x:p,y:s,width:m,height:c,stroke:"none",fill:n[S],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return reactExports.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var defaultVerticalCoordinatesGenerator=(e,t)=>{var{xAxis:n,width:a,height:i,offset:s}=e;return getCoordinatesOfGrid(getTicks(_objectSpread$2(_objectSpread$2(_objectSpread$2({},defaultCartesianAxisProps),n),{},{ticks:getTicksOfAxis(n),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,t)},defaultHorizontalCoordinatesGenerator=(e,t)=>{var{yAxis:n,width:a,height:i,offset:s}=e;return getCoordinatesOfGrid(getTicks(_objectSpread$2(_objectSpread$2(_objectSpread$2({},defaultCartesianAxisProps),n),{},{ticks:getTicksOfAxis(n),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,t)},defaultProps$1={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function CartesianGrid(e){var t=useChartWidth(),n=useChartHeight(),a=useOffsetInternal(),i=_objectSpread$2(_objectSpread$2({},resolveDefaultProps(e,defaultProps$1)),{},{x:isNumber(e.x)?e.x:a.left,y:isNumber(e.y)?e.y:a.top,width:isNumber(e.width)?e.width:a.width,height:isNumber(e.height)?e.height:a.height}),{xAxisId:s,yAxisId:o,x:c,y:h,width:f,height:u,syncWithTicks:p,horizontalValues:g,verticalValues:v}=i,m=useIsPanorama(),S=useAppSelector(z=>selectAxisPropsNeededForCartesianGridTicksGenerator(z,"xAxis",s,m)),E=useAppSelector(z=>selectAxisPropsNeededForCartesianGridTicksGenerator(z,"yAxis",o,m));if(!isNumber(f)||f<=0||!isNumber(u)||u<=0||!isNumber(c)||c!==+c||!isNumber(h)||h!==+h)return null;var w=i.verticalCoordinatesGenerator||defaultVerticalCoordinatesGenerator,T=i.horizontalCoordinatesGenerator||defaultHorizontalCoordinatesGenerator,{horizontalPoints:A,verticalPoints:L}=i;if((!A||!A.length)&&typeof T=="function"){var k=g&&g.length,D=T({yAxis:E?_objectSpread$2(_objectSpread$2({},E),{},{ticks:k?g:E.ticks}):void 0,width:t,height:n,offset:a},k?!0:p);warn(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(A=D)}if((!L||!L.length)&&typeof w=="function"){var N=v&&v.length,Y=w({xAxis:S?_objectSpread$2(_objectSpread$2({},S),{},{ticks:N?v:S.ticks}):void 0,width:t,height:n,offset:a},N?!0:p);warn(Array.isArray(Y),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof Y,"]")),Array.isArray(Y)&&(L=Y)}return reactExports.createElement("g",{className:"recharts-cartesian-grid"},reactExports.createElement(Background,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),reactExports.createElement(HorizontalStripes,_extends$6({},i,{horizontalPoints:A})),reactExports.createElement(VerticalStripes,_extends$6({},i,{verticalPoints:L})),reactExports.createElement(HorizontalGridLines,_extends$6({},i,{offset:a,horizontalPoints:A,xAxis:S,yAxis:E})),reactExports.createElement(VerticalGridLines,_extends$6({},i,{offset:a,verticalPoints:L,xAxis:S,yAxis:E})))}CartesianGrid.displayName="CartesianGrid";var selectXAxisWithScale=(e,t,n,a)=>selectAxisWithScale(e,"xAxis",t,a),selectXAxisTicks=(e,t,n,a)=>selectTicksOfGraphicalItem(e,"xAxis",t,a),selectYAxisWithScale=(e,t,n,a)=>selectAxisWithScale(e,"yAxis",n,a),selectYAxisTicks=(e,t,n,a)=>selectTicksOfGraphicalItem(e,"yAxis",n,a),selectBandSize=createSelector([selectChartLayout,selectXAxisWithScale,selectYAxisWithScale,selectXAxisTicks,selectYAxisTicks],(e,t,n,a,i)=>isCategoricalAxis(e,"xAxis")?getBandSizeOfAxis(t,a,!1):getBandSizeOfAxis(n,i,!1)),pickLineId=(e,t,n,a,i)=>i;function isLineSettings(e){return e.type==="line"}var selectSynchronisedLineSettings=createSelector([selectUnfilteredCartesianItems,pickLineId],(e,t)=>e.filter(isLineSettings).find(n=>n.id===t)),selectLinePoints=createSelector([selectChartLayout,selectXAxisWithScale,selectYAxisWithScale,selectXAxisTicks,selectYAxisTicks,selectSynchronisedLineSettings,selectBandSize,selectChartDataWithIndexesIfNotInPanorama],(e,t,n,a,i,s,o,c)=>{var{chartData:h,dataStartIndex:f,dataEndIndex:u}=c;if(!(s==null||t==null||n==null||a==null||i==null||a.length===0||i.length===0||o==null)){var{dataKey:p,data:g}=s,v;if(g!=null&&g.length>0?v=g:v=h?.slice(f,u+1),v!=null)return computeLinePoints({layout:e,xAxis:t,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:p,bandSize:o,displayedData:v})}});function getRadiusAndStrokeWidthFromDot(e){var t=svgPropertiesNoEventsFromUnknown(e),n=3,a=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),c=Number(s);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(c)||c<0)&&(c=a),{r:o,strokeWidth:c}}return{r:n,strokeWidth:a}}var _excluded$4=["id"],_excluded2$2=["type","layout","connectNulls","needClip"],_excluded3$2=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function ownKeys$1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys$1(Object(n),!0).forEach(function(a){_defineProperty$1(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$1(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty$1(e,t,n){return(t=_toPropertyKey$1(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey$1(e){var t=_toPrimitive$1(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive$1(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _objectWithoutProperties$4(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$4(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$4(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function _extends$5(){return _extends$5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$5.apply(null,arguments)}var computeLegendPayloadFromAreaData=e=>{var{dataKey:t,name:n,stroke:a,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:a,value:getTooltipNameProp(n,t),payload:e}]};function getTooltipEntrySettings(e){var{dataKey:t,data:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:c,unit:h}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:getTooltipNameProp(o,t),hide:c,type:e.tooltipType,color:e.stroke,unit:h}}}var generateSimpleStrokeDasharray=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function repeat(e,t){for(var n=e.length%2!==0?[...e,0]:e,a=[],i=0;i<t;++i)a=[...a,...n];return a}var getStrokeDasharray=(e,t,n)=>{var a=n.reduce((p,g)=>p+g);if(!a)return generateSimpleStrokeDasharray(t,e);for(var i=Math.floor(e/a),s=e%a,o=t-e,c=[],h=0,f=0;h<n.length;f+=n[h],++h)if(f+n[h]>s){c=[...n.slice(0,h),s-f];break}var u=c.length%2===0?[0,o]:[o];return[...repeat(n,i),...c,...u].map(p=>"".concat(p,"px")).join(", ")};function renderDotItem(e,t){var n;if(reactExports.isValidElement(e))n=reactExports.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var a=clsx("recharts-line-dot",typeof e!="boolean"?e.className:"");n=reactExports.createElement(Dot,_extends$5({},t,{className:a}))}return n}function shouldRenderDots(e,t){return e==null?!1:t?!0:e.length===1}function Dots(e){var{clipPathId:t,points:n,props:a}=e,{dot:i,dataKey:s,needClip:o}=a;if(!shouldRenderDots(n,i))return null;var{id:c}=a,h=_objectWithoutProperties$4(a,_excluded$4),f=isClipDot(i),u=svgPropertiesNoEvents(h),p=svgPropertiesAndEventsFromUnknown(i),g=n.map((m,S)=>{var E=_objectSpread$1(_objectSpread$1(_objectSpread$1({key:"dot-".concat(S),r:3},u),p),{},{index:S,cx:m.x,cy:m.y,dataKey:s,value:m.value,payload:m.payload,points:n});return renderDotItem(i,E)}),v={clipPath:o?"url(#clipPath-".concat(f?"":"dots-").concat(t,")"):void 0};return reactExports.createElement(Layer,_extends$5({className:"recharts-line-dots",key:"dots"},v),g)}function LineLabelListProvider(e){var{showLabels:t,children:n,points:a}=e,i=reactExports.useMemo(()=>a?.map(s=>{var o={x:s.x,y:s.y,width:0,height:0};return _objectSpread$1(_objectSpread$1({},o),{},{value:s.value,payload:s.payload,viewBox:o,parentViewBox:void 0,fill:void 0})}),[a]);return reactExports.createElement(CartesianLabelListContextProvider,{value:t?i:null},n)}function StaticCurve(e){var{clipPathId:t,pathRef:n,points:a,strokeDasharray:i,props:s}=e,{type:o,layout:c,connectNulls:h,needClip:f}=s,u=_objectWithoutProperties$4(s,_excluded2$2),p=_objectSpread$1(_objectSpread$1({},svgPropertiesAndEvents(u)),{},{fill:"none",className:"recharts-line-curve",clipPath:f?"url(#clipPath-".concat(t,")"):void 0,points:a,type:o,layout:c,connectNulls:h,strokeDasharray:i??s.strokeDasharray});return reactExports.createElement(reactExports.Fragment,null,a?.length>1&&reactExports.createElement(Curve,_extends$5({},p,{pathRef:n})),reactExports.createElement(Dots,{points:a,clipPathId:t,props:s}))}function getTotalLength(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function CurveWithAnimation(e){var{clipPathId:t,props:n,pathRef:a,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:c,isAnimationActive:h,animationBegin:f,animationDuration:u,animationEasing:p,animateNewValues:g,width:v,height:m,onAnimationEnd:S,onAnimationStart:E}=n,w=i.current,T=useAnimationId(n,"recharts-line-"),[A,L]=reactExports.useState(!1),k=!A,D=reactExports.useCallback(()=>{typeof S=="function"&&S(),L(!1)},[S]),N=reactExports.useCallback(()=>{typeof E=="function"&&E(),L(!0)},[E]),Y=getTotalLength(a.current),z=s.current;return reactExports.createElement(LineLabelListProvider,{points:o,showLabels:k},n.children,reactExports.createElement(JavascriptAnimate,{animationId:T,begin:f,duration:u,isActive:h,easing:p,onAnimationEnd:D,onAnimationStart:N,key:T},te=>{var Z=interpolate$1(z,Y+z,te),ne=Math.min(Z,Y),oe;if(h)if(c){var le="".concat(c).split(/[,\s]+/gim).map(J=>parseFloat(J));oe=getStrokeDasharray(ne,Y,le)}else oe=generateSimpleStrokeDasharray(Y,ne);else oe=c==null?void 0:String(c);if(w){var pe=w.length/o.length,de=te===1?o:o.map((J,V)=>{var C=Math.floor(V*pe);if(w[C]){var O=w[C];return _objectSpread$1(_objectSpread$1({},J),{},{x:interpolate$1(O.x,J.x,te),y:interpolate$1(O.y,J.y,te)})}return g?_objectSpread$1(_objectSpread$1({},J),{},{x:interpolate$1(v*2,J.x,te),y:interpolate$1(m/2,J.y,te)}):_objectSpread$1(_objectSpread$1({},J),{},{x:J.x,y:J.y})});return i.current=de,reactExports.createElement(StaticCurve,{props:n,points:de,clipPathId:t,pathRef:a,strokeDasharray:oe})}return te>0&&Y>0&&(i.current=o,s.current=ne),reactExports.createElement(StaticCurve,{props:n,points:o,clipPathId:t,pathRef:a,strokeDasharray:oe})}),reactExports.createElement(LabelListFromLabelProp,{label:n.label}))}function RenderCurve(e){var{clipPathId:t,props:n}=e,a=reactExports.useRef(null),i=reactExports.useRef(0),s=reactExports.useRef(null);return reactExports.createElement(CurveWithAnimation,{props:n,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:i,pathRef:s})}var errorBarDataPointFormatter=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:getValueByDataKey(e.payload,t)});class LineWithState extends reactExports.Component{render(){var{hide:t,dot:n,points:a,className:i,xAxisId:s,yAxisId:o,top:c,left:h,width:f,height:u,id:p,needClip:g}=this.props;if(t)return null;var v=clsx("recharts-line",i),m=p,{r:S,strokeWidth:E}=getRadiusAndStrokeWidthFromDot(n),w=isClipDot(n),T=S*2+E;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Layer,{className:v},g&&reactExports.createElement("defs",null,reactExports.createElement(GraphicalItemClipPath,{clipPathId:m,xAxisId:s,yAxisId:o}),!w&&reactExports.createElement("clipPath",{id:"clipPath-dots-".concat(m)},reactExports.createElement("rect",{x:h-T/2,y:c-T/2,width:f+T,height:u+T}))),reactExports.createElement(SetErrorBarContext,{xAxisId:s,yAxisId:o,data:a,dataPointFormatter:errorBarDataPointFormatter,errorBarOffset:0},reactExports.createElement(RenderCurve,{props:this.props,clipPathId:m}))),reactExports.createElement(ActivePoints,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var defaultLineProps={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Global.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function LineImpl(e){var t=resolveDefaultProps(e,defaultLineProps),{activeDot:n,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:c,dot:h,hide:f,isAnimationActive:u,label:p,legendType:g,xAxisId:v,yAxisId:m,id:S}=t,E=_objectWithoutProperties$4(t,_excluded3$2),{needClip:w}=useNeedsClip(v,m),T=usePlotArea(),A=useChartLayout(),L=useIsPanorama(),k=useAppSelector(te=>selectLinePoints(te,v,m,L,S));if(A!=="horizontal"&&A!=="vertical"||k==null||T==null)return null;var{height:D,width:N,x:Y,y:z}=T;return reactExports.createElement(LineWithState,_extends$5({},E,{id:S,connectNulls:c,dot:h,activeDot:n,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:u,hide:f,label:p,legendType:g,xAxisId:v,yAxisId:m,points:k,layout:A,height:D,width:N,left:Y,top:z,needClip:w}))}function computeLinePoints(e){var{layout:t,xAxis:n,yAxis:a,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:c,displayedData:h}=e;return h.map((f,u)=>{var p=getValueByDataKey(f,o);if(t==="horizontal"){var g=getCateCoordinateOfLine({axis:n,ticks:i,bandSize:c,entry:f,index:u}),v=isNullish(p)?null:a.scale(p);return{x:g,y:v,value:p,payload:f}}var m=isNullish(p)?null:n.scale(p),S=getCateCoordinateOfLine({axis:a,ticks:s,bandSize:c,entry:f,index:u});return m==null||S==null?null:{x:m,y:S,value:p,payload:f}}).filter(Boolean)}function LineFn(e){var t=resolveDefaultProps(e,defaultLineProps),n=useIsPanorama();return reactExports.createElement(RegisterGraphicalItemId,{id:t.id,type:"line"},a=>reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetLegendPayload,{legendPayload:computeLegendPayloadFromAreaData(t)}),reactExports.createElement(SetTooltipEntrySettings,{fn:getTooltipEntrySettings,args:t}),reactExports.createElement(SetCartesianGraphicalItem,{type:"line",id:a,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),reactExports.createElement(LineImpl,_extends$5({},t,{id:a}))))}var Line=reactExports.memo(LineFn);Line.displayName="Line";var _excluded$3=["dangerouslySetInnerHTML","ticks"],_excluded2$1=["id"],_excluded3$1=["domain"],_excluded4$1=["domain"];function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$4.apply(null,arguments)}function _objectWithoutProperties$3(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$3(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function SetXAxisSettings(e){var t=useAppDispatch();return reactExports.useLayoutEffect(()=>(t(addXAxis(e)),()=>{t(removeXAxis(e))}),[e,t]),null}var XAxisImpl=e=>{var{xAxisId:t,className:n}=e,a=useAppSelector(selectAxisViewBox),i=useIsPanorama(),s="xAxis",o=useAppSelector(E=>selectAxisScale(E,s,t,i)),c=useAppSelector(E=>selectTicksOfAxis(E,s,t,i)),h=useAppSelector(E=>selectXAxisSize(E,t)),f=useAppSelector(E=>selectXAxisPosition(E,t)),u=useAppSelector(E=>selectXAxisSettingsNoDefaults(E,t));if(h==null||f==null||u==null)return null;var{dangerouslySetInnerHTML:p,ticks:g}=e,v=_objectWithoutProperties$3(e,_excluded$3),{id:m}=u,S=_objectWithoutProperties$3(u,_excluded2$1);return reactExports.createElement(CartesianAxis,_extends$4({},v,S,{scale:o,x:f.x,y:f.y,width:h.width,height:h.height,className:clsx("recharts-".concat(s," ").concat(s),n),viewBox:a,ticks:c}))},xAxisDefaultProps={allowDataOverflow:implicitXAxis.allowDataOverflow,allowDecimals:implicitXAxis.allowDecimals,allowDuplicatedCategory:implicitXAxis.allowDuplicatedCategory,height:implicitXAxis.height,hide:!1,mirror:implicitXAxis.mirror,orientation:implicitXAxis.orientation,padding:implicitXAxis.padding,reversed:implicitXAxis.reversed,scale:implicitXAxis.scale,tickCount:implicitXAxis.tickCount,type:implicitXAxis.type,xAxisId:0},XAxisSettingsDispatcher=e=>{var t,n,a,i,s,o=resolveDefaultProps(e,xAxisDefaultProps);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetXAxisSettings,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),reactExports.createElement(XAxisImpl,o))},XAxisMemoComparator=(e,t)=>{var{domain:n}=e,a=_objectWithoutProperties$3(e,_excluded3$1),{domain:i}=t,s=_objectWithoutProperties$3(t,_excluded4$1);return shallowEqual(a,s)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:shallowEqual({domain:n},{domain:i}):!1},XAxis=reactExports.memo(XAxisSettingsDispatcher,XAxisMemoComparator);XAxis.displayName="XAxis";var _excluded$2=["dangerouslySetInnerHTML","ticks"],_excluded2=["id"],_excluded3=["domain"],_excluded4=["domain"];function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$3.apply(null,arguments)}function _objectWithoutProperties$2(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$2(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$2(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function SetYAxisSettings(e){var t=useAppDispatch();return reactExports.useLayoutEffect(()=>(t(addYAxis(e)),()=>{t(removeYAxis(e))}),[e,t]),null}var YAxisImpl=e=>{var{yAxisId:t,className:n,width:a,label:i}=e,s=reactExports.useRef(null),o=reactExports.useRef(null),c=useAppSelector(selectAxisViewBox),h=useIsPanorama(),f=useAppDispatch(),u="yAxis",p=useAppSelector(k=>selectAxisScale(k,u,t,h)),g=useAppSelector(k=>selectYAxisSize(k,t)),v=useAppSelector(k=>selectYAxisPosition(k,t)),m=useAppSelector(k=>selectTicksOfAxis(k,u,t,h)),S=useAppSelector(k=>selectYAxisSettingsNoDefaults(k,t));if(reactExports.useLayoutEffect(()=>{if(!(a!=="auto"||!g||isLabelContentAFunction(i)||reactExports.isValidElement(i)||S==null)){var k=s.current;if(k){var D=k.getCalculatedWidth();Math.round(g.width)!==Math.round(D)&&f(updateYAxisWidth({id:t,width:D}))}}},[m,g,f,i,t,a,S]),g==null||v==null||S==null)return null;var{dangerouslySetInnerHTML:E,ticks:w}=e,T=_objectWithoutProperties$2(e,_excluded$2),{id:A}=S,L=_objectWithoutProperties$2(S,_excluded2);return reactExports.createElement(CartesianAxis,_extends$3({},T,L,{ref:s,labelRef:o,scale:p,x:v.x,y:v.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:g.width,height:g.height,className:clsx("recharts-".concat(u," ").concat(u),n),viewBox:c,ticks:m}))},yAxisDefaultProps={allowDataOverflow:implicitYAxis.allowDataOverflow,allowDecimals:implicitYAxis.allowDecimals,allowDuplicatedCategory:implicitYAxis.allowDuplicatedCategory,hide:!1,mirror:implicitYAxis.mirror,orientation:implicitYAxis.orientation,padding:implicitYAxis.padding,reversed:implicitYAxis.reversed,scale:implicitYAxis.scale,tickCount:implicitYAxis.tickCount,type:implicitYAxis.type,width:implicitYAxis.width,yAxisId:0},YAxisSettingsDispatcher=e=>{var t,n,a,i,s,o=resolveDefaultProps(e,yAxisDefaultProps);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(SetYAxisSettings,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),reactExports.createElement(YAxisImpl,o))},YAxisMemoComparator=(e,t)=>{var{domain:n}=e,a=_objectWithoutProperties$2(e,_excluded3),{domain:i}=t,s=_objectWithoutProperties$2(t,_excluded4);return shallowEqual(a,s)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:shallowEqual({domain:n},{domain:i}):!1},YAxis=reactExports.memo(YAxisSettingsDispatcher,YAxisMemoComparator);YAxis.displayName="YAxis";var withSelector={exports:{}},useSyncExternalStoreWithSelector_production={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreWithSelector_production;function requireUseSyncExternalStoreWithSelector_production(){if(hasRequiredUseSyncExternalStoreWithSelector_production)return useSyncExternalStoreWithSelector_production;hasRequiredUseSyncExternalStoreWithSelector_production=1;var e=requireReact();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,i=e.useRef,s=e.useEffect,o=e.useMemo,c=e.useDebugValue;return useSyncExternalStoreWithSelector_production.useSyncExternalStoreWithSelector=function(h,f,u,p,g){var v=i(null);if(v.current===null){var m={hasValue:!1,value:null};v.current=m}else m=v.current;v=o(function(){function E(k){if(!w){if(w=!0,T=k,k=p(k),g!==void 0&&m.hasValue){var D=m.value;if(g(D,k))return A=D}return A=k}if(D=A,n(T,k))return D;var N=p(k);return g!==void 0&&g(D,N)?(T=k,D):(T=k,A=N)}var w=!1,T,A,L=u===void 0?null:u;return[function(){return E(f())},L===null?void 0:function(){return E(L())}]},[f,u,p,g]);var S=a(h,v[0],v[1]);return s(function(){m.hasValue=!0,m.value=S},[S]),c(S),S},useSyncExternalStoreWithSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireUseSyncExternalStoreWithSelector_production()),withSelector.exports}requireWithSelector();function defaultNoopBatch(e){e()}function createListenerCollection(){let e=null,t=null;return{clear(){e=null,t=null},notify(){defaultNoopBatch(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=e;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!a||e===null||(a=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var nullListeners={notify(){},get:()=>[]};function createSubscription(e,t){let n,a=nullListeners,i=0,s=!1;function o(S){u();const E=a.subscribe(S);let w=!1;return()=>{w||(w=!0,E(),p())}}function c(){a.notify()}function h(){m.onStateChange&&m.onStateChange()}function f(){return s}function u(){i++,n||(n=e.subscribe(h),a=createListenerCollection())}function p(){i--,n&&i===0&&(n(),n=void 0,a.clear(),a=nullListeners)}function g(){s||(s=!0,u())}function v(){s&&(s=!1,p())}const m={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:h,isSubscribed:f,trySubscribe:g,tryUnsubscribe:v,getListeners:()=>a};return m}var canUseDOM=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isDOM=canUseDOM(),isRunningInReactNative=()=>typeof navigator<"u"&&navigator.product==="ReactNative",isReactNative=isRunningInReactNative(),getUseIsomorphicLayoutEffect=()=>isDOM||isReactNative?reactExports.useLayoutEffect:reactExports.useEffect,useIsomorphicLayoutEffect=getUseIsomorphicLayoutEffect(),ContextKey=Symbol.for("react-redux-context"),gT=typeof globalThis<"u"?globalThis:{};function getContext(){if(!reactExports.createContext)return{};const e=gT[ContextKey]??=new Map;let t=e.get(reactExports.createContext);return t||(t=reactExports.createContext(null),e.set(reactExports.createContext,t)),t}var ReactReduxContext=getContext();function Provider(e){const{children:t,context:n,serverState:a,store:i}=e,s=reactExports.useMemo(()=>{const h=createSubscription(i);return{store:i,subscription:h,getServerState:a?()=>a:void 0}},[i,a]),o=reactExports.useMemo(()=>i.getState(),[i]);useIsomorphicLayoutEffect(()=>{const{subscription:h}=s;return h.onStateChange=h.notifyNestedSubs,h.trySubscribe(),o!==i.getState()&&h.notifyNestedSubs(),()=>{h.tryUnsubscribe(),h.onStateChange=void 0}},[s,o]);const c=n||ReactReduxContext;return reactExports.createElement(c.Provider,{value:s},t)}var Provider_default=Provider,pickChartPointer=(e,t)=>t,selectActivePropsFromChartPointer=createSelector([pickChartPointer,selectChartLayout,selectPolarViewBox,selectTooltipAxisType,selectTooltipAxisRangeWithReverse,selectTooltipAxisTicks,selectOrderedTooltipTicks,selectChartOffsetInternal],combineActiveProps),getChartPointer=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/a)}},mouseClickAction=createAction("mouseClick"),mouseClickMiddleware=createListenerMiddleware();mouseClickMiddleware.startListening({actionCreator:mouseClickAction,effect:(e,t)=>{var n=e.payload,a=selectActivePropsFromChartPointer(t.getState(),getChartPointer(n));a?.activeIndex!=null&&t.dispatch(setMouseClickAxisIndex({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var mouseMoveAction=createAction("mouseMove"),mouseMoveMiddleware=createListenerMiddleware();mouseMoveMiddleware.startListening({actionCreator:mouseMoveAction,effect:(e,t)=>{var n=e.payload,a=t.getState(),i=selectTooltipEventType$1(a,a.tooltip.settings.shared),s=selectActivePropsFromChartPointer(a,getChartPointer(n));i==="axis"&&(s?.activeIndex!=null?t.dispatch(setMouseOverAxisIndex({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(mouseLeaveChart()))}});var initialState={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},rootPropsSlice=createSlice({name:"rootProps",initialState,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:initialState.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),rootPropsReducer=rootPropsSlice.reducer,{updateOptions}=rootPropsSlice.actions,polarOptionsSlice=createSlice({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions}=polarOptionsSlice.actions,polarOptionsReducer=polarOptionsSlice.reducer,keyDownAction=createAction("keyDown"),focusAction=createAction("focus"),keyboardEventsMiddleware=createListenerMiddleware();keyboardEventsMiddleware.startListening({actionCreator:keyDownAction,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=Number(combineActiveTooltipIndex(i,selectTooltipDisplayedData(n))),c=selectTooltipAxisTicks(n);if(s==="Enter"){var h=selectCoordinateForDefaultIndex(n,"axis","hover",String(i.index));t.dispatch(setKeyboardInteraction({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:h}));return}var f=selectChartDirection(n),u=f==="left-to-right"?1:-1,p=s==="ArrowRight"?1:-1,g=o+p*u;if(!(c==null||g>=c.length||g<0)){var v=selectCoordinateForDefaultIndex(n,"axis","hover",String(g));t.dispatch(setKeyboardInteraction({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:v}))}}}}});keyboardEventsMiddleware.startListening({actionCreator:focusAction,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=n.tooltip;if(!i.active&&i.index==null){var s="0",o=selectCoordinateForDefaultIndex(n,"axis","hover",String(s));t.dispatch(setKeyboardInteraction({activeDataKey:void 0,active:!0,activeIndex:s,activeCoordinate:o}))}}}});var externalEventAction=createAction("externalEvent"),externalEventsMiddleware=createListenerMiddleware();externalEventsMiddleware.startListening({actionCreator:externalEventAction,effect:(e,t)=>{if(e.payload.handler!=null){var n=t.getState(),a={activeCoordinate:selectActiveTooltipCoordinate(n),activeDataKey:selectActiveTooltipDataKey(n),activeIndex:selectActiveTooltipIndex(n),activeLabel:selectActiveLabel$1(n),activeTooltipIndex:selectActiveTooltipIndex(n),isTooltipActive:selectIsTooltipActive$1(n)};e.payload.handler(a,e.payload.reactEvent)}}});var selectAllTooltipPayloadConfiguration=createSelector([selectTooltipState],e=>e.tooltipItemPayloads),selectTooltipCoordinate=createSelector([selectAllTooltipPayloadConfiguration,selectTooltipPayloadSearcher,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,a)=>{var i=e.find(c=>c.settings.dataKey===a);if(i!=null){var{positions:s}=i;if(s!=null){var o=t(s,n);return o}}}),touchEventAction=createAction("touchMove"),touchEventMiddleware=createListenerMiddleware();touchEventMiddleware.startListening({actionCreator:touchEventAction,effect:(e,t)=>{var n=e.payload,a=t.getState(),i=selectTooltipEventType$1(a,a.tooltip.settings.shared);if(i==="axis"){var s=selectActivePropsFromChartPointer(a,getChartPointer({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));s?.activeIndex!=null&&t.dispatch(setMouseOverAxisIndex({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(i==="item"){var o,c=n.touches[0],h=document.elementFromPoint(c.clientX,c.clientY);if(!h||!h.getAttribute)return;var f=h.getAttribute(DATA_ITEM_INDEX_ATTRIBUTE_NAME),u=(o=h.getAttribute(DATA_ITEM_DATAKEY_ATTRIBUTE_NAME))!==null&&o!==void 0?o:void 0,p=selectTooltipCoordinate(t.getState(),f,u);t.dispatch(setActiveMouseOverItemIndex({activeDataKey:u,activeIndex:f,activeCoordinate:p}))}}});var rootReducer=combineReducers({brush:brushReducer,cartesianAxis:cartesianAxisReducer,chartData:chartDataReducer,errorBars:errorBarReducer,graphicalItems:graphicalItemsReducer,layout:chartLayoutReducer,legend:legendReducer,options:optionsReducer,polarAxis:polarAxisReducer,polarOptions:polarOptionsReducer,referenceElements:referenceElementsReducer,rootProps:rootPropsReducer,tooltip:tooltipReducer}),createRechartsStore=function e(t){return configureStore({reducer:rootReducer,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([mouseClickMiddleware.middleware,mouseMoveMiddleware.middleware,keyboardEventsMiddleware.middleware,externalEventsMiddleware.middleware,touchEventMiddleware.middleware]),enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(autoBatchEnhancer({type:"raf"}))},devTools:Global.devToolsEnabled})};function RechartsStoreProvider(e){var{preloadedState:t,children:n,reduxStoreName:a}=e,i=useIsPanorama(),s=reactExports.useRef(null);if(i)return n;s.current==null&&(s.current=createRechartsStore(t));var o=RechartsReduxContext;return reactExports.createElement(Provider_default,{context:o,store:s.current},n)}function ReportMainChartProps(e){var{layout:t,margin:n}=e,a=useAppDispatch(),i=useIsPanorama();return reactExports.useEffect(()=>{i||(a(setLayout(t)),a(setMargin(n)))},[a,i,t,n]),null}function ReportChartProps(e){var t=useAppDispatch();return reactExports.useEffect(()=>{t(updateOptions(e))},[t,e]),null}var _excluded$1=["children"];function _objectWithoutProperties$1(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose$1(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$1(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$2.apply(null,arguments)}var FULL_WIDTH_AND_HEIGHT={width:"100%",height:"100%",display:"block"},MainChartSurface=reactExports.forwardRef((e,t)=>{var n=useChartWidth(),a=useChartHeight(),i=useAccessibilityLayer();if(!isPositiveNumber(n)||!isPositiveNumber(a))return null;var{children:s,otherAttributes:o,title:c,desc:h}=e,f,u;return typeof o.tabIndex=="number"?f=o.tabIndex:f=i?0:void 0,typeof o.role=="string"?u=o.role:u=i?"application":void 0,reactExports.createElement(Surface,_extends$2({},o,{title:c,desc:h,role:u,tabIndex:f,width:n,height:a,style:FULL_WIDTH_AND_HEIGHT,ref:t}),s)}),BrushPanoramaSurface=e=>{var{children:t}=e,n=useAppSelector(selectBrushDimensions);if(!n)return null;var{width:a,height:i,y:s,x:o}=n;return reactExports.createElement(Surface,{width:a,height:i,x:o,y:s},t)},RootSurface=reactExports.forwardRef((e,t)=>{var{children:n}=e,a=_objectWithoutProperties$1(e,_excluded$1),i=useIsPanorama();return i?reactExports.createElement(BrushPanoramaSurface,null,n):reactExports.createElement(MainChartSurface,_extends$2({ref:t},a),n)});function useReportScale(){var e=useAppDispatch(),[t,n]=reactExports.useState(null),a=useAppSelector(selectContainerScale);return reactExports.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;isWellBehavedNumber(s)&&s!==a&&e(setScale(s))}},[t,e,a]),n}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(a){_defineProperty(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return typeof t=="symbol"?t:t+""}function _toPrimitive(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends$1.apply(null,arguments)}var EventSynchronizer=()=>(useSynchronisedEventsFromOtherCharts(),null);function getNumberOrZero(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var ResponsiveDiv=reactExports.forwardRef((e,t)=>{var n,a,i=reactExports.useRef(null),[s,o]=reactExports.useState({containerWidth:getNumberOrZero((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:getNumberOrZero((a=e.style)===null||a===void 0?void 0:a.height)}),c=reactExports.useCallback((f,u)=>{o(p=>{var g=Math.round(f),v=Math.round(u);return p.containerWidth===g&&p.containerHeight===v?p:{containerWidth:g,containerHeight:v}})},[]),h=reactExports.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:u,height:p}=f.getBoundingClientRect();c(u,p);var g=m=>{var{width:S,height:E}=m[0].contentRect;c(S,E)},v=new ResizeObserver(g);v.observe(f),i.current=v}},[t,c]);return reactExports.useEffect(()=>()=>{var f=i.current;f?.disconnect()},[c]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:s.containerWidth,height:s.containerHeight}),reactExports.createElement("div",_extends$1({ref:h},e)))}),ReadSizeOnceDiv=reactExports.forwardRef((e,t)=>{var{width:n,height:a}=e,[i,s]=reactExports.useState({containerWidth:getNumberOrZero(n),containerHeight:getNumberOrZero(a)}),o=reactExports.useCallback((h,f)=>{s(u=>{var p=Math.round(h),g=Math.round(f);return u.containerWidth===p&&u.containerHeight===g?u:{containerWidth:p,containerHeight:g}})},[]),c=reactExports.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null){var{width:f,height:u}=h.getBoundingClientRect();o(f,u)}},[t,o]);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:i.containerWidth,height:i.containerHeight}),reactExports.createElement("div",_extends$1({ref:c},e)))}),StaticDiv=reactExports.forwardRef((e,t)=>{var{width:n,height:a}=e;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:n,height:a}),reactExports.createElement("div",_extends$1({ref:t},e)))}),NonResponsiveDiv=reactExports.forwardRef((e,t)=>{var{width:n,height:a}=e;return isPercent(n)||isPercent(a)?reactExports.createElement(ReadSizeOnceDiv,_extends$1({},e,{ref:t})):reactExports.createElement(StaticDiv,_extends$1({},e,{ref:t}))});function getWrapperDivComponent(e){return e===!0?ResponsiveDiv:NonResponsiveDiv}var RechartsWrapper=reactExports.forwardRef((e,t)=>{var{children:n,className:a,height:i,onClick:s,onContextMenu:o,onDoubleClick:c,onMouseDown:h,onMouseEnter:f,onMouseLeave:u,onMouseMove:p,onMouseUp:g,onTouchEnd:v,onTouchMove:m,onTouchStart:S,style:E,width:w,responsive:T,dispatchTouchEvents:A=!0}=e,L=reactExports.useRef(null),k=useAppDispatch(),[D,N]=reactExports.useState(null),[Y,z]=reactExports.useState(null),te=useReportScale(),Z=useResponsiveContainerContext(),ne=Z?.width>0?Z.width:w,oe=Z?.height>0?Z.height:i,le=reactExports.useCallback(W=>{te(W),typeof t=="function"&&t(W),N(W),z(W),W!=null&&(L.current=W)},[te,t,N,z]),pe=reactExports.useCallback(W=>{k(mouseClickAction(W)),k(externalEventAction({handler:s,reactEvent:W}))},[k,s]),de=reactExports.useCallback(W=>{k(mouseMoveAction(W)),k(externalEventAction({handler:f,reactEvent:W}))},[k,f]),J=reactExports.useCallback(W=>{k(mouseLeaveChart()),k(externalEventAction({handler:u,reactEvent:W}))},[k,u]),V=reactExports.useCallback(W=>{k(mouseMoveAction(W)),k(externalEventAction({handler:p,reactEvent:W}))},[k,p]),C=reactExports.useCallback(()=>{k(focusAction())},[k]),O=reactExports.useCallback(W=>{k(keyDownAction(W.key))},[k]),I=reactExports.useCallback(W=>{k(externalEventAction({handler:o,reactEvent:W}))},[k,o]),M=reactExports.useCallback(W=>{k(externalEventAction({handler:c,reactEvent:W}))},[k,c]),H=reactExports.useCallback(W=>{k(externalEventAction({handler:h,reactEvent:W}))},[k,h]),G=reactExports.useCallback(W=>{k(externalEventAction({handler:g,reactEvent:W}))},[k,g]),j=reactExports.useCallback(W=>{k(externalEventAction({handler:S,reactEvent:W}))},[k,S]),F=reactExports.useCallback(W=>{A&&k(touchEventAction(W)),k(externalEventAction({handler:m,reactEvent:W}))},[k,A,m]),q=reactExports.useCallback(W=>{k(externalEventAction({handler:v,reactEvent:W}))},[k,v]),X=getWrapperDivComponent(T);return reactExports.createElement(TooltipPortalContext.Provider,{value:D},reactExports.createElement(LegendPortalContext.Provider,{value:Y},reactExports.createElement(X,{width:ne??E?.width,height:oe??E?.height,className:clsx("recharts-wrapper",a),style:_objectSpread({position:"relative",cursor:"default",width:ne,height:oe},E),onClick:pe,onContextMenu:I,onDoubleClick:M,onFocus:C,onKeyDown:O,onMouseDown:H,onMouseEnter:de,onMouseLeave:J,onMouseMove:V,onMouseUp:G,onTouchEnd:q,onTouchMove:F,onTouchStart:j,ref:le},reactExports.createElement(EventSynchronizer,null),n)))}),_excluded=["width","height","responsive","children","className","style","compact","title","desc"];function _objectWithoutProperties(e,t){if(e==null)return{};var n,a,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var CategoricalChart=reactExports.forwardRef((e,t)=>{var{width:n,height:a,responsive:i,children:s,className:o,style:c,compact:h,title:f,desc:u}=e,p=_objectWithoutProperties(e,_excluded),g=svgPropertiesNoEvents(p);return h?reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(ReportChartSize,{width:n,height:a}),reactExports.createElement(RootSurface,{otherAttributes:g,title:f,desc:u},s)):reactExports.createElement(RechartsWrapper,{className:o,style:c,width:n,height:a,responsive:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},reactExports.createElement(RootSurface,{otherAttributes:g,title:f,desc:u,ref:t},reactExports.createElement(ClipPathProvider,null,s)))});function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends.apply(null,arguments)}var defaultMargin={top:5,right:5,bottom:5,left:5},defaultProps={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:defaultMargin,reverseStackOrder:!1,syncMethod:"index",responsive:!1},CartesianChart=reactExports.forwardRef(function e(t,n){var a,i=resolveDefaultProps(t.categoricalChartProps,defaultProps),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:h,categoricalChartProps:f}=t,u={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:c,tooltipPayloadSearcher:h,eventEmitter:void 0};return reactExports.createElement(RechartsStoreProvider,{preloadedState:{options:u},reduxStoreName:(a=f.id)!==null&&a!==void 0?a:s},reactExports.createElement(ChartDataContextProvider,{chartData:f.data}),reactExports.createElement(ReportMainChartProps,{layout:i.layout,margin:i.margin}),reactExports.createElement(ReportChartProps,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),reactExports.createElement(CategoricalChart,_extends({},i,{ref:n})))}),allowedTooltipTypes=["axis"],LineChart=reactExports.forwardRef((e,t)=>reactExports.createElement(CartesianChart,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:allowedTooltipTypes,tooltipPayloadSearcher:arrayTooltipSearcher,categoricalChartProps:e,ref:t}));function computeRealPerformanceRatio(e,t,n){if(console.log("===== [RPR v9.9.7-Pro]  Physically Correct Dynamic-Sin ====="),!e?.records?.length||!n)return console.warn("No valid records or missing capacity  return 0"),"0.00";const a=new Map;e.records.forEach(u=>{const p=u?.StartTime||u?.time||u?.Time||"";isGridConnected(u)&&p&&!a.has(p)&&a.set(p,u)});const i=Array.from(a.values()),s=i.length;console.log("Connected UNIQUE slots:",s);const o=i.reduce((u,p)=>u+Number(p["Active power(kW)"]||p["Active power"]||0)/12,0)||0;console.log(" E_ac (from Active Power):",o.toFixed(3),"kWh");const h=(t?.length>0?t.reduce((u,p)=>u+p,0)/t.length:0)*(s/288);console.log(" E_irr (from Irradiance):",h.toFixed(3),"kWh/m"),console.log("System Capacity (kWp):",n);const f=n>0&&h>0?o/(n*h)*100:0;return console.log(" Real PR:",f.toFixed(2),"%"),console.log("===== [RPR CALC END] ====="),f.toFixed(2)}function computeDailyRPRSeries(e,t,n){if(console.log("===== [RPR v9.9.7-Pro]  computeDailyRPRSeries() ====="),!e?.dailyProduction?.length||!n)return console.warn("No dailyProduction data found  returning empty series"),[];const a=t?.length?t:Array(30).fill(5),i=e.dailyProduction.map((s,o)=>{const c=Number(s.production||s.Eac||s["Daily Production"]||0),h=n>0&&a[o]>0?c/(n*a[o])*100:0;return{date:String(o+1).padStart(2,"0"),RPR:Number(h.toFixed(1))}});return console.log("Generated daily RPR series:",i.length,"days"),i}function isGridConnected(e){const t=(e["Inverter status"]||e["Inverter Status"]||e.Status||e.status||"").toLowerCase();return t.includes("grid")&&t.includes("connect")||t.includes("power limit")||t.includes("grid-connected")||t.includes("kt ni li")||t.includes("ha li")||t.includes("")||t.includes("connected : power limit")}const ghiBaselineMonthly={Vietnam:[135,145,165,170,180,175,170,160,155,150,135,130],Thailand:[150,160,175,185,190,180,170,160,155,150,145,140],Philippines:[140,145,160,165,170,165,160,155,150,145,140,135],Indonesia:[155,160,165,165,165,160,155,155,155,155,155,155],Malaysia:[130,135,145,150,155,155,155,150,145,140,135,130],India:[135,150,175,190,200,195,190,180,170,160,145,135],China:[100,120,145,165,180,190,200,190,160,135,110,95],Japan:[85,105,140,165,180,190,185,165,135,105,85,75],Korea:[80,95,125,155,175,185,180,160,130,100,80,70],Singapore:[145,150,155,160,160,160,155,155,150,150,145,145]};function getMonthlyGHI(e,t){return(ghiBaselineMonthly[e]||ghiBaselineMonthly.Vietnam)[t-1]||0}function fmtMonthRange(e,t){if(!e||!t)return"";const n=new Date(e),a=new Date(t);return n.toLocaleDateString("en-GB",{month:"short",year:"numeric"})+"  "+a.toLocaleDateString("en-GB",{month:"short",year:"numeric"})}function todayStr(){return new Date().toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}function Report(){const{state:e}=useLocation(),t=e?.projectData,n=e?.files||{},a=n?.logFile||null,i=n?.irrFile||null,[s,o]=React.useState(""),[c,h]=React.useState([]),[f,u]=React.useState(!1),[p,g]=React.useState(""),[v,m]=React.useState(todayStr()),[S,E]=React.useState(0);if(!t)return jsxRuntimeExports.jsx("div",{className:"text-center mt-20 text-gray-500",children:"No project data found. Please go back and analyze again."});const{siteName:w,location:T,installed:A,module:L,inverter:k,cod:D,actualProduction:N,irradiation:Y,days:z,gpsCountry:te}=t;React.useEffect(()=>{(async()=>{if(a)try{const O=await checkFusionSolarPeriod(a),I=O?.startDate?new Date(O.startDate).getMonth()+1:new Date().getMonth()+1,M=getMonthlyGHI(te||"Vietnam",I)/30,H=O?.days||z||15;E(Math.round(M*H)),g(fmtMonthRange(O.startDate,O.endDate)),m(todayStr())}catch{g("")}})()},[a]);const Z=new Date,ne=te||"Vietnam",oe=Z.getMonth()+1;getMonthlyGHI(ne,oe)/30;const le=z||15,pe=Number(N)||0,de=Number(String(A||"").replace(/[^\d.]/g,""))||0,J=Number(S)||0,V=de>0&&J>0?(pe/(de*J)*100).toFixed(2):"0.00";React.useEffect(()=>{(async()=>{if(!a||!de){o(V),h([]);return}try{u(!0);const O=await checkFusionSolarPeriod(a),I=O?.startDate?new Date(O.startDate).getMonth()+1:new Date().getMonth()+1,M=getMonthlyGHI(te||"Vietnam",I)/30,H=Array.from({length:O?.days||le},()=>M),G=computeRealPerformanceRatio(O,H,de),j=computeDailyRPRSeries(O,H,de);o(G),h(j)}catch(O){console.error("RPR calc error:",O),o("0.00")}finally{u(!1)}})()},[a,i,de]);const C=(O="")=>{const I=O.length;return typeof window<"u"&&window.innerWidth<768?I>55?"10.5px":I>45?"11.5px":I>35?"12px":"13px":I>55?"11.5px":I>45?"12.5px":I>35?"13.5px":"15px"};return jsxRuntimeExports.jsxs("div",{className:"bg-white min-h-screen flex flex-col items-center text-gray-800",children:[jsxRuntimeExports.jsxs("div",{className:"w-full max-w-[850px] bg-[#2563EB] rounded-lg shadow-md px-6 md:px-10 py-6 text-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start mb-3",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-[22px] md:text-[24px] font-bold tracking-tight",children:"Site Performance Report"}),jsxRuntimeExports.jsx("div",{className:"h-[3px] w-14 bg-white/80 rounded-full mt-1 mb-2"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm md:text-base",children:[jsxRuntimeExports.jsx("p",{className:"font-semibold",children:w||"Unnamed Site"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-100",children:[" COD:"," ",jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:D||"--"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"text-left md:text-right text-xs text-gray-100 leading-5 mt-3 md:mt-1",children:[jsxRuntimeExports.jsxs("p",{children:["Period:"," ",jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:p})]}),jsxRuntimeExports.jsxs("p",{children:["Generated:"," ",jsxRuntimeExports.jsx("span",{className:"font-medium text-white",children:v})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"grid gap-3 md:gap-5 mt-2 grid-cols-1 sm:grid-cols-2 md:grid-cols-[0.9fr_1fr_1.6fr]",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/10 border border-white/25 rounded-xl px-5 py-3",children:[jsxRuntimeExports.jsx("p",{className:"text-[13px] text-gray-200 font-medium mb-1",children:" GPS"}),jsxRuntimeExports.jsx("p",{className:"text-white font-medium text-sm md:text-base",children:T||""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/10 border border-white/25 rounded-xl px-5 py-3",children:[jsxRuntimeExports.jsx("p",{className:"text-[13px] text-gray-200 font-medium mb-1",children:" Capacity"}),jsxRuntimeExports.jsx("p",{className:"text-white font-semibold text-sm md:text-base",children:A||""})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/10 border border-white/25 rounded-xl px-5 py-3",children:[jsxRuntimeExports.jsx("p",{className:"text-[13px] text-gray-200 font-medium mb-1",children:" PV / INV"}),jsxRuntimeExports.jsxs("div",{className:"text-white font-medium leading-snug",children:[jsxRuntimeExports.jsx("p",{className:"truncate text-[12px] md:text-[14px]",children:L||""}),jsxRuntimeExports.jsx("p",{className:"whitespace-normal overflow-hidden text-[12px] md:text-[14px]",style:{fontSize:C(k)},children:k||""})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full max-w-[850px] bg-[#F9FBFF] rounded-lg shadow p-6 mb-6 mt-5",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-700",children:"Summary & Performance Trend"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-4 flex-1",children:[{title:["Actual","Production"],value:(pe||0).toLocaleString(),unit:"kWh",color:"#9CC9FF"},{title:["Total","Irradiation"],value:S,unit:"kWh/m",color:"#FFF3B0"},{title:["Real","Performance Ratio"],value:f?"":s,unit:"%",color:"#E6C4FF"},{title:["Performance","Ratio"],value:V,unit:"%",color:"#B9FBC0"}].map((O,I)=>jsxRuntimeExports.jsxs("div",{className:"rounded-2xl shadow-sm px-4 py-4 flex flex-col items-center justify-center text-center",style:{backgroundColor:O.color},children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium text-gray-700 leading-tight whitespace-pre-line",children:O.title.join(`
`)}),jsxRuntimeExports.jsx("div",{className:"mt-3",children:jsxRuntimeExports.jsxs("p",{className:"text-2xl font-bold text-gray-800 leading-tight",children:[O.value,jsxRuntimeExports.jsx("span",{className:"text-base font-semibold text-gray-700 ml-1",children:O.unit})]})})]},I))}),jsxRuntimeExports.jsxs("div",{className:"flex-1 bg-[#FFFFFF] rounded-2xl shadow-sm p-4",children:[jsxRuntimeExports.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2 text-center",children:"Daily RPR (%) Trend"}),jsxRuntimeExports.jsx(ResponsiveContainer,{width:"100%",height:220,children:jsxRuntimeExports.jsxs(LineChart,{data:c.length>0?c:[{date:"01",RPR:Number(s)||0}],margin:{top:10,right:20,left:0,bottom:10},children:[jsxRuntimeExports.jsx(CartesianGrid,{strokeDasharray:"3 3"}),jsxRuntimeExports.jsx(XAxis,{dataKey:"date",tick:{fontSize:11},interval:"preserveStartEnd"}),jsxRuntimeExports.jsx(YAxis,{domain:[0,100],tick:{fontSize:11},unit:"%"}),jsxRuntimeExports.jsx(Tooltip,{}),jsxRuntimeExports.jsx(Line,{type:"monotone",dataKey:"RPR",stroke:"#66B2FF",strokeWidth:2,dot:{r:3}})]})})]})]}),!i&&jsxRuntimeExports.jsx("p",{className:"text-left text-gray-500 italic text-xs mt-3 ml-1",children:"No irradiation file uploaded  using monthly baseline for reference."})]}),jsxRuntimeExports.jsx("div",{className:"w-full max-w-[850px] flex justify-end pr-3 mt-auto mb-4",children:jsxRuntimeExports.jsx("p",{className:"text-[11px] italic text-gray-400 font-light",children:"Automatically generated by iSolarChecking"})})]})}function App(){return jsxRuntimeExports.jsx(Routes,{children:jsxRuntimeExports.jsxs(Route,{element:jsxRuntimeExports.jsx(AppLayout,{}),children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(HomePage,{})}),jsxRuntimeExports.jsx(Route,{path:"/report",element:jsxRuntimeExports.jsx(Report,{})})]})})}ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(App,{})})}));
